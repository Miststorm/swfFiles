var globalWorkersBlob = (function(){ var d = "var global = self; var Reflect = {global: global};\n";
 d += "!function(){return function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var u=\"function\"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error(\"Cannot find module '\"+a+\"'\");throw c.code=\"MODULE_NOT_FOUND\",c}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){return o(t[a][1][e]||e)},l,l.exports,e,t,r,n)}return r[a].exports}for(var i=\"function\"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}}()({1:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o={};try{o=e(\"./local-config\")}catch(e){}n.merge(o,{redis:{port:6379,host:\"127.0.0.1\",options:{}}}),t.exports=o},{\"./local-config\":35,lodash:61}],2:[function(e,t,r){\"use strict\";e(\"q\"),e(\"./local-storage\");var n=e(\"lodash\"),o=e(\"./message-mux\");function i(e){for(var t in e)\"_\"!=t[0]?n.isArray(e[t])?e[t].forEach(i):n.isObject(e[t])&&i(e[t]):delete e[t]}t.exports=function(e){var t=[],r=[],a=[],s=[];return{update:function(e,r){i(r=n.cloneDeep(r)),n.isObject(e)&&(n.merge(e,r),e=e._id),t.push({_id:e,data:r})},insert:function(e){i(e=n.cloneDeep(e)),r.push(e)},remove:function(e){a.push(e)},inc:function(e,t,r){n.isObject(e)&&(e=e._id),s.push({_id:e,key:t,amount:r})},addToSet:function(){},pull:function(){},execute:function(){return o.sendMessage({type:\"bulk\",storage:e,updates:t,inserts:r,removes:a,incs:s})}}}},{\"./local-storage\":6,\"./message-mux\":7,lodash:9,q:10}],3:[function(e,t,r){\"use strict\";t.exports={localStorage:{PENDING_QUEUE:\"pendingQueue_\",PROCESSING_QUEUE:\"processingQueue_\",USERS:\"users\",USERS_CODE:\"users.code.activeSim\",USERS_MEMORY:\"users.memory\",TRANSACTIONS:\"transactions\",ROOMS:\"rooms\",ROOMS_OBJECTS:\"rooms.objects\",ROOMS_FLAGS:\"rooms.flags\",ROOMS_TERRAIN:\"rooms.terrain\",ROOMS_INTENTS:\"rooms.intents\",GAME_TIME:\"gametime\",RUN_TIMESTAMP:\"runTimestamp\",GAME_INFO:\"gameinfo\",REPLAY:\"replay\",ROOM_VISUAL:\"visual\",USERS_MEMORY_SEGMENTS:\"users.memory.segments\",ROOM_EVENT_LOG:\"roomEvent\"}}},{}],4:[function(e,t,r){\"use strict\";var n=e(\"q\");r.saveTick=function(e,t,r){return n.when()},r.get=function(e){return n.when()},r.upload=function(e,t,r){return n.when()},r.del=function(e){return n.when()}},{q:10}],5:[function(require,module,exports){\"use strict\";function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EvalCodeError(e){this.toString=function(){return e}}!function(){exports.constants=require(\"@screeps/common/lib/constants\");var e=require(\"lodash\"),t=require(\"q\"),r=require(\"events\").EventEmitter,n=require(\"./config\"),o=require(\"./local-storage\"),i=require(\"./bulk\"),a=require(\"./workers\"),s=require(\"./message-mux\"),u={0:[],1:[],2:[]},c=t.defer(),l=(new Date).getTime(),p=require(\"../utils\");exports.config=new r,Object.assign(exports.config,{mainLoopMinDuration:void 0,mainLoopResetInterval:1e4,mainLoopCustomStage:function(){return t.when()},customIntentTypes:{}}),self.onmessage=function(e){\"setTickPeriod\"==e.data.type?c.resolve(e.data.period):\"worker\"==e.data.type?a.handleMessage(e.data):e.data.consoleCommand?u[e.data.userId].push({expression:e.data.consoleCommand}):s.handleMessage(e.data)},setInterval(function(){o.get(n.localStorage.RUN_TIMESTAMP).then(function(e){e>l&&self.close()})},1e3),exports.queue=require(\"./queue\"),exports.connect=function(e){return(\"main\"==e?c.promise.then(function(e){return exports.config.mainLoopMinDuration=parseInt(e)}):t.when()).then(function(){return t.all([o.initArray(n.localStorage.USERS),o.initArray(n.localStorage.ROOMS,[{_id:\"sim\"}]),o.initArray(n.localStorage.ROOMS_OBJECTS),o.initArray(n.localStorage.ROOMS_FLAGS),o.initArray(n.localStorage.ROOMS_INTENTS)])})},exports.setupRunner=function(){},exports.setupProcessor=function(){},exports.setupMain=function(){},exports.getUserData=function(t){return o.get(n.localStorage.USERS).then(function(r){var n=new Object({user:e.find(n[0],function(e){return e._id==t}),cpu:1/0});return n})},exports.getRuntimeData=function(r){return t.all([o.get(n.localStorage.USERS),o.get(n.localStorage.USERS_CODE).then(function(t){return e.find(t,function(e){return e._id==r})}),o.get(n.localStorage.ROOMS_OBJECTS),o.get(n.localStorage.ROOMS),o.get(n.localStorage.GAME_TIME),o.get(n.localStorage.ROOMS_TERRAIN),o.get(n.localStorage.USERS_MEMORY).then(function(t){return e.find(t,function(e){return e._id==r})}),o.get(n.localStorage.GAME_INFO),o.get(n.localStorage.TRANSACTIONS),o.get(n.localStorage.ROOMS_FLAGS),o.get(n.localStorage.USERS_MEMORY_SEGMENTS).then(function(t){return e.find(t,function(e){return e._id==r})}),o.get(n.localStorage.ROOM_EVENT_LOG)]).then(function(t){var n={};t[5].forEach(function(e){for(var t,r=new Uint8Array(2500),o=0;o<2500;o++)t=e.terrain.charAt(o),r[o]=Number(t);n[e.room]=r}),t[9].forEach(function(e){return e.room=\"sim\"});var o=e.find(t[0],function(e){return e._id==r});t=new Object({user:o,users:exports.mapById(t[0]),userCode:t[1]&&t[1].modules,userCodeTimestamp:t[1]&&t[1].timestamp||0,userObjects:exports.mapById(e.filter(t[2],function(e){return e.user==r})),roomObjects:exports.mapById(t[2]),flags:e.filter(t[9],function(e){return e.user==r}),rooms:exports.mapById(t[3]),time:t[4],consoleCommands:u[r],userMemory:t[6].memory,memorySegments:t[10].segments,cpu:1/0,games:{sim:t[7]},transactions:{incoming:t[8],outgoing:t[8]},market:{orders:{all:{}},myOrders:[]},staticTerrainData:n,roomEventLog:JSON.parse(t[11]),userPowerCreeps:{},sim:!0});return u[r]=[],t})},exports.initUserRoomVisibility=function(){return t.when()},exports.setUserRoomVisibility=function(e,r){return t.when()},exports.resetUserRoomVisibility=function(e){return t.when()},exports.getAllUsers=function(){return o.get(n.localStorage.USERS).then(function(e){return{ivm:[],legacy:e}})},exports.restartAllRuntimes=function(){return t.when()},exports.makeRuntime=function(e,r){return exports.getRuntimeData(e,r).then(function(r){var i=a.create(\"runtime\"),u=t.defer(),c=!1,l={type:\"timeout\",timeout:5e3};return s.sendMessage(l).then(function(){c||(i.terminate(),u.reject(\"Script execution has been terminated\"))}),i.onmessage=function(t){\"done\"==t.data.type&&(c=!0,s.sendMessage({type:\"clearTimeout\",timeoutTransactionId:l.transactionId}),t.data.intents&&(t.data.intents=p.storeIntents(e,t.data.intents,r)),t.data.visual&&(o.put(n.localStorage.ROOM_VISUAL,t.data.visual),delete t.data.visual),u.resolve(t.data)),\"error\"==t.data.type&&(c=!0,s.sendMessage({type:\"clearTimeout\",timeoutTransactionId:l.transactionId}),t.data.intents&&(t.data.intents=p.storeIntents(e,t.data.intents,r)),u.reject(t.data))},i.postMessage(r),u.promise}).catch(function(e){return\"error\"==e.type?t.reject(e):t.reject({type:\"reject\"})})},exports.saveUserMemory=function(t,r){return o.get(n.localStorage.USERS_MEMORY).then(function(i){return e.find(i,function(e){return e._id==t}).memory=r,o.put(n.localStorage.USERS_MEMORY,i)})},exports.saveUserMemorySegments=function(t,r){return o.get(n.localStorage.USERS_MEMORY_SEGMENTS).then(function(i){var a=e.find(i,function(e){return e._id==t});for(var s in r)a.segments[s]=r[s];return o.put(n.localStorage.USERS_MEMORY_SEGMENTS,i)})},exports.saveUserIntents=function(t,r){return o.get(n.localStorage.ROOMS_INTENTS).then(function(i){for(var a in r)if(\"notify\"!=a){var s=e.find(i,{room:a});s||i.push(s={room:a}),s.users=s.users||{},s.users[t]=s.users[t]||{objects:{}},e.merge(s.users[t].objects,r[a])}return o.put(n.localStorage.ROOMS_INTENTS,i)})},exports.getAllRooms=function(){return o.get(n.localStorage.ROOMS)},exports.getRoomIntents=function(t){return o.get(n.localStorage.ROOMS_INTENTS).then(function(r){return e.find(r,{room:t})})},exports.getRoomObjects=function(e){return o.get(n.localStorage.ROOMS_OBJECTS).then(function(e){var t={users:{}};return t.objects=exports.mapById(e,function(e){e.user&&(t.users[e.user]={})}),t})},exports.getRoomFlags=function(e){return o.get(n.localStorage.ROOMS_FLAGS)},exports.getRoomTerrain=function(e){return o.get(n.localStorage.ROOMS_TERRAIN).then(function(e){return exports.mapById(e)})},exports.bulkObjectsWrite=function(){return i(n.localStorage.ROOMS_OBJECTS)},exports.bulkFlagsWrite=function(){return i(n.localStorage.ROOMS_FLAGS)},exports.bulkUsersWrite=function(){return i(n.localStorage.USERS)},exports.bulkTransactionsWrite=function(){return i(n.localStorage.TRANSACTIONS)},exports.bulkRoomsWrite=function(){return i(n.localStorage.ROOMS_FLAGS)},exports.clearRoomIntents=function(t){return o.get(n.localStorage.ROOMS_INTENTS).then(function(r){return e.remove(r,{room:t}),o.put(n.localStorage.ROOMS_INTENTS,r)})},exports.mapById=function(t,r){return e.reduce(t,function(e,t){return e[t._id.toString()]=t,r&&r(t),e},{})},exports.notifyRoomsDone=function(){return s.sendMessage({type:\"roomsDone\"})},exports.sendConsoleMessages=function(e,t){self.postMessage({type:\"console\",userId:e,messages:t})},exports.sendConsoleError=function(e,t){self.postMessage({type:\"console\",userId:e,error:\"\"+t})},exports.getGameTime=function(){return o.get(n.localStorage.GAME_TIME).then(parseInt)},exports.incrementGameTime=function(){return o.get(n.localStorage.GAME_TIME).then(function(e){return e++,o.put(n.localStorage.GAME_TIME,e)})},exports.getGameInfo=function(){return o.get(n.localStorage.GAME_INFO)},exports.saveGameInfo=function(e,t){return o.get(n.localStorage.REPLAY).then(function(r){return r.log[e.score]=p.getDiff(r.current,t),r.current=t,o.put(n.localStorage.REPLAY,r)}).then(function(){return o.put(n.localStorage.GAME_INFO,e)})},exports.getInterRoom=function(){return t.when()},exports.saveRoomInfo=function(e,r){return t.when(null)},exports.updateAccessibleRoomsList=function(){return t.when(null)},exports.sendNotification=function(){return t.when(null)},exports.getRoomStatsUpdater=function(){return{inc:function(){},save:function(){return t.when(null)}}},exports.roomsStatsSave=function(){return t.when(null)},exports.commitDbBulk=function(){return t.when(null)},exports.notifyTickStarted=function(){return t.when(null)},exports.getMapGridData=function(){return{}},exports.mapViewSave=function(){return t.when(null)},exports.getRoomInfo=function(){return t.when({})},exports.bulkUsersMoney=function(){return{execute:function(){return t.when()}}},exports.bulkUsersResources=function(){return{execute:function(){return t.when()}}},exports.bulkMarketOrders=function(){return{execute:function(){return t.when()}}},exports.bulkUsersPowerCreeps=function(){return{execute:function(){return t.when()}}},exports.getWorldSize=function(){return 1},exports.addRoomToUser=function(){},exports.removeRoomFromUser=function(){},exports.bufferFromBase64=function(e){for(var t=atob(e),r=t.length,n=new Uint8Array(new ArrayBuffer(r)),o=0;o<r;o++)n[o]=t.charCodeAt(o);return n},exports.startLoop=function(e,t){!function e(){t().finally(e)}()},exports.saveRoomEventLog=function(e,t){return o.put(n.localStorage.ROOM_EVENT_LOG,JSON.stringify(_defineProperty({},e,JSON.stringify(t))))},exports.clearGlobalIntents=function(){return t.when()},exports.history=require(\"./history\"),exports.pathFinder=require(\"./path-finder\")}(),exports.evalCode=function(module,globals,returnValue){var window,self,process,exports=module.exports,scopeInject=\"\";for(var i in globals)scopeInject+=i+\" = __globals.\"+i+\", \";module.name=module.name.replace(/[^a-zA-Z0-9_]+/g,\"\");try{if(returnValue)return eval(\"(function __run_\"+module.name+\"(__globals){ var \"+scopeInject+\"globals = undefined, __result = \"+module.code+\";\\n return __result; \\n}).call(global, globals);\");\"__mainLoop\"!=module.name&&(module.code=\"module.__initGlobals = function() { \"+scopeInject.replace(/,/g,\";\")+\" }; \"+module.code),eval(\"(function __run_\"+module.name+\"(__globals){ var \"+scopeInject+\"globals = undefined; \"+module.code+\" \\n}).call(global, globals);\")}catch(e){if(e instanceof EvalCodeError)throw e;var message=\"\";if(/at Object\\.exports\\.evalCode /.test(e.stack)){message=e.stack,message=message.replace(/at __run_([^ ]+) /g,\"at $1 \"),message=message.replace(/</g,\"&lt;\");var strip=[\"Object\\\\.eval\",\"Object\\\\.exports\\\\.evalCode\",\"Object\\\\.exports\\\\.runCode\",\"requireFn\"];strip.forEach(function(e){var t=new RegExp(\" *at \"+e+\" [^\\n]*?\\n\",\"g\");message=message.replace(t,\"\")}),message=message.replace(/ *at .*?$/,\"\"),message=message.replace(/ \\([^\\n]*\\:(\\d+)\\:(\\d+)\\)\\n/g,\":$1:$2\\n\"),message=message.replace(/_console\\d+:\\d+/g,\"console\")}else message=e.message;throw new EvalCodeError(message)}}},{\"../utils\":184,\"./bulk\":2,\"./config\":3,\"./history\":4,\"./local-storage\":6,\"./message-mux\":7,\"./path-finder\":11,\"./queue\":12,\"./workers\":15,\"@screeps/common/lib/constants\":8,events:185,lodash:9,q:10}],6:[function(e,t,r){\"use strict\";e(\"q\");var n=e(\"./message-mux\");r.put=function(e,t){return n.sendMessage({type:\"localStorage\",put:{key:e,value:t}}).then(function(e){return e.put.value})},r.get=function(e){return n.sendMessage({type:\"localStorage\",get:{key:e}}).then(function(e){return e.get.value})},r.initArray=function(e,t){return r.get(e).then(function(n){if(!n)return r.put(e,t||[])})}},{\"./message-mux\":7,q:10}],7:[function(e,t,r){\"use strict\";var n=e(\"q\"),o={},i=0;r.sendMessage=function(e){return o[++i]=n.defer(),e.transactionId=i,self.postMessage(e),o[i].promise},r.handleMessage=function(e){o[e.transactionId]&&(e.reject?o[e.transactionId].reject(e):o[e.transactionId].resolve(e),delete o[e.transactionId])}},{q:10}],8:[function(e,t,r){Object.assign(r,{OK:0,ERR_NOT_OWNER:-1,ERR_NO_PATH:-2,ERR_NAME_EXISTS:-3,ERR_BUSY:-4,ERR_NOT_FOUND:-5,ERR_NOT_ENOUGH_ENERGY:-6,ERR_NOT_ENOUGH_RESOURCES:-6,ERR_INVALID_TARGET:-7,ERR_FULL:-8,ERR_NOT_IN_RANGE:-9,ERR_INVALID_ARGS:-10,ERR_TIRED:-11,ERR_NO_BODYPART:-12,ERR_NOT_ENOUGH_EXTENSIONS:-6,ERR_RCL_NOT_ENOUGH:-14,ERR_GCL_NOT_ENOUGH:-15,FIND_EXIT_TOP:1,FIND_EXIT_RIGHT:3,FIND_EXIT_BOTTOM:5,FIND_EXIT_LEFT:7,FIND_EXIT:10,FIND_CREEPS:101,FIND_MY_CREEPS:102,FIND_HOSTILE_CREEPS:103,FIND_SOURCES_ACTIVE:104,FIND_SOURCES:105,FIND_DROPPED_ENERGY:-106,FIND_DROPPED_RESOURCES:106,FIND_STRUCTURES:107,FIND_MY_STRUCTURES:108,FIND_HOSTILE_STRUCTURES:109,FIND_FLAGS:110,FIND_CONSTRUCTION_SITES:111,FIND_MY_SPAWNS:112,FIND_HOSTILE_SPAWNS:113,FIND_MY_CONSTRUCTION_SITES:114,FIND_HOSTILE_CONSTRUCTION_SITES:115,FIND_MINERALS:116,FIND_NUKES:117,FIND_TOMBSTONES:118,FIND_POWER_CREEPS:119,FIND_MY_POWER_CREEPS:120,FIND_HOSTILE_POWER_CREEPS:121,TOP:1,TOP_RIGHT:2,RIGHT:3,BOTTOM_RIGHT:4,BOTTOM:5,BOTTOM_LEFT:6,LEFT:7,TOP_LEFT:8,COLOR_RED:1,COLOR_PURPLE:2,COLOR_BLUE:3,COLOR_CYAN:4,COLOR_GREEN:5,COLOR_YELLOW:6,COLOR_ORANGE:7,COLOR_BROWN:8,COLOR_GREY:9,COLOR_WHITE:10,LOOK_CREEPS:\"creep\",LOOK_ENERGY:\"energy\",LOOK_RESOURCES:\"resource\",LOOK_SOURCES:\"source\",LOOK_MINERALS:\"mineral\",LOOK_STRUCTURES:\"structure\",LOOK_FLAGS:\"flag\",LOOK_CONSTRUCTION_SITES:\"constructionSite\",LOOK_NUKES:\"nuke\",LOOK_TERRAIN:\"terrain\",LOOK_TOMBSTONES:\"tombstone\",LOOK_POWER_CREEPS:\"powerCreep\",OBSTACLE_OBJECT_TYPES:[\"spawn\",\"creep\",\"powerCreep\",\"source\",\"mineral\",\"controller\",\"constructedWall\",\"extension\",\"link\",\"storage\",\"tower\",\"observer\",\"powerSpawn\",\"powerBank\",\"lab\",\"terminal\",\"nuker\"],MOVE:\"move\",WORK:\"work\",CARRY:\"carry\",ATTACK:\"attack\",RANGED_ATTACK:\"ranged_attack\",TOUGH:\"tough\",HEAL:\"heal\",CLAIM:\"claim\",BODYPART_COST:{move:50,work:100,attack:80,carry:50,heal:250,ranged_attack:150,tough:10,claim:600},WORLD_WIDTH:202,WORLD_HEIGHT:202,CREEP_LIFE_TIME:1500,CREEP_CLAIM_LIFE_TIME:600,CREEP_CORPSE_RATE:.2,CREEP_PART_MAX_ENERGY:125,CARRY_CAPACITY:50,HARVEST_POWER:2,HARVEST_MINERAL_POWER:1,REPAIR_POWER:100,DISMANTLE_POWER:50,BUILD_POWER:5,ATTACK_POWER:30,UPGRADE_CONTROLLER_POWER:1,RANGED_ATTACK_POWER:10,HEAL_POWER:12,RANGED_HEAL_POWER:4,REPAIR_COST:.01,DISMANTLE_COST:.005,RAMPART_DECAY_AMOUNT:300,RAMPART_DECAY_TIME:100,RAMPART_HITS:1,RAMPART_HITS_MAX:{2:3e5,3:1e6,4:3e6,5:1e7,6:3e7,7:1e8,8:3e8},ENERGY_REGEN_TIME:300,ENERGY_DECAY:1e3,SPAWN_HITS:5e3,SPAWN_ENERGY_START:300,SPAWN_ENERGY_CAPACITY:300,CREEP_SPAWN_TIME:3,SPAWN_RENEW_RATIO:1.2,SOURCE_ENERGY_CAPACITY:3e3,SOURCE_ENERGY_NEUTRAL_CAPACITY:1500,SOURCE_ENERGY_KEEPER_CAPACITY:4e3,WALL_HITS:1,WALL_HITS_MAX:3e8,EXTENSION_HITS:1e3,EXTENSION_ENERGY_CAPACITY:{0:50,1:50,2:50,3:50,4:50,5:50,6:50,7:100,8:200},ROAD_HITS:5e3,ROAD_WEAROUT:1,ROAD_WEAROUT_POWER_CREEP:100,ROAD_DECAY_AMOUNT:100,ROAD_DECAY_TIME:1e3,LINK_HITS:1e3,LINK_HITS_MAX:1e3,LINK_CAPACITY:800,LINK_COOLDOWN:1,LINK_LOSS_RATIO:.03,STORAGE_CAPACITY:1e6,STORAGE_HITS:1e4,STRUCTURE_SPAWN:\"spawn\",STRUCTURE_EXTENSION:\"extension\",STRUCTURE_ROAD:\"road\",STRUCTURE_WALL:\"constructedWall\",STRUCTURE_RAMPART:\"rampart\",STRUCTURE_KEEPER_LAIR:\"keeperLair\",STRUCTURE_PORTAL:\"portal\",STRUCTURE_CONTROLLER:\"controller\",STRUCTURE_LINK:\"link\",STRUCTURE_STORAGE:\"storage\",STRUCTURE_TOWER:\"tower\",STRUCTURE_OBSERVER:\"observer\",STRUCTURE_POWER_BANK:\"powerBank\",STRUCTURE_POWER_SPAWN:\"powerSpawn\",STRUCTURE_EXTRACTOR:\"extractor\",STRUCTURE_LAB:\"lab\",STRUCTURE_TERMINAL:\"terminal\",STRUCTURE_CONTAINER:\"container\",STRUCTURE_NUKER:\"nuker\",CONSTRUCTION_COST:{spawn:15e3,extension:3e3,road:300,constructedWall:1,rampart:1,link:5e3,storage:3e4,tower:5e3,observer:8e3,powerSpawn:1e5,extractor:5e3,lab:5e4,terminal:1e5,container:5e3,nuker:1e5},CONSTRUCTION_COST_ROAD_SWAMP_RATIO:5,CONSTRUCTION_COST_ROAD_WALL_RATIO:150,CONTROLLER_LEVELS:{1:200,2:45e3,3:135e3,4:405e3,5:1215e3,6:3645e3,7:10935e3},CONTROLLER_STRUCTURES:{spawn:{0:0,1:1,2:1,3:1,4:1,5:1,6:1,7:2,8:3},extension:{0:0,1:0,2:5,3:10,4:20,5:30,6:40,7:50,8:60},link:{1:0,2:0,3:0,4:0,5:2,6:3,7:4,8:6},road:{0:2500,1:2500,2:2500,3:2500,4:2500,5:2500,6:2500,7:2500,8:2500},constructedWall:{1:0,2:2500,3:2500,4:2500,5:2500,6:2500,7:2500,8:2500},rampart:{1:0,2:2500,3:2500,4:2500,5:2500,6:2500,7:2500,8:2500},storage:{1:0,2:0,3:0,4:1,5:1,6:1,7:1,8:1},tower:{1:0,2:0,3:1,4:1,5:2,6:2,7:3,8:6},observer:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1},powerSpawn:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1},extractor:{1:0,2:0,3:0,4:0,5:0,6:1,7:1,8:1},terminal:{1:0,2:0,3:0,4:0,5:0,6:1,7:1,8:1},lab:{1:0,2:0,3:0,4:0,5:0,6:3,7:6,8:10},container:{0:5,1:5,2:5,3:5,4:5,5:5,6:5,7:5,8:5},nuker:{1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1}},CONTROLLER_DOWNGRADE:{1:2e4,2:1e4,3:2e4,4:4e4,5:8e4,6:12e4,7:15e4,8:2e5},CONTROLLER_DOWNGRADE_RESTORE:100,CONTROLLER_DOWNGRADE_SAFEMODE_THRESHOLD:5e3,CONTROLLER_CLAIM_DOWNGRADE:300,CONTROLLER_RESERVE:1,CONTROLLER_RESERVE_MAX:5e3,CONTROLLER_MAX_UPGRADE_PER_TICK:15,CONTROLLER_ATTACK_BLOCKED_UPGRADE:1e3,CONTROLLER_NUKE_BLOCKED_UPGRADE:200,SAFE_MODE_DURATION:2e4,SAFE_MODE_COOLDOWN:5e4,SAFE_MODE_COST:1e3,TOWER_HITS:3e3,TOWER_CAPACITY:1e3,TOWER_ENERGY_COST:10,TOWER_POWER_ATTACK:600,TOWER_POWER_HEAL:400,TOWER_POWER_REPAIR:800,TOWER_OPTIMAL_RANGE:5,TOWER_FALLOFF_RANGE:20,TOWER_FALLOFF:.75,OBSERVER_HITS:500,OBSERVER_RANGE:10,POWER_BANK_HITS:2e6,POWER_BANK_CAPACITY_MAX:5e3,POWER_BANK_CAPACITY_MIN:500,POWER_BANK_CAPACITY_CRIT:.3,POWER_BANK_DECAY:5e3,POWER_BANK_HIT_BACK:.5,POWER_SPAWN_HITS:5e3,POWER_SPAWN_ENERGY_CAPACITY:5e3,POWER_SPAWN_POWER_CAPACITY:100,POWER_SPAWN_ENERGY_RATIO:50,EXTRACTOR_HITS:500,EXTRACTOR_COOLDOWN:5,LAB_HITS:500,LAB_MINERAL_CAPACITY:3e3,LAB_ENERGY_CAPACITY:2e3,LAB_BOOST_ENERGY:20,LAB_BOOST_MINERAL:30,LAB_COOLDOWN:10,LAB_REACTION_AMOUNT:5,LAB_UNBOOST_ENERGY:0,LAB_UNBOOST_MINERAL:15,GCL_POW:2.4,GCL_MULTIPLY:1e6,GCL_NOVICE:3,MODE_SIMULATION:null,MODE_WORLD:null,TERRAIN_MASK_WALL:1,TERRAIN_MASK_SWAMP:2,TERRAIN_MASK_LAVA:4,MAX_CONSTRUCTION_SITES:100,MAX_CREEP_SIZE:50,MINERAL_REGEN_TIME:5e4,MINERAL_MIN_AMOUNT:{H:35e3,O:35e3,L:35e3,K:35e3,Z:35e3,U:35e3,X:35e3},MINERAL_RANDOM_FACTOR:2,MINERAL_DENSITY:{1:15e3,2:35e3,3:7e4,4:1e5},MINERAL_DENSITY_PROBABILITY:{1:.1,2:.5,3:.9,4:1},MINERAL_DENSITY_CHANGE:.05,DENSITY_LOW:1,DENSITY_MODERATE:2,DENSITY_HIGH:3,DENSITY_ULTRA:4,TERMINAL_CAPACITY:3e5,TERMINAL_HITS:3e3,TERMINAL_SEND_COST:.1,TERMINAL_MIN_SEND:100,TERMINAL_COOLDOWN:10,CONTAINER_HITS:25e4,CONTAINER_CAPACITY:2e3,CONTAINER_DECAY:5e3,CONTAINER_DECAY_TIME:100,CONTAINER_DECAY_TIME_OWNED:500,NUKER_HITS:1e3,NUKER_COOLDOWN:1e5,NUKER_ENERGY_CAPACITY:3e5,NUKER_GHODIUM_CAPACITY:5e3,NUKE_LAND_TIME:5e4,NUKE_RANGE:10,NUKE_DAMAGE:{0:1e7,2:5e6},TOMBSTONE_DECAY_PER_PART:5,TOMBSTONE_DECAY_POWER_CREEP:500,PORTAL_DECAY:3e4,ORDER_SELL:\"sell\",ORDER_BUY:\"buy\",MARKET_FEE:.05,FLAGS_LIMIT:1e4,SUBSCRIPTION_TOKEN:\"token\",RESOURCE_ENERGY:\"energy\",RESOURCE_POWER:\"power\",RESOURCE_HYDROGEN:\"H\",RESOURCE_OXYGEN:\"O\",RESOURCE_UTRIUM:\"U\",RESOURCE_LEMERGIUM:\"L\",RESOURCE_KEANIUM:\"K\",RESOURCE_ZYNTHIUM:\"Z\",RESOURCE_CATALYST:\"X\",RESOURCE_GHODIUM:\"G\",RESOURCE_HYDROXIDE:\"OH\",RESOURCE_ZYNTHIUM_KEANITE:\"ZK\",RESOURCE_UTRIUM_LEMERGITE:\"UL\",RESOURCE_UTRIUM_HYDRIDE:\"UH\",RESOURCE_UTRIUM_OXIDE:\"UO\",RESOURCE_KEANIUM_HYDRIDE:\"KH\",RESOURCE_KEANIUM_OXIDE:\"KO\",RESOURCE_LEMERGIUM_HYDRIDE:\"LH\",RESOURCE_LEMERGIUM_OXIDE:\"LO\",RESOURCE_ZYNTHIUM_HYDRIDE:\"ZH\",RESOURCE_ZYNTHIUM_OXIDE:\"ZO\",RESOURCE_GHODIUM_HYDRIDE:\"GH\",RESOURCE_GHODIUM_OXIDE:\"GO\",RESOURCE_UTRIUM_ACID:\"UH2O\",RESOURCE_UTRIUM_ALKALIDE:\"UHO2\",RESOURCE_KEANIUM_ACID:\"KH2O\",RESOURCE_KEANIUM_ALKALIDE:\"KHO2\",RESOURCE_LEMERGIUM_ACID:\"LH2O\",RESOURCE_LEMERGIUM_ALKALIDE:\"LHO2\",RESOURCE_ZYNTHIUM_ACID:\"ZH2O\",RESOURCE_ZYNTHIUM_ALKALIDE:\"ZHO2\",RESOURCE_GHODIUM_ACID:\"GH2O\",RESOURCE_GHODIUM_ALKALIDE:\"GHO2\",RESOURCE_CATALYZED_UTRIUM_ACID:\"XUH2O\",RESOURCE_CATALYZED_UTRIUM_ALKALIDE:\"XUHO2\",RESOURCE_CATALYZED_KEANIUM_ACID:\"XKH2O\",RESOURCE_CATALYZED_KEANIUM_ALKALIDE:\"XKHO2\",RESOURCE_CATALYZED_LEMERGIUM_ACID:\"XLH2O\",RESOURCE_CATALYZED_LEMERGIUM_ALKALIDE:\"XLHO2\",RESOURCE_CATALYZED_ZYNTHIUM_ACID:\"XZH2O\",RESOURCE_CATALYZED_ZYNTHIUM_ALKALIDE:\"XZHO2\",RESOURCE_CATALYZED_GHODIUM_ACID:\"XGH2O\",RESOURCE_CATALYZED_GHODIUM_ALKALIDE:\"XGHO2\",RESOURCE_OPS:\"ops\",REACTIONS:{H:{O:\"OH\",L:\"LH\",K:\"KH\",U:\"UH\",Z:\"ZH\",G:\"GH\"},O:{H:\"OH\",L:\"LO\",K:\"KO\",U:\"UO\",Z:\"ZO\",G:\"GO\"},Z:{K:\"ZK\",H:\"ZH\",O:\"ZO\"},L:{U:\"UL\",H:\"LH\",O:\"LO\"},K:{Z:\"ZK\",H:\"KH\",O:\"KO\"},G:{H:\"GH\",O:\"GO\"},U:{L:\"UL\",H:\"UH\",O:\"UO\"},OH:{UH:\"UH2O\",UO:\"UHO2\",ZH:\"ZH2O\",ZO:\"ZHO2\",KH:\"KH2O\",KO:\"KHO2\",LH:\"LH2O\",LO:\"LHO2\",GH:\"GH2O\",GO:\"GHO2\"},X:{UH2O:\"XUH2O\",UHO2:\"XUHO2\",LH2O:\"XLH2O\",LHO2:\"XLHO2\",KH2O:\"XKH2O\",KHO2:\"XKHO2\",ZH2O:\"XZH2O\",ZHO2:\"XZHO2\",GH2O:\"XGH2O\",GHO2:\"XGHO2\"},ZK:{UL:\"G\"},UL:{ZK:\"G\"},LH:{OH:\"LH2O\"},ZH:{OH:\"ZH2O\"},GH:{OH:\"GH2O\"},KH:{OH:\"KH2O\"},UH:{OH:\"UH2O\"},LO:{OH:\"LHO2\"},ZO:{OH:\"ZHO2\"},KO:{OH:\"KHO2\"},UO:{OH:\"UHO2\"},GO:{OH:\"GHO2\"},LH2O:{X:\"XLH2O\"},KH2O:{X:\"XKH2O\"},ZH2O:{X:\"XZH2O\"},UH2O:{X:\"XUH2O\"},GH2O:{X:\"XGH2O\"},LHO2:{X:\"XLHO2\"},UHO2:{X:\"XUHO2\"},KHO2:{X:\"XKHO2\"},ZHO2:{X:\"XZHO2\"},GHO2:{X:\"XGHO2\"}},BOOSTS:{work:{UO:{harvest:3},UHO2:{harvest:5},XUHO2:{harvest:7},LH:{build:1.5,repair:1.5},LH2O:{build:1.8,repair:1.8},XLH2O:{build:2,repair:2},ZH:{dismantle:2},ZH2O:{dismantle:3},XZH2O:{dismantle:4},GH:{upgradeController:1.5},GH2O:{upgradeController:1.8},XGH2O:{upgradeController:2}},attack:{UH:{attack:2},UH2O:{attack:3},XUH2O:{attack:4}},ranged_attack:{KO:{rangedAttack:2,rangedMassAttack:2},KHO2:{rangedAttack:3,rangedMassAttack:3},XKHO2:{rangedAttack:4,rangedMassAttack:4}},heal:{LO:{heal:2,rangedHeal:2},LHO2:{heal:3,rangedHeal:3},XLHO2:{heal:4,rangedHeal:4}},carry:{KH:{capacity:2},KH2O:{capacity:3},XKH2O:{capacity:4}},move:{ZO:{fatigue:2},ZHO2:{fatigue:3},XZHO2:{fatigue:4}},tough:{GO:{damage:.7},GHO2:{damage:.5},XGHO2:{damage:.3}}},REACTION_TIME:{OH:20,ZK:5,UL:5,G:5,UH:10,UH2O:5,XUH2O:60,UO:10,UHO2:5,XUHO2:60,KH:10,KH2O:5,XKH2O:60,KO:10,KHO2:5,XKHO2:60,LH:15,LH2O:10,XLH2O:65,LO:10,LHO2:5,XLHO2:60,ZH:20,ZH2O:40,XZH2O:160,ZO:10,ZHO2:5,XZHO2:60,GH:10,GH2O:15,XGH2O:80,GO:10,GHO2:30,XGHO2:150},PORTAL_UNSTABLE:864e6,PORTAL_MIN_TIMEOUT:10368e5,PORTAL_MAX_TIMEOUT:19008e5,POWER_BANK_RESPAWN_TIME:5e4,INVADERS_ENERGY_GOAL:1e5,SYSTEM_USERNAME:\"Screeps\",SIGN_NOVICE_AREA:\"A new Novice or Respawn Area is being planned somewhere in this sector. Please make sure all important rooms are reserved.\",SIGN_RESPAWN_AREA:\"A new Novice or Respawn Area is being planned somewhere in this sector. Please make sure all important rooms are reserved.\",SIGN_PLANNED_AREA:\"A new Novice or Respawn Area is being planned somewhere in this sector. Please make sure all important rooms are reserved.\",EVENT_ATTACK:1,EVENT_OBJECT_DESTROYED:2,EVENT_ATTACK_CONTROLLER:3,EVENT_BUILD:4,EVENT_HARVEST:5,EVENT_HEAL:6,EVENT_REPAIR:7,EVENT_RESERVE_CONTROLLER:8,EVENT_UPGRADE_CONTROLLER:9,EVENT_EXIT:10,EVENT_POWER:11,EVENT_ATTACK_TYPE_MELEE:1,EVENT_ATTACK_TYPE_RANGED:2,EVENT_ATTACK_TYPE_RANGED_MASS:3,EVENT_ATTACK_TYPE_DISMANTLE:4,EVENT_ATTACK_TYPE_HIT_BACK:5,EVENT_ATTACK_TYPE_NUKE:6,EVENT_HEAL_TYPE_MELEE:1,EVENT_HEAL_TYPE_RANGED:2,POWER_LEVEL_MULTIPLY:1e3,POWER_LEVEL_POW:2,POWER_CREEP_SPAWN_COOLDOWN:288e5,POWER_CREEP_DELETE_COOLDOWN:864e5,POWER_CREEP_MAX_LEVEL:25,POWER_CREEP_LIFE_TIME:5e3,POWER_CLASS:{OPERATOR:\"operator\"},PWR_GENERATE_OPS:1,PWR_OPERATE_SPAWN:2,PWR_OPERATE_TOWER:3,PWR_OPERATE_STORAGE:4,PWR_OPERATE_LAB:5,PWR_OPERATE_EXTENSION:6,PWR_OPERATE_OBSERVER:7,PWR_OPERATE_TERMINAL:8,PWR_DISRUPT_SPAWN:9,PWR_DISRUPT_TOWER:10,PWR_DISRUPT_SOURCE:11,PWR_SHIELD:12,PWR_REGEN_SOURCE:13,PWR_REGEN_MINERAL:14,PWR_DISRUPT_TERMINAL:15,PWR_OPERATE_POWER:16,PWR_FORTIFY:17,PWR_OPERATE_CONTROLLER:18,PWR_OPERATE_FACTORY:19}),Object.assign(r,{POWER_INFO:{[r.PWR_GENERATE_OPS]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:50,effect:[1,2,4,6,8]},[r.PWR_OPERATE_SPAWN]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:300,duration:1e3,range:3,ops:100,effect:[.9,.7,.5,.35,.2]},[r.PWR_OPERATE_TOWER]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:10,duration:100,range:3,ops:10,effect:[1.1,1.2,1.3,1.4,1.5]},[r.PWR_OPERATE_STORAGE]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:800,duration:1e3,range:3,ops:100,effect:[5e5,1e6,2e6,4e6,7e6]},[r.PWR_OPERATE_LAB]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:50,duration:1e3,range:3,ops:10,effect:[2,4,6,8,10]},[r.PWR_OPERATE_EXTENSION]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:50,range:3,ops:2,effect:[.2,.4,.6,.8,1]},[r.PWR_OPERATE_OBSERVER]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:400,duration:[200,400,600,800,1e3],range:3,ops:10},[r.PWR_OPERATE_TERMINAL]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:500,duration:1e3,range:3,ops:100,effect:[.9,.8,.7,.6,.5]},[r.PWR_DISRUPT_SPAWN]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:5,range:20,ops:10,duration:[1,2,3,4,5]},[r.PWR_DISRUPT_TOWER]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:0,duration:5,range:50,ops:10,effect:[.9,.8,.7,.6,.5]},[r.PWR_DISRUPT_SOURCE]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:100,range:3,ops:100,duration:[100,200,300,400,500]},[r.PWR_SHIELD]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],effect:[5e3,1e4,15e3,2e4,25e3],duration:50,cooldown:20,energy:100},[r.PWR_REGEN_SOURCE]:{className:r.POWER_CLASS.OPERATOR,level:[10,11,12,14,22],cooldown:100,duration:300,range:3,effect:[50,100,150,200,250],period:15},[r.PWR_REGEN_MINERAL]:{className:r.POWER_CLASS.OPERATOR,level:[10,11,12,14,22],cooldown:100,duration:100,range:3,effect:[2,4,6,8,10],period:10},[r.PWR_DISRUPT_TERMINAL]:{className:r.POWER_CLASS.OPERATOR,level:[20,21,22,23,24],cooldown:8,duration:10,range:50,ops:[50,40,30,20,10]},[r.PWR_FORTIFY]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:5,range:3,ops:5,duration:[1,2,3,4,5]},[r.PWR_OPERATE_POWER]:{className:r.POWER_CLASS.OPERATOR,level:[10,11,12,14,22],cooldown:800,range:3,duration:1e3,ops:200,effect:[1,2,3,4,5]},[r.PWR_OPERATE_CONTROLLER]:{className:r.POWER_CLASS.OPERATOR,level:[20,21,22,23,24],cooldown:800,range:3,duration:1e3,ops:200,effect:[10,20,30,40,50]},[r.PWR_OPERATE_FACTORY]:{className:r.POWER_CLASS.OPERATOR,level:[0,2,7,14,22],cooldown:1e3,range:3,duration:800,ops:100}},BODYPARTS_ALL:[r.MOVE,r.WORK,r.CARRY,r.ATTACK,r.RANGED_ATTACK,r.TOUGH,r.HEAL,r.CLAIM],RESOURCES_ALL:[r.RESOURCE_ENERGY,r.RESOURCE_POWER,r.RESOURCE_HYDROGEN,r.RESOURCE_OXYGEN,r.RESOURCE_UTRIUM,r.RESOURCE_KEANIUM,r.RESOURCE_LEMERGIUM,r.RESOURCE_ZYNTHIUM,r.RESOURCE_CATALYST,r.RESOURCE_GHODIUM,r.RESOURCE_HYDROXIDE,r.RESOURCE_ZYNTHIUM_KEANITE,r.RESOURCE_UTRIUM_LEMERGITE,r.RESOURCE_UTRIUM_HYDRIDE,r.RESOURCE_UTRIUM_OXIDE,r.RESOURCE_KEANIUM_HYDRIDE,r.RESOURCE_KEANIUM_OXIDE,r.RESOURCE_LEMERGIUM_HYDRIDE,r.RESOURCE_LEMERGIUM_OXIDE,r.RESOURCE_ZYNTHIUM_HYDRIDE,r.RESOURCE_ZYNTHIUM_OXIDE,r.RESOURCE_GHODIUM_HYDRIDE,r.RESOURCE_GHODIUM_OXIDE,r.RESOURCE_UTRIUM_ACID,r.RESOURCE_UTRIUM_ALKALIDE,r.RESOURCE_KEANIUM_ACID,r.RESOURCE_KEANIUM_ALKALIDE,r.RESOURCE_LEMERGIUM_ACID,r.RESOURCE_LEMERGIUM_ALKALIDE,r.RESOURCE_ZYNTHIUM_ACID,r.RESOURCE_ZYNTHIUM_ALKALIDE,r.RESOURCE_GHODIUM_ACID,r.RESOURCE_GHODIUM_ALKALIDE,r.RESOURCE_CATALYZED_UTRIUM_ACID,r.RESOURCE_CATALYZED_UTRIUM_ALKALIDE,r.RESOURCE_CATALYZED_KEANIUM_ACID,r.RESOURCE_CATALYZED_KEANIUM_ALKALIDE,r.RESOURCE_CATALYZED_LEMERGIUM_ACID,r.RESOURCE_CATALYZED_LEMERGIUM_ALKALIDE,r.RESOURCE_CATALYZED_ZYNTHIUM_ACID,r.RESOURCE_CATALYZED_ZYNTHIUM_ALKALIDE,r.RESOURCE_CATALYZED_GHODIUM_ACID,r.RESOURCE_CATALYZED_GHODIUM_ALKALIDE,r.RESOURCE_OPS],COLORS_ALL:[r.COLOR_RED,r.COLOR_PURPLE,r.COLOR_BLUE,r.COLOR_CYAN,r.COLOR_GREEN,r.COLOR_YELLOW,r.COLOR_ORANGE,r.COLOR_BROWN,r.COLOR_GREY,r.COLOR_WHITE],INTERSHARD_RESOURCES:[r.SUBSCRIPTION_TOKEN]})},{}],9:[function(e,t,r){(function(e){(function(){var n,o=\"3.9.3\",i=1,a=2,s=4,u=8,c=16,l=32,p=64,f=128,d=256,h=30,m=\"...\",y=150,_=16,R=0,E=1,g=2,v=\"Expected a function\",O=\"__lodash_placeholder__\",T=\"[object Arguments]\",A=\"[object Array]\",b=\"[object Boolean]\",w=\"[object Date]\",N=\"[object Error]\",C=\"[object Function]\",S=\"[object Number]\",I=\"[object Object]\",x=\"[object RegExp]\",L=\"[object String]\",P=\"[object ArrayBuffer]\",M=\"[object Float32Array]\",k=\"[object Float64Array]\",D=\"[object Int8Array]\",U=\"[object Int16Array]\",j=\"[object Int32Array]\",W=\"[object Uint8Array]\",G=\"[object Uint8ClampedArray]\",F=\"[object Uint16Array]\",B=\"[object Uint32Array]\",H=/\\b__p \\+= '';/g,Y=/\\b(__p \\+=) '' \\+/g,K=/(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g,V=/&(?:amp|lt|gt|quot|#39|#96);/g,X=/[&<>\"'`]/g,q=RegExp(V.source),z=RegExp(X.source),J=/<%-([\\s\\S]+?)%>/g,Z=/<%([\\s\\S]+?)%>/g,$=/<%=([\\s\\S]+?)%>/g,Q=/\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\n\\\\]|\\\\.)*?\\1)\\]/,ee=/^\\w*$/,te=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\n\\\\]|\\\\.)*?)\\2)\\]/g,re=/[.*+?^${}()|[\\]\\/\\\\]/g,ne=RegExp(re.source),oe=/[\\u0300-\\u036f\\ufe20-\\ufe23]/g,ie=/\\\\(\\\\)?/g,ae=/\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g,se=/\\w*$/,ue=/^0[xX]/,ce=/^\\[object .+?Constructor\\]$/,le=/^\\d+$/,pe=/[\\xc0-\\xd6\\xd8-\\xde\\xdf-\\xf6\\xf8-\\xff]/g,fe=/($^)/,de=/['\\n\\r\\u2028\\u2029\\\\]/g,he=function(){var e=\"[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]\",t=\"[a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff]+\";return RegExp(e+\"+(?=\"+e+t+\")|\"+e+\"?\"+t+\"|\"+e+\"+|[0-9]+\",\"g\")}(),me=\" \\t\\v\\f \\ufeff\\n\\r\\u2028\\u2029 ᠎             　\",ye=[\"Array\",\"ArrayBuffer\",\"Date\",\"Error\",\"Float32Array\",\"Float64Array\",\"Function\",\"Int8Array\",\"Int16Array\",\"Int32Array\",\"Math\",\"Number\",\"Object\",\"RegExp\",\"Set\",\"String\",\"_\",\"clearTimeout\",\"document\",\"isFinite\",\"parseFloat\",\"parseInt\",\"setTimeout\",\"TypeError\",\"Uint8Array\",\"Uint8ClampedArray\",\"Uint16Array\",\"Uint32Array\",\"WeakMap\",\"window\"],_e=-1,Re={};Re[M]=Re[k]=Re[D]=Re[U]=Re[j]=Re[W]=Re[G]=Re[F]=Re[B]=!0,Re[T]=Re[A]=Re[P]=Re[b]=Re[w]=Re[N]=Re[C]=Re[\"[object Map]\"]=Re[S]=Re[I]=Re[x]=Re[\"[object Set]\"]=Re[L]=Re[\"[object WeakMap]\"]=!1;var Ee={};Ee[T]=Ee[A]=Ee[P]=Ee[b]=Ee[w]=Ee[M]=Ee[k]=Ee[D]=Ee[U]=Ee[j]=Ee[S]=Ee[I]=Ee[x]=Ee[L]=Ee[W]=Ee[G]=Ee[F]=Ee[B]=!0,Ee[N]=Ee[C]=Ee[\"[object Map]\"]=Ee[\"[object Set]\"]=Ee[\"[object WeakMap]\"]=!1;var ge={leading:!1,maxWait:0,trailing:!1},ve={\"À\":\"A\",\"Á\":\"A\",\"Â\":\"A\",\"Ã\":\"A\",\"Ä\":\"A\",\"Å\":\"A\",\"à\":\"a\",\"á\":\"a\",\"â\":\"a\",\"ã\":\"a\",\"ä\":\"a\",\"å\":\"a\",\"Ç\":\"C\",\"ç\":\"c\",\"Ð\":\"D\",\"ð\":\"d\",\"È\":\"E\",\"É\":\"E\",\"Ê\":\"E\",\"Ë\":\"E\",\"è\":\"e\",\"é\":\"e\",\"ê\":\"e\",\"ë\":\"e\",\"Ì\":\"I\",\"Í\":\"I\",\"Î\":\"I\",\"Ï\":\"I\",\"ì\":\"i\",\"í\":\"i\",\"î\":\"i\",\"ï\":\"i\",\"Ñ\":\"N\",\"ñ\":\"n\",\"Ò\":\"O\",\"Ó\":\"O\",\"Ô\":\"O\",\"Õ\":\"O\",\"Ö\":\"O\",\"Ø\":\"O\",\"ò\":\"o\",\"ó\":\"o\",\"ô\":\"o\",\"õ\":\"o\",\"ö\":\"o\",\"ø\":\"o\",\"Ù\":\"U\",\"Ú\":\"U\",\"Û\":\"U\",\"Ü\":\"U\",\"ù\":\"u\",\"ú\":\"u\",\"û\":\"u\",\"ü\":\"u\",\"Ý\":\"Y\",\"ý\":\"y\",\"ÿ\":\"y\",\"Æ\":\"Ae\",\"æ\":\"ae\",\"Þ\":\"Th\",\"þ\":\"th\",\"ß\":\"ss\"},Oe={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"`\":\"&#96;\"},Te={\"&amp;\":\"&\",\"&lt;\":\"<\",\"&gt;\":\">\",\"&quot;\":'\"',\"&#39;\":\"'\",\"&#96;\":\"`\"},Ae={function:!0,object:!0},be={\"\\\\\":\"\\\\\",\"'\":\"'\",\"\\n\":\"n\",\"\\r\":\"r\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"},we=Ae[typeof r]&&r&&!r.nodeType&&r,Ne=Ae[typeof t]&&t&&!t.nodeType&&t,Ce=we&&Ne&&\"object\"==typeof e&&e&&e.Object&&e,Se=Ae[typeof self]&&self&&self.Object&&self,Ie=Ae[typeof window]&&window&&window.Object&&window,xe=Ne&&Ne.exports===we&&we,Le=Ce||Ie!==(this&&this.window)&&Ie||Se||this;function Pe(e,t){if(e!==t){var r=null===e,o=e===n,i=e==e,a=null===t,s=t===n,u=t==t;if(e>t&&!a||!i||r&&!s&&u||o&&u)return 1;if(e<t&&!r||!u||a&&!o&&i||s&&i)return-1}return 0}function Me(e,t,r){for(var n=e.length,o=r?n:-1;r?o--:++o<n;)if(t(e[o],o,e))return o;return-1}function ke(e,t,r){if(t!=t)return Ye(e,r);for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}function De(e){return\"function\"==typeof e||!1}function Ue(e){return\"string\"==typeof e?e:null==e?\"\":e+\"\"}function je(e,t){for(var r=-1,n=e.length;++r<n&&t.indexOf(e.charAt(r))>-1;);return r}function We(e,t){for(var r=e.length;r--&&t.indexOf(e.charAt(r))>-1;);return r}function Ge(e,t){return Pe(e.criteria,t.criteria)||e.index-t.index}function Fe(e){return ve[e]}function Be(e){return Oe[e]}function He(e){return\"\\\\\"+be[e]}function Ye(e,t,r){for(var n=e.length,o=t+(r?0:-1);r?o--:++o<n;){var i=e[o];if(i!=i)return o}return-1}function Ke(e){return!!e&&\"object\"==typeof e}function Ve(e){return e<=160&&e>=9&&e<=13||32==e||160==e||5760==e||6158==e||e>=8192&&(e<=8202||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}function Xe(e,t){for(var r=-1,n=e.length,o=-1,i=[];++r<n;)e[r]===t&&(e[r]=O,i[++o]=r);return i}function qe(e){for(var t=-1,r=e.length;++t<r&&Ve(e.charCodeAt(t)););return t}function ze(e){for(var t=e.length;t--&&Ve(e.charCodeAt(t)););return t}function Je(e){return Te[e]}var Ze=function e(t){var r=(t=t?Ze.defaults(Le.Object(),t,Ze.pick(Le,ye)):Le).Array,ve=t.Date,Oe=t.Error,Te=t.Function,Ae=t.Math,be=t.Number,we=t.Object,Ne=t.RegExp,Ce=t.String,Se=t.TypeError,Ie=r.prototype,xe=we.prototype,Ve=Ce.prototype,$e=($e=t.window)?$e.document:null,Qe=Te.prototype.toString,et=xe.hasOwnProperty,tt=0,rt=xe.toString,nt=t._,ot=Ne(\"^\"+xi(Qe.call(et)).replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,\"$1.*?\")+\"$\"),it=Tn(t,\"ArrayBuffer\"),at=Tn(it&&new it(0),\"slice\"),st=Ae.ceil,ut=t.clearTimeout,ct=Ae.floor,lt=Tn(we,\"getPrototypeOf\"),pt=t.parseFloat,ft=Ie.push,dt=Tn(t,\"Set\"),ht=t.setTimeout,mt=Ie.splice,yt=Tn(t,\"Uint8Array\"),_t=Tn(t,\"WeakMap\"),Rt=function(){try{var e=Tn(t,\"Float64Array\"),r=new e(new it(10),0,1)&&e}catch(e){}return r||null}(),Et=Tn(we,\"create\"),gt=Tn(r,\"isArray\"),vt=t.isFinite,Ot=Tn(we,\"keys\"),Tt=Ae.max,At=Ae.min,bt=Tn(ve,\"now\"),wt=Tn(be,\"isFinite\"),Nt=t.parseInt,Ct=Ae.random,St=be.NEGATIVE_INFINITY,It=be.POSITIVE_INFINITY,xt=4294967295,Lt=xt-1,Pt=xt>>>1,Mt=Rt?Rt.BYTES_PER_ELEMENT:0,kt=9007199254740991,Dt=_t&&new _t,Ut={};function jt(e){if(Ke(e)&&!zo(e)&&!(e instanceof Bt)){if(e instanceof Gt)return e;if(et.call(e,\"__chain__\")&&et.call(e,\"__wrapped__\"))return Gn(e)}return new Gt(e)}function Wt(){}function Gt(e,t,r){this.__wrapped__=e,this.__actions__=r||[],this.__chain__=!!t}var Ft=jt.support={};function Bt(e){this.__wrapped__=e,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=It,this.__views__=null}function Ht(){this.__data__={}}function Yt(e){var t=e?e.length:0;for(this.data={hash:Et(null),set:new dt};t--;)this.push(e[t])}function Kt(e,t){var r=e.data;return(\"string\"==typeof t||ti(t)?r.set.has(t):r.hash[t])?0:-1}function Vt(e,t){var n=-1,o=e.length;for(t||(t=r(o));++n<o;)t[n]=e[n];return t}function Xt(e,t){for(var r=-1,n=e.length;++r<n&&!1!==t(e[r],r,e););return e}function qt(e,t){for(var r=-1,n=e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function zt(e,t){for(var r=-1,n=e.length,o=-1,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[++o]=a)}return i}function Jt(e,t){for(var n=-1,o=e.length,i=r(o);++n<o;)i[n]=t(e[n],n,e);return i}function Zt(e,t,r,n){var o=-1,i=e.length;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}function $t(e,t){for(var r=-1,n=e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function Qt(e,t){return e===n?t:e}function er(e,t,r,o){return e!==n&&et.call(o,r)?e:t}function tr(e,t,r){for(var o=-1,i=gi(t),a=i.length;++o<a;){var s=i[o],u=e[s],c=r(u,t[s],s,e,t);(c==c?c===u:u!=u)&&(u!==n||s in e)||(e[s]=c)}return e}function rr(e,t){return null==t?e:or(t,gi(t),e)}function nr(e,t){for(var o=-1,i=null==e,a=!i&&bn(e),s=a?e.length:0,u=t.length,c=r(u);++o<u;){var l=t[o];c[o]=a?wn(l,s)?e[l]:n:i?n:e[l]}return c}function or(e,t,r){r||(r={});for(var n=-1,o=t.length;++n<o;){var i=t[n];r[i]=e[i]}return r}function ir(e,t,r){var o=typeof e;return\"function\"==o?t===n?e:Br(e,t,r):null==e?Yi:\"object\"==o?wr(e):t===n?Ji(e):Nr(e,t)}function ar(e,t,r,o,i,a,s){var u;if(r&&(u=i?r(e,o,i):r(e)),u!==n)return u;if(!ti(e))return e;var c=zo(e);if(c){if(u=function(e){var t=e.length,r=new e.constructor(t);return t&&\"string\"==typeof e[0]&&et.call(e,\"index\")&&(r.index=e.index,r.input=e.input),r}(e),!t)return Vt(e,u)}else{var l=rt.call(e),p=l==C;if(l!=I&&l!=T&&(!p||i))return Ee[l]?function(e,t,r){var n=e.constructor;switch(t){case P:return Hr(e);case b:case w:return new n(+e);case M:case k:case D:case U:case j:case W:case G:case F:case B:var o=e.buffer;return new n(r?Hr(o):o,e.byteOffset,e.length);case S:case L:return new n(e);case x:var i=new n(e.source,se.exec(e));i.lastIndex=e.lastIndex}return i}(e,l,t):i?e:{};if(u=function(e){var t=e.constructor;return\"function\"==typeof t&&t instanceof t||(t=we),new t}(p?{}:e),!t)return rr(u,e)}a||(a=[]),s||(s=[]);for(var f=a.length;f--;)if(a[f]==e)return s[f];return a.push(e),s.push(u),(c?Xt:Er)(e,function(n,o){u[o]=ar(n,t,r,o,e,a,s)}),u}!function(e){var t=function(){this.x=1},r=[];for(var n in t.prototype={valueOf:1,y:1},new t)r.push(n);try{Ft.dom=11===$e.createDocumentFragment().nodeType}catch(e){Ft.dom=!1}}(),jt.templateSettings={escape:J,evaluate:Z,interpolate:$,variable:\"\",imports:{_:jt}};var sr=function(){function e(){}return function(t){if(ti(t)){e.prototype=t;var r=new e;e.prototype=null}return r||{}}}();function ur(e,t,r){if(\"function\"!=typeof e)throw new Se(v);return ht(function(){e.apply(n,r)},t)}function cr(e,t){var r=e?e.length:0,n=[];if(!r)return n;var o=-1,i=gn(),a=i==ke,s=a&&t.length>=200?Jr(t):null,u=t.length;s&&(i=Kt,a=!1,t=s);e:for(;++o<r;){var c=e[o];if(a&&c==c){for(var l=u;l--;)if(t[l]===c)continue e;n.push(c)}else i(t,c,0)<0&&n.push(c)}return n}var lr=qr(Er),pr=qr(gr,!0);function fr(e,t){var r=!0;return lr(e,function(e,n,o){return r=!!t(e,n,o)}),r}function dr(e,t){var r=[];return lr(e,function(e,n,o){t(e,n,o)&&r.push(e)}),r}function hr(e,t,r,n){var o;return r(e,function(e,r,i){if(t(e,r,i))return o=n?r:e,!1}),o}function mr(e,t,r){for(var n=-1,o=e.length,i=-1,a=[];++n<o;){var s=e[n];if(Ke(s)&&bn(s)&&(r||zo(s)||qo(s))){t&&(s=mr(s,t,r));for(var u=-1,c=s.length;++u<c;)a[++i]=s[u]}else r||(a[++i]=s)}return a}var yr=zr(),_r=zr(!0);function Rr(e,t){return yr(e,t,vi)}function Er(e,t){return yr(e,t,gi)}function gr(e,t){return _r(e,t,gi)}function vr(e,t){for(var r=-1,n=t.length,o=-1,i=[];++r<n;){var a=t[r];ei(e[a])&&(i[++o]=a)}return i}function Or(e,t,r){if(null!=e){r!==n&&r in jn(e)&&(t=[r]);for(var o=0,i=t.length;null!=e&&o<i;)e=e[t[o++]];return o&&o==i?e:n}}function Tr(e,t,r,o,i,a){return e===t||(null==e||null==t||!ti(e)&&!Ke(t)?e!=e&&t!=t:function(e,t,r,o,i,a,s){var u=zo(e),c=zo(t),l=A,p=A;u||((l=rt.call(e))==T?l=I:l!=I&&(u=si(e))),c||((p=rt.call(t))==T?p=I:p!=I&&(c=si(t)));var f=l==I,d=p==I,h=l==p;if(h&&!u&&!f)return function(e,t,r){switch(r){case b:case w:return+e==+t;case N:return e.name==t.name&&e.message==t.message;case S:return e!=+e?t!=+t:e==+t;case x:case L:return e==t+\"\"}return!1}(e,t,l);if(!i){var m=f&&et.call(e,\"__wrapped__\"),y=d&&et.call(t,\"__wrapped__\");if(m||y)return r(m?e.value():e,y?t.value():t,o,i,a,s)}if(!h)return!1;a||(a=[]),s||(s=[]);for(var _=a.length;_--;)if(a[_]==e)return s[_]==t;a.push(e),s.push(t);var R=(u?function(e,t,r,o,i,a,s){var u=-1,c=e.length,l=t.length;if(c!=l&&!(i&&l>c))return!1;for(;++u<c;){var p=e[u],f=t[u],d=o?o(i?f:p,i?p:f,u):n;if(d!==n){if(d)continue;return!1}if(i){if(!$t(t,function(e){return p===e||r(p,e,o,i,a,s)}))return!1}else if(p!==f&&!r(p,f,o,i,a,s))return!1}return!0}:function(e,t,r,o,i,a,s){var u=gi(e),c=u.length,l=gi(t).length;if(c!=l&&!i)return!1;for(var p=c;p--;){var f=u[p];if(!(i?f in t:et.call(t,f)))return!1}for(var d=i;++p<c;){f=u[p];var h=e[f],m=t[f],y=o?o(i?m:h,i?h:m,f):n;if(!(y===n?r(h,m,o,i,a,s):y))return!1;d||(d=\"constructor\"==f)}if(!d){var _=e.constructor,R=t.constructor;if(_!=R&&\"constructor\"in e&&\"constructor\"in t&&!(\"function\"==typeof _&&_ instanceof _&&\"function\"==typeof R&&R instanceof R))return!1}return!0})(e,t,r,o,i,a,s);return a.pop(),s.pop(),R}(e,t,Tr,r,o,i,a))}function Ar(e,t,r){var o=t.length,i=o,a=!r;if(null==e)return!i;for(e=jn(e);o--;){var s=t[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){var u=(s=t[o])[0],c=e[u],l=s[1];if(a&&s[2]){if(c===n&&!(u in e))return!1}else{var p=r?r(c,l,u):n;if(!(p===n?Tr(l,c,r,!0):p))return!1}}return!0}function br(e,t){var n=-1,o=bn(e)?r(e.length):[];return lr(e,function(e,r,i){o[++n]=t(e,r,i)}),o}function wr(e){var t=On(e);if(1==t.length&&t[0][2]){var r=t[0][0],o=t[0][1];return function(e){return null!=e&&e[r]===o&&(o!==n||r in jn(e))}}return function(e){return Ar(e,t)}}function Nr(e,t){var r=zo(e),o=Cn(e)&&xn(t),i=e+\"\";return e=Wn(e),function(a){if(null==a)return!1;var s=i;if(a=jn(a),(r||!o)&&!(s in a)){if(null==(a=1==e.length?a:Or(a,Lr(e,0,-1))))return!1;s=zn(e),a=jn(a)}return a[s]===t?t!==n||s in a:Tr(t,a[s],n,!0)}}function Cr(e){return function(t){return null==t?n:t[e]}}function Sr(e,t){for(var r=e?t.length:0;r--;){var n=t[r];if(n!=o&&wn(n)){var o=n;mt.call(e,n,1)}}return e}function Ir(e,t){return e+ct(Ct()*(t-e+1))}var xr=Dt?function(e,t){return Dt.set(e,t),e}:Yi;function Lr(e,t,o){var i=-1,a=e.length;(t=null==t?0:+t||0)<0&&(t=-t>a?0:a+t),(o=o===n||o>a?a:+o||0)<0&&(o+=a),a=t>o?0:o-t>>>0,t>>>=0;for(var s=r(a);++i<a;)s[i]=e[i+t];return s}function Pr(e,t){var r;return lr(e,function(e,n,o){return!(r=t(e,n,o))}),!!r}function Mr(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function kr(e,t,r){var n=_n(),o=-1;return t=Jt(t,function(e){return n(e)}),Mr(br(e,function(e){return{criteria:Jt(t,function(t){return t(e)}),index:++o,value:e}}),function(e,t){return function(e,t,r){for(var n=-1,o=e.criteria,i=t.criteria,a=o.length,s=r.length;++n<a;){var u=Pe(o[n],i[n]);if(u)return n>=s?u:u*(r[n]?1:-1)}return e.index-t.index}(e,t,r)})}function Dr(e,t){var r=-1,n=gn(),o=e.length,i=n==ke,a=i&&o>=200,s=a?Jr():null,u=[];s?(n=Kt,i=!1):(a=!1,s=t?[]:u);e:for(;++r<o;){var c=e[r],l=t?t(c,r,e):c;if(i&&c==c){for(var p=s.length;p--;)if(s[p]===l)continue e;t&&s.push(l),u.push(c)}else n(s,l,0)<0&&((t||a)&&s.push(l),u.push(c))}return u}function Ur(e,t){for(var n=-1,o=t.length,i=r(o);++n<o;)i[n]=e[t[n]];return i}function jr(e,t,r,n){for(var o=e.length,i=n?o:-1;(n?i--:++i<o)&&t(e[i],i,e););return r?Lr(e,n?0:i,n?i+1:o):Lr(e,n?i+1:0,n?o:i)}function Wr(e,t){var r=e;r instanceof Bt&&(r=r.value());for(var n=-1,o=t.length;++n<o;){var i=[r],a=t[n];ft.apply(i,a.args),r=a.func.apply(a.thisArg,i)}return r}function Gr(e,t,r){var n=0,o=e?e.length:n;if(\"number\"==typeof t&&t==t&&o<=Pt){for(;n<o;){var i=n+o>>>1,a=e[i];(r?a<=t:a<t)&&null!==a?n=i+1:o=i}return o}return Fr(e,t,Yi,r)}function Fr(e,t,r,o){t=r(t);for(var i=0,a=e?e.length:0,s=t!=t,u=null===t,c=t===n;i<a;){var l=ct((i+a)/2),p=r(e[l]),f=p!==n,d=p==p;if(s)var h=d||o;else h=u?d&&f&&(o||null!=p):c?d&&(o||f):null!=p&&(o?p<=t:p<t);h?i=l+1:a=l}return At(a,Lt)}function Br(e,t,r){if(\"function\"!=typeof e)return Yi;if(t===n)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 3:return function(r,n,o){return e.call(t,r,n,o)};case 4:return function(r,n,o,i){return e.call(t,r,n,o,i)};case 5:return function(r,n,o,i,a){return e.call(t,r,n,o,i,a)}}return function(){return e.apply(t,arguments)}}function Hr(e){return at.call(e,0)}function Yr(e,t,n){for(var o=n.length,i=-1,a=Tt(e.length-o,0),s=-1,u=t.length,c=r(a+u);++s<u;)c[s]=t[s];for(;++i<o;)c[n[i]]=e[i];for(;a--;)c[s++]=e[i++];return c}function Kr(e,t,n){for(var o=-1,i=n.length,a=-1,s=Tt(e.length-i,0),u=-1,c=t.length,l=r(s+c);++a<s;)l[a]=e[a];for(var p=a;++u<c;)l[p+u]=t[u];for(;++o<i;)l[p+n[o]]=e[a++];return l}function Vr(e,t){return function(r,n,o){var i=t?t():{};if(n=_n(n,o,3),zo(r))for(var a=-1,s=r.length;++a<s;){var u=r[a];e(i,u,n(u,a,r),r)}else lr(r,function(t,r,o){e(i,t,n(t,r,o),o)});return i}}function Xr(e){return Vo(function(t,r){var o=-1,i=null==t?0:r.length,a=i>2?r[i-2]:n,s=i>2?r[2]:n,u=i>1?r[i-1]:n;for(\"function\"==typeof a?(a=Br(a,u,5),i-=2):i-=(a=\"function\"==typeof u?u:n)?1:0,s&&Nn(r[0],r[1],s)&&(a=i<3?n:a,i=1);++o<i;){var c=r[o];c&&e(t,c,a)}return t})}function qr(e,t){return function(r,n){var o=r?vn(r):0;if(!In(o))return e(r,n);for(var i=t?o:-1,a=jn(r);(t?i--:++i<o)&&!1!==n(a[i],i,a););return r}}function zr(e){return function(t,r,n){for(var o=jn(t),i=n(t),a=i.length,s=e?a:-1;e?s--:++s<a;){var u=i[s];if(!1===r(o[u],u,o))break}return t}}at||(Hr=it&&yt?function(e){var t=e.byteLength,r=Rt?ct(t/Mt):0,n=r*Mt,o=new it(t);if(r){var i=new Rt(o,0,r);i.set(new Rt(e,0,r))}return t!=n&&(i=new yt(o,n)).set(new yt(e,n)),o}:Hi(null));var Jr=Et&&dt?function(e){return new Yt(e)}:Hi(null);function Zr(e){return function(t){for(var r=-1,n=Gi(Ii(t)),o=n.length,i=\"\";++r<o;)i=e(i,n[r],r);return i}}function $r(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4])}var r=sr(e.prototype),n=e.apply(r,t);return ti(n)?n:r}}function Qr(e){return function t(r,n,o){o&&Nn(r,n,o)&&(n=null);var i=yn(r,e,null,null,null,null,null,n);return i.placeholder=t.placeholder,i}}function en(e,t){return function(r,n,o){if(o&&Nn(r,n,o)&&(n=null),1==(n=_n(n,o,3)).length){var i=function(e,t,r,n){for(var o=-1,i=e.length,a=n,s=a;++o<i;){var u=e[o],c=+t(u);r(c,a)&&(a=c,s=u)}return s}(r=Un(r),n,e,t);if(!r.length||i!==t)return i}return function(e,t,r,n){var o=n,i=o;return lr(e,function(e,a,s){var u=+t(e,a,s);(r(u,o)||u===n&&u===i)&&(o=u,i=e)}),i}(r,n,e,t)}}function tn(e,t){return function(r,o,i){if(o=_n(o,i,3),zo(r)){var a=Me(r,o,t);return a>-1?r[a]:n}return hr(r,o,e)}}function rn(e){return function(t,r,n){return t&&t.length?Me(t,r=_n(r,n,3),e):-1}}function nn(e){return function(t,r,n){return hr(t,r=_n(r,n,3),e,!0)}}function on(e){return function(){for(var t,n=arguments.length,o=e?n:-1,i=0,a=r(n);e?o--:++o<n;){var s=a[i++]=arguments[o];if(\"function\"!=typeof s)throw new Se(v);!t&&Gt.prototype.thru&&\"wrapper\"==En(s)&&(t=new Gt([]))}for(o=t?-1:n;++o<n;){var c=En(s=a[o]),p=\"wrapper\"==c?Rn(s):null;t=p&&Sn(p[0])&&p[1]==(f|u|l|d)&&!p[4].length&&1==p[9]?t[En(p[0])].apply(t,p[3]):1==s.length&&Sn(s)?t[c]():t.thru(s)}return function(){var e=arguments;if(t&&1==e.length&&zo(e[0]))return t.plant(e[0]).value();for(var r=0,o=n?a[r].apply(this,e):e[0];++r<n;)o=a[r].call(this,o);return o}}}function an(e,t){return function(r,o,i){return\"function\"==typeof o&&i===n&&zo(r)?e(r,o):t(r,Br(o,i,3))}}function sn(e){return function(t,r,o){return\"function\"==typeof r&&o===n||(r=Br(r,o,3)),e(t,r,vi)}}function un(e){return function(t,r,o){return\"function\"==typeof r&&o===n||(r=Br(r,o,3)),e(t,r)}}function cn(e){return function(t,r,n){var o={};return r=_n(r,n,3),Er(t,function(t,n,i){var a=r(t,n,i);n=e?a:n,t=e?t:a,o[n]=t}),o}}function ln(e){return function(t,r,n){return t=Ue(t),(e?t:\"\")+hn(t,r,n)+(e?\"\":t)}}function pn(e){var t=Vo(function(r,n){var o=Xe(n,t.placeholder);return yn(r,e,null,n,o)});return t}function fn(e,t){return function(r,o,i,a){var s=arguments.length<3;return\"function\"==typeof o&&a===n&&zo(r)?e(r,o,i,s):function(e,t,r,n,o){return o(e,function(e,o,i){r=n?(n=!1,e):t(r,e,o,i)}),r}(r,_n(o,a,4),i,s,t)}}function dn(e,t,o,d,h,m,y,_,R,E){var g=t&f,v=t&i,O=t&a,T=t&u,A=t&s,b=t&c,w=O?null:$r(e);return function s(){for(var u=arguments.length,c=u,f=r(u);c--;)f[c]=arguments[c];if(d&&(f=Yr(f,d,h)),m&&(f=Kr(f,m,y)),T||b){var N=s.placeholder,C=Xe(f,N);if((u-=C.length)<E){var S=_?Vt(_):null,I=Tt(E-u,0);t|=T?l:p,t&=~(T?p:l),A||(t&=~(i|a));var x=[e,t,o,T?f:null,T?C:null,T?null:f,T?null:C,S,R,I],L=dn.apply(n,x);return Sn(e)&&Mn(L,x),L.placeholder=N,L}}var P=v?o:this,M=O?P[e]:e;return _&&(f=function(e,t){for(var r=e.length,o=At(t.length,r),i=Vt(e);o--;){var a=t[o];e[o]=wn(a,r)?i[a]:n}return e}(f,_)),g&&R<f.length&&(f.length=R),this&&this!==Le&&this instanceof s&&(M=w||$r(e)),M.apply(P,f)}}function hn(e,t,r){var n=e.length;if(n>=(t=+t)||!vt(t))return\"\";var o=t-n;return Di(r=null==r?\" \":r+\"\",st(o/r.length)).slice(0,o)}function mn(e){return function(t,r,n,o){var i=_n(n);return null==n&&i===ir?Gr(t,r,e):Fr(t,r,i(n,o,1),e)}}function yn(e,t,o,c,h,m,y,_){var R=t&a;if(!R&&\"function\"!=typeof e)throw new Se(v);var E=c?c.length:0;if(E||(t&=~(l|p),c=h=null),E-=h?h.length:0,t&p){var g=c,T=h;c=h=null}var A=R?null:Rn(e),b=[e,t,o,c,h,g,T,m,y,_];if(A&&(function(e,t){var r=e[1],n=t[1],o=r|n,a=o<f,c=n==f&&r==u||n==f&&r==d&&e[7].length<=t[8]||n==(f|d)&&r==u;if(!a&&!c)return e;n&i&&(e[2]=t[2],o|=r&i?0:s);var l=t[3];if(l){var p=e[3];e[3]=p?Yr(p,l,t[4]):Vt(l),e[4]=p?Xe(e[3],O):Vt(t[4])}(l=t[5])&&(p=e[5],e[5]=p?Kr(p,l,t[6]):Vt(l),e[6]=p?Xe(e[5],O):Vt(t[6])),(l=t[7])&&(e[7]=Vt(l)),n&f&&(e[8]=null==e[8]?t[8]:At(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(b,A),t=b[1],_=b[9]),b[9]=null==_?R?0:e.length:Tt(_-E,0)||0,t==i)var w=function(e,t){var r=$r(e);return function n(){return(this&&this!==Le&&this instanceof n?r:e).apply(t,arguments)}}(b[0],b[2]);else w=t!=l&&t!=(i|l)||b[4].length?dn.apply(n,b):function(e,t,n,o){var a=t&i,s=$r(e);return function t(){for(var i=-1,u=arguments.length,c=-1,l=o.length,p=r(u+l);++c<l;)p[c]=o[c];for(;u--;)p[c++]=arguments[++i];return(this&&this!==Le&&this instanceof t?s:e).apply(a?n:this,p)}}.apply(n,b);return(A?xr:Mn)(w,b)}function _n(e,t,r){var n=jt.callback||Bi;return n=n===Bi?ir:n,r?n(e,t,r):n}var Rn=Dt?function(e){return Dt.get(e)}:zi;function En(e){for(var t=e.name,r=Ut[t],n=r?r.length:0;n--;){var o=r[n],i=o.func;if(null==i||i==e)return o.name}return t}function gn(e,t,r){var n=jt.indexOf||Xn;return n=n===Xn?ke:n,e?n(e,t,r):n}var vn=Cr(\"length\");function On(e){for(var t=wi(e),r=t.length;r--;)t[r][2]=xn(t[r][1]);return t}function Tn(e,t){var r=null==e?n:e[t];return ri(r)?r:n}function An(e,t,r){null==e||Cn(t,e)||(e=1==(t=Wn(t)).length?e:Or(e,Lr(t,0,-1)),t=zn(t));var o=null==e?e:e[t];return null==o?n:o.apply(e,r)}function bn(e){return null!=e&&In(vn(e))}function wn(e,t){return e=\"number\"==typeof e||le.test(e)?+e:-1,t=null==t?kt:t,e>-1&&e%1==0&&e<t}function Nn(e,t,r){if(!ti(r))return!1;var n=typeof t;if(\"number\"==n?bn(r)&&wn(t,r.length):\"string\"==n&&t in r){var o=r[t];return e==e?e===o:o!=o}return!1}function Cn(e,t){var r=typeof e;return!!(\"string\"==r&&ee.test(e)||\"number\"==r)||!zo(e)&&(!Q.test(e)||null!=t&&e in jn(t))}function Sn(e){var t=En(e);if(!(t in Bt.prototype))return!1;var r=jt[t];if(e===r)return!0;var n=Rn(r);return!!n&&e===n[0]}function In(e){return\"number\"==typeof e&&e>-1&&e%1==0&&e<=kt}function xn(e){return e==e&&!ti(e)}function Ln(e,t){e=jn(e);for(var r=-1,n=t.length,o={};++r<n;){var i=t[r];i in e&&(o[i]=e[i])}return o}function Pn(e,t){var r={};return Rr(e,function(e,n,o){t(e,n,o)&&(r[n]=e)}),r}var Mn=function(){var e=0,t=0;return function(r,n){var o=Io(),i=_-(o-t);if(t=o,i>0){if(++e>=y)return r}else e=0;return xr(r,n)}}();function kn(e){var t,r;return jt.support,!(!Ke(e)||rt.call(e)!=I||!(et.call(e,\"constructor\")||\"function\"!=typeof(t=e.constructor)||t instanceof t))&&(Rr(e,function(e,t){r=t}),r===n||et.call(e,r))}function Dn(e){for(var t=vi(e),r=t.length,n=r&&e.length,o=!!n&&In(n)&&(zo(e)||qo(e)),i=-1,a=[];++i<r;){var s=t[i];(o&&wn(s,n)||et.call(e,s))&&a.push(s)}return a}function Un(e){return null==e?[]:bn(e)?ti(e)?e:we(e):Ci(e)}function jn(e){return ti(e)?e:we(e)}function Wn(e){if(zo(e))return e;var t=[];return Ue(e).replace(te,function(e,r,n,o){t.push(n?o.replace(ie,\"$1\"):r||e)}),t}function Gn(e){return e instanceof Bt?e.clone():new Gt(e.__wrapped__,e.__chain__,Vt(e.__actions__))}var Fn=Vo(function(e,t){return bn(e)?cr(e,mr(t,!1,!0)):[]});function Bn(e,t,r){return e&&e.length?((r?Nn(e,t,r):null==t)&&(t=1),Lr(e,t<0?0:t)):[]}function Hn(e,t,r){var n=e?e.length:0;return n?((r?Nn(e,t,r):null==t)&&(t=1),Lr(e,0,(t=n-(+t||0))<0?0:t)):[]}var Yn=rn(),Kn=rn(!0);function Vn(e){return e?e[0]:n}function Xn(e,t,r){var n=e?e.length:0;if(!n)return-1;if(\"number\"==typeof r)r=r<0?Tt(n+r,0):r;else if(r){var o=Gr(e,t),i=e[o];return(t==t?t===i:i!=i)?o:-1}return ke(e,t,r||0)}var qn=Vo(function(e){for(var t=e.length,n=t,o=r(p),i=gn(),a=i==ke,s=[];n--;){var u=e[n]=bn(u=e[n])?u:[];o[n]=a&&u.length>=120?Jr(n&&u):null}var c=e[0],l=-1,p=c?c.length:0,f=o[0];e:for(;++l<p;)if(u=c[l],(f?Kt(f,u):i(s,u,0))<0){for(n=t;--n;){var d=o[n];if((d?Kt(d,u):i(e[n],u,0))<0)continue e}f&&f.push(u),s.push(u)}return s});function zn(e){var t=e?e.length:0;return t?e[t-1]:n}var Jn=Vo(function(e,t){var r=nr(e,t=mr(t));return Sr(e,t.sort(Pe)),r});function Zn(e){return Bn(e,1)}var $n=mn(),Qn=mn(!0);var eo=Vo(function(e){return Dr(mr(e,!1,!0))});function to(e,t,r,n){if(!e||!e.length)return[];null!=t&&\"boolean\"!=typeof t&&(r=Nn(e,t,n=r)?null:t,t=!1);var o=_n();return null==r&&o===ir||(r=o(r,n,3)),t&&gn()==ke?function(e,t){for(var r,n=-1,o=e.length,i=-1,a=[];++n<o;){var s=e[n],u=t?t(s,n,e):s;n&&r===u||(r=u,a[++i]=s)}return a}(e,r):Dr(e,r)}function ro(e){if(!e||!e.length)return[];var t=-1,n=0;e=zt(e,function(e){if(bn(e))return n=Tt(e.length,n),!0});for(var o=r(n);++t<n;)o[t]=Jt(e,Cr(t));return o}function no(e,t,r){if(!e||!e.length)return[];var o=ro(e);return null==t?o:(t=Br(t,r,4),Jt(o,function(e){return Zt(e,t,n,!0)}))}var oo=Vo(function(e,t){return bn(e)?cr(e,t):[]});var io=Vo(ro);function ao(e,t){var r=-1,n=e?e.length:0,o={};for(!n||t||zo(e[0])||(t=[]);++r<n;){var i=e[r];t?o[i]=t[r]:i&&(o[i[0]]=i[1])}return o}var so=Vo(function(e){var t=e.length,r=t>2?e[t-2]:n,o=t>1?e[t-1]:n;return t>2&&\"function\"==typeof r?t-=2:(r=t>1&&\"function\"==typeof o?(--t,o):n,o=n),e.length=t,no(e,r,o)});function uo(e){var t=jt(e);return t.__chain__=!0,t}function co(e,t,r){return t.call(r,e)}var lo=Vo(function(e,t){return nr(e,mr(t))}),po=Vr(function(e,t,r){et.call(e,r)?++e[r]:e[r]=1});function fo(e,t,r){var o=zo(e)?qt:fr;return r&&Nn(e,t,r)&&(t=null),\"function\"==typeof t&&r===n||(t=_n(t,r,3)),o(e,t)}function ho(e,t,r){return(zo(e)?zt:dr)(e,t=_n(t,r,3))}var mo=tn(lr),yo=tn(pr,!0);var _o=an(Xt,lr),Ro=an(function(e,t){for(var r=e.length;r--&&!1!==t(e[r],r,e););return e},pr),Eo=Vr(function(e,t,r){et.call(e,r)?e[r].push(t):e[r]=[t]});function go(e,t,r,n){var o=e?vn(e):0;return In(o)||(o=(e=Ci(e)).length),!!o&&(r=\"number\"!=typeof r||n&&Nn(t,r,n)?0:r<0?Tt(o+r,0):r||0,\"string\"==typeof e||!zo(e)&&ai(e)?r<o&&e.indexOf(t,r)>-1:gn(e,t,r)>-1)}var vo=Vr(function(e,t,r){e[r]=t}),Oo=Vo(function(e,t,n){var o=-1,i=\"function\"==typeof t,a=Cn(t),s=bn(e)?r(e.length):[];return lr(e,function(e){var r=i?t:a&&null!=e?e[t]:null;s[++o]=r?r.apply(e,n):An(e,t,n)}),s});function To(e,t,r){return(zo(e)?Jt:br)(e,t=_n(t,r,3))}var Ao=Vr(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]});var bo=fn(Zt,lr),wo=fn(function(e,t,r,n){var o=e.length;for(n&&o&&(r=e[--o]);o--;)r=t(r,e[o],o,e);return r},pr);function No(e,t,r){if(r?Nn(e,t,r):null==t)return(o=(e=Un(e)).length)>0?e[Ir(0,o-1)]:n;var o,i=-1,a=ci(e),s=(o=a.length)-1;for(t=At(t<0?0:+t||0,o);++i<t;){var u=Ir(i,s),c=a[u];a[u]=a[i],a[i]=c}return a.length=t,a}function Co(e,t,r){var o=zo(e)?$t:Pr;return r&&Nn(e,t,r)&&(t=null),\"function\"==typeof t&&r===n||(t=_n(t,r,3)),o(e,t)}var So=Vo(function(e,t){if(null==e)return[];var r=t[2];return r&&Nn(t[0],t[1],r)&&(t.length=1),kr(e,mr(t),[])});var Io=bt||function(){return(new ve).getTime()};function xo(e,t){var r;if(\"function\"!=typeof t){if(\"function\"!=typeof e)throw new Se(v);var n=e;e=t,t=n}return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}var Lo=Vo(function(e,t,r){var n=i;if(r.length){var o=Xe(r,Lo.placeholder);n|=l}return yn(e,n,t,r,o)}),Po=Vo(function(e,t){for(var r=-1,n=(t=t.length?mr(t):Ei(e)).length;++r<n;){var o=t[r];e[o]=yn(e[o],i,e)}return e}),Mo=Vo(function(e,t,r){var n=i|a;if(r.length){var o=Xe(r,Mo.placeholder);n|=l}return yn(t,n,e,r,o)}),ko=Qr(u),Do=Qr(c);function Uo(e,t,r){var o,i,a,s,u,c,l,p=0,f=!1,d=!0;if(\"function\"!=typeof e)throw new Se(v);if(t=t<0?0:+t||0,!0===r){var h=!0;d=!1}else ti(r)&&(h=r.leading,f=\"maxWait\"in r&&Tt(+r.maxWait||0,t),d=\"trailing\"in r?r.trailing:d);function m(){var r=t-(Io()-s);if(r<=0||r>t){i&&ut(i);var f=l;i=c=l=n,f&&(p=Io(),a=e.apply(u,o),c||i||(o=u=null))}else c=ht(m,r)}function y(){c&&ut(c),i=c=l=n,(d||f!==t)&&(p=Io(),a=e.apply(u,o),c||i||(o=u=null))}function _(){if(o=arguments,s=Io(),u=this,l=d&&(c||!h),!1===f)var r=h&&!c;else{i||h||(p=s);var n=f-(s-p),_=n<=0||n>f;_?(i&&(i=ut(i)),p=s,a=e.apply(u,o)):i||(i=ht(y,n))}return _&&c?c=ut(c):c||t===f||(c=ht(m,t)),r&&(_=!0,a=e.apply(u,o)),!_||c||i||(o=u=null),a}return _.cancel=function(){c&&ut(c),i&&ut(i),i=c=l=n},_}var jo=Vo(function(e,t){return ur(e,1,t)}),Wo=Vo(function(e,t,r){return ur(e,t,r)}),Go=on(),Fo=on(!0);function Bo(e,t){if(\"function\"!=typeof e||t&&\"function\"!=typeof t)throw new Se(v);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new Bo.Cache,r}var Ho=pn(l),Yo=pn(p),Ko=Vo(function(e,t){return yn(e,d,null,null,null,mr(t))});function Vo(e,t){if(\"function\"!=typeof e)throw new Se(v);return t=Tt(t===n?e.length-1:+t||0,0),function(){for(var n=arguments,o=-1,i=Tt(n.length-t,0),a=r(i);++o<i;)a[o]=n[t+o];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,n[0],a);case 2:return e.call(this,n[0],n[1],a)}var s=r(t+1);for(o=-1;++o<t;)s[o]=n[o];return s[t]=a,e.apply(this,s)}}function Xo(e,t){return e>t}function qo(e){return Ke(e)&&bn(e)&&rt.call(e)==T}var zo=gt||function(e){return Ke(e)&&In(e.length)&&rt.call(e)==A};function Jo(e){return!!e&&1===e.nodeType&&Ke(e)&&rt.call(e).indexOf(\"Element\")>-1}function Zo(e,t,r,o){var i=(r=\"function\"==typeof r?Br(r,o,3):n)?r(e,t):n;return i===n?Tr(e,t,r):!!i}function $o(e){return Ke(e)&&\"string\"==typeof e.message&&rt.call(e)==N}Ft.dom||(Jo=function(e){return!!e&&1===e.nodeType&&Ke(e)&&!oi(e)});var Qo=wt||function(e){return\"number\"==typeof e&&vt(e)},ei=De(/x/)||yt&&!De(yt)?function(e){return rt.call(e)==C}:De;function ti(e){var t=typeof e;return!!e&&(\"object\"==t||\"function\"==t)}function ri(e){return null!=e&&(rt.call(e)==C?ot.test(Qe.call(e)):Ke(e)&&ce.test(e))}function ni(e){return\"number\"==typeof e||Ke(e)&&rt.call(e)==S}var oi=lt?function(e){if(!e||rt.call(e)!=I)return!1;var t=Tn(e,\"valueOf\"),r=t&&(r=lt(t))&&lt(r);return r?e==r||lt(e)==r:kn(e)}:kn;function ii(e){return Ke(e)&&rt.call(e)==x}function ai(e){return\"string\"==typeof e||Ke(e)&&rt.call(e)==L}function si(e){return Ke(e)&&In(e.length)&&!!Re[rt.call(e)]}function ui(e,t){return e<t}function ci(e){var t=e?vn(e):0;return In(t)?t?Vt(e):[]:Ci(e)}function li(e){return or(e,vi(e))}var pi=Xr(function(e,t,r){return r?tr(e,t,r):rr(e,t)});var fi=Vo(function(e){var t=e[0];return null==t?t:(e.push(Qt),pi.apply(n,e))}),di=nn(Er),hi=nn(gr),mi=sn(yr),yi=sn(_r),_i=un(Er),Ri=un(gr);function Ei(e){return vr(e,vi(e))}var gi=Ot?function(e){var t=null==e?null:e.constructor;return\"function\"==typeof t&&t.prototype===e||\"function\"!=typeof e&&bn(e)?Dn(e):ti(e)?Ot(e):[]}:Dn;function vi(e){if(null==e)return[];ti(e)||(e=we(e));var t=e.length;t=t&&In(t)&&(zo(e)||qo(e))&&t||0;for(var n=e.constructor,o=-1,i=\"function\"==typeof n&&n.prototype===e,a=r(t),s=t>0;++o<t;)a[o]=o+\"\";for(var u in e)s&&wn(u,t)||\"constructor\"==u&&(i||!et.call(e,u))||a.push(u);return a}var Oi=cn(!0),Ti=cn(),Ai=Xr(function e(t,r,o,i,a){if(!ti(t))return t;var s=bn(r)&&(zo(r)||si(r)),u=s?null:gi(r);return Xt(u||r,function(c,l){if(u&&(c=r[l=c]),Ke(c))i||(i=[]),a||(a=[]),function(e,t,r,o,i,a,s){for(var u=a.length,c=t[r];u--;)if(a[u]==c)return void(e[r]=s[u]);var l=e[r],p=i?i(l,c,r,e,t):n,f=p===n;f&&(p=c,bn(c)&&(zo(c)||si(c))?p=zo(l)?l:bn(l)?Vt(l):[]:oi(c)||qo(c)?p=qo(l)?li(l):oi(l)?l:{}:f=!1),a.push(c),s.push(p),f?e[r]=o(p,c,i,a,s):(p==p?p!==l:l==l)&&(e[r]=p)}(t,r,l,e,o,i,a);else{var p=t[l],f=o?o(p,c,l,t,r):n,d=f===n;d&&(f=c),f===n&&(!s||l in t)||!d&&(f==f?f===p:p!=p)||(t[l]=f)}}),t}),bi=Vo(function(e,t){if(null==e)return{};if(\"function\"!=typeof t[0])return t=Jt(mr(t),Ce),Ln(e,cr(vi(e),t));var r=Br(t[0],t[1],3);return Pn(e,function(e,t,n){return!r(e,t,n)})});function wi(e){e=jn(e);for(var t=-1,n=gi(e),o=n.length,i=r(o);++t<o;){var a=n[t];i[t]=[a,e[a]]}return i}var Ni=Vo(function(e,t){return null==e?{}:\"function\"==typeof t[0]?Pn(e,Br(t[0],t[1],3)):Ln(e,mr(t))});function Ci(e){return Ur(e,gi(e))}var Si=Zr(function(e,t,r){return t=t.toLowerCase(),e+(r?t.charAt(0).toUpperCase()+t.slice(1):t)});function Ii(e){return(e=Ue(e))&&e.replace(pe,Fe).replace(oe,\"\")}function xi(e){return(e=Ue(e))&&ne.test(e)?e.replace(re,\"\\\\$&\"):e}var Li=Zr(function(e,t,r){return e+(r?\"-\":\"\")+t.toLowerCase()});var Pi=ln(),Mi=ln(!0);function ki(e,t,r){return r&&Nn(e,t,r)&&(t=0),Nt(e,t)}function Di(e,t){var r=\"\";if(e=Ue(e),(t=+t)<1||!e||!vt(t))return r;do{t%2&&(r+=e),t=ct(t/2),e+=e}while(t);return r}8!=Nt(me+\"08\")&&(ki=function(e,t,r){return(r?Nn(e,t,r):null==t)?t=0:t&&(t=+t),e=Wi(e),Nt(e,t||(ue.test(e)?16:10))});var Ui=Zr(function(e,t,r){return e+(r?\"_\":\"\")+t.toLowerCase()}),ji=Zr(function(e,t,r){return e+(r?\" \":\"\")+(t.charAt(0).toUpperCase()+t.slice(1))});function Wi(e,t,r){var n=e;return(e=Ue(e))?(r?Nn(n,t,r):null==t)?e.slice(qe(e),ze(e)+1):(t+=\"\",e.slice(je(e,t),We(e,t)+1)):e}function Gi(e,t,r){return r&&Nn(e,t,r)&&(t=null),(e=Ue(e)).match(t||he)||[]}var Fi=Vo(function(e,t){try{return e.apply(n,t)}catch(e){return $o(e)?e:new Oe(e)}});function Bi(e,t,r){return r&&Nn(e,t,r)&&(t=null),Ke(e)?Ki(e):ir(e,t)}function Hi(e){return function(){return e}}function Yi(e){return e}function Ki(e){return wr(ar(e,!0))}var Vi=Vo(function(e,t){return function(r){return An(r,e,t)}}),Xi=Vo(function(e,t){return function(r){return An(e,r,t)}});function qi(e,t,r){if(null==r){var n=ti(t),o=n?gi(t):null,i=o&&o.length?vr(t,o):null;(i?i.length:n)||(i=!1,r=t,t=e,e=this)}i||(i=vr(t,gi(t)));var a=!0,s=-1,u=ei(e),c=i.length;!1===r?a=!1:ti(r)&&\"chain\"in r&&(a=r.chain);for(;++s<c;){var l=i[s],p=t[l];e[l]=p,u&&(e.prototype[l]=function(t){return function(){var r=this.__chain__;if(a||r){var n=e(this.__wrapped__);return(n.__actions__=Vt(this.__actions__)).push({func:t,args:arguments,thisArg:e}),n.__chain__=r,n}var o=[this.value()];return ft.apply(o,arguments),t.apply(e,o)}}(p))}return e}function zi(){}function Ji(e){return Cn(e)?Cr(e):function(e){var t=e+\"\";return e=Wn(e),function(r){return Or(r,e,t)}}(e)}var Zi=en(Xo,St),$i=en(ui,It);return jt.prototype=Wt.prototype,Gt.prototype=sr(Wt.prototype),Gt.prototype.constructor=Gt,Bt.prototype=sr(Wt.prototype),Bt.prototype.constructor=Bt,Ht.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ht.prototype.get=function(e){return\"__proto__\"==e?n:this.__data__[e]},Ht.prototype.has=function(e){return\"__proto__\"!=e&&et.call(this.__data__,e)},Ht.prototype.set=function(e,t){return\"__proto__\"!=e&&(this.__data__[e]=t),this},Yt.prototype.push=function(e){var t=this.data;\"string\"==typeof e||ti(e)?t.set.add(e):t.hash[e]=!0},Bo.Cache=Ht,jt.after=function(e,t){if(\"function\"!=typeof t){if(\"function\"!=typeof e)throw new Se(v);var r=e;e=t,t=r}return e=vt(e=+e)?e:0,function(){if(--e<1)return t.apply(this,arguments)}},jt.ary=function(e,t,r){return r&&Nn(e,t,r)&&(t=null),t=e&&null==t?e.length:Tt(+t||0,0),yn(e,f,null,null,null,null,t)},jt.assign=pi,jt.at=lo,jt.before=xo,jt.bind=Lo,jt.bindAll=Po,jt.bindKey=Mo,jt.callback=Bi,jt.chain=uo,jt.chunk=function(e,t,n){t=(n?Nn(e,t,n):null==t)?1:Tt(+t||1,1);for(var o=0,i=e?e.length:0,a=-1,s=r(st(i/t));o<i;)s[++a]=Lr(e,o,o+=t);return s},jt.compact=function(e){for(var t=-1,r=e?e.length:0,n=-1,o=[];++t<r;){var i=e[t];i&&(o[++n]=i)}return o},jt.constant=Hi,jt.countBy=po,jt.create=function(e,t,r){var n=sr(e);return r&&Nn(e,t,r)&&(t=null),t?rr(n,t):n},jt.curry=ko,jt.curryRight=Do,jt.debounce=Uo,jt.defaults=fi,jt.defer=jo,jt.delay=Wo,jt.difference=Fn,jt.drop=Bn,jt.dropRight=Hn,jt.dropRightWhile=function(e,t,r){return e&&e.length?jr(e,_n(t,r,3),!0,!0):[]},jt.dropWhile=function(e,t,r){return e&&e.length?jr(e,_n(t,r,3),!0):[]},jt.fill=function(e,t,r,o){var i=e?e.length:0;return i?(r&&\"number\"!=typeof r&&Nn(e,t,r)&&(r=0,o=i),function(e,t,r,o){var i=e.length;for((r=null==r?0:+r||0)<0&&(r=-r>i?0:i+r),(o=o===n||o>i?i:+o||0)<0&&(o+=i),i=r>o?0:o>>>0,r>>>=0;r<i;)e[r++]=t;return e}(e,t,r,o)):[]},jt.filter=ho,jt.flatten=function(e,t,r){var n=e?e.length:0;return r&&Nn(e,t,r)&&(t=!1),n?mr(e,t):[]},jt.flattenDeep=function(e){return e&&e.length?mr(e,!0):[]},jt.flow=Go,jt.flowRight=Fo,jt.forEach=_o,jt.forEachRight=Ro,jt.forIn=mi,jt.forInRight=yi,jt.forOwn=_i,jt.forOwnRight=Ri,jt.functions=Ei,jt.groupBy=Eo,jt.indexBy=vo,jt.initial=function(e){return Hn(e,1)},jt.intersection=qn,jt.invert=function(e,t,r){r&&Nn(e,t,r)&&(t=null);for(var n=-1,o=gi(e),i=o.length,a={};++n<i;){var s=o[n],u=e[s];t?et.call(a,u)?a[u].push(s):a[u]=[s]:a[u]=s}return a},jt.invoke=Oo,jt.keys=gi,jt.keysIn=vi,jt.map=To,jt.mapKeys=Oi,jt.mapValues=Ti,jt.matches=Ki,jt.matchesProperty=function(e,t){return Nr(e,ar(t,!0))},jt.memoize=Bo,jt.merge=Ai,jt.method=Vi,jt.methodOf=Xi,jt.mixin=qi,jt.negate=function(e){if(\"function\"!=typeof e)throw new Se(v);return function(){return!e.apply(this,arguments)}},jt.omit=bi,jt.once=function(e){return xo(2,e)},jt.pairs=wi,jt.partial=Ho,jt.partialRight=Yo,jt.partition=Ao,jt.pick=Ni,jt.pluck=function(e,t){return To(e,Ji(t))},jt.property=Ji,jt.propertyOf=function(e){return function(t){return Or(e,Wn(t),t+\"\")}},jt.pull=function(){var e=arguments,t=e[0];if(!t||!t.length)return t;for(var r=0,n=gn(),o=e.length;++r<o;)for(var i=0,a=e[r];(i=n(t,a,i))>-1;)mt.call(t,i,1);return t},jt.pullAt=Jn,jt.range=function(e,t,n){n&&Nn(e,t,n)&&(t=n=null),e=+e||0,n=null==n?1:+n||0,null==t?(t=e,e=0):t=+t||0;for(var o=-1,i=Tt(st((t-e)/(n||1)),0),a=r(i);++o<i;)a[o]=e,e+=n;return a},jt.rearg=Ko,jt.reject=function(e,t,r){var n=zo(e)?zt:dr;return t=_n(t,r,3),n(e,function(e,r,n){return!t(e,r,n)})},jt.remove=function(e,t,r){var n=[];if(!e||!e.length)return n;var o=-1,i=[],a=e.length;for(t=_n(t,r,3);++o<a;){var s=e[o];t(s,o,e)&&(n.push(s),i.push(o))}return Sr(e,i),n},jt.rest=Zn,jt.restParam=Vo,jt.set=function(e,t,r){if(null==e)return e;for(var n=t+\"\",o=-1,i=(t=null!=e[n]||Cn(t,e)?[n]:Wn(t)).length,a=i-1,s=e;null!=s&&++o<i;){var u=t[o];ti(s)&&(o==a?s[u]=r:null==s[u]&&(s[u]=wn(t[o+1])?[]:{})),s=s[u]}return e},jt.shuffle=function(e){return No(e,It)},jt.slice=function(e,t,r){var n=e?e.length:0;return n?(r&&\"number\"!=typeof r&&Nn(e,t,r)&&(t=0,r=n),Lr(e,t,r)):[]},jt.sortBy=function(e,t,r){if(null==e)return[];r&&Nn(e,t,r)&&(t=null);var n=-1;return t=_n(t,r,3),Mr(br(e,function(e,r,o){return{criteria:t(e,r,o),index:++n,value:e}}),Ge)},jt.sortByAll=So,jt.sortByOrder=function(e,t,r,n){return null==e?[]:(n&&Nn(t,r,n)&&(r=null),zo(t)||(t=null==t?[]:[t]),zo(r)||(r=null==r?[]:[r]),kr(e,t,r))},jt.spread=function(e){if(\"function\"!=typeof e)throw new Se(v);return function(t){return e.apply(this,t)}},jt.take=function(e,t,r){return e&&e.length?((r?Nn(e,t,r):null==t)&&(t=1),Lr(e,0,t<0?0:t)):[]},jt.takeRight=function(e,t,r){var n=e?e.length:0;return n?((r?Nn(e,t,r):null==t)&&(t=1),Lr(e,(t=n-(+t||0))<0?0:t)):[]},jt.takeRightWhile=function(e,t,r){return e&&e.length?jr(e,_n(t,r,3),!1,!0):[]},jt.takeWhile=function(e,t,r){return e&&e.length?jr(e,_n(t,r,3)):[]},jt.tap=function(e,t,r){return t.call(r,e),e},jt.throttle=function(e,t,r){var n=!0,o=!0;if(\"function\"!=typeof e)throw new Se(v);return!1===r?n=!1:ti(r)&&(n=\"leading\"in r?!!r.leading:n,o=\"trailing\"in r?!!r.trailing:o),ge.leading=n,ge.maxWait=+t,ge.trailing=o,Uo(e,t,ge)},jt.thru=co,jt.times=function(e,t,n){if((e=ct(e))<1||!vt(e))return[];var o=-1,i=r(At(e,xt));for(t=Br(t,n,1);++o<e;)o<xt?i[o]=t(o):t(o);return i},jt.toArray=ci,jt.toPlainObject=li,jt.transform=function(e,t,r,n){var o=zo(e)||si(e);if(t=_n(t,n,4),null==r)if(o||ti(e)){var i=e.constructor;r=o?zo(e)?new i:[]:sr(ei(i)?i.prototype:null)}else r={};return(o?Xt:Er)(e,function(e,n,o){return t(r,e,n,o)}),r},jt.union=eo,jt.uniq=to,jt.unzip=ro,jt.unzipWith=no,jt.values=Ci,jt.valuesIn=function(e){return Ur(e,vi(e))},jt.where=function(e,t){return ho(e,wr(t))},jt.without=oo,jt.wrap=function(e,t){return yn(t=null==t?Yi:t,l,null,[e],[])},jt.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var r=arguments[e];if(bn(r))var n=n?cr(n,r).concat(cr(r,n)):r}return n?Dr(n):[]},jt.zip=io,jt.zipObject=ao,jt.zipWith=so,jt.backflow=Fo,jt.collect=To,jt.compose=Fo,jt.each=_o,jt.eachRight=Ro,jt.extend=pi,jt.iteratee=Bi,jt.methods=Ei,jt.object=ao,jt.select=ho,jt.tail=Zn,jt.unique=to,qi(jt,jt),jt.add=function(e,t){return(+e||0)+(+t||0)},jt.attempt=Fi,jt.camelCase=Si,jt.capitalize=function(e){return(e=Ue(e))&&e.charAt(0).toUpperCase()+e.slice(1)},jt.clone=function(e,t,r,n){return t&&\"boolean\"!=typeof t&&Nn(e,t,r)?t=!1:\"function\"==typeof t&&(n=r,r=t,t=!1),\"function\"==typeof r?ar(e,t,Br(r,n,1)):ar(e,t)},jt.cloneDeep=function(e,t,r){return\"function\"==typeof t?ar(e,!0,Br(t,r,1)):ar(e,!0)},jt.deburr=Ii,jt.endsWith=function(e,t,r){t+=\"\";var o=(e=Ue(e)).length;return r=r===n?o:At(r<0?0:+r||0,o),(r-=t.length)>=0&&e.indexOf(t,r)==r},jt.escape=function(e){return(e=Ue(e))&&z.test(e)?e.replace(X,Be):e},jt.escapeRegExp=xi,jt.every=fo,jt.find=mo,jt.findIndex=Yn,jt.findKey=di,jt.findLast=yo,jt.findLastIndex=Kn,jt.findLastKey=hi,jt.findWhere=function(e,t){return mo(e,wr(t))},jt.first=Vn,jt.get=function(e,t,r){var o=null==e?n:Or(e,Wn(t),t+\"\");return o===n?r:o},jt.gt=Xo,jt.gte=function(e,t){return e>=t},jt.has=function(e,t){if(null==e)return!1;var r=et.call(e,t);if(!r&&!Cn(t)){if(null==(e=1==(t=Wn(t)).length?e:Or(e,Lr(t,0,-1))))return!1;t=zn(t),r=et.call(e,t)}return r||In(e.length)&&wn(t,e.length)&&(zo(e)||qo(e))},jt.identity=Yi,jt.includes=go,jt.indexOf=Xn,jt.inRange=function(e,t,r){return t=+t||0,void 0===r?(r=t,t=0):r=+r||0,e>=At(t,r)&&e<Tt(t,r)},jt.isArguments=qo,jt.isArray=zo,jt.isBoolean=function(e){return!0===e||!1===e||Ke(e)&&rt.call(e)==b},jt.isDate=function(e){return Ke(e)&&rt.call(e)==w},jt.isElement=Jo,jt.isEmpty=function(e){return null==e||(bn(e)&&(zo(e)||ai(e)||qo(e)||Ke(e)&&ei(e.splice))?!e.length:!gi(e).length)},jt.isEqual=Zo,jt.isError=$o,jt.isFinite=Qo,jt.isFunction=ei,jt.isMatch=function(e,t,r,o){return r=\"function\"==typeof r?Br(r,o,3):n,Ar(e,On(t),r)},jt.isNaN=function(e){return ni(e)&&e!=+e},jt.isNative=ri,jt.isNull=function(e){return null===e},jt.isNumber=ni,jt.isObject=ti,jt.isPlainObject=oi,jt.isRegExp=ii,jt.isString=ai,jt.isTypedArray=si,jt.isUndefined=function(e){return e===n},jt.kebabCase=Li,jt.last=zn,jt.lastIndexOf=function(e,t,r){var n=e?e.length:0;if(!n)return-1;var o=n;if(\"number\"==typeof r)o=(r<0?Tt(n+r,0):At(r||0,n-1))+1;else if(r){var i=e[o=Gr(e,t,!0)-1];return(t==t?t===i:i!=i)?o:-1}if(t!=t)return Ye(e,o,!0);for(;o--;)if(e[o]===t)return o;return-1},jt.lt=ui,jt.lte=function(e,t){return e<=t},jt.max=Zi,jt.min=$i,jt.noConflict=function(){return t._=nt,this},jt.noop=zi,jt.now=Io,jt.pad=function(e,t,r){t=+t;var n=(e=Ue(e)).length;if(n>=t||!vt(t))return e;var o=(t-n)/2,i=ct(o);return(r=hn(\"\",st(o),r)).slice(0,i)+e+r},jt.padLeft=Pi,jt.padRight=Mi,jt.parseInt=ki,jt.random=function(e,t,r){r&&Nn(e,t,r)&&(t=r=null);var n=null==e,o=null==t;if(null==r&&(o&&\"boolean\"==typeof e?(r=e,e=1):\"boolean\"==typeof t&&(r=t,o=!0)),n&&o&&(t=1,o=!1),e=+e||0,o?(t=e,e=0):t=+t||0,r||e%1||t%1){var i=Ct();return At(e+i*(t-e+pt(\"1e-\"+((i+\"\").length-1))),t)}return Ir(e,t)},jt.reduce=bo,jt.reduceRight=wo,jt.repeat=Di,jt.result=function(e,t,r){var o=null==e?n:e[t];return o===n&&(null==e||Cn(t,e)||(o=null==(e=1==(t=Wn(t)).length?e:Or(e,Lr(t,0,-1)))?n:e[zn(t)]),o=o===n?r:o),ei(o)?o.call(e):o},jt.runInContext=e,jt.size=function(e){var t=e?vn(e):0;return In(t)?t:gi(e).length},jt.snakeCase=Ui,jt.some=Co,jt.sortedIndex=$n,jt.sortedLastIndex=Qn,jt.startCase=ji,jt.startsWith=function(e,t,r){return e=Ue(e),r=null==r?0:At(r<0?0:+r||0,e.length),e.lastIndexOf(t,r)==r},jt.sum=function(e,t,r){r&&Nn(e,t,r)&&(t=null);var n=_n(),o=null==t;return o&&n===ir||(o=!1,t=n(t,r,3)),o?function(e){for(var t=e.length,r=0;t--;)r+=+e[t]||0;return r}(zo(e)?e:Un(e)):function(e,t){var r=0;return lr(e,function(e,n,o){r+=+t(e,n,o)||0}),r}(e,t)},jt.template=function(e,t,r){var o=jt.templateSettings;r&&Nn(e,t,r)&&(t=r=null),e=Ue(e);var i,a,s=tr(rr({},(t=tr(rr({},r||t),o,er)).imports),o.imports,er),u=gi(s),c=Ur(s,u),l=0,p=t.interpolate||fe,f=\"__p += '\",d=Ne((t.escape||fe).source+\"|\"+p.source+\"|\"+(p===$?ae:fe).source+\"|\"+(t.evaluate||fe).source+\"|$\",\"g\"),h=\"//# sourceURL=\"+(\"sourceURL\"in t?t.sourceURL:\"lodash.templateSources[\"+ ++_e+\"]\")+\"\\n\";e.replace(d,function(t,r,n,o,s,u){return n||(n=o),f+=e.slice(l,u).replace(de,He),r&&(i=!0,f+=\"' +\\n__e(\"+r+\") +\\n'\"),s&&(a=!0,f+=\"';\\n\"+s+\";\\n__p += '\"),n&&(f+=\"' +\\n((__t = (\"+n+\")) == null ? '' : __t) +\\n'\"),l=u+t.length,t}),f+=\"';\\n\";var m=t.variable;m||(f=\"with (obj) {\\n\"+f+\"\\n}\\n\"),f=(a?f.replace(H,\"\"):f).replace(Y,\"$1\").replace(K,\"$1;\"),f=\"function(\"+(m||\"obj\")+\") {\\n\"+(m?\"\":\"obj || (obj = {});\\n\")+\"var __t, __p = ''\"+(i?\", __e = _.escape\":\"\")+(a?\", __j = Array.prototype.join;\\nfunction print() { __p += __j.call(arguments, '') }\\n\":\";\\n\")+f+\"return __p\\n}\";var y=Fi(function(){return Te(u,h+\"return \"+f).apply(n,c)});if(y.source=f,$o(y))throw y;return y},jt.trim=Wi,jt.trimLeft=function(e,t,r){var n=e;return(e=Ue(e))?(r?Nn(n,t,r):null==t)?e.slice(qe(e)):e.slice(je(e,t+\"\")):e},jt.trimRight=function(e,t,r){var n=e;return(e=Ue(e))?(r?Nn(n,t,r):null==t)?e.slice(0,ze(e)+1):e.slice(0,We(e,t+\"\")+1):e},jt.trunc=function(e,t,r){r&&Nn(e,t,r)&&(t=null);var n=h,o=m;if(null!=t)if(ti(t)){var i=\"separator\"in t?t.separator:i;n=\"length\"in t?+t.length||0:n,o=\"omission\"in t?Ue(t.omission):o}else n=+t||0;if(n>=(e=Ue(e)).length)return e;var a=n-o.length;if(a<1)return o;var s=e.slice(0,a);if(null==i)return s+o;if(ii(i)){if(e.slice(a).search(i)){var u,c,l=e.slice(0,a);for(i.global||(i=Ne(i.source,(se.exec(i)||\"\")+\"g\")),i.lastIndex=0;u=i.exec(l);)c=u.index;s=s.slice(0,null==c?a:c)}}else if(e.indexOf(i,a)!=a){var p=s.lastIndexOf(i);p>-1&&(s=s.slice(0,p))}return s+o},jt.unescape=function(e){return(e=Ue(e))&&q.test(e)?e.replace(V,Je):e},jt.uniqueId=function(e){var t=++tt;return Ue(e)+t},jt.words=Gi,jt.all=fo,jt.any=Co,jt.contains=go,jt.eq=Zo,jt.detect=mo,jt.foldl=bo,jt.foldr=wo,jt.head=Vn,jt.include=go,jt.inject=bo,qi(jt,function(){var e={};return Er(jt,function(t,r){jt.prototype[r]||(e[r]=t)}),e}(),!1),jt.sample=No,jt.prototype.sample=function(e){return this.__chain__||null!=e?this.thru(function(t){return No(t,e)}):No(this.value())},jt.VERSION=o,Xt([\"bind\",\"bindKey\",\"curry\",\"curryRight\",\"partial\",\"partialRight\"],function(e){jt[e].placeholder=jt}),Xt([\"dropWhile\",\"filter\",\"map\",\"takeWhile\"],function(e,t){var r=t!=g,n=t==R;Bt.prototype[e]=function(e,o){var i=this.__filtered__,a=i&&n?new Bt(this):this.clone();return(a.__iteratees__||(a.__iteratees__=[])).push({done:!1,count:0,index:0,iteratee:_n(e,o,1),limit:-1,type:t}),a.__filtered__=i||r,a}}),Xt([\"drop\",\"take\"],function(e,t){var r=e+\"While\";Bt.prototype[e]=function(r){var n=this.__filtered__,o=n&&!t?this.dropWhile():this.clone();return r=null==r?1:Tt(ct(r)||0,0),n?t?o.__takeCount__=At(o.__takeCount__,r):zn(o.__iteratees__).limit=r:(o.__views__||(o.__views__=[])).push({size:r,type:e+(o.__dir__<0?\"Right\":\"\")}),o},Bt.prototype[e+\"Right\"]=function(t){return this.reverse()[e](t).reverse()},Bt.prototype[e+\"RightWhile\"]=function(e,t){return this.reverse()[r](e,t).reverse()}}),Xt([\"first\",\"last\"],function(e,t){var r=\"take\"+(t?\"Right\":\"\");Bt.prototype[e]=function(){return this[r](1).value()[0]}}),Xt([\"initial\",\"rest\"],function(e,t){var r=\"drop\"+(t?\"\":\"Right\");Bt.prototype[e]=function(){return this[r](1)}}),Xt([\"pluck\",\"where\"],function(e,t){var r=t?\"filter\":\"map\",n=t?wr:Ji;Bt.prototype[e]=function(e){return this[r](n(e))}}),Bt.prototype.compact=function(){return this.filter(Yi)},Bt.prototype.reject=function(e,t){return e=_n(e,t,1),this.filter(function(t){return!e(t)})},Bt.prototype.slice=function(e,t){var r=this;return(e=null==e?0:+e||0)<0?r=this.takeRight(-e):e&&(r=this.drop(e)),t!==n&&(r=(t=+t||0)<0?r.dropRight(-t):r.take(t-e)),r},Bt.prototype.toArray=function(){return this.drop(0)},Er(Bt.prototype,function(e,t){var r=jt[t];if(r){var n=/^(?:filter|map|reject)|While$/.test(t),o=/^(?:first|last)$/.test(t);jt.prototype[t]=function(){var t=arguments,i=this.__chain__,a=this.__wrapped__,s=!!this.__actions__.length,u=a instanceof Bt,c=t[0],l=u||zo(a);l&&n&&\"function\"==typeof c&&1!=c.length&&(u=l=!1);var p=u&&!s;if(o&&!i)return p?e.call(a):r.call(jt,this.value());var f=function(e){var n=[e];return ft.apply(n,t),r.apply(jt,n)};if(l){var d=p?a:new Bt(this),h=e.apply(d,t);return o||!s&&!h.__actions__||(h.__actions__||(h.__actions__=[])).push({func:co,args:[f],thisArg:jt}),new Gt(h,i)}return this.thru(f)}}}),Xt([\"concat\",\"join\",\"pop\",\"push\",\"replace\",\"shift\",\"sort\",\"splice\",\"split\",\"unshift\"],function(e){var t=(/^(?:replace|split)$/.test(e)?Ve:Ie)[e],r=/^(?:push|sort|unshift)$/.test(e)?\"tap\":\"thru\",n=/^(?:join|pop|replace|shift)$/.test(e);jt.prototype[e]=function(){var e=arguments;return n&&!this.__chain__?t.apply(this.value(),e):this[r](function(r){return t.apply(r,e)})}}),Er(Bt.prototype,function(e,t){var r=jt[t];if(r){var n=r.name;(Ut[n]||(Ut[n]=[])).push({name:t,func:r})}}),Ut[dn(null,a).name]=[{name:\"wrapper\",func:null}],Bt.prototype.clone=function(){var e=this.__actions__,t=this.__iteratees__,r=this.__views__,n=new Bt(this.__wrapped__);return n.__actions__=e?Vt(e):null,n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=t?Vt(t):null,n.__takeCount__=this.__takeCount__,n.__views__=r?Vt(r):null,n},Bt.prototype.reverse=function(){if(this.__filtered__){var e=new Bt(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Bt.prototype.value=function(){var e=this.__wrapped__.value();if(!zo(e))return Wr(e,this.__actions__);var t=this.__dir__,r=t<0,n=function(e,t,r){for(var n=-1,o=r?r.length:0;++n<o;){var i=r[n],a=i.size;switch(i.type){case\"drop\":e+=a;break;case\"dropRight\":t-=a;break;case\"take\":t=At(t,e+a);break;case\"takeRight\":e=Tt(e,t-a)}}return{start:e,end:t}}(0,e.length,this.__views__),o=n.start,i=n.end,a=i-o,s=r?i:o-1,u=At(a,this.__takeCount__),c=this.__iteratees__,l=c?c.length:0,p=0,f=[];e:for(;a--&&p<u;){for(var d=-1,h=e[s+=t];++d<l;){var m=c[d],y=m.iteratee,_=m.type;if(_==R){if(m.done&&(r?s>m.index:s<m.index)&&(m.count=0,m.done=!1),m.index=s,!m.done){var v=m.limit;if(!(m.done=v>-1?m.count++>=v:!y(h)))continue e}}else{var O=y(h);if(_==g)h=O;else if(!O){if(_==E)continue e;break e}}}f[p++]=h}return f},jt.prototype.chain=function(){return uo(this)},jt.prototype.commit=function(){return new Gt(this.value(),this.__chain__)},jt.prototype.plant=function(e){for(var t,r=this;r instanceof Wt;){var n=Gn(r);t?o.__wrapped__=n:t=n;var o=n;r=r.__wrapped__}return o.__wrapped__=e,t},jt.prototype.reverse=function(){var e=this.__wrapped__;return e instanceof Bt?(this.__actions__.length&&(e=new Bt(this)),new Gt(e.reverse(),this.__chain__)):this.thru(function(e){return e.reverse()})},jt.prototype.toString=function(){return this.value()+\"\"},jt.prototype.run=jt.prototype.toJSON=jt.prototype.valueOf=jt.prototype.value=function(){return Wr(this.__wrapped__,this.__actions__)},jt.prototype.collect=jt.prototype.map,jt.prototype.head=jt.prototype.first,jt.prototype.select=jt.prototype.filter,jt.prototype.tail=jt.prototype.rest,jt}();\"function\"==typeof define&&\"object\"==typeof define.amd&&define.amd?(Le._=Ze,define(function(){return Ze})):we&&Ne?xe?(Ne.exports=Ze)._=Ze:we._=Ze:Le._=Ze}).call(this)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],10:[function(e,t,r){(function(e,n){!function(e){\"use strict\";if(\"function\"==typeof bootstrap)bootstrap(\"promise\",e);else if(\"object\"==typeof r&&\"object\"==typeof t)t.exports=e();else if(\"function\"==typeof define&&define.amd)define(e);else if(\"undefined\"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if(\"undefined\"==typeof window&&\"undefined\"==typeof self)throw new Error(\"This environment was not anticipated by Q. Please file a bug.\");var n=\"undefined\"!=typeof window?window:self,o=n.Q;n.Q=e(),n.Q.noConflict=function(){return n.Q=o,this}}}(function(){\"use strict\";var t=!1;try{throw new Error}catch(e){t=!!e.stack}var r,o=A(),i=function(){},a=function(){var t={task:void 0,next:null},r=t,o=!1,i=void 0,s=!1,u=[];function c(){for(var e,r;t.next;)e=(t=t.next).task,t.task=void 0,(r=t.domain)&&(t.domain=void 0,r.enter()),l(e,r);for(;u.length;)l(e=u.pop());o=!1}function l(e,t){try{e()}catch(e){if(s)throw t&&t.exit(),setTimeout(c,0),t&&t.enter(),e;setTimeout(function(){throw e},0)}t&&t.exit()}if(a=function(t){r=r.next={task:t,domain:s&&e.domain,next:null},o||(o=!0,i())},\"object\"==typeof e&&\"[object process]\"===e.toString()&&e.nextTick)s=!0,i=function(){e.nextTick(c)};else if(\"function\"==typeof n)i=\"undefined\"!=typeof window?n.bind(window,c):function(){n(c)};else if(\"undefined\"!=typeof MessageChannel){var p=new MessageChannel;p.port1.onmessage=function(){i=f,p.port1.onmessage=c,c()};var f=function(){p.port2.postMessage(0)};i=function(){setTimeout(c,0),f()}}else i=function(){setTimeout(c,0)};return a.runAfter=function(e){u.push(e),o||(o=!0,i())},a}(),s=Function.call;function u(e){return function(){return s.apply(e,arguments)}}var c,l=u(Array.prototype.slice),p=u(Array.prototype.reduce||function(e,t){var r=0,n=this.length;if(1===arguments.length)for(;;){if(r in this){t=this[r++];break}if(++r>=n)throw new TypeError}for(;r<n;r++)r in this&&(t=e(t,this[r],r));return t}),f=u(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),d=u(Array.prototype.map||function(e,t){var r=this,n=[];return p(r,function(o,i,a){n.push(e.call(t,i,a,r))},void 0),n}),h=Object.create||function(e){function t(){}return t.prototype=e,new t},m=Object.defineProperty||function(e,t,r){return e[t]=r.value,e},y=u(Object.prototype.hasOwnProperty),_=Object.keys||function(e){var t=[];for(var r in e)y(e,r)&&t.push(r);return t},R=u(Object.prototype.toString);c=\"undefined\"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var E=\"From previous event:\";function g(e,r){if(t&&r.stack&&\"object\"==typeof e&&null!==e&&e.stack){for(var n=[],o=r;o;o=o.source)o.stack&&(!e.__minimumStackCounter__||e.__minimumStackCounter__>o.stackCounter)&&(m(e,\"__minimumStackCounter__\",{value:o.stackCounter,configurable:!0}),n.unshift(o.stack));n.unshift(e.stack);var i=function(e){for(var t=e.split(\"\\n\"),r=[],n=0;n<t.length;++n){var o=t[n];T(o)||v(o)||!o||r.push(o)}return r.join(\"\\n\")}(n.join(\"\\n\"+E+\"\\n\"));m(e,\"stack\",{value:i,configurable:!0})}}function v(e){return-1!==e.indexOf(\"(module.js:\")||-1!==e.indexOf(\"(node.js:\")}function O(e){var t=/at .+ \\((.+):(\\d+):(?:\\d+)\\)$/.exec(e);if(t)return[t[1],Number(t[2])];var r=/at ([^ ]+):(\\d+):(?:\\d+)$/.exec(e);if(r)return[r[1],Number(r[2])];var n=/.*@(.+):(\\d+)$/.exec(e);return n?[n[1],Number(n[2])]:void 0}function T(e){var t=O(e);if(!t)return!1;var n=t[0],i=t[1];return n===r&&i>=o&&i<=X}function A(){if(t)try{throw new Error}catch(t){var e=t.stack.split(\"\\n\"),n=O(e[0].indexOf(\"@\")>0?e[1]:e[2]);if(!n)return;return r=n[0],n[1]}}function b(e){return e instanceof I?e:M(e)?function(e){var t=N();return b.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}}),t.promise}(e):F(e)}b.resolve=b,b.nextTick=a,b.longStackSupport=!1;var w=1;function N(){var e,r=[],n=[],o=h(N.prototype),i=h(I.prototype);if(i.promiseDispatch=function(t,o,i){var a=l(arguments);r?(r.push(a),\"when\"===o&&i[1]&&n.push(i[1])):b.nextTick(function(){e.promiseDispatch.apply(e,a)})},i.valueOf=function(){if(r)return i;var t=L(e);return P(t)&&(e=t),t},i.inspect=function(){return e?e.inspect():{state:\"pending\"}},b.longStackSupport&&t)try{throw new Error}catch(e){i.stack=e.stack.substring(e.stack.indexOf(\"\\n\")+1),i.stackCounter=w++}function a(o){e=o,b.longStackSupport&&t&&(i.source=o),p(r,function(e,t){b.nextTick(function(){o.promiseDispatch.apply(o,t)})},void 0),r=void 0,n=void 0}return o.promise=i,o.resolve=function(t){e||a(b(t))},o.fulfill=function(t){e||a(F(t))},o.reject=function(t){e||a(G(t))},o.notify=function(t){e||p(n,function(e,r){b.nextTick(function(){r(t)})},void 0)},o}function C(e){if(\"function\"!=typeof e)throw new TypeError(\"resolver must be a function.\");var t=N();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function S(e){return C(function(t,r){for(var n=0,o=e.length;n<o;n++)b(e[n]).then(t,r)})}function I(e,t,r){void 0===t&&(t=function(e){return G(new Error(\"Promise does not support operation: \"+e))}),void 0===r&&(r=function(){return{state:\"unknown\"}});var n=h(I.prototype);if(n.promiseDispatch=function(r,o,i){var a;try{a=e[o]?e[o].apply(n,i):t.call(n,o,i)}catch(e){a=G(e)}r&&r(a)},n.inspect=r,r){var o=r();\"rejected\"===o.state&&(n.exception=o.reason),n.valueOf=function(){var e=r();return\"pending\"===e.state||\"rejected\"===e.state?n:e.value}}return n}function x(e,t,r,n){return b(e).then(t,r,n)}function L(e){if(P(e)){var t=e.inspect();if(\"fulfilled\"===t.state)return t.value}return e}function P(e){return e instanceof I}function M(e){return function(e){return e===Object(e)}(e)&&\"function\"==typeof e.then}\"object\"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(b.longStackSupport=!0),b.defer=N,N.prototype.makeNodeResolver=function(){var e=this;return function(t,r){t?e.reject(t):arguments.length>2?e.resolve(l(arguments,1)):e.resolve(r)}},b.Promise=C,b.promise=C,C.race=S,C.all=Y,C.reject=G,C.resolve=b,b.passByCopy=function(e){return e},I.prototype.passByCopy=function(){return this},b.join=function(e,t){return b(e).join(t)},I.prototype.join=function(e){return b([this,e]).spread(function(e,t){if(e===t)return e;throw new Error(\"Q can't join: not the same: \"+e+\" \"+t)})},b.race=S,I.prototype.race=function(){return this.then(b.race)},b.makePromise=I,I.prototype.toString=function(){return\"[object Promise]\"},I.prototype.then=function(e,t,r){var n=this,o=N(),i=!1;return b.nextTick(function(){n.promiseDispatch(function(t){i||(i=!0,o.resolve(function(t){try{return\"function\"==typeof e?e(t):t}catch(e){return G(e)}}(t)))},\"when\",[function(e){i||(i=!0,o.resolve(function(e){if(\"function\"==typeof t){g(e,n);try{return t(e)}catch(e){return G(e)}}return G(e)}(e)))}])}),n.promiseDispatch(void 0,\"when\",[void 0,function(e){var t,n=!1;try{t=function(e){return\"function\"==typeof r?r(e):e}(e)}catch(e){if(n=!0,!b.onerror)throw e;b.onerror(e)}n||o.notify(t)}]),o.promise},b.tap=function(e,t){return b(e).tap(t)},I.prototype.tap=function(e){return e=b(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},b.when=x,I.prototype.thenResolve=function(e){return this.then(function(){return e})},b.thenResolve=function(e,t){return b(e).thenResolve(t)},I.prototype.thenReject=function(e){return this.then(function(){throw e})},b.thenReject=function(e,t){return b(e).thenReject(t)},b.nearer=L,b.isPromise=P,b.isPromiseAlike=M,b.isPending=function(e){return P(e)&&\"pending\"===e.inspect().state},I.prototype.isPending=function(){return\"pending\"===this.inspect().state},b.isFulfilled=function(e){return!P(e)||\"fulfilled\"===e.inspect().state},I.prototype.isFulfilled=function(){return\"fulfilled\"===this.inspect().state},b.isRejected=function(e){return P(e)&&\"rejected\"===e.inspect().state},I.prototype.isRejected=function(){return\"rejected\"===this.inspect().state};var k=[],D=[],U=[],j=!0;function W(){k.length=0,D.length=0,j||(j=!0)}function G(t){var r=I({when:function(r){return r&&function(t){if(j){var r=f(D,t);-1!==r&&(\"object\"==typeof e&&\"function\"==typeof e.emit&&b.nextTick.runAfter(function(){var n=f(U,t);-1!==n&&(e.emit(\"rejectionHandled\",k[r],t),U.splice(n,1))}),D.splice(r,1),k.splice(r,1))}}(this),r?r(t):this}},function(){return this},function(){return{state:\"rejected\",reason:t}});return function(t,r){j&&(\"object\"==typeof e&&\"function\"==typeof e.emit&&b.nextTick.runAfter(function(){-1!==f(D,t)&&(e.emit(\"unhandledRejection\",r,t),U.push(t))}),D.push(t),r&&void 0!==r.stack?k.push(r.stack):k.push(\"(no stack) \"+r))}(r,t),r}function F(e){return I({when:function(){return e},get:function(t){return e[t]},set:function(t,r){e[t]=r},delete:function(t){delete e[t]},post:function(t,r){return null===t||void 0===t?e.apply(void 0,r):e[t].apply(e,r)},apply:function(t,r){return e.apply(t,r)},keys:function(){return _(e)}},void 0,function(){return{state:\"fulfilled\",value:e}})}function B(e,t,r){return b(e).spread(t,r)}function H(e,t,r){return b(e).dispatch(t,r)}function Y(e){return x(e,function(e){var t=0,r=N();return p(e,function(n,o,i){var a;P(o)&&\"fulfilled\"===(a=o.inspect()).state?e[i]=a.value:(++t,x(o,function(n){e[i]=n,0==--t&&r.resolve(e)},r.reject,function(e){r.notify({index:i,value:e})}))},void 0),0===t&&r.resolve(e),r.promise})}function K(e){if(0===e.length)return b.resolve();var t=b.defer(),r=0;return p(e,function(n,o,i){var a=e[i];r++,x(a,function(e){t.resolve(e)},function(e){if(0==--r){var n=e||new Error(\"\"+e);n.message=\"Q can't get fulfillment value from any promise, all promises were rejected. Last error message: \"+n.message,t.reject(n)}},function(e){t.notify({index:i,value:e})})},void 0),t.promise}function V(e){return x(e,function(e){return e=d(e,b),x(Y(d(e,function(e){return x(e,i,i)})),function(){return e})})}b.resetUnhandledRejections=W,b.getUnhandledReasons=function(){return k.slice()},b.stopUnhandledRejectionTracking=function(){W(),j=!1},W(),b.reject=G,b.fulfill=F,b.master=function(e){return I({isDef:function(){}},function(t,r){return H(e,t,r)},function(){return b(e).inspect()})},b.spread=B,I.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},b.async=function(e){return function(){function t(e,t){var i;if(\"undefined\"==typeof StopIteration){try{i=r[e](t)}catch(e){return G(e)}return i.done?b(i.value):x(i.value,n,o)}try{i=r[e](t)}catch(e){return function(e){return\"[object StopIteration]\"===R(e)||e instanceof c}(e)?b(e.value):G(e)}return x(i,n,o)}var r=e.apply(this,arguments),n=t.bind(t,\"next\"),o=t.bind(t,\"throw\");return n()}},b.spawn=function(e){b.done(b.async(e)())},b.return=function(e){throw new c(e)},b.promised=function(e){return function(){return B([this,Y(arguments)],function(t,r){return e.apply(t,r)})}},b.dispatch=H,I.prototype.dispatch=function(e,t){var r=this,n=N();return b.nextTick(function(){r.promiseDispatch(n.resolve,e,t)}),n.promise},b.get=function(e,t){return b(e).dispatch(\"get\",[t])},I.prototype.get=function(e){return this.dispatch(\"get\",[e])},b.set=function(e,t,r){return b(e).dispatch(\"set\",[t,r])},I.prototype.set=function(e,t){return this.dispatch(\"set\",[e,t])},b.del=b.delete=function(e,t){return b(e).dispatch(\"delete\",[t])},I.prototype.del=I.prototype.delete=function(e){return this.dispatch(\"delete\",[e])},b.mapply=b.post=function(e,t,r){return b(e).dispatch(\"post\",[t,r])},I.prototype.mapply=I.prototype.post=function(e,t){return this.dispatch(\"post\",[e,t])},b.send=b.mcall=b.invoke=function(e,t){return b(e).dispatch(\"post\",[t,l(arguments,2)])},I.prototype.send=I.prototype.mcall=I.prototype.invoke=function(e){return this.dispatch(\"post\",[e,l(arguments,1)])},b.fapply=function(e,t){return b(e).dispatch(\"apply\",[void 0,t])},I.prototype.fapply=function(e){return this.dispatch(\"apply\",[void 0,e])},b.try=b.fcall=function(e){return b(e).dispatch(\"apply\",[void 0,l(arguments,1)])},I.prototype.fcall=function(){return this.dispatch(\"apply\",[void 0,l(arguments)])},b.fbind=function(e){var t=b(e),r=l(arguments,1);return function(){return t.dispatch(\"apply\",[this,r.concat(l(arguments))])}},I.prototype.fbind=function(){var e=this,t=l(arguments);return function(){return e.dispatch(\"apply\",[this,t.concat(l(arguments))])}},b.keys=function(e){return b(e).dispatch(\"keys\",[])},I.prototype.keys=function(){return this.dispatch(\"keys\",[])},b.all=Y,I.prototype.all=function(){return Y(this)},b.any=K,I.prototype.any=function(){return K(this)},b.allResolved=function(e,t,r){return function(){return\"undefined\"!=typeof console&&console.warn,e.apply(e,arguments)}}(V),I.prototype.allResolved=function(){return V(this)},b.allSettled=function(e){return b(e).allSettled()},I.prototype.allSettled=function(){return this.then(function(e){return Y(d(e,function(e){function t(){return e.inspect()}return(e=b(e)).then(t,t)}))})},b.fail=b.catch=function(e,t){return b(e).then(void 0,t)},I.prototype.fail=I.prototype.catch=function(e){return this.then(void 0,e)},b.progress=function(e,t){return b(e).then(void 0,void 0,t)},I.prototype.progress=function(e){return this.then(void 0,void 0,e)},b.fin=b.finally=function(e,t){return b(e).finally(t)},I.prototype.fin=I.prototype.finally=function(e){if(!e||\"function\"!=typeof e.apply)throw new Error(\"Q can't apply finally callback\");return e=b(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},b.done=function(e,t,r,n){return b(e).done(t,r,n)},I.prototype.done=function(t,r,n){var o=function(e){b.nextTick(function(){if(g(e,i),!b.onerror)throw e;b.onerror(e)})},i=t||r||n?this.then(t,r,n):this;\"object\"==typeof e&&e&&e.domain&&(o=e.domain.bind(o)),i.then(void 0,o)},b.timeout=function(e,t,r){return b(e).timeout(t,r)},I.prototype.timeout=function(e,t){var r=N(),n=setTimeout(function(){t&&\"string\"!=typeof t||((t=new Error(t||\"Timed out after \"+e+\" ms\")).code=\"ETIMEDOUT\"),r.reject(t)},e);return this.then(function(e){clearTimeout(n),r.resolve(e)},function(e){clearTimeout(n),r.reject(e)},r.notify),r.promise},b.delay=function(e,t){return void 0===t&&(t=e,e=void 0),b(e).delay(t)},I.prototype.delay=function(e){return this.then(function(t){var r=N();return setTimeout(function(){r.resolve(t)},e),r.promise})},b.nfapply=function(e,t){return b(e).nfapply(t)},I.prototype.nfapply=function(e){var t=N(),r=l(e);return r.push(t.makeNodeResolver()),this.fapply(r).fail(t.reject),t.promise},b.nfcall=function(e){var t=l(arguments,1);return b(e).nfapply(t)},I.prototype.nfcall=function(){var e=l(arguments),t=N();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},b.nfbind=b.denodeify=function(e){if(void 0===e)throw new Error(\"Q can't wrap an undefined function\");var t=l(arguments,1);return function(){var r=t.concat(l(arguments)),n=N();return r.push(n.makeNodeResolver()),b(e).fapply(r).fail(n.reject),n.promise}},I.prototype.nfbind=I.prototype.denodeify=function(){var e=l(arguments);return e.unshift(this),b.denodeify.apply(void 0,e)},b.nbind=function(e,t){var r=l(arguments,2);return function(){var n=r.concat(l(arguments)),o=N();return n.push(o.makeNodeResolver()),b(function(){return e.apply(t,arguments)}).fapply(n).fail(o.reject),o.promise}},I.prototype.nbind=function(){var e=l(arguments,0);return e.unshift(this),b.nbind.apply(void 0,e)},b.nmapply=b.npost=function(e,t,r){return b(e).npost(t,r)},I.prototype.nmapply=I.prototype.npost=function(e,t){var r=l(t||[]),n=N();return r.push(n.makeNodeResolver()),this.dispatch(\"post\",[e,r]).fail(n.reject),n.promise},b.nsend=b.nmcall=b.ninvoke=function(e,t){var r=l(arguments,2),n=N();return r.push(n.makeNodeResolver()),b(e).dispatch(\"post\",[t,r]).fail(n.reject),n.promise},I.prototype.nsend=I.prototype.nmcall=I.prototype.ninvoke=function(e){var t=l(arguments,1),r=N();return t.push(r.makeNodeResolver()),this.dispatch(\"post\",[e,t]).fail(r.reject),r.promise},b.nodeify=function(e,t){return b(e).nodeify(t)},I.prototype.nodeify=function(e){if(!e)return this;this.then(function(t){b.nextTick(function(){e(null,t)})},function(t){b.nextTick(function(){e(t)})})},b.noConflict=function(){throw new Error(\"Q.noConflict only works when Q is used as a global\")};var X=A();return b})}).call(this,e(\"_process\"),e(\"timers\").setImmediate)},{_process:188,timers:189}],11:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"@screeps/common/lib/constants\"),i=e(\"../game/path-utils\"),a=i.Heap,s=i.OpenClosed,u=void 0,c=void 0,l=void 0,p=void 0,f=void 0,d=void 0,h=void 0,m=void 0,y=void 0,_=void 0,R=void 0;function E(e){return 50*e.x+e.y}function g(e){return new R(Math.floor(e/50),e%50,p)}function v(e,t){var r=new R(e.x,e.y,e.roomName);switch(t){case o.TOP_LEFT:case o.TOP:case o.TOP_RIGHT:--r.y;break;case o.BOTTOM_LEFT:case o.BOTTOM:case o.BOTTOM_RIGHT:++r.y}switch(t){case o.TOP_LEFT:case o.LEFT:case o.BOTTOM_LEFT:--r.x;break;case o.TOP_RIGHT:case o.RIGHT:case o.BOTTOM_RIGHT:++r.x}return r}function O(e,t,r){var n=E(t);if(!y.isClosed(n)){var o=A(t)*h+r;y.isOpen(n)?m.priority(n)>o&&(m.update(n,o),_[n]=e):(m.push(n,o),y.open(n),_[n]=e)}}function T(e){if(e.x<0||e.x>49||e.y<0||e.y>49)return 1/0;if(l){var t=l.get(e.x,e.y);if(t)return 255===t?1/0:t}switch(e.lookFor(\"terrain\")[0]){case\"plain\":return f;case\"wall\":return 1/0;case\"swamp\":return d}}function A(e){if(u){for(var t=0,r=0;r<c.length;++r)t=Math.max(t,c[r].range-e.getRangeTo(c[r].pos));return t}for(t=1/0,r=0;r<c.length;++r)t=Math.min(t,Math.max(0,e.getRangeTo(c[r].pos)-c[r].range));return t}function b(e,t,r){for(var n=T(new R(t.x,t.y-1,t.roomName)),o=T(new R(t.x,t.y+1,t.roomName));;){if(0==A(t)||(t.x+2)%50<4)return t;var i=T(new R(t.x+r,t.y-1,t.roomName)),a=T(new R(t.x+r,t.y+1,t.roomName));if(i!==1/0&&n!=e||a!==1/0&&o!=e)return t;n=i,o=a,t.x+=r;var s=T(t);if(s===1/0)return;if(s!==e)return t}}function w(e,t,r){for(var n=T(new R(t.x-1,t.y,t.roomName)),o=T(new R(t.x+1,t.y,t.roomName));;){if(0==A(t)||(t.y+2)%50<4)return t;var i=T(new R(t.x-1,t.y+r,t.roomName)),a=T(new R(t.x+1,t.y+r,t.roomName));if(i!==1/0&&n!==e||a!==1/0&&o!==e)return t;n=i,o=a,t.y+=r;var s=T(t);if(s===1/0)return;if(s!==e)return t}}function N(e,t,r,n){return 0!==r?0!==n?function(e,t,r,n){for(var o=T(new R(t.x-r,t.y,t.roomName)),i=T(new R(t.x,t.y-n,t.roomName));;){if(0==A(t)||(t.x+2)%50<4||(t.y+2)%50<4)return t;if(T(new R(t.x-r,t.y+n,t.roomName))!==1/0&&o!==e||T(new R(t.x+r,t.y-n,t.roomName))!==1/0&&i!==e)return t;if(o=T(new R(t.x,t.y+n,t.roomName)),(i=T(new R(t.x+r,t.y,t.roomName)))!==1/0&&void 0!==b(e,new R(t.x+r,t.y,t.roomName),r)||o!==1/0&&void 0!==w(e,new R(t.x,t.y+n,t.roomName),n))return t;t.x+=r,t.y+=n;var a=T(t);if(a===1/0)return;if(a!==e)return t}}(e,t,r,n):b(e,t,r):w(e,t,n)}function C(e,t,r){var n=g(_[e]),o=t.x>n.x?1:t.x<n.x?-1:0,i=t.y>n.y?1:t.y<n.y?-1:0,a=[];if(0===t.x){if(-1===o)return;1===o&&(a.push(new R(t.x+1,t.y-1,t.roomName)),a.push(new R(t.x+1,t.y,t.roomName)),a.push(new R(t.x+1,t.y+1,t.roomName)))}else if(49==t.x){if(1===o)return;-1===o&&(a.push(new R(t.x-1,t.y-1,t.roomName)),a.push(new R(t.x-1,t.y,t.roomName)),a.push(new R(t.x-1,t.y+1,t.roomName)))}else if(0===t.y){if(-1===i)return;1===i&&(a.push(new R(t.x-1,t.y+1,t.roomName)),a.push(new R(t.x,t.y+1,t.roomName)),a.push(new R(t.x+1,t.y+1,t.roomName)))}else if(49===t.y){if(1===i)return;-1===i&&(a.push(new R(t.x-1,t.y-1,t.roomName)),a.push(new R(t.x,t.y-1,t.roomName)),a.push(new R(t.x+1,t.y-1,t.roomName)))}if(0===a.length){var s=0;t.x%50==1?s=-1:t.x%50==48&&(s=1);var u=0;t.y%50==1?u=-1:t.y%50==48&&(u=1);var c,l=T(t);if(0!==o)(f=T(c=new R(t.x+o,t.y,t.roomName)))!==1/0&&(0===u?S(t,e,c,r,l,f):O(e,c,r+f));if(0!==i)(f=T(c=new R(t.x,t.y+i,t.roomName)))!==1/0&&(0===s?S(t,e,c,r,l,f):O(e,c,r+f));if(0!==o)if(0!==i)(f=T(c=new R(t.x+o,t.y+i,t.roomName)))!==1/0&&S(t,e,c,r,l,f),T(new R(t.x-o,t.y,t.roomName))!==l&&S(t,e,new R(t.x-o,t.y+i,t.roomName),r,l,T(new R(t.x-o,t.y+i,t.roomName))),T(new R(t.x,t.y-i,t.roomName))!==l&&S(t,e,new R(t.x+o,t.y-i,t.roomName),r,l,T(new R(t.x+o,t.y-i,t.roomName)));else 1!==u&&T(new R(t.x,t.y+1,t.roomName))===l||S(t,e,new R(t.x+o,t.y+1,t.roomName),r,l,T(new R(t.x+o,t.y+1,t.roomName))),-1!==u&&T(new R(t.x,t.y-1,t.roomName))===l||S(t,e,new R(t.x+o,t.y-1,t.roomName),r,l,T(new R(t.x+o,t.y-1,t.roomName)));else 1!==s&&T(new R(t.x+1,t.y,t.roomName))===l||S(t,e,new R(t.x+1,t.y+i,t.roomName),r,l,T(new R(t.x+1,t.y+i,t.roomName))),-1!==s&&T(new R(t.x-1,t.y,t.roomName))===l||S(t,e,new R(t.x-1,t.y+i,t.roomName),r,l,T(new R(t.x-1,t.y+i,t.roomName)))}else for(var p=0;p<a.length;++p){var f;(f=T(a[p]))!==1/0&&O(e,a[p],r+f)}}function S(e,t,r,n,o,i){if(i!==o){if(i===1/0)return;n+=i}else{if(void 0===(r=N(i,r,r.x-e.x,r.y-e.y)))return;n+=i*(e.getRangeTo(r)-1)+T(r)}O(t,r,n)}r.init=function(){},r.make=function(e){R=e.RoomPosition,y=new s(2500),m=new a(2500),_=new Uint16Array(2500)},r.search=function(e,t,r){l=(r=r||{}).roomCallback?r.roomCallback(e.roomName):void 0,m.clear(),y.clear(),p=e.roomName,f=r.plainCost||1,d=r.swampCost||5,h=Math.min(9,Math.max(1,r.heuristicWeight||1)),u=r.flee;var i=r.maxOps||2e3,a=r.maxCost||1/0,s=i;c=n.map(Array.isArray(t)?t:[t],function(e){return e instanceof R?{range:0,pos:e}:e});var b=1/0,w=1/0,N=0;if(0==A(e))return{path:[],ops:0,cost:0,incomplete:!1};if(!1===l)return{path:[],ops:0,cost:0,incomplete:!0};for(function(e,t,r){for(var n=o.TOP;n<=o.TOP_LEFT;++n){var i=v(t,n);if((0!==t.x&&49!==t.x||t.x!==i.x)&&(0!==t.y&&49!==t.y||t.y!==i.y)){var a=T(i);if(a!==1/0){var s=E(i);y.isClosed(s)||O(e,i,r+a)}}}}(N=E(e),e,0);m.size()&&s>0;){var S=m.min(),I=m.minPriority();m.pop(),y.close(S);var x=g(S),L=A(x),P=I-Math.floor(L*h);if(0==L){N=S,b=0,w=P;break}if(L<b&&(N=S,b=L,w=P),P+L>a)break;C(S,x,P),--s}for(var M=[],k=N,D=g(k);!D.isEqualTo(e);){M.push(D);var U=g(k=_[k]);if(U.getRangeTo(D)>1){var j=D.getDirectionTo(U);do{D=v(D,j),M.push(D)}while(D.getRangeTo(U)>1)}D=U}return{path:M.reverse(),ops:i-s,cost:w,incomplete:0!==b}}},{\"../game/path-utils\":28,\"@screeps/common/lib/constants\":8,lodash:9}],12:[function(e,t,r){\"use strict\";var n=e(\"q\"),o=e(\"./local-storage\"),i=e(\"./config\");r.create=function(e){return o.put(i.localStorage.PENDING_QUEUE+e,[]),o.put(i.localStorage.PROCESSING_QUEUE+e,[]),\"users\"==e&&(e=\"usersLegacy\"),{fetch:function(){var t=n.defer();return function r(){var n;o.get(i.localStorage.PENDING_QUEUE+e).then(function(a){a&&0!=a.length?(n=a.pop(),o.get(i.localStorage.PROCESSING_QUEUE+e).then(function(t){return t.push(n),o.put(i.localStorage.PROCESSING_QUEUE+e,t)}).then(function(){return o.put(i.localStorage.PENDING_QUEUE+e,a)}).then(function(){return t.resolve(n)})):setTimeout(r,50)}).catch(console.error)}(),t.promise},markDone:function(t){return o.get(i.localStorage.PROCESSING_QUEUE+e).then(function(r){var n=r.indexOf(t);if(-1!=n)return r.splice(n,1),o.put(i.localStorage.PROCESSING_QUEUE+e,r)})},add:function(t){return o.get(i.localStorage.PENDING_QUEUE+e).then(function(r){return r.push(t),o.put(i.localStorage.PENDING_QUEUE+e,r)})},addMulti:function(t){return o.get(i.localStorage.PENDING_QUEUE+e).then(function(r){return r=r.concat(t),o.put(i.localStorage.PENDING_QUEUE+e,r)})},whenAllDone:function(){var t=n.defer();return function r(){n.all([o.get(i.localStorage.PROCESSING_QUEUE+e),o.get(i.localStorage.PENDING_QUEUE+e)]).then(function(e){e[0].length>0||e[1].length>0?setTimeout(r,10):t.resolve()})}(),t.promise},getAffinitySet:function(){return{}},setAffinitySet:function(e){}}}},{\"./config\":3,\"./local-storage\":6,q:10}],13:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o={},i={};r.init=function(e,t){o[e=\"\"+e]?n.extend(o[e],t):o[e]=t||{}},r.get=function(e){return o[e=\"\"+e]},r.checkObsolete=function(e,t){(!i[e]||t>i[e])&&(delete o[e],o[e]=null),i[e]=t}},{lodash:9}],14:[function(e,t,r){\"use strict\";var n=e(\"../game/game\"),o=e(\"../game/console\"),i=e(\"lodash\"),a=(e(\"q\"),e(\"./runtime-user-globals\"));self.onmessage=function(e){var t,r=e.data,s={list:{},set:function(e,t,r){this.list[e]=this.list[e]||{},this.list[e][t]=r},push:function(e,t,r){return this.list[e]=this.list[e]||[],!(this.list[e].length>=r)&&(this.list[e].push(t),!0)},pushByName:function(e,t,r,n){return this.list[e]=this.list[e]||{},this.list[e][t]=this.list[e][t]||[],!(n&&this.list[e][t].length>=n)&&(this.list[e][t].push(r),!0)},remove:function(e,t){return!!this.list[e][t]&&(delete this.list[e][t],!0)}};if(r.user){a.checkObsolete(r.user._id,r.userCodeTimestamp),a.init(r.user._id);var u={get:function(){return r.userMemory},set:function(e){if(!i.isString(e))throw new Error(\"Raw memory value is not a string\");this._parsed&&delete this._parsed,r.userMemory=e},segments:Object.create(null),interShardSegment:{value:\"\",writable:!0},setActiveSegments:function(e){if(!i.isArray(e))throw new Error('\"'+e+'\" is not an array');if(e.length>10)throw new Error(\"Only 10 memory segments can be active at the same time\");for(var t=0;t<e.length;t++){var r=parseInt(e[t]);if(i.isNaN(r)||r>99||r<0)throw new Error('\"'+e[t]+'\" is not a valid segment ID')}},setPublicSegments:function(e){if(!i.isArray(e))throw new Error('\"'+e+'\" is not an array')},setDefaultPublicSegment:function(e){if(null!==e&&(e=parseInt(e),i.isNaN(e)||e>99||e<0))throw new Error('\"'+e+'\" is not a valid segment ID')},setActiveForeignSegment:function(e,t){if(null!==e&&void 0!==t&&(t=parseInt(t),i.isNaN(t)||t>99||t<0))throw new Error('\"'+t+'\" is not a valid segment ID')}};if(r.memorySegments)for(var c in r.memorySegments)u.segments[c]=r.memorySegments[c];try{var l=function(e){return e};n.init(a.get(r.user._id),r.userCode,r,s,u,o.makeConsole(r.user._id,l),r.consoleCommands,1/0,function(){return 0},function(){},void 0,l,void 0).globals.Game.shard=Object.create(null,{name:{value:\"sim\"},type:{value:\"normal\"}}),n.run(r.user._id),t={type:\"done\"}}catch(e){t={type:\"error\",error:i.isObject(e)&&e.stack||e.toString()}}t.intents=s.list,u._parsed&&(r.userMemory=JSON.stringify(u._parsed)),t.memory=r.userMemory,t.console={log:o.getMessages(r.user._id),results:o.getCommandResults(r.user._id)},t.visual=o.getVisual(r.user._id);try{var p=Object.keys(u.segments);if(p.length>0){t.memorySegments={};for(c=0;c<p.length;c++){var f=parseInt(p[c]);if(i.isNaN(f)||f<0||f>99)throw new Error('\"'+p[c]+'\" is not a valid memory segment ID');if(u.segments[p[c]].length>102400)throw new Error('Memory segment \"'+p[c]+'\" has exceeded 100 KB length limit');t.memorySegments[f]=\"\"+u.segments[p[c]]}}}catch(e){t={type:\"error\",error:i.isObject(e)&&e.stack||e.toString()}}self.postMessage(t)}}},{\"../game/console\":16,\"../game/game\":21,\"./runtime-user-globals\":13,lodash:9,q:10}],15:[function(e,t,r){\"use strict\";var n={};r.create=function(e){return self.postMessage({type:\"worker\",workerId:0,startSrc:e}),n[0]={postMessage:function(e){self.postMessage({type:\"worker\",workerId:0,message:e})},terminate:function(){self.postMessage({type:\"worker\",workerId:0,terminate:!0})}}},r.handleMessage=function(e){n[e.workerId]&&n[e.workerId].onmessage({target:n[e.workerId],data:e.message})}},{}],16:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o={},i={},a={};r.makeConsole=function(e,t){return o[e]=[],i[e]=[],a[e]={},Object.create(null,{log:{writable:!0,configurable:!0,value:t(function(){\"undefined\"!=typeof self&&self.navigator.userAgent&&self.console.log.apply(console,arguments),o[e].push(n.map(arguments,function(e){return e&&e.toString?e.toString():void 0===e?\"undefined\":JSON.stringify(e)}).join(\" \"))})},commandResult:{value:t(function(t){\"undefined\"!=typeof self&&self.navigator.userAgent&&self.console.log.call(console,t),i[e].push(String(t))})},addVisual:{value:t(function(t,r){if(t=t||\"\",a[e][t]=a[e][t]||\"\",a[e][t].length>512e3)throw new Error(\"RoomVisual size in room \"+t+\" has exceeded 500 KB limit\");a[e][t]+=JSON.stringify(r)+\"\\n\"})},getVisualSize:{value:t(function(t){return t=t||\"\",a[e][t]?a[e][t].length:0})},clearVisual:{value:t(function(t){t=t||\"\",a[e][t]=\"\"})}})},r.getMessages=function(e){var t=o[e];return o[e]=[],t},r.getCommandResults=function(e){var t=i[e];return i[e]=[],t},r.getVisual=function(e){var t=a[e];return a[e]=[],t}},{lodash:61}],17:[function(e,t,r){\"use strict\";var n,o,i,a,s=e(\"./../utils\"),u=(e(\"./rooms\"),s.getRuntimeDriver().constants),c=e(\"lodash\");r.make=function(e,t,r,l){if(n=e,o=t,i=r,!(a=l).ConstructionSite){var p=function(e){if(!n.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return n.roomObjects[e]},f=i.wrapFn(function(e){var t=p(e);a.RoomObject.call(this,t.x,t.y,t.room,t.effects),this.id=e});f.prototype=Object.create(a.RoomObject.prototype),f.prototype.constructor=f,s.defineGameObjectProperties(f.prototype,p,{progress:function(e){return e.progress},progressTotal:function(e){return e.progressTotal},structureType:function(e){return e.structureType},name:function(e){return e.name},owner:function(e){return new Object({username:n.users[e.user].username})},my:function(e){return c.isUndefined(e.user)?void 0:e.user==n.user._id}}),f.prototype.toString=i.wrapFn(function(){return\"[construction site (\"+p(this.id).structureType+\") #\"+this.id+\"]\"}),f.prototype.remove=i.wrapFn(function(){return this.my||this.room&&this.room.controller&&this.room.controller.my?(o.pushByName(\"room\",\"removeConstructionSite\",{roomName:p(this.id).room,id:this.id}),u.OK):u.ERR_NOT_OWNER}),Object.defineProperty(a,\"ConstructionSite\",{enumerable:!0,value:f})}}},{\"./../utils\":184,\"./rooms\":31,lodash:61}],18:[function(e,t,r){\"use strict\";var n,o,i,a,s,u=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),c=e(\"./../utils\"),l=(e(\"./rooms\"),c.getRuntimeDriver()),p=e(\"lodash\"),f=l.constants;function d(e,t){for(var r=0,n=e.length-1;n>=0&&!(e[n].hits<=0);n--)e[n].type===t&&r++;return r}function h(e,t){if(!e)return!0;for(var r=e.length-1;r>=0&&!(e[r].hits<=0);r--)if(e[r].type===t)return!0;return!1}r.make=function(e,t,r,l){if(n=e,o=t,i=r,s=0,!(a=l).Creep){var m=function(e){if(!e)throw new Error(\"This creep doesn't exist yet\");if(!n.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return n.roomObjects[e]},y=i.wrapFn(function(e){if(e){var t=m(e);a.RoomObject.call(this,t.x,t.y,t.room,t.effects),this.id=e}});y.prototype=Object.create(a.RoomObject.prototype),y.prototype.constructor=y,c.defineGameObjectProperties(y.prototype,m,{name:function(e){return e.name},body:function(e){return e.body},my:function(e){return e.user==n.user._id},owner:function(e){return new Object({username:n.users[e.user].username})},spawning:function(e){return e.spawning},ticksToLive:function(e){return e.ageTime?e.ageTime-n.time:void 0},carryCapacity:function(e){return e.energyCapacity},carry:function(e){var t={energy:0};return f.RESOURCES_ALL.forEach(function(r){e[r]&&(t[r]=e[r])}),t},fatigue:function(e){return e.fatigue},hits:function(e){return e.hits},hitsMax:function(e){return e.hitsMax},saying:function(e){if(e.actionLog&&e.actionLog.say)return e.user==n.user._id?e.actionLog.say.message:e.actionLog.say.isPublic?e.actionLog.say.message:void 0}}),Object.defineProperty(y.prototype,\"memory\",{get:function(){if((!this.id||this.my)&&((p.isUndefined(a.Memory.creeps)||\"undefined\"===a.Memory.creeps)&&(a.Memory.creeps={}),p.isObject(a.Memory.creeps)))return a.Memory.creeps[this.name]=a.Memory.creeps[this.name]||{}},set:function(e){if(this.id&&!this.my)throw new Error(\"Could not set other player's creep memory\");if((p.isUndefined(a.Memory.creeps)||\"undefined\"===a.Memory.creeps)&&(a.Memory.creeps={}),!p.isObject(a.Memory.creeps))throw new Error(\"Could not set creep memory\");a.Memory.creeps[this.name]=e}}),y.prototype.toString=i.wrapFn(function(){return\"[creep \"+this.name+\"]\"}),y.prototype.move=i.wrapFn(function(e){if(!this.my)return f.ERR_NOT_OWNER;if(this.spawning)return f.ERR_BUSY;if(e&&e instanceof a.Creep)return e.pos.isNearTo(this.pos)?(o.set(this.id,\"move\",{id:e.id}),f.OK):f.ERR_NOT_IN_RANGE;if(m(this.id).fatigue>0)return f.ERR_TIRED;if(!h(this.body,f.MOVE))return f.ERR_NO_BODYPART;var t=+e;return!t||t<1||t>8?f.ERR_INVALID_ARGS:(o.set(this.id,\"move\",{direction:t}),f.OK)}),y.prototype.moveTo=i.wrapFn(function(e,t,r){var o=!1;if(!this.my)return f.ERR_NOT_OWNER;if(this.spawning)return f.ERR_BUSY;if(p.isObject(e)&&(r=p.clone(t)),r=r||{},m(this.id).fatigue>0&&(!r||!r.visualizePathStyle))return f.ERR_TIRED;if(!h(this.body,f.MOVE))return f.ERR_NO_BODYPART;var s=c.fetchXYArguments(e,t,a),l=u(s,3),d=l[0],y=l[1],_=l[2];if(_=_||this.pos.roomName,p.isUndefined(d)||p.isUndefined(y))return i.assertTargetObject(e),f.ERR_INVALID_TARGET;var R=new a.RoomPosition(d,y,_);if(p.isUndefined(r.reusePath)&&(r.reusePath=5),p.isUndefined(r.serializeMemory)&&(r.serializeMemory=!0),r.visualizePathStyle&&p.defaults(r.visualizePathStyle,{fill:\"transparent\",stroke:\"#fff\",lineStyle:\"dashed\",strokeWidth:.15,opacity:.1}),d==this.pos.x&&y==this.pos.y&&_==this.pos.roomName)return f.OK;if(r.reusePath&&this.memory&&p.isObject(this.memory)&&this.memory._move){var E=this.memory._move;if(n.time>E.time+parseInt(r.reusePath)||E.room!=this.pos.roomName)delete this.memory._move;else if(E.dest.room==_&&E.dest.x==d&&E.dest.y==y){var g=p.isString(E.path)?c.deserializePath(E.path):E.path,v=p.findIndex(g,{x:this.pos.x,y:this.pos.y});if(-1!=v){p.cloneDeep(E);g.splice(0,v+1);try{E.path=r.serializeMemory?c.serializePath(g):g}catch(e){throw e}}if(0==g.length)return this.pos.isNearTo(R)?f.OK:f.ERR_NO_PATH;if(r.visualizePathStyle&&(this.room.visual.poly(g,r.visualizePathStyle),o=!0),this.moveByPath(g)==f.OK)return f.OK}}if(r.noPathFinding)return f.ERR_NOT_FOUND;g=this.pos.findPathTo(R,r);return r.reusePath&&this.memory&&p.isObject(this.memory)&&(this.memory._move={dest:{x:d,y:y,room:_},time:n.time,path:r.serializeMemory?c.serializePath(g):p.clone(g),room:this.pos.roomName}),0==g.length?f.ERR_NO_PATH:(r.visualizePathStyle&&!o&&this.room.visual.poly(g,r.visualizePathStyle),this.move(g[0].direction))}),y.prototype.moveByPath=i.wrapFn(function(e){var t=this;if(p.isArray(e)&&e.length>0&&e[0]instanceof a.RoomPosition){var r=p.findIndex(e,function(e){return e.isEqualTo(t.pos)});return-1!==r||e[0].isNearTo(this.pos)?++r>=e.length?f.ERR_NOT_FOUND:this.move(this.pos.getDirectionTo(e[r])):f.ERR_NOT_FOUND}if(p.isString(e)&&(e=c.deserializePath(e)),!p.isArray(e))return f.ERR_INVALID_ARGS;var n=p.find(e,function(e){return e.x-e.dx==t.pos.x&&e.y-e.dy==t.pos.y});return n?this.move(n.direction):f.ERR_NOT_FOUND}),y.prototype.harvest=i.wrapFn(function(e){if(!this.my)return f.ERR_NOT_OWNER;if(this.spawning)return f.ERR_BUSY;if(!h(this.body,f.WORK))return f.ERR_NO_BODYPART;if(!e||!e.id)return f.ERR_INVALID_TARGET;if(i.sources[e.id]&&e instanceof a.Source){if(!e.energy)return f.ERR_NOT_ENOUGH_RESOURCES;if(!e.pos.isNearTo(this.pos))return f.ERR_NOT_IN_RANGE;if(this.room.controller&&(this.room.controller.owner&&this.room.controller.owner.username!=n.user.username||this.room.controller.reservation&&this.room.controller.reservation.username!=n.user.username))return f.ERR_NOT_OWNER}else{if(!(i.minerals[e.id]&&e instanceof a.Mineral))return i.assertTargetObject(e),f.ERR_INVALID_TARGET;if(!e.mineralAmount)return f.ERR_NOT_ENOUGH_RESOURCES;if(!e.pos.isNearTo(this.pos))return f.ERR_NOT_IN_RANGE;var t=p.find(e.pos.lookFor(\"structure\"),{structureType:f.STRUCTURE_EXTRACTOR});if(!t)return f.ERR_NOT_FOUND;if(t.owner&&!t.my)return f.ERR_NOT_OWNER;if(!t.isActive())return f.ERR_RCL_NOT_ENOUGH;if(t.cooldown)return f.ERR_TIRED}return o.set(this.id,\"harvest\",{id:e.id}),f.OK}),y.prototype.drop=i.wrapFn(function(e,t){return this.my?this.spawning?f.ERR_BUSY:p.contains(f.RESOURCES_ALL,e)?m(this.id)[e]?(t||(t=m(this.id)[e]),m(this.id)[e]<t?f.ERR_NOT_ENOUGH_RESOURCES:(o.set(this.id,\"drop\",{amount:t,resourceType:e}),f.OK)):f.ERR_NOT_ENOUGH_RESOURCES:f.ERR_INVALID_ARGS:f.ERR_NOT_OWNER}),y.prototype.transfer=i.wrapFn(function(e,t,r){if(!this.my)return f.ERR_NOT_OWNER;if(this.spawning)return f.ERR_BUSY;if(r<0)return f.ERR_INVALID_ARGS;if(!p.contains(f.RESOURCES_ALL,t))return f.ERR_INVALID_ARGS;if(!(e&&e.id&&(i.spawns[e.id]||i.powerCreeps[e.id]||i.creeps[e.id]||i.structures[e.id])&&(e instanceof a.StructureSpawn||e instanceof a.Structure||e instanceof a.Creep||e instanceof a.PowerCreep||e.spawning)))return i.assertTargetObject(e),f.ERR_INVALID_TARGET;if(t==f.RESOURCE_ENERGY){if(i.structures[e.id]&&\"controller\"==i.structures[e.id].structureType)return this.upgradeController(e);if(i.structures[e.id]&&\"extension\"!=i.structures[e.id].structureType&&\"spawn\"!=i.structures[e.id].structureType&&\"link\"!=i.structures[e.id].structureType&&\"storage\"!=i.structures[e.id].structureType&&\"tower\"!=i.structures[e.id].structureType&&\"powerSpawn\"!=i.structures[e.id].structureType&&\"terminal\"!=i.structures[e.id].structureType&&\"container\"!=i.structures[e.id].structureType&&\"lab\"!=i.structures[e.id].structureType&&\"nuker\"!=i.structures[e.id].structureType)return f.ERR_INVALID_TARGET}else if(t==f.RESOURCE_POWER){if(i.structures[e.id]&&\"storage\"!=i.structures[e.id].structureType&&\"terminal\"!=i.structures[e.id].structureType&&\"container\"!=i.structures[e.id].structureType&&\"powerSpawn\"!=i.structures[e.id].structureType)return f.ERR_INVALID_TARGET}else if(i.structures[e.id]&&\"storage\"!=i.structures[e.id].structureType&&\"terminal\"!=i.structures[e.id].structureType&&\"container\"!=i.structures[e.id].structureType&&\"lab\"!=i.structures[e.id].structureType&&\"nuker\"!=i.structures[e.id].structureType)return f.ERR_INVALID_TARGET;if(!e.pos.isNearTo(this.pos))return f.ERR_NOT_IN_RANGE;if(!m(this.id)[t])return f.ERR_NOT_ENOUGH_RESOURCES;if(\"powerSpawn\"==e.structureType){if(m(e.id)[t]>=m(e.id)[t+\"Capacity\"])return f.ERR_FULL;if(r||(r=Math.min(m(this.id)[t],m(e.id)[t+\"Capacity\"]-m(e.id)[t])),m(this.id)[t]<r)return f.ERR_NOT_ENOUGH_RESOURCES;if(!r||m(e.id)[t]+r>m(e.id)[t+\"Capacity\"])return f.ERR_FULL}else if(\"lab\"==e.structureType){if(t!=f.RESOURCE_ENERGY&&m(e.id).mineralType&&m(e.id).mineralType!=t)return f.ERR_FULL;var n=t==f.RESOURCE_ENERGY?m(e.id).energyCapacity:m(e.id).mineralCapacity,s=t==f.RESOURCE_ENERGY?m(e.id).energy:m(e.id).mineralAmount;if(s>n)return f.ERR_FULL;if(r||(r=Math.min(m(this.id)[t],n-s)),m(this.id)[t]<r)return f.ERR_NOT_ENOUGH_RESOURCES;if(!r||s+r>n)return f.ERR_FULL}else if(\"nuker\"==e.structureType){if(t!=f.RESOURCE_ENERGY&&t!=f.RESOURCE_GHODIUM)return f.ERR_FULL;if(m(e.id)[t]>=m(e.id)[t+\"Capacity\"])return f.ERR_FULL;if(r||(r=Math.min(m(this.id)[t],m(e.id)[t+\"Capacity\"]-m(e.id)[t])),m(this.id)[t]<r)return f.ERR_NOT_ENOUGH_RESOURCES;if(!r||m(e.id)[t]+r>m(e.id)[t+\"Capacity\"])return f.ERR_FULL}else{if(!p.isUndefined(m(e.id).energyCapacity)&&c.calcResources(m(e.id))>m(e.id).energyCapacity)return f.ERR_FULL;if(r||(r=p.isUndefined(m(e.id).energyCapacity)?m(this.id)[t]:Math.min(m(this.id)[t],m(e.id).energyCapacity-c.calcResources(m(e.id)))),m(this.id)[t]<r)return f.ERR_NOT_ENOUGH_RESOURCES;if(!p.isUndefined(m(e.id).energyCapacity)&&(!r||c.calcResources(m(e.id))+r>m(e.id).energyCapacity))return f.ERR_FULL}return o.set(this.id,\"transfer\",{id:e.id,amount:r,resourceType:t}),f.OK}),y.prototype.withdraw=i.wrapFn(function(e,t,r){if(!this.my)return f.ERR_NOT_OWNER;if(this.spawning)return f.ERR_BUSY;if(r<0)return f.ERR_INVALID_ARGS;if(!p.contains(f.RESOURCES_ALL,t))return f.ERR_INVALID_ARGS;if(!(e&&e.id&&(i.structures[e.id]&&e instanceof a.Structure||e instanceof a.Tombstone)))return i.assertTargetObject(e),f.ERR_INVALID_TARGET;if(!1===e.my&&p.any(e.pos.lookFor(\"structure\"),function(e){return e.structureType==f.STRUCTURE_RAMPART&&!e.my&&!e.isPublic}))return f.ERR_NOT_OWNER;if(this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode)return f.ERR_NOT_OWNER;if(t==f.RESOURCE_ENERGY){if(i.structures[e.id]&&\"extension\"!=i.structures[e.id].structureType&&\"spawn\"!=i.structures[e.id].structureType&&\"link\"!=i.structures[e.id].structureType&&\"storage\"!=i.structures[e.id].structureType&&\"tower\"!=i.structures[e.id].structureType&&\"powerSpawn\"!=i.structures[e.id].structureType&&\"terminal\"!=i.structures[e.id].structureType&&\"container\"!=i.structures[e.id].structureType&&\"lab\"!=i.structures[e.id].structureType)return f.ERR_INVALID_TARGET}else if(t==f.RESOURCE_POWER){if(i.structures[e.id]&&\"storage\"!=i.structures[e.id].structureType&&\"terminal\"!=i.structures[e.id].structureType&&\"container\"!=i.structures[e.id].structureType&&\"powerSpawn\"!=i.structures[e.id].structureType)return f.ERR_INVALID_TARGET}else if(i.structures[e.id]&&\"storage\"!=i.structures[e.id].structureType&&\"terminal\"!=i.structures[e.id].structureType&&\"container\"!=i.structures[e.id].structureType&&\"lab\"!=i.structures[e.id].structureType)return f.ERR_INVALID_TARGET;if(!e.pos.isNearTo(this.pos))return f.ERR_NOT_IN_RANGE;var n=c.calcResources(m(this.id)),s=m(this.id).energyCapacity-n;if(s<=0)return f.ERR_FULL;if(\"powerSpawn\"==e.structureType){if(r||(r=Math.min(m(e.id)[t],s)),!m(e.id)[t]||m(e.id)[t]<r)return f.ERR_NOT_ENOUGH_RESOURCES;if(r>s)return f.ERR_FULL}else if(\"lab\"==e.structureType){if(t!=f.RESOURCE_ENERGY&&m(e.id).mineralType&&m(e.id).mineralType!=t)return f.ERR_INVALID_ARGS;t==f.RESOURCE_ENERGY?m(e.id).energyCapacity:m(e.id).mineralCapacity;var u=t==f.RESOURCE_ENERGY?m(e.id).energy:m(e.id).mineralAmount;if(r||(r=Math.min(u,s)),!u||u<r)return f.ERR_NOT_ENOUGH_RESOURCES;if(r>s)return f.ERR_FULL}else{if(r||(r=Math.min(m(e.id)[t],s)),!m(e.id)[t]||m(e.id)[t]<r)return f.ERR_NOT_ENOUGH_RESOURCES;if(r>s)return f.ERR_FULL}return o.set(this.id,\"withdraw\",{id:e.id,amount:r,resourceType:t}),f.OK}),y.prototype.pickup=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:e&&e.id&&i.energy[e.id]&&e instanceof a.Energy?c.calcResources(this.carry)>=this.carryCapacity?f.ERR_FULL:e.pos.isNearTo(this.pos)?(o.set(this.id,\"pickup\",{id:e.id}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NOT_OWNER}),y.prototype.getActiveBodyparts=i.wrapFn(function(e){return d(this.body,e)}),y.prototype.attack=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:h(this.body,f.ATTACK)?this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?f.ERR_NO_BODYPART:e&&e.id&&(i.creeps[e.id]||i.powerCreeps[e.id]||i.structures[e.id])&&(e instanceof a.Creep||e instanceof a.PowerCreep||e instanceof a.StructureSpawn||e instanceof a.Structure)?e.pos.isNearTo(this.pos)?(o.set(this.id,\"attack\",{id:e.id,x:e.pos.x,y:e.pos.y}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NO_BODYPART:f.ERR_NOT_OWNER}),y.prototype.rangedAttack=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:h(this.body,f.RANGED_ATTACK)?this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?f.ERR_NO_BODYPART:e&&e.id&&(i.creeps[e.id]||i.powerCreeps[e.id]||i.structures[e.id])&&(e instanceof a.Creep||e instanceof a.PowerCreep||e instanceof a.StructureSpawn||e instanceof a.Structure)?this.pos.inRangeTo(e,3)?(o.set(this.id,\"rangedAttack\",{id:e.id}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NO_BODYPART:f.ERR_NOT_OWNER}),y.prototype.rangedMassAttack=i.wrapFn(function(){return this.my?this.spawning?f.ERR_BUSY:h(this.body,f.RANGED_ATTACK)?this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?f.ERR_NO_BODYPART:(o.set(this.id,\"rangedMassAttack\",{}),f.OK):f.ERR_NO_BODYPART:f.ERR_NOT_OWNER}),y.prototype.heal=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:h(this.body,f.HEAL)?e&&e.id&&(i.creeps[e.id]||i.powerCreeps[e.id])&&(e instanceof a.Creep||e instanceof a.PowerCreep)?e.pos.isNearTo(this.pos)?this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?f.ERR_NO_BODYPART:(o.set(this.id,\"heal\",{id:e.id,x:e.pos.x,y:e.pos.y}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NO_BODYPART:f.ERR_NOT_OWNER}),y.prototype.rangedHeal=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:h(this.body,f.HEAL)?e&&e.id&&(i.creeps[e.id]||i.powerCreeps[e.id])&&(e instanceof a.Creep||e instanceof a.PowerCreep)?this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?f.ERR_NO_BODYPART:this.pos.inRangeTo(e,3)?(o.set(this.id,\"rangedHeal\",{id:e.id}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NO_BODYPART:f.ERR_NOT_OWNER}),y.prototype.repair=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:h(this.body,f.WORK)?this.carry.energy?e&&e.id&&i.structures[e.id]&&(e instanceof a.Structure||e instanceof a.StructureSpawn)?this.pos.inRangeTo(e,3)?(o.set(this.id,\"repair\",{id:e.id,x:e.pos.x,y:e.pos.y}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NOT_ENOUGH_RESOURCES:f.ERR_NO_BODYPART:f.ERR_NOT_OWNER}),y.prototype.build=i.wrapFn(function(e){if(!this.my)return f.ERR_NOT_OWNER;if(this.spawning)return f.ERR_BUSY;if(!h(this.body,f.WORK))return f.ERR_NO_BODYPART;if(!this.carry.energy)return f.ERR_NOT_ENOUGH_RESOURCES;if(!(e&&e.id&&i.constructionSites[e.id]&&e instanceof a.ConstructionSite))return i.assertTargetObject(e),f.ERR_INVALID_TARGET;if(!this.pos.inRangeTo(e,3))return f.ERR_NOT_IN_RANGE;var t=i.objectsByRoom[m(this.id).room],r=[],n=[],s=[],u=m(this.id).user;if(p.forEach(t,function(t){t.x==e.pos.x&&t.y==e.pos.y&&p.contains(f.OBSTACLE_OBJECT_TYPES,t.type)&&(\"creep\"==t.type?(n.push(t),t.user==u&&s.push(t)):r.push(t))}),p.contains(f.OBSTACLE_OBJECT_TYPES,e.structureType)){if(p.any(r))return f.ERR_INVALID_TARGET;var c=this.room.controller&&this.room.controller.my&&this.room.controller.safeMode?s:n;if(p.any(c))return f.ERR_INVALID_TARGET}return o.set(this.id,\"build\",{id:e.id,x:e.pos.x,y:e.pos.y}),f.OK}),y.prototype.suicide=i.wrapFn(function(){return this.my?this.spawning?f.ERR_BUSY:(o.set(this.id,\"suicide\",{}),f.OK):f.ERR_NOT_OWNER}),y.prototype.say=i.wrapFn(function(e,t){return this.my?this.spawning?f.ERR_BUSY:(o.set(this.id,\"say\",{message:\"\"+e,isPublic:t}),f.OK):f.ERR_NOT_OWNER}),y.prototype.claimController=i.wrapFn(function(e){if(!this.my)return f.ERR_NOT_OWNER;if(this.spawning)return f.ERR_BUSY;var t=n.user.rooms.length+s;return t&&(!n.user.gcl||n.user.gcl<c.calcNeededGcl(t+1))?f.ERR_GCL_NOT_ENOUGH:t>=f.GCL_NOVICE&&n.rooms[this.room.name].novice>Date.now()?f.ERR_FULL:e&&e.id&&i.structures[e.id]&&e instanceof a.Structure?h(this.body,f.CLAIM)?e.pos.isNearTo(this.pos)?\"controller\"!=e.structureType?f.ERR_INVALID_TARGET:e.level>0?f.ERR_INVALID_TARGET:e.reservation&&e.reservation.username!=n.user.username?f.ERR_INVALID_TARGET:this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?f.ERR_NO_BODYPART:(s++,o.set(this.id,\"claimController\",{id:e.id}),f.OK):f.ERR_NOT_IN_RANGE:f.ERR_NO_BODYPART:(i.assertTargetObject(e),f.ERR_INVALID_TARGET)}),y.prototype.attackController=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:e&&e.id&&i.structures[e.id]&&e instanceof a.StructureController?d(this.body,f.CLAIM)?e.pos.isNearTo(this.pos)?e.owner||e.reservation?m(e.id).upgradeBlocked>n.time?f.ERR_TIRED:this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?f.ERR_NO_BODYPART:(o.set(this.id,\"attackController\",{id:e.id}),f.OK):f.ERR_INVALID_TARGET:f.ERR_NOT_IN_RANGE:f.ERR_NO_BODYPART:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NOT_OWNER}),y.prototype.upgradeController=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:h(this.body,f.WORK)?this.carry.energy?e&&e.id&&i.structures[e.id]&&e instanceof a.StructureController?e.upgradeBlocked&&e.upgradeBlocked>0?f.ERR_INVALID_TARGET:e.pos.inRangeTo(this.pos,3)?e.my?e.level&&e.owner?(o.set(this.id,\"upgradeController\",{id:e.id}),f.OK):f.ERR_INVALID_TARGET:f.ERR_NOT_OWNER:f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NOT_ENOUGH_RESOURCES:f.ERR_NO_BODYPART:f.ERR_NOT_OWNER}),y.prototype.reserveController=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:e&&e.id&&i.structures[e.id]&&e instanceof a.Structure?e.pos.isNearTo(this.pos)?\"controller\"!=e.structureType?f.ERR_INVALID_TARGET:e.owner?f.ERR_INVALID_TARGET:e.reservation&&e.reservation.username!=n.user.username?f.ERR_INVALID_TARGET:h(this.body,f.CLAIM)?(o.set(this.id,\"reserveController\",{id:e.id}),f.OK):f.ERR_NO_BODYPART:f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NOT_OWNER}),y.prototype.notifyWhenAttacked=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:p.isBoolean(e)?(e!=m(this.id).notifyWhenAttacked&&o.set(this.id,\"notifyWhenAttacked\",{enabled:e}),f.OK):f.ERR_INVALID_ARGS:f.ERR_NOT_OWNER}),y.prototype.cancelOrder=i.wrapFn(function(e){return o.remove(this.id,e)?f.OK:f.ERR_NOT_FOUND}),y.prototype.dismantle=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:h(this.body,f.WORK)?e&&e.id&&i.structures[e.id]&&(e instanceof a.Structure||e instanceof a.StructureSpawn)&&!(e instanceof a.StructurePowerBank)?e.pos.isNearTo(this.pos)?this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?f.ERR_NO_BODYPART:(o.set(this.id,\"dismantle\",{id:e.id}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NO_BODYPART:f.ERR_NOT_OWNER}),y.prototype.generateSafeMode=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:m(this.id)[f.RESOURCE_GHODIUM]>=f.SAFE_MODE_COST?e&&e.id&&i.structures[e.id]&&e instanceof a.StructureController?e.pos.isNearTo(this.pos)?(o.set(this.id,\"generateSafeMode\",{id:e.id}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NOT_ENOUGH_RESOURCES:f.ERR_NOT_OWNER}),y.prototype.signController=i.wrapFn(function(e,t){return this.spawning?f.ERR_BUSY:e&&e.id&&i.structures[e.id]&&e instanceof a.Structure?e.pos.isNearTo(this.pos)?\"controller\"!=e.structureType?f.ERR_INVALID_TARGET:(o.set(this.id,\"signController\",{id:e.id,sign:\"\"+t}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET)}),y.prototype.pull=i.wrapFn(function(e){return this.my?this.spawning?f.ERR_BUSY:e&&e.id&&i.creeps[e.id]&&e instanceof a.Creep&&!e.spawning&&e.id!=this.id?e.pos.isNearTo(this.pos)?(o.set(this.id,\"pull\",{id:e.id}),f.OK):f.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),f.ERR_INVALID_TARGET):f.ERR_NOT_OWNER}),Object.defineProperty(a,\"Creep\",{enumerable:!0,value:y})}}},{\"./../utils\":184,\"./rooms\":31,lodash:61}],19:[function(e,t,r){\"use strict\";var n=e(\"./../utils\"),o=(e(\"./rooms\"),n.getRuntimeDriver().constants,{});t.exports=function(e,t,r,i,a){return function(s,u,c,l){if(o.runtimeData=s,o.intents=u,o.register=c,o.globals=l,!o.globals[e]){var p=function(e){if(!o.runtimeData.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return o.runtimeData.roomObjects[e]},f=o.register.wrapFn(function(e){var r=p(e);t?o.globals[t].call(this,e):o.globals.RoomObject.call(this,r.x,r.y,r.room),this.id=e});f.prototype=Object.create(t?o.globals[t].prototype:o.globals.RoomObject.prototype),f.prototype.constructor=f,r&&n.defineGameObjectProperties(f.prototype,p,r),a&&n.defineGameObjectProperties(f.prototype,p,{my:function(e){return e.user==o.runtimeData.user._id},owner:function(e){return new Object({username:o.runtimeData.users[e.user].username})}}),i&&i(f.prototype,o),o.globals[e]=f}}}},{\"./../utils\":184,\"./rooms\":31}],20:[function(e,t,r){\"use strict\";var n,o,i,a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),s=e(\"./../utils\"),u=(e(\"./rooms\"),s.getRuntimeDriver().constants),c=e(\"lodash\");r.make=function(e,t,r,l){if(e,n=t,o=r,!(i=l).Flag){var p=o.wrapFn(function(e,t,r,n,o,a){i.RoomObject.call(this,Number(o),Number(a),n),this.name=e,this.color=Number(t),this.secondaryColor=Number(r||t)});p.prototype=Object.create(i.RoomObject.prototype),p.prototype.constructor=p,Object.defineProperty(p.prototype,\"memory\",{get:function(){if((c.isUndefined(i.Memory.flags)||\"undefined\"===i.Memory.flags)&&(i.Memory.flags={}),c.isObject(i.Memory.flags))return i.Memory.flags[this.name]=i.Memory.flags[this.name]||{}},set:function(e){if((c.isUndefined(i.Memory.flags)||\"undefined\"===i.Memory.flags)&&(i.Memory.flags={}),!c.isObject(i.Memory.flags))throw new Error(\"Could not set flag memory\");i.Memory.flags[this.name]=e}}),p.prototype.toString=o.wrapFn(function(){return\"[flag \"+this.name+\"]\"}),p.prototype.remove=o.wrapFn(function(){return n.pushByName(\"room\",\"removeFlag\",{roomName:this.pos.roomName,name:this.name}),u.OK}),p.prototype.setPosition=o.wrapFn(function(e,t){var r=s.fetchXYArguments(e,t,i),o=a(r,3),l=o[0],p=o[1],f=o[2];return f=f||this.pos.roomName,c.isUndefined(l)||c.isUndefined(p)?u.ERR_INVALID_TARGET:(n.pushByName(\"room\",\"removeFlag\",{roomName:this.pos.roomName,name:this.name}),n.pushByName(\"room\",\"createFlag\",{roomName:f,x:l,y:p,name:this.name,color:this.color,secondaryColor:this.secondaryColor}),u.OK)}),p.prototype.setColor=o.wrapFn(function(e,t){return c.contains(u.COLORS_ALL,e)?(t=t||e,c.contains(u.COLORS_ALL,t)?(n.pushByName(\"room\",\"removeFlag\",{roomName:this.pos.roomName,name:this.name}),n.pushByName(\"room\",\"createFlag\",{roomName:this.pos.roomName,x:this.pos.x,y:this.pos.y,name:this.name,color:e,secondaryColor:t}),u.OK):u.ERR_INVALID_ARGS):u.ERR_INVALID_ARGS}),Object.defineProperty(i,\"Flag\",{enumerable:!0,value:p})}}},{\"./../utils\":184,\"./rooms\":31,lodash:61}],21:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(){var t,o=e(\"lodash\"),i=e(\"../utils\").getRuntimeDriver(),a=i.constants,s=e(\"./map\"),u=e(\"./market\");e(\"./custom-prototypes\");function c(e,t){if(o.extend(e,{creeps:{},structures:{},ownedStructures:{},spawns:{},sources:{},energy:{},flags:{},constructionSites:{},minerals:{},tombstones:{},nukes:{},powerCreeps:{}}),t){var r=Object.keys(e);e.spatial={},r.forEach(function(t){e.spatial[t]=new Array(2500)})}}var l=(n(t={},a.FIND_CREEPS,function(e){return!e.spawning}),n(t,a.FIND_MY_CREEPS,function(e){return!e.spawning&&e.my}),n(t,a.FIND_HOSTILE_CREEPS,function(e){return!e.spawning&&!e.my}),n(t,a.FIND_MY_POWER_CREEPS,function(e){return e.my}),n(t,a.FIND_HOSTILE_POWER_CREEPS,function(e){return!e.my}),n(t,a.FIND_MY_SPAWNS,function(e){return!0===e.my}),n(t,a.FIND_HOSTILE_SPAWNS,function(e){return!1===e.my}),n(t,a.FIND_SOURCES_ACTIVE,function(e){return e.energy>0}),n(t,a.FIND_MY_STRUCTURES,function(e){return!0===e.my}),n(t,a.FIND_HOSTILE_STRUCTURES,function(e){return!1===e.my&&e.owner}),n(t,a.FIND_MY_CONSTRUCTION_SITES,function(e){return e.my}),n(t,a.FIND_HOSTILE_CONSTRUCTION_SITES,function(e){return!1===e.my}),t);function p(e,t,r,n){l[t]&&!l[t](r)||(e.findCache[t]=e.findCache[t]||{},e.findCache[t][n.room]=e.findCache[t][n.room]||[],e.findCache[t][n.room].push(r))}function f(e,t,r,n){e[t][r.id]=r,e.byRoom[n.room][t][r.id]=r;var o=50*n.x+n.y,i=e.byRoom[n.room].spatial[t];void 0===i[o]?i[o]=[r]:i[o].push(r)}!function(){var t={};r.init=function(r,d,h,m,y,_,R,E,g,v,O,T,A){var b=h.user._id;return t[b]=t[b]||{},t[b].globals=r,t[b].codeModules=d,t[b].runtimeData=h,t[b].intents=m,t[b].memory=y,t[b].fakeConsole=_,t[b].consoleCommands=R,t[b].timeout=E,t[b].getUsedCpu=g,t[b].scriptCachedData=v,t[b].getHeapStatistics=T,t[b].cpuHalt=A,t[b].sandboxedFunctionWrapper=O,o.extend(t[b].globals,{RawMemory:t[b].memory,console:t[b].fakeConsole}),t[b].globals._||(t[b].globals._=o.runInContext()),Object.defineProperty(t[b].globals,\"Memory\",{configurable:!0,enumerable:!0,get:function(){try{t[b].memory._parsed=JSON.parse(t[b].memory.get()||\"{}\"),t[b].memory._parsed.__proto__=null}catch(e){t[b].memory._parsed=null}return Object.defineProperty(t[b].globals,\"Memory\",{configurable:!0,enumerable:!0,value:t[b].memory._parsed}),t[b].memory._parsed}}),t[b].globals.Game=function(t){var r=t.runtimeData,i=t.intents,d=(t.memory,t.getUsedCpu),h=t.globals,m=t.sandboxedFunctionWrapper,y=t.getHeapStatistics,_=t.cpuHalt,R={},E={_useNewPathFinder:!0,_objects:{},byRoom:{},findCache:{},rooms:{},roomEventLogCache:{},wrapFn:m||function(e){return e}},g=[];E.deprecated=function(e){o.contains(g,e)||(g.push(e),h.console.log(e))},E.assertTargetObject=function(e){if(e&&o.isPlainObject(e)&&o.isString(e.id)&&24==e.id.length)throw new Error(\"It seems you're trying to use a serialized game object stored in Memory which is not allowed. Please use `Game.getObjectById` to retrieve a live object reference instead.\")},c(E);var v=Math.floor(Math.pow((r.user.gcl||0)/a.GCL_MULTIPLY,1/a.GCL_POW))+1,O=Math.pow(v-1,a.GCL_POW)*a.GCL_MULTIPLY,T=Math.floor(Math.pow((r.user.power||0)/a.POWER_LEVEL_MULTIPLY,1/a.POWER_LEVEL_POW)),A=Math.pow(T,a.POWER_LEVEL_POW)*a.POWER_LEVEL_MULTIPLY,b={creeps:{},powerCreeps:{},spawns:{},structures:{},flags:{},constructionSites:{},rooms:{},time:r.time,cpuLimit:r.cpu,cpu:{getUsed:function(){return d()},tickLimit:r.cpu,limit:r.user.cpu,bucket:r.cpuBucket,getHeapStatistics:y?function(){return y()}:void 0,halt:_?function(){throw _.applySync(),new Error(\"No one should ever see this message.\")}:void 0},map:{},gcl:{level:v,progress:(r.user.gcl||0)-O,progressTotal:Math.pow(v,a.GCL_POW)*a.GCL_MULTIPLY-O},gpl:{level:T,progress:(r.user.power||0)-A,progressTotal:1e3*Math.pow(T+1,2)-A},market:{},resources:n({},a.SUBSCRIPTION_TOKEN,r.user.subscriptionTokens||0),getObjectById:function(e){return E._objects[e]||null},notify:function(e,t){return i.push(\"notify\",{message:e,groupInterval:t},20)?a.OK:a.ERR_FULL}};for(var w in E.objectsByRoom={},E.objectsByRoomKeys={},o.forEach(r.roomObjects,function(e,t){e.temp||(E.objectsByRoom[e.room]=E.objectsByRoom[e.room]||{},E.objectsByRoom[e.room][t]=e,E.objectsByRoomKeys[e.room]=E.objectsByRoomKeys[e.room]||[],E.objectsByRoomKeys[e.room].push(t))}),r.rooms)E.byRoom[w]={},c(E.byRoom[w],!0);for(var w in e(\"./rooms\").make(r,i,E,h),e(\"./rooms\").makePos(E,h),e(\"./creeps\").make(r,i,E,h),e(\"./structures\").make(r,i,E,h),e(\"./sources\").make(r,i,E,h),e(\"./minerals\").make(r,i,E,h),e(\"./nukes\").make(r,i,E,h),e(\"./resources\").make(r,i,E,h),e(\"./flags\").make(r,i,E,h),e(\"./tombstones\").make(r,i,E,h),e(\"./construction-sites\").make(r,i,E,h),e(\"./path-finder\").make(r,i,E,h),e(\"./power-creeps\").make(r,i,E,h),r.rooms)E.rooms[w]=new h.Room(w);for(var w in R)R[w].make(r,i,E,h);b.rooms=o.clone(E.rooms);var N={rampart:h.StructureRampart,road:h.StructureRoad,extension:h.StructureExtension,constructedWall:h.StructureWall,keeperLair:h.StructureKeeperLair,controller:h.StructureController,link:h.StructureLink,storage:h.StructureStorage,tower:h.StructureTower,observer:h.StructureObserver,powerBank:h.StructurePowerBank,powerSpawn:h.StructurePowerSpawn,lab:h.StructureLab,extractor:h.StructureExtractor,terminal:h.StructureTerminal,container:h.StructureContainer,spawn:h.StructureSpawn,nuker:h.StructureNuker,portal:h.StructurePortal},C={};for(var w in r.userPowerCreeps)E.powerCreeps[w]=new h.PowerCreep(w),b.powerCreeps[E.powerCreeps[w].name]=E.powerCreeps[w];for(var w in r.roomObjects){var S=r.roomObjects[w];S.temp||(C[S.type]=C[S.type]||0,C[S.type]++,\"creep\"==S.type&&(E._objects[w]=new h.Creep(w),f(E,\"creeps\",E._objects[w],S),r.userObjects[w]&&(b.creeps[E.creeps[w].name]?E.creeps[w].suicide():b.creeps[E.creeps[w].name]=E.creeps[w]),p(E,a.FIND_CREEPS,E.creeps[w],S),p(E,a.FIND_MY_CREEPS,E.creeps[w],S),p(E,a.FIND_HOSTILE_CREEPS,E.creeps[w],S)),\"powerCreep\"==S.type&&(E.powerCreeps[w]?E._objects[w]=E.powerCreeps[w]:E._objects[w]=new h.PowerCreep(w),f(E,\"powerCreeps\",E._objects[w],S),p(E,a.FIND_POWER_CREEPS,E.powerCreeps[w],S),p(E,a.FIND_MY_POWER_CREEPS,E.powerCreeps[w],S),p(E,a.FIND_HOSTILE_POWER_CREEPS,E.powerCreeps[w],S)),N[S.type]&&(E._objects[w]=new N[S.type](w),f(E,\"structures\",E._objects[w],S),E._objects[w]instanceof h.OwnedStructure&&(r.userObjects[w]&&(b.structures[E.structures[w].id]=E.structures[w]),f(E,\"ownedStructures\",E._objects[w],S)),p(E,a.FIND_STRUCTURES,E.structures[w],S),p(E,a.FIND_MY_STRUCTURES,E.structures[w],S),p(E,a.FIND_HOSTILE_STRUCTURES,E.structures[w],S),\"spawn\"==S.type&&(f(E,\"spawns\",E._objects[w],S),r.userObjects[w]&&(b.spawns[E.spawns[w].name]=E.spawns[w]),p(E,a.FIND_MY_SPAWNS,E.spawns[w],S),p(E,a.FIND_HOSTILE_SPAWNS,E.spawns[w],S))),S.off||\"extension\"!=S.type&&\"spawn\"!=S.type||S.user!=r.user._id||(E.rooms[S.room].energyAvailable+=S.energy,E.rooms[S.room].energyCapacityAvailable+=S.energyCapacity),\"source\"==S.type&&(E._objects[w]=new h.Source(w),f(E,\"sources\",E._objects[w],S),p(E,a.FIND_SOURCES,E.sources[w],S),p(E,a.FIND_SOURCES_ACTIVE,E.sources[w],S)),\"mineral\"==S.type&&(E._objects[w]=new h.Mineral(w),f(E,\"minerals\",E._objects[w],S),p(E,a.FIND_MINERALS,E.minerals[w],S)),\"energy\"==S.type&&(E._objects[w]=new h.Energy(w),f(E,\"energy\",E._objects[w],S),p(E,a.FIND_DROPPED_RESOURCES,E.energy[w],S)),\"nuke\"==S.type&&(E._objects[w]=new h.Nuke(w),f(E,\"nukes\",E._objects[w],S),p(E,a.FIND_NUKES,E._objects[w],S)),\"tombstone\"==S.type&&(E._objects[w]=new h.Tombstone(w),f(E,\"tombstones\",E._objects[w],S),p(E,a.FIND_TOMBSTONES,E._objects[w],S)),\"constructionSite\"==S.type&&(E._objects[w]=new h.ConstructionSite(w),r.userObjects[w]&&(b.constructionSites[E._objects[w].id]=E._objects[w],E.byRoom[r.userObjects[w].room]||(E.byRoom[r.userObjects[w].room]={},c(E.byRoom[r.userObjects[w].room],!0))),f(E,\"constructionSites\",E._objects[w],S),r.rooms[S.room]&&(p(E,a.FIND_CONSTRUCTION_SITES,E.constructionSites[w],S),p(E,a.FIND_MY_CONSTRUCTION_SITES,E.constructionSites[w],S),p(E,a.FIND_HOSTILE_CONSTRUCTION_SITES,E.constructionSites[w],S))),R[S.type]&&(E._objects[w]=new h[R[S.type].name](w),R[S.type].findConstant&&p(E,R[S.type].findConstant,E._objects[w],S)))}return r.flags.forEach(function(e){e.data.split(\"|\").forEach(function(t){if(t){var r=t.split(\"~\");r[0]=r[0].replace(/\\$VLINE\\$/g,\"|\").replace(/\\$TILDE\\$/g,\"~\");var n=\"flag_\"+r[0],o=E._objects[n]=new h.Flag(r[0],r[1],r[2],e.room,r[3],r[4]);if(E.flags[n]=o,E.byRoom[e.room]){E.byRoom[e.room].flags[n]=o;var i=50*+r[3]+ +r[4],s=E.byRoom[e.room].spatial.flags;void 0===s[i]?s[i]=[o]:s[i].push(o)}b.flags[r[0]]=o,l[a.FIND_FLAGS]&&!l[a.FIND_FLAGS](o)||(E.findCache[a.FIND_FLAGS]=E.findCache[a.FIND_FLAGS]||{},E.findCache[a.FIND_FLAGS][e.room]=E.findCache[a.FIND_FLAGS][e.room]||[],E.findCache[a.FIND_FLAGS][e.room].push(o))}})}),b.map=E.map=s.makeMap(r,E,h),b.market=E.market=u.make(r,i,E),o.extend(h,JSON.parse(JSON.stringify(a))),b}(t[b]),t[b].globals.require&&t[b].runtimeData.userCodeTimestamp==t[b].globals.require.timestamp&&o.isObject(t[b].globals.require.cache.main)&&o.isFunction(t[b].globals.require.cache.main.loop)||(t[b].globals.require=function(e){if((e=e.replace(/^\\.\\//,\"\"))in this.globals.require.cache){if(-1===this.globals.require.cache[e])throw new Error(\"Circular reference to module '\"+e+\"'\")}else{if(o.isUndefined(this.codeModules[e]))throw new Error(\"Unknown module '\"+e+\"'\");if(o.isObject(this.codeModules[e])&&void 0!==this.codeModules[e].binary)this.globals.require.cache[e]=i.bufferFromBase64(this.codeModules[e].binary);else{this.globals.require.cache[e]=-1;var t={exports:{},user:this.runtimeData.user._id,timestamp:this.runtimeData.userCodeTimestamp,name:e,code:this.codeModules[e]};try{i.evalCode(t,this.globals,!1,this.timeout,this.scriptCachedData)}catch(t){throw delete this.globals.require.cache[e],t}this.globals.require.cache[e]=t.exports,t.__initGlobals&&(this.globals.require.initGlobals=this.globals.require.initGlobals||{},this.globals.require.initGlobals[e]=t.__initGlobals)}}return this.globals.require.cache[e]}.bind(t[b]),t[b].globals.require.cache={lodash:t[b].globals._},t[b].globals.require.timestamp=t[b].runtimeData.userCodeTimestamp),t[b]},r.run=function(e){var r=t[e].globals.require(\"main\");if(o.isObject(r)&&o.isFunction(r.loop)&&(t[e].globals.require.initGlobals&&o.forEach(t[e].globals.require.initGlobals,function(e){return e()}),i.evalCode({exports:r,user:t[e].runtimeData.user._id,timestamp:t[e].runtimeData.userCodeTimestamp,name:\"__mainLoop\",code:\"module.exports.loop();\"},t[e].globals,!1,t[e].timeout)),t[e].consoleCommands)for(var n=0;n<t[e].consoleCommands.length;n++){var a=i.evalCode({exports:{},user:t[e].runtimeData.user._id,name:\"_console\"+(new Date).getTime()+\"_\"+n,code:t[e].consoleCommands[n].expression},t[e].globals,!0);t[e].consoleCommands[n].hidden||t[e].fakeConsole.commandResult(a)}}}()}()},{\"../utils\":184,\"./construction-sites\":17,\"./creeps\":18,\"./custom-prototypes\":19,\"./flags\":20,\"./map\":22,\"./market\":23,\"./minerals\":24,\"./nukes\":26,\"./path-finder\":27,\"./power-creeps\":29,\"./resources\":30,\"./rooms\":31,\"./sources\":32,\"./structures\":33,\"./tombstones\":34,lodash:61}],22:[function(e,t,r){\"use strict\";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),o=e(\"../utils\"),i=o.getRuntimeDriver(),a=i.constants,s=e(\"lodash\"),u=e(\"./path-utils\"),c=u.Heap,l=u.OpenClosed,p=30;r.makeMap=function(e,t,r){var u,f,d,h,m,y,_;function R(t){if(!/^(W|E)\\d+(N|S)\\d+$/.test(t))return null;var r=o.roomNameToXY(t),i=n(r,2),s=i[0],u=i[1],c=e.mapGrid.gridData[s+\",\"+u];if(!c)return null;var l={};return c.t&&(l[a.TOP]=o.getRoomNameFromXY(s,u-1)),c.b&&(l[a.BOTTOM]=o.getRoomNameFromXY(s,u+1)),c.l&&(l[a.LEFT]=o.getRoomNameFromXY(s-1,u)),c.r&&(l[a.RIGHT]=o.getRoomNameFromXY(s+1,u)),l}function E(e,t){var r=h-e,n=m-t;if(!(r<0||r>=2*p||n<0||n>=2*p))return r*p*2+n}function g(e){return[h-Math.floor(e/(2*p)),m-e%(2*p)]}function v(e,t){return Math.abs(e-y)+Math.abs(t-_)}return{findRoute:function(e,t,r){if(s.isObject(e)&&(e=e.name),s.isObject(t)&&(t=t.name),e==t)return[];if(!/(W|E)\\d+(N|S)\\d+$/.test(e)||!/(W|E)\\d+(N|S)\\d+$/.test(t))return a.ERR_NO_PATH;var i=o.roomNameToXY(e),O=n(i,2),T=O[0],A=O[1],b=o.roomNameToXY(t),w=n(b,2);if(y=w[0],_=w[1],T==y&&A==_)return[];h=T+p,m=A+p,u?(u.clear(),f.clear()):(u=new c(Math.pow(2*p,2),Float64Array),f=new l(Math.pow(2*p,2))),d||(d=new Uint16Array(Math.pow(2*p,2)));var N=E(T,A);u.push(N,v(T,A));for(var C=r&&r.routeCallback||function(){return 1};u.size();){var S=u.min(),I=u.minPriority();u.pop(),f.close(S);var x=g(S),L=n(x,2),P=L[0],M=L[1],k=v(P,M),D=I-k;if(0===k){for(var U=[];S!==N;){var j=g(S),W=n(j,2),G=W[0],F=W[1],B=g(S=d[S]),H=n(B,2),Y=H[0],K=H[1],V=void 0;V=Y<G?a.FIND_EXIT_RIGHT:Y>G?a.FIND_EXIT_LEFT:K<F?a.FIND_EXIT_BOTTOM:a.FIND_EXIT_TOP,U.push({exit:V,room:o.getRoomNameFromXY(G,F)})}return U.reverse(),U}var X=o.getRoomNameFromXY(P,M),q=R(X);for(var z in q){var J=q[z],Z=o.roomNameToXY(J),$=n(Z,2),Q=$[0],ee=$[1],te=E(Q,ee);if(void 0!==te&&!f.isClosed(te)){var re=Number(C(J,X))||1;if(re!==1/0){var ne=D+v(Q,ee)+re;f.isOpen(te)?u.priority(te)>ne&&(u.update(te,ne),d[te]=S):(u.push(te,ne),f.open(te),d[te]=S)}}}}return a.ERR_NO_PATH},findExit:function(e,t,r){var n=this.findRoute(e,t,r);return s.isArray(n)?n.length?n[0].exit:a.ERR_INVALID_ARGS:n},describeExits:R,isRoomProtected:function(r){return t.deprecated(\"Method `Game.map.isRoomProtected` is deprecated and will be removed. Please use `Game.map.isRoomAvailable` instead.\"),/^(W|E)\\d+(N|S)\\d+$/.test(r)?!s.contains(e.accessibleRooms,r):null},isRoomAvailable:function(t){return!!/^(W|E)\\d+(N|S)\\d+$/.test(t)&&s.contains(e.accessibleRooms,t)},getTerrainAt:function(r,n,o){if(t.deprecated(\"Method `Game.map.getTerrainAt` is deprecated and will be removed. Please use a faster method `Game.map.getRoomTerrain` instead.\"),s.isObject(r)&&(n=r.y,o=r.roomName,r=r.x),!(r<0||r>49||n<0||n>49)&&e.staticTerrainData&&e.staticTerrainData[o]){var i=e.staticTerrainData[o][50*n+r];return i&a.TERRAIN_MASK_WALL?\"wall\":i&a.TERRAIN_MASK_SWAMP?\"swamp\":\"plain\"}},getRoomTerrain:function(e){return new r.Room.Terrain(e)},getRoomLinearDistance:function(e,t,r){return o.calcRoomsDistance(e,t,r)},getWorldSize:function(){return i.getWorldSize()}}}},{\"../utils\":184,\"./path-utils\":28,lodash:61}],23:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../utils\"),i=o.getRuntimeDriver().constants;e(\"util\");r.make=function(e,t,r){var a,s,u,c=0,l={};var p={calcTransactionCost:r.wrapFn(function(e,t,r){var n=o.calcRoomsDistance(t,r,!0);return o.calcTerminalEnergyCost(e,n)}),getAllOrders:r.wrapFn(function(t){var r=function(t){if(t||(t=\"all\"),!l[t]){if(\"all\"!=t&&!n.contains(i.RESOURCES_ALL,t)&&!n.contains(i.INTERSHARD_RESOURCES,t))return{};for(var r in l[t]=JSON.parse(JSON.stringify(e.market.orders[t])||\"{}\"),l[t])l[t][r].price/=1e3}return l[t]}(t&&t.resourceType);return n.filter(r,t)}),getOrderById:r.wrapFn(function(t){var r=e.market.orders.all[t]||this.orders[t];if(!r)return null;var n=JSON.parse(JSON.stringify(r));return n.price/=1e3,n}),createOrder:r.wrapFn(function(r,o,a,s,u){return n.contains(i.RESOURCES_ALL,o)||n.contains(i.INTERSHARD_RESOURCES,o)?r!=i.ORDER_BUY&&r!=i.ORDER_SELL?i.ERR_INVALID_ARGS:(a=parseFloat(a),s=parseInt(s),!a||a<=0||!s?i.ERR_INVALID_ARGS:a*s*i.MARKET_FEE>this.credits?i.ERR_NOT_ENOUGH_RESOURCES:n.contains(i.INTERSHARD_RESOURCES,o)||u&&n.any(e.userObjects,{type:\"terminal\",room:u})?n.size(this.orders)+c>=50?i.ERR_FULL:(c++,t.pushByName(\"global\",\"createOrder\",{type:r,resourceType:o,price:a,totalAmount:s,roomName:u}),i.OK):i.ERR_NOT_OWNER):i.ERR_INVALID_ARGS}),cancelOrder:r.wrapFn(function(e){return this.orders[e]?(t.pushByName(\"global\",\"cancelOrder\",{orderId:e},50),i.OK):i.ERR_INVALID_ARGS}),deal:r.wrapFn(function(r,o,a){var s=e.market.orders.all[r];if(!s)return i.ERR_INVALID_ARGS;if(!(o=parseInt(o))||o<0)return i.ERR_INVALID_ARGS;if(n.contains(i.INTERSHARD_RESOURCES,s.resourceType)){if(s.resourceType==i.SUBSCRIPTION_TOKEN&&s.type==i.ORDER_BUY&&(e.user.subscriptionTokens||0)<o)return i.ERR_NOT_ENOUGH_RESOURCES}else{if(!a)return i.ERR_INVALID_ARGS;var u=n.find(e.userObjects,{type:\"terminal\",room:a}),c=this.calcTransactionCost(o,a,s.roomName);if(!u)return i.ERR_NOT_OWNER;if(u[i.RESOURCE_ENERGY]<c)return i.ERR_NOT_ENOUGH_RESOURCES;if(u.cooldownTime>e.time)return i.ERR_TIRED;if(s.type==i.ORDER_BUY&&(s.resourceType!=i.RESOURCE_ENERGY&&(!u[s.resourceType]||u[s.resourceType]<o)||s.resourceType==i.RESOURCE_ENERGY&&u[i.RESOURCE_ENERGY]<o+c))return i.ERR_NOT_ENOUGH_RESOURCES}return s.type==i.ORDER_SELL&&(e.user.money||0)<o*s.price?i.ERR_NOT_ENOUGH_RESOURCES:t.pushByName(\"global\",\"deal\",{orderId:r,targetRoomName:a,amount:o},10)?i.OK:i.ERR_FULL}),changeOrderPrice:r.wrapFn(function(e,r){var n=this.orders[e];return n?!(r=parseFloat(r))||r<=0?i.ERR_INVALID_ARGS:r>n.price&&(r-n.price)*n.remainingAmount*i.MARKET_FEE>this.credits?i.ERR_NOT_ENOUGH_RESOURCES:(t.pushByName(\"global\",\"changeOrderPrice\",{orderId:e,newPrice:r},50),i.OK):i.ERR_INVALID_ARGS}),extendOrder:r.wrapFn(function(e,r){var n=this.orders[e];return n?!(r=parseInt(r))||r<=0?i.ERR_INVALID_ARGS:n.price*r*i.MARKET_FEE>this.credits?i.ERR_NOT_ENOUGH_RESOURCES:(t.pushByName(\"global\",\"extendOrder\",{orderId:e,addAmount:r},50),i.OK):i.ERR_INVALID_ARGS})};return Object.defineProperties(p,{credits:{enumerable:!0,get:function(){return(e.user.money||0)/1e3}},incomingTransactions:{enumerable:!0,get:function(){return a||(a=n.map(e.transactions.incoming||[],function(t){return t.transactionId=\"\"+t._id,delete t._id,t.sender=t.sender?{username:e.users[t.sender].username}:void 0,t.recipient=t.recipient?{username:e.users[t.recipient].username}:void 0,t})),a}},outgoingTransactions:{enumerable:!0,get:function(){return s||(s=n.map(e.transactions.outgoing||[],function(t){return t.transactionId=\"\"+t._id,delete t._id,t.sender=t.sender?{username:e.users[t.sender].username}:void 0,t.recipient=t.recipient?{username:e.users[t.recipient].username}:void 0,t})),s}},orders:{enumerable:!0,get:function(){return u||(u=n(e.market.myOrders).map(function(e){return e.id=\"\"+e._id,delete e._id,delete e.user,e.price/=1e3,e}).indexBy(\"id\").value()),u}}}),p}},{\"../utils\":184,lodash:61,util:191}],24:[function(e,t,r){\"use strict\";var n,o,i,a=e(\"./../utils\");e(\"./rooms\"),a.getRuntimeDriver().constants;r.make=function(e,t,r,s){if(n=e,t,o=r,!(i=s).Mineral){var u=function(e){if(!n.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return n.roomObjects[e]},c=o.wrapFn(function(e){var t=u(e);i.RoomObject.call(this,t.x,t.y,t.room,t.effects),this.id=e});c.prototype=Object.create(i.RoomObject.prototype),c.prototype.constructor=c,a.defineGameObjectProperties(c.prototype,u,{mineralType:function(e){return e.mineralType},mineralAmount:function(e){return e.mineralAmount},density:function(e){return e.density},ticksToRegeneration:function(e){return e.nextRegenerationTime?e.nextRegenerationTime-n.time:void 0}}),c.prototype.toString=o.wrapFn(function(){return\"[mineral (\"+this.mineralType+\") #\"+this.id+\"]\"}),Object.defineProperty(i,\"Mineral\",{enumerable:!0,value:c})}}},{\"./../utils\":184,\"./rooms\":31}],25:[function(e,t,r){\"use strict\";var n=[\"Jackson\",\"Aiden\",\"Liam\",\"Lucas\",\"Noah\",\"Mason\",\"Jayden\",\"Ethan\",\"Jacob\",\"Jack\",\"Caden\",\"Logan\",\"Benjamin\",\"Michael\",\"Caleb\",\"Ryan\",\"Alexander\",\"Elijah\",\"James\",\"William\",\"Oliver\",\"Connor\",\"Matthew\",\"Daniel\",\"Luke\",\"Brayden\",\"Jayce\",\"Henry\",\"Carter\",\"Dylan\",\"Gabriel\",\"Joshua\",\"Nicholas\",\"Isaac\",\"Owen\",\"Nathan\",\"Grayson\",\"Eli\",\"Landon\",\"Andrew\",\"Max\",\"Samuel\",\"Gavin\",\"Wyatt\",\"Christian\",\"Hunter\",\"Cameron\",\"Evan\",\"Charlie\",\"David\",\"Sebastian\",\"Joseph\",\"Dominic\",\"Anthony\",\"Colton\",\"John\",\"Tyler\",\"Zachary\",\"Thomas\",\"Julian\",\"Levi\",\"Adam\",\"Isaiah\",\"Alex\",\"Aaron\",\"Parker\",\"Cooper\",\"Miles\",\"Chase\",\"Muhammad\",\"Christopher\",\"Blake\",\"Austin\",\"Jordan\",\"Leo\",\"Jonathan\",\"Adrian\",\"Colin\",\"Hudson\",\"Ian\",\"Xavier\",\"Camden\",\"Tristan\",\"Carson\",\"Jason\",\"Nolan\",\"Riley\",\"Lincoln\",\"Brody\",\"Bentley\",\"Nathaniel\",\"Josiah\",\"Declan\",\"Jake\",\"Asher\",\"Jeremiah\",\"Cole\",\"Mateo\",\"Micah\",\"Elliot\"],o=[\"Sophia\",\"Emma\",\"Olivia\",\"Isabella\",\"Mia\",\"Ava\",\"Lily\",\"Zoe\",\"Emily\",\"Chloe\",\"Layla\",\"Madison\",\"Madelyn\",\"Abigail\",\"Aubrey\",\"Charlotte\",\"Amelia\",\"Ella\",\"Kaylee\",\"Avery\",\"Aaliyah\",\"Hailey\",\"Hannah\",\"Addison\",\"Riley\",\"Harper\",\"Aria\",\"Arianna\",\"Mackenzie\",\"Lila\",\"Evelyn\",\"Adalyn\",\"Grace\",\"Brooklyn\",\"Ellie\",\"Anna\",\"Kaitlyn\",\"Isabelle\",\"Sophie\",\"Scarlett\",\"Natalie\",\"Leah\",\"Sarah\",\"Nora\",\"Mila\",\"Elizabeth\",\"Lillian\",\"Kylie\",\"Audrey\",\"Lucy\",\"Maya\",\"Annabelle\",\"Makayla\",\"Gabriella\",\"Elena\",\"Victoria\",\"Claire\",\"Savannah\",\"Peyton\",\"Maria\",\"Alaina\",\"Kennedy\",\"Stella\",\"Liliana\",\"Allison\",\"Samantha\",\"Keira\",\"Alyssa\",\"Reagan\",\"Molly\",\"Alexandra\",\"Violet\",\"Charlie\",\"Julia\",\"Sadie\",\"Ruby\",\"Eva\",\"Alice\",\"Eliana\",\"Taylor\",\"Callie\",\"Penelope\",\"Camilla\",\"Bailey\",\"Kaelyn\",\"Alexis\",\"Kayla\",\"Katherine\",\"Sydney\",\"Lauren\",\"Jasmine\",\"London\",\"Bella\",\"Adeline\",\"Caroline\",\"Vivian\",\"Juliana\",\"Gianna\",\"Skyler\",\"Jordyn\"];r.getUniqueName=function(e){var t,r,i=0;do{var a=Math.random()>.5?n:o;t=a[Math.floor(Math.random()*a.length)],i>3&&(t+=a[Math.floor(Math.random()*a.length)]),i++,r=e(t)}while(r);return t}},{}],26:[function(e,t,r){\"use strict\";var n,o,i,a=e(\"./../utils\");e(\"./rooms\"),a.getRuntimeDriver().constants;r.make=function(e,t,r,s){if(n=e,t,o=r,!(i=s).Nuke){var u=function(e){if(!n.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return n.roomObjects[e]},c=o.wrapFn(function(e){var t=u(e);i.RoomObject.call(this,t.x,t.y,t.room,t.effects),this.id=e});c.prototype=Object.create(i.RoomObject.prototype),c.prototype.constructor=c,a.defineGameObjectProperties(c.prototype,u,{timeToLand:function(e){return e.landTime-n.time},launchRoomName:function(e){return e.launchRoomName}}),c.prototype.toString=o.wrapFn(function(){return\"[nuke #\"+this.id+\"]\"}),Object.defineProperty(i,\"Nuke\",{enumerable:!0,value:c})}}},{\"./../utils\":184,\"./rooms\":31}],27:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../utils\").getRuntimeDriver();n.constants;r.make=function(e,t,r,o){if(n.pathFinder.make(o),!o.PathFinder){var i=r.wrapFn(function(){this._bits=new Uint8Array(2500)});i.prototype.set=r.wrapFn(function(e,t,r){e|=0,t|=0,this._bits[50*e+t]=Math.min(Math.max(0,r),255)}),i.prototype.get=r.wrapFn(function(e,t){return e|=0,t|=0,this._bits[50*e+t]}),i.prototype.clone=r.wrapFn(function(){var e=new i;return e._bits=new Uint8Array(this._bits),e}),i.prototype.serialize=r.wrapFn(function(){return Array.prototype.slice.apply(new Uint32Array(this._bits.buffer))}),i.deserialize=r.wrapFn(function(e){var t=Object.create(i.prototype);return t._bits=new Uint8Array(new Uint32Array(e).buffer),t});var a=Object.create(Object.prototype,{CostMatrix:{enumerable:!0,value:i},search:{enumerable:!0,value:r.wrapFn(function(e,t,r){return!t||Array.isArray(t)&&!t.length?{path:[],ops:0}:n.pathFinder.search(e,t,r)})},use:{enumerable:!0,value:r.wrapFn(function(e){e||r.deprecated(\"`PathFinder.use` is considered deprecated and will be removed soon.\"),r._useNewPathFinder=!!e})}});Object.defineProperty(o,\"PathFinder\",{enumerable:!0,value:a})}}},{\"../utils\":184,lodash:61}],28:[function(e,t,r){\"use strict\";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}r.OpenClosed=function(){function e(t){o(this,e),this.list=new Uint8Array(t),this.marker=1}return n(e,[{key:\"clear\",value:function(){this.marker>=253?(this.list=new Uint8Array(this.list.length),this.marker=1):this.marker+=2}},{key:\"isOpen\",value:function(e){return this.list[e]===this.marker}},{key:\"isClosed\",value:function(e){return this.list[e]===this.marker+1}},{key:\"open\",value:function(e){this.list[e]=this.marker}},{key:\"close\",value:function(e){this.list[e]=this.marker+1}}]),e}(),r.Heap=function(){function e(t,r){o(this,e),this.priorities=new(r||Uint16Array)(t+1),this.heap=new Uint16Array(t+1),this.size_=0}return n(e,[{key:\"minPriority\",value:function(){return this.priorities[this.heap[1]]}},{key:\"min\",value:function(){return this.heap[1]}},{key:\"size\",value:function(){return this.size_}},{key:\"priority\",value:function(e){return this.priorities[e]}},{key:\"pop\",value:function(){this.heap[1]=this.heap[this.size_],--this.size_;for(var e=1;;){var t=e;if(1+(t<<1)<=this.size_?(this.priorities[this.heap[t]]>=this.priorities[this.heap[t<<1]]&&(e=t<<1),this.priorities[this.heap[e]]>=this.priorities[this.heap[1+(t<<1)]]&&(e=1+(t<<1))):t<<1<=this.size_&&this.priorities[this.heap[t]]>=this.priorities[this.heap[t<<1]]&&(e=t<<1),t===e)return;var r=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=r}}},{key:\"push\",value:function(e,t){this.priorities[e]=t;var r=++this.size_;this.heap[r]=e,this.bubbleUp(r)}},{key:\"update\",value:function(e,t){for(var r=this.size_;r>0;--r)if(this.heap[r]===e)return this.priorities[e]=t,void this.bubbleUp(r)}},{key:\"bubbleUp\",value:function(e){for(;1!==e;){if(!(this.priorities[this.heap[e]]<=this.priorities[this.heap[e>>>1]]))return;var t=this.heap[e];this.heap[e]=this.heap[e>>>1],this.heap[e>>>=1]=t}}},{key:\"clear\",value:function(){this.size_=0}}]),e}()},{}],29:[function(e,t,r){\"use strict\";var n,o,i,a,s=e(\"./../utils\"),u=(e(\"./rooms\"),s.getRuntimeDriver()),c=e(\"lodash\"),l=u.constants;function p(){return Math.floor(Math.pow((n.user.power||0)/l.POWER_LEVEL_MULTIPLY,1/l.POWER_LEVEL_POW))-(Object.keys(n.userPowerCreeps).length+c.sum(n.userPowerCreeps,\"level\"))}function f(e){return Object.assign({},n.userPowerCreeps[e],n.roomObjects[e])}r.make=function(e,t,r,u){if(n=e,o=t,i=r,!(a=u).PowerCreep){var d=i.wrapFn(function(e){var t=f(e);t.room&&a.RoomObject.call(this,t.x,t.y,t.room),this.id=e});d.prototype=Object.create(a.RoomObject.prototype),d.prototype.constructor=d,s.defineGameObjectProperties(d.prototype,f,{name:function(e){return e.name},my:function(e){return e.user==n.user._id},owner:function(e){return new Object({username:n.users[e.user].username})},level:function(e){return e.level},className:function(e){return e.className},hitsMax:function(e){return e.hitsMax},hits:function(e){return e.hits},shard:function(e){return e.shard||void 0},spawnCooldownTime:function(e){return null!==e.spawnCooldownTime&&e.spawnCooldownTime>Date.now()?e.spawnCooldownTime:void 0},deleteTime:function(e){return e.deleteTime||void 0},powers:function(e){return c.mapValues(e.powers,function(e){return{level:e.level,cooldown:Math.max(0,(e.cooldownTime||0)-n.time)}})},saying:function(e){if(e.actionLog&&e.actionLog.say)return e.user==n.user._id?e.actionLog.say.message:e.actionLog.say.isPublic?e.actionLog.say.message:void 0},carry:function(e){var t={energy:0};return l.RESOURCES_ALL.forEach(function(r){e[r]&&(t[r]=e[r])}),t},carryCapacity:function(e){return e.energyCapacity},ticksToLive:function(e){return e.ageTime-n.time}}),Object.defineProperty(d.prototype,\"memory\",{get:function(){if((!this.id||this.my)&&((c.isUndefined(a.Memory.powerCreeps)||\"undefined\"===a.Memory.powerCreeps)&&(a.Memory.powerCreeps={}),c.isObject(a.Memory.powerCreeps)))return a.Memory.powerCreeps[this.name]=a.Memory.powerCreeps[this.name]||{}},set:function(e){if(this.id&&!this.my)throw new Error(\"Could not set other player's creep memory\");if((c.isUndefined(a.Memory.powerCreeps)||\"undefined\"===a.Memory.powerCreeps)&&(a.Memory.powerCreeps={}),!c.isObject(a.Memory.powerCreeps))throw new Error(\"Could not set creep memory\");a.Memory.powerCreeps[this.name]=e}}),d.prototype.toString=i.wrapFn(function(){return\"[powerCreep \"+this.name+\"]\"}),d.prototype.move=i.wrapFn(function(e){return this.room?a.Creep.prototype.move.call(this,e):l.ERR_BUSY}),d.prototype.moveTo=i.wrapFn(function(e,t,r){return this.room?a.Creep.prototype.moveTo.call(this,e,t,r):l.ERR_BUSY}),d.prototype.moveByPath=i.wrapFn(function(e){return this.room?a.Creep.prototype.moveByPath.call(this,e):l.ERR_BUSY}),d.prototype.transfer=i.wrapFn(function(e,t,r){return this.room?a.Creep.prototype.transfer.call(this,e,t,r):l.ERR_BUSY}),d.prototype.withdraw=i.wrapFn(function(e,t,r){return this.room?a.Creep.prototype.withdraw.call(this,e,t,r):l.ERR_BUSY}),d.prototype.drop=i.wrapFn(function(e,t){return this.room?a.Creep.prototype.drop.call(this,e,t):l.ERR_BUSY}),d.prototype.pickup=i.wrapFn(function(e){return this.room?a.Creep.prototype.pickup.call(this,e):l.ERR_BUSY}),d.prototype.say=i.wrapFn(function(e,t){return this.room?a.Creep.prototype.say.call(this,e,t):l.ERR_BUSY}),d.prototype.spawn=i.wrapFn(function(e){return this.room?l.ERR_BUSY:e instanceof a.StructurePowerSpawn?this.my&&e.my?s.checkStructureAgainstController(f(e.id),i.objectsByRoom[f(e.id).room],f(e.room.controller.id))?this.spawnCooldownTime?l.ERR_TIRED:(c.isUndefined(a.Memory.powerCreeps)&&(a.Memory.powerCreeps={}),c.isObject(a.Memory.powerCreeps)&&c.isUndefined(a.Memory.powerCreeps[this.name])&&(a.Memory.powerCreeps[this.name]={}),o.pushByName(\"global\",\"spawnPowerCreep\",{id:e.id,name:this.name},50),l.OK):l.ERR_RCL_NOT_ENOUGH:l.ERR_NOT_OWNER:l.ERR_INVALID_TARGET}),d.prototype.suicide=i.wrapFn(function(){return this.room?this.my?(o.pushByName(\"global\",\"suicidePowerCreep\",{id:this.id},50),l.OK):l.ERR_NOT_OWNER:l.ERR_BUSY}),d.prototype.delete=i.wrapFn(function(e){return this.room?l.ERR_BUSY:this.my?(o.pushByName(\"global\",\"deletePowerCreep\",{id:this.id,cancel:e},50),l.OK):l.ERR_NOT_OWNER}),d.prototype.upgrade=i.wrapFn(function(e){if(!this.my)return l.ERR_NOT_OWNER;if(p()<=0)return l.ERR_NOT_ENOUGH_RESOURCES;if(this.level>=l.POWER_CREEP_MAX_LEVEL)return l.ERR_FULL;var t=l.POWER_INFO[e];if(!t||t.className!==this.className)return l.ERR_INVALID_ARGS;var r=f(this.id).powers[e],n=r?r.level:0;return 5==n?l.ERR_FULL:this.level<t.level[n]?l.ERR_FULL:(o.pushByName(\"global\",\"upgradePowerCreep\",{id:this.id,power:e},50),l.OK)}),d.prototype.usePower=i.wrapFn(function(e,t){if(!this.my)return l.ERR_NOT_OWNER;if(!this.room)return l.ERR_BUSY;if(this.room.controller){if(!this.room.controller.isPowerEnabled)return l.ERR_INVALID_ARGS;if(!this.room.controller.my&&this.room.controller.safeMode)return l.ERR_INVALID_ARGS}var r=f(this.id).powers[e],i=l.POWER_INFO[e];if(!r||!r.level||!i)return l.ERR_NO_BODYPART;if(r.cooldownTime>n.time)return l.ERR_TIRED;var a=i.ops||0;if(c.isArray(a)&&(a=a[r.level-1]),(f(this.id).ops||0)<a)return l.ERR_NOT_ENOUGH_RESOURCES;if(i.range){if(!t)return l.ERR_INVALID_TARGET;if(!this.pos.inRangeTo(t,i.range))return l.ERR_NOT_IN_RANGE;var s=c.find(t.effects,function(t){return t.power==e});if(s&&s.level>r.level&&s.ticksRemaining>0)return l.ERR_FULL}return o.set(this.id,\"usePower\",{power:e,id:t?t.id:void 0}),l.OK}),d.prototype.enableRoom=i.wrapFn(function(e){return this.my?this.room?e&&e.id&&i.structures[e.id]&&e instanceof a.Structure?e.pos.isNearTo(this.pos)?\"controller\"!=e.structureType||e.safeMode&&!e.my?l.ERR_INVALID_TARGET:(o.set(this.id,\"enableRoom\",{id:e.id}),l.OK):l.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),l.ERR_INVALID_TARGET):l.ERR_BUSY:l.ERR_NOT_OWNER}),d.prototype.renew=i.wrapFn(function(e){return this.my?this.room?e&&e.id&&i.structures[e.id]&&(e instanceof a.StructurePowerBank||e instanceof a.StructurePowerSpawn)?e.pos.isNearTo(this.pos)?(o.set(this.id,\"renew\",{id:e.id}),l.OK):l.ERR_NOT_IN_RANGE:(i.assertTargetObject(e),l.ERR_INVALID_TARGET):l.ERR_BUSY:l.ERR_NOT_OWNER}),d.prototype.cancelOrder=i.wrapFn(function(e){return this.room?this.my?o.remove(this.id,e)?l.OK:l.ERR_NOT_FOUND:l.ERR_NOT_OWNER:l.ERR_BUSY}),d.prototype.rename=i.wrapFn(function(e){return this.room?l.ERR_BUSY:this.my?c.any(n.userPowerCreeps,{name:e})?l.ERR_NAME_EXISTS:(o.pushByName(\"global\",\"renamePowerCreep\",{id:this.id,name:e},50),l.OK):l.ERR_NOT_OWNER}),d.prototype.notifyWhenAttacked=i.wrapFn(function(e){return this.room?this.my?c.isBoolean(e)?(e!=f(this.id).notifyWhenAttacked&&o.set(this.id,\"notifyWhenAttacked\",{enabled:e}),l.OK):l.ERR_INVALID_ARGS:l.ERR_NOT_OWNER:l.ERR_BUSY}),d.create=i.wrapFn(function(e,t){return p()<=0?l.ERR_NOT_ENOUGH_RESOURCES:c.any(n.userPowerCreeps,{name:e})?l.ERR_NAME_EXISTS:-1===Object.values(l.POWER_CLASS).indexOf(t)?l.ERR_INVALID_ARGS:(o.pushByName(\"global\",\"createPowerCreep\",{name:e,className:t},50),l.OK)}),Object.defineProperty(a,\"PowerCreep\",{enumerable:!0,value:d})}}},{\"./../utils\":184,\"./rooms\":31,lodash:61}],30:[function(e,t,r){\"use strict\";var n,o,i,a=e(\"./../utils\"),s=(e(\"./rooms\"),a.getRuntimeDriver().constants);r.make=function(e,t,r,u){if(n=e,t,o=r,!(i=u).Resource){var c=function(e){if(!n.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return n.roomObjects[e]},l=o.wrapFn(function(e){var t=c(e);i.RoomObject.call(this,t.x,t.y,t.room,t.effects),this.id=e});l.prototype=Object.create(i.RoomObject.prototype),l.prototype.constructor=l,a.defineGameObjectProperties(l.prototype,c,{energy:function(e){return e.energy},amount:function(e){return e[e.resourceType||s.RESOURCE_ENERGY]},resourceType:function(e){return e.resourceType||s.RESOURCE_ENERGY}}),l.prototype.toString=o.wrapFn(function(){return\"[resource (\"+this.resourceType+\") #\"+this.id+\"]\"}),Object.defineProperty(i,\"Resource\",{enumerable:!0,value:l}),Object.defineProperty(i,\"Energy\",{enumerable:!0,value:l})}}},{\"./../utils\":184,\"./rooms\":31}],31:[function(e,t,r){\"use strict\";var n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}();function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a,s,u,c,l,p,f,d,h,m=e(\"lodash\"),y=e(\"./../utils\"),_=y.getRuntimeDriver().constants,R=e(\"@screeps/pathfinding\"),E=Math.abs,g=(Math.min,Math.max),v=null,O=null;function T(e,t,r){var n=\"grid\";return(t=t||{}).ignoreCreeps&&(n+=\"_ignoreCreeps\"),t.ignoreDestructibleStructures&&(n+=\"_ignoreDestructibleStructures\"),m.isNumber(r)&&(n+=\"_endNodes\"+r),t.avoid&&(n+=\"_avoid\"+d[e].positionsSetCache.key(t.avoid)),t.ignore&&(n+=\"_ignore\"+d[e].positionsSetCache.key(t.ignore)),d[e].pfGrid[n]||(d[e].pfGrid[n]=function(e,t,r){t=t||{};var n=new Array(50),o=m.clone(_.OBSTACLE_OBJECT_TYPES);t.ignoreDestructibleStructures&&(o=m.without(o,\"constructedWall\",\"spawn\",\"extension\",\"link\",\"storage\",\"observer\",\"tower\",\"powerBank\",\"powerSpawn\",\"lab\",\"terminal\")),t.ignoreCreeps&&(o=m.without(o,\"creep\",\"powerCreep\"));for(var i=0;i<50;i++){n[i]=new Array(50);for(var s=0;s<50;s++){n[i][s]=0==s||0==i||49==s||49==i?11:2;var l=a.staticTerrainData[e][50*i+s];l&_.TERRAIN_MASK_WALL&&(n[i][s]=0),l&_.TERRAIN_MASK_SWAMP&&2==n[i][s]&&(n[i][s]=10)}}if(u.objectsByRoomKeys[e].forEach(function(r){var i=u.objectsByRoom[e][r];(m.contains(o,i.type)||!t.ignoreDestructibleStructures&&\"rampart\"==i.type&&!i.isPublic&&i.user!=a.user._id||!t.ignoreDestructibleStructures&&\"constructionSite\"==i.type&&i.user==a.user._id&&m.contains(_.OBSTACLE_OBJECT_TYPES,i.structureType))&&(n[i.y][i.x]=0),\"road\"==i.type&&n[i.y][i.x]>0&&(n[i.y][i.x]=1)}),t.ignore){if(!m.isArray(t.ignore))throw new Error(\"option `ignore` is not an array\");m.forEach(t.ignore,function(r,o){r&&(r.pos&&(n[r.pos.y][r.pos.x]=n[r.pos.y][r.pos.x]>2?2:n[r.pos.y][r.pos.x]),!m.isObject(r)||m.isUndefined(r.x)||r instanceof c.RoomPosition||(t.ignore[o]=new c.RoomPosition(r.x,r.y,e)),m.isUndefined(r.x)||(n[r.y][r.x]=n[r.y][r.x]>2?2:n[r.y][r.x]))})}if(t.avoid){if(!m.isArray(t.avoid))throw new Error(\"option `avoid` is not an array\");m.forEach(t.avoid,function(r,o){r&&(r.pos&&(n[r.pos.y][r.pos.x]=0),!m.isObject(r)||m.isUndefined(r.x)||r instanceof c.RoomPosition||(t.avoid[o]=new c.RoomPosition(r.x,r.y,e)),m.isUndefined(r.x)||(n[r.y][r.x]=0))})}return r&&m.forEach(d[e].pfEndNodes[r],function(e){m.isUndefined(e.x)?m.isUndefined(e.pos)||(n[e.pos.y][e.pos.x]=999):n[e.y][e.x]=999}),new R.Grid(50,50,n)}(e,t,r)),d[e].pfGrid[n].clone()}function A(e,t){if(!d[e])return new c.PathFinder.CostMatrix;var r=\"grid2\";return(t=t||{}).ignoreCreeps&&(r+=\"_ignoreCreeps\"),t.ignoreDestructibleStructures&&(r+=\"_ignoreDestructibleStructures\"),t.ignoreRoads&&(r+=\"_ignoreRoads\"),d[e].pfGrid[r]||(d[e].pfGrid[r]=function(e,t){t=t||{};var r=new c.PathFinder.CostMatrix,n=m.clone(_.OBSTACLE_OBJECT_TYPES);return n.push(\"portal\"),t.ignoreDestructibleStructures&&(n=m.without(n,\"constructedWall\",\"spawn\",\"extension\",\"link\",\"storage\",\"observer\",\"tower\",\"powerBank\",\"powerSpawn\",\"lab\",\"terminal\")),(t.ignoreCreeps||u.rooms[e].controller&&u.rooms[e].controller.safeMode&&u.rooms[e].controller.my)&&(n=m.without(n,\"creep\",\"powerCreep\")),u.objectsByRoomKeys[e]&&u.objectsByRoomKeys[e].forEach(function(o){var i=u.objectsByRoom[e][o];(m.contains(n,i.type)||!t.ignoreCreeps&&u.rooms[e].controller&&u.rooms[e].controller.safeMode&&u.rooms[e].controller.my&&(\"creep\"==i.type||\"powerCreep\"==i.type)&&i.user==a.user._id||!t.ignoreDestructibleStructures&&\"rampart\"==i.type&&!i.isPublic&&i.user!=a.user._id||!t.ignoreDestructibleStructures&&\"constructionSite\"==i.type&&i.user==a.user._id&&m.contains(_.OBSTACLE_OBJECT_TYPES,i.structureType))&&r.set(i.x,i.y,255),\"swamp\"==i.type&&0==r.get(i.x,i.y)&&r.set(i.x,i.y,t.ignoreRoads?5:10),!t.ignoreRoads&&\"road\"==i.type&&r.get(i.x,i.y)<255&&r.set(i.x,i.y,1)}),r}(e,t)),d[e].pfGrid[r]}r.make=function(e,t,r,g){if(a=e,s=t,u=r,c=g,l=1,p=[],f=[],d={},h=0,v||function(){for(var e in a.staticTerrainData){var t=a.staticTerrainData[e];v=t.constructor;break}}(),O||function(){O=v.prototype.set}(),!c.Room){var b=u.wrapFn(function(e){!function(e){if(!a.rooms[e])throw new Error(\"Could not find a room with name \"+e);a.rooms[e]}(e);var t,r=e,n=e.match(/survival_(.*)$/);n&&(r=n[1]),a.games&&r in a.games&&(t=a.games[r]),this.name=e,this.energyAvailable=0,this.energyCapacityAvailable=0,this.survivalInfo=t,d[e]={pfGrid:{},pfFinders:{},pfEndNodes:{},pfDijkstraFinder:new R.DijkstraFinder({diagonalMovement:1}),pathCache:{},positionsSetCache:{cache:{},key:function(t){if(!m.isArray(t))return 0;var r=m.map(t,function(t){return t&&t.pos?t.pos:!m.isObject(t)||m.isUndefined(t.x)||t instanceof c.RoomPosition?t:new c.RoomPosition(t.x,t.y,e)}),n=m.findKey(this.cache,function(e){return r.length==e.length&&m.every(r,function(t){return m.any(e,function(e){if(!m.isObject(t)||!t.isEqualTo)throw new Error(\"Invalid position \"+t+\", check your `opts` property\");return t.isEqualTo(e)})})});return void 0===n?(n=l++,this.cache[n]=m.clone(t)):n=parseInt(n),n}},lookTypeRegisters:{creep:u.byRoom[e].creeps,energy:u.byRoom[e].energy,resource:u.byRoom[e].energy,source:u.byRoom[e].sources,mineral:u.byRoom[e].minerals,structure:u.byRoom[e].structures,flag:u.byRoom[e].flags,constructionSite:u.byRoom[e].constructionSites,tombstone:u.byRoom[e].tombstones,nuke:u.byRoom[e].nukes,powerCreep:u.byRoom[e].powerCreeps},lookTypeSpatialRegisters:{creep:u.byRoom[e].spatial.creeps,energy:u.byRoom[e].spatial.energy,resource:u.byRoom[e].spatial.energy,source:u.byRoom[e].spatial.sources,mineral:u.byRoom[e].spatial.minerals,structure:u.byRoom[e].spatial.structures,flag:u.byRoom[e].spatial.flags,constructionSite:u.byRoom[e].spatial.constructionSites,tombstone:u.byRoom[e].spatial.tombstones,nuke:u.byRoom[e].spatial.nukes,powerCreep:u.byRoom[e].spatial.powerCreeps}},this.visual=new c.RoomVisual(e)});b.serializePath=u.wrapFn(function(e){return y.serializePath(e)}),b.deserializePath=u.wrapFn(function(e){return y.deserializePath(e)}),b.prototype.toString=u.wrapFn(function(){return\"[room \"+this.name+\"]\"}),b.prototype.toJSON=u.wrapFn(function(){var e={};for(var t in this)\"_\"==t[0]||m.contains([\"toJSON\",\"toString\",\"controller\",\"storage\",\"terminal\"],t)||(e[t]=this[t]);return e}),Object.defineProperty(b.prototype,\"memory\",{get:function(){if((m.isUndefined(c.Memory.rooms)||\"undefined\"===c.Memory.rooms)&&(c.Memory.rooms={}),m.isObject(c.Memory.rooms))return c.Memory.rooms[this.name]=c.Memory.rooms[this.name]||{}},set:function(e){if((m.isUndefined(c.Memory.rooms)||\"undefined\"===c.Memory.rooms)&&(c.Memory.rooms={}),!m.isObject(c.Memory.rooms))throw new Error(\"Could not set room memory\");c.Memory.rooms[this.name]=e}}),b.prototype.getEventLog=u.wrapFn(function(e){if(e)return a.roomEventLog[this.name]||\"[]\";var t=u.roomEventLogCache;return t[this.name]||(t[this.name]=JSON.parse(a.roomEventLog[this.name]||\"[]\")),t[this.name]}),b.prototype.find=u.wrapFn(function(e,t){var r=this,n=[];if(t=t||{},e===_.FIND_DROPPED_ENERGY&&(u.deprecated(\"FIND_DROPPED_ENERGY constant is considered deprecated and will be removed soon. Please use FIND_DROPPED_RESOURCES instead.\"),e=_.FIND_DROPPED_RESOURCES),u.findCache[e]&&u.findCache[e][this.name])n=u.findCache[e][this.name];else switch(e){case _.FIND_EXIT:return u.findCache[e]=u.findCache[e]||{},u.findCache[e][this.name]=this.find(_.FIND_EXIT_TOP,t).concat(this.find(_.FIND_EXIT_BOTTOM,t)).concat(this.find(_.FIND_EXIT_RIGHT,t)).concat(this.find(_.FIND_EXIT_LEFT,t)),m.clone(u.findCache[e][this.name]);case _.FIND_EXIT_TOP:case _.FIND_EXIT_RIGHT:case _.FIND_EXIT_BOTTOM:case _.FIND_EXIT_LEFT:u.findCache[e]=u.findCache[e]||{};for(var o=[],i=0;i<50;i++){var s=0,c=0;e==_.FIND_EXIT_LEFT||e==_.FIND_EXIT_RIGHT?c=i:s=i,e==_.FIND_EXIT_RIGHT&&(s=49),e==_.FIND_EXIT_BOTTOM&&(c=49),o.push(!(a.staticTerrainData[this.name][50*c+s]&_.TERRAIN_MASK_WALL))}n=m.reduce(o,function(t,n,o){return n&&(e==_.FIND_EXIT_TOP&&t.push(r.getPositionAt(o,0)),e==_.FIND_EXIT_BOTTOM&&t.push(r.getPositionAt(o,49)),e==_.FIND_EXIT_LEFT&&t.push(r.getPositionAt(0,o)),e==_.FIND_EXIT_RIGHT&&t.push(r.getPositionAt(49,o))),t},[]),u.findCache[e][this.name]=n}return n=t.filter?m.filter(n,t.filter):m.clone(n)}),b.prototype.lookAt=u.wrapFn(function(e,t){var r=y.fetchXYArguments(e,t,c),n=o(r,2),i=n[0],a=n[1],s=[];return N(this.name,_.LOOK_CREEPS,i,a,s),N(this.name,_.LOOK_ENERGY,i,a,s),N(this.name,_.LOOK_RESOURCES,i,a,s),N(this.name,_.LOOK_SOURCES,i,a,s),N(this.name,_.LOOK_MINERALS,i,a,s),N(this.name,_.LOOK_STRUCTURES,i,a,s),N(this.name,_.LOOK_FLAGS,i,a,s),N(this.name,_.LOOK_CONSTRUCTION_SITES,i,a,s),N(this.name,_.LOOK_TERRAIN,i,a,s),N(this.name,_.LOOK_NUKES,i,a,s),N(this.name,_.LOOK_TOMBSTONES,i,a,s),N(this.name,_.LOOK_POWER_CREEPS,i,a,s),s}),b.prototype.lookForAt=u.wrapFn(function(e,t,r){var n=y.fetchXYArguments(t,r,c),i=o(n,2),a=i[0],s=i[1];return\"terrain\"==e||e in d[this.name].lookTypeSpatialRegisters?N(this.name,e,a,s):_.ERR_INVALID_ARGS}),b.prototype.lookAtArea=u.wrapFn(function(e,t,r,n,o){var i=o?[]:{};if(!o)for(var a=e;a<=r;a++){i[a]={};for(var s=t;s<=n;s++)i[a][s]=[]}return C(this.name,_.LOOK_CREEPS,e,t,r,n,!0,o,i),C(this.name,_.LOOK_ENERGY,e,t,r,n,!0,o,i),C(this.name,_.LOOK_RESOURCES,e,t,r,n,!0,o,i),C(this.name,_.LOOK_SOURCES,e,t,r,n,!0,o,i),C(this.name,_.LOOK_MINERALS,e,t,r,n,!0,o,i),C(this.name,_.LOOK_STRUCTURES,e,t,r,n,!0,o,i),C(this.name,_.LOOK_FLAGS,e,t,r,n,!0,o,i),C(this.name,_.LOOK_CONSTRUCTION_SITES,e,t,r,n,!0,o,i),C(this.name,_.LOOK_TERRAIN,e,t,r,n,!0,o,i),C(this.name,_.LOOK_NUKES,e,t,r,n,!0,o,i),C(this.name,_.LOOK_TOMBSTONES,e,t,r,n,!0,o,i),i}),b.prototype.lookForAtArea=u.wrapFn(function(e,t,r,n,o,i){var a=i?[]:{};if(!i)for(var s=t;s<=n;s++)a[s]={};return C(this.name,e,t,r,n,o,!1,i,a),a}),b.prototype.findPath=u.wrapFn(function(e,t,r){if(e.roomName!=this.name)return r.serialize?\"\":[];if(u._useNewPathFinder)return function(e,t,r,n){if(n=n||{},t.isEqualTo(r))return n.serialize?\"\":[];n.avoid&&(u.deprecated(\"`avoid` option cannot be used when `PathFinder.use()` is enabled. Use `costCallback` instead.\"),n.avoid=void 0),n.ignore&&(u.deprecated(\"`ignore` option cannot be used when `PathFinder.use()` is enabled. Use `costCallback` instead.\"),n.ignore=void 0),void 0===n.maxOps&&(void 0===n.maxRooms||n.maxRooms>1)&&t.roomName!=r.roomName&&(n.maxOps=2e4);var o={roomCallback:function(e){var t=A(e,n);if(\"function\"==typeof n.costCallback){t=t.clone();var r=n.costCallback(e,t);r instanceof c.PathFinder.CostMatrix&&(t=r)}return t},maxOps:n.maxOps,maxRooms:n.maxRooms};n.ignoreRoads||(o.plainCost=2,o.swampCost=10),n.plainCost&&(o.plainCost=n.plainCost),n.swampCost&&(o.swampCost=n.swampCost);var i=c.PathFinder.search(t,{range:Math.max(1,n.range||0),pos:r},o);!n.range&&(i.path.length&&i.path[i.path.length-1].isNearTo(r)&&!i.path[i.path.length-1].isEqualTo(r)||!i.path.length&&t.isNearTo(r))&&i.path.push(r);for(var a=t.x,s=t.y,l=[],p=0;p<i.path.length;p++){var f=i.path[p];if(f.roomName!=e)break;var d={x:f.x,y:f.y,dx:f.x-a,dy:f.y-s,direction:y.getDirection(f.x-a,f.y-s)};a=d.x,s=d.y,l.push(d)}return n.serialize?y.serializePath(l):l}(this.name,e,t,r);var n,o=e.x,i=e.y,a=\"\";if((r=m.clone(r||{})).ignoreCreeps&&(a+=\"_ignoreCreeps\"),r.ignoreDestructibleStructures&&(a+=\"_ignoreDestructibleStructures\"),r.avoid&&(a+=\"_avoid\"+d[this.name].positionsSetCache.key(r.avoid)),r.ignore&&(a+=\"_ignore\"+d[this.name].positionsSetCache.key(r.ignore)),m.isNumber(t)){if(!d[this.name].pfEndNodes[t])return r.serialize?\"\":[];var s=T(this.name,r,t);n=d[this.name].pfDijkstraFinder.findPath(o,i,-999,-999,s)}else{if(t.roomName!=this.name)return r.serialize?\"\":[];var l=t.x,p=t.y,f=o+\",\"+i+\",\"+l+\",\"+p+a;if(d[this.name].pathCache[f])return r.serialize?y.serializePath(d[this.name].pathCache[f]):m.cloneDeep(d[this.name].pathCache[f]);if(o==l&&i==p)return r.serialize?\"\":[];if(o<0||i<0||l<0||p<0||o>=50||i>=50||l>=50||p>=50)return r.serialize?\"\":[];if(E(o-l)<2&&E(i-p)<2){var h=[{x:l,y:p,dx:l-o,dy:p-i,direction:y.getDirection(l-o,p-i)}];return r.serialize?y.serializePath(h):h}s=T(this.name,r);var _=function(e,t){t=t||{},m.defaults(t,{maxOps:2e3,heuristicWeight:1});var r=t.maxOps+\",\"+t.heuristicWeight;return d[e].pfFinders[r]||(d[e].pfFinders[r]=new R.AStarFinder({diagonalMovement:1,maxOpsLimit:t.maxOps,heuristic:R.Heuristic.chebyshev,weight:t.heuristicWeight})),d[e].pfFinders[r]}(this.name,r);s.setWalkableAt(l,p,!0),n=_.findPath(o,i,l,p,s)}n.splice(0,1);var g=o,v=i,O=m.map(n,function(e){var t={x:e[0],y:e[1],dx:e[0]-g,dy:e[1]-v,direction:y.getDirection(e[0]-g,e[1]-v)};return g=t.x,v=t.y,t});if(O.length>0){var b=O[O.length-1];f=o+\",\"+i+\",\"+b.x+\",\"+b.y+a;d[this.name].pathCache[f]=m.cloneDeep(O)}return r.serialize?y.serializePath(O):O}),b.prototype.getPositionAt=u.wrapFn(function(e,t){return e<0||e>49||t<0||t>49?null:new c.RoomPosition(e,t,this.name)}),b.prototype.createFlag=u.wrapFn(function(e,t,r,n,i){var a=y.fetchXYArguments(e,t,c),l=o(a,2),f=l[0],d=l[1];if(m.isUndefined(f)||m.isUndefined(d)||f<0||f>49||d<0||d>49)return _.ERR_INVALID_ARGS;if(m.size(c.Game.flags)>=_.FLAGS_LIMIT)return _.ERR_FULL;if(m.isObject(e)&&(i=n,n=r,r=t),n||(n=_.COLOR_WHITE),i||(i=n),!m.contains(_.COLORS_ALL,n))return _.ERR_INVALID_ARGS;if(!m.contains(_.COLORS_ALL,i))return _.ERR_INVALID_ARGS;if(!r){var h=1;do{r=\"Flag\"+h,h++}while(m.any(u.flags,{name:r})||-1!=p.indexOf(r))}return m.any(u.flags,{name:r})||-1!=p.indexOf(r)?_.ERR_NAME_EXISTS:r.length>60?_.ERR_INVALID_ARGS:(p.push(r),c.Game.flags[r]=new c.Flag(r,n,i,this.name,f,d),s.pushByName(\"room\",\"createFlag\",{roomName:this.name,x:f,y:d,name:r,color:n,secondaryColor:i}),r)}),b.prototype.createConstructionSite=u.wrapFn(function(e,t,r,n){var i=y.fetchXYArguments(e,t,c),l=o(i,2),p=l[0],d=l[1];if(m.isUndefined(p)||m.isUndefined(d)||p<0||p>49||d<0||d>49)return _.ERR_INVALID_ARGS;if(m.isString(t)&&m.isUndefined(r)&&(r=t),!_.CONSTRUCTION_COST[r])return _.ERR_INVALID_ARGS;if(\"spawn\"==r&&\"string\"==typeof n){if(-1!=f.indexOf(n))return _.ERR_INVALID_ARGS;if(m.any(u.spawns,{name:n})||m.any(u.constructionSites,{structureType:\"spawn\",name:n}))return _.ERR_INVALID_ARGS}if(this.controller&&this.controller.level>0&&!this.controller.my)return _.ERR_RCL_NOT_ENOUGH;if(!y.checkControllerAvailability(r,u.objectsByRoom[this.name],this.controller))return _.ERR_RCL_NOT_ENOUGH;if(!y.checkConstructionSite(u.objectsByRoom[this.name],r,p,d)||!y.checkConstructionSite(a.staticTerrainData[this.name],r,p,d))return _.ERR_INVALID_TARGET;if(m(a.userObjects).filter({type:\"constructionSite\"}).size()+h>=_.MAX_CONSTRUCTION_SITES)return _.ERR_FULL;var R={roomName:this.name,x:p,y:d,structureType:r};if(\"spawn\"==r){if(\"string\"!=typeof n){var E=1;do{n=\"Spawn\"+E,E++}while(m.any(u.spawns,{name:n})||m.any(u.constructionSites,{structureType:\"spawn\",name:n})||-1!=f.indexOf(n))}f.push(n),R.name=n}return h++,s.pushByName(\"room\",\"createConstructionSite\",R),_.OK}),b.prototype.getEndNodes=u.wrapFn(function(e,t){var r;if(t=t||{},m.isUndefined(e))throw new Error(\"Find type cannot be undefined\");return!t.filter&&m.isNumber(e)?r=e:(m.isNumber(e)&&(e=this.find(e,t)),r=d[this.name].positionsSetCache.key(e),d[this.name].pfEndNodes[r]=d[this.name].positionsSetCache.cache[r]),d[this.name].pfEndNodes[r]||(d[this.name].pfEndNodes[r]=m.clone(e),m.isNumber(e)&&(d[this.name].pfEndNodes[r]=this.find(e,t))),{key:r,objects:d[this.name].pfEndNodes[r]}}),b.prototype.findExitTo=u.wrapFn(function(e){return u.map.findExit(this.name,e)}),b.prototype.getTerrain=u.wrapFn(function(){return new b.Terrain(this.name)}),Object.defineProperty(c,\"Room\",{enumerable:!0,value:b});var w=u.wrapFn(function(e){this.roomName=e});w.prototype.circle=u.wrapFn(function(e,t,r){return\"object\"==(void 0===e?\"undefined\":n(e))&&(r=t,t=e.y,e=e.x),c.console.addVisual(this.roomName,{t:\"c\",x:e,y:t,s:r}),this}),w.prototype.line=u.wrapFn(function(e,t,r,o,i){return\"object\"==(void 0===e?\"undefined\":n(e))&&\"object\"==(void 0===t?\"undefined\":n(t))&&(i=r,r=t.x,o=t.y,t=e.y,e=e.x),c.console.addVisual(this.roomName,{t:\"l\",x1:e,y1:t,x2:r,y2:o,s:i}),this}),w.prototype.rect=u.wrapFn(function(e,t,r,o,i){return\"object\"==(void 0===e?\"undefined\":n(e))&&(i=o,o=r,r=t,t=e.y,e=e.x),c.console.addVisual(this.roomName,{t:\"r\",x:e,y:t,w:r,h:o,s:i}),this}),w.prototype.poly=u.wrapFn(function(e,t){return m.isArray(e)&&m.some(e)&&(e=e.map(function(e){return void 0!==e.x?[e.x,e.y]:e}),c.console.addVisual(this.roomName,{t:\"p\",points:e,s:t})),this}),w.prototype.text=u.wrapFn(function(e,t,r,o){return\"object\"==(void 0===t?\"undefined\":n(t))&&(o=r,r=t.y,t=t.x),c.console.addVisual(this.roomName,{t:\"t\",text:e,x:t,y:r,s:o}),this}),w.prototype.getSize=u.wrapFn(function(){return c.console.getVisualSize(this.roomName)}),w.prototype.clear=u.wrapFn(function(){return c.console.clearVisual(this.roomName),this}),Object.defineProperty(c,\"RoomVisual\",{enumerable:!0,value:w}),b.Terrain=u.wrapFn(function(e){e=\"\"+e;var t=(a.staticTerrainData||{})[e];if(!t)throw new Error(\"Could not access room \"+e);this.get=u.wrapFn(function(e,r){var n=t[50*r+e];return n&_.TERRAIN_MASK_WALL||n&_.TERRAIN_MASK_SWAMP||0}),this.getRawBuffer=u.wrapFn(function(e){return e?(O.call(e,t),e):new v(t)})})}function N(e,t,r,n,o,i){var s;if(\"terrain\"==t){var u=\"plain\",c=a.staticTerrainData[e][50*n+r];return c&_.TERRAIN_MASK_SWAMP&&(u=\"swamp\"),c&_.TERRAIN_MASK_WALL&&(u=\"wall\"),o?(s={type:\"terrain\",terrain:u},i&&(s.x=r,s.y=n),void o.push(s)):[u]}if(r<0||n<0||r>49||n>49)throw new Error(\"look coords are out of bounds\");var l=d[e].lookTypeSpatialRegisters[t][50*r+n];return l?o?void l.forEach(function(e){(s={type:t})[t]=e,i&&(s.x=r,s.y=n),o.push(s)}):m.clone(l):[]}function C(e,t,r,n,o,a,s,u,c){var l=d[e].lookTypeRegisters[t],p=l&&Object.keys(l);if(\"terrain\"!=t&&p.length<(o-r+1)*(a-n+1)){var f;p.forEach(function(p){var d=l[p];(function(t){return(!t.pos&&t.roomName==e||t.pos&&t.pos.roomName==e)&&t.pos&&t.pos.y>=r&&t.pos.y<=o&&t.pos.x>=n&&t.pos.x<=a||!t.pos&&t.y>=r&&t.y<=o&&t.x>=n&&t.x<=a})(d)&&(s?((f={type:t})[t]=d,u?c.push(i({x:d.x||d.pos.x,y:d.y||d.pos.y,type:t},t,d)):c[d.y||d.pos.y][d.x||d.pos.x].push(f)):u?c.push(i({x:d.x||d.pos.x,y:d.y||d.pos.y},t,d)):(c[d.y||d.pos.y][d.x||d.pos.x]=c[d.y||d.pos.y][d.x||d.pos.x]||[],c[d.y||d.pos.y][d.x||d.pos.x].push(d)))})}else for(var h=r;h<=o;h++)for(var m=n;m<=a;m++)u?N(e,t,m,h,c,!0):c[h][m]?N(e,t,m,h,c[h][m]):c[h][m]=N(e,t,m,h,void 0)}},r.makePos=function(e){if(u=e,!c.RoomPosition){var t=[];y.getRoomNameFromXY=function(e){return function(r,n){var o=r+128<<8|n+128,i=t[o];return void 0===i?t[o]=e(r,n):i}}(y.getRoomNameFromXY),t[0]=\"sim\";var r=u.wrapFn(function(e,t,r){var n=\"sim\"===r?[-128,-128]:y.roomNameToXY(r);if(n[0]+=128,n[1]+=128,n[0]<0||n[0]>256||n[0]!=n[0]||n[1]<0||n[1]>256||n[1]!=n[1]||e<0||e>49||e!=e||t<0||t>49||t!=t)throw new Error(\"Invalid arguments in RoomPosition constructor\");Object.defineProperty(this,\"__packedPos\",{enumerable:!1,value:n[0]<<24|n[1]<<16|e<<8|t,writable:!0})});Object.defineProperties(r.prototype,{x:{enumerable:!0,get:function(){return this.__packedPos>>8&255},set:function(e){if(e<0||e>49||e!=e)throw new Error(\"Invalid coordinate\");this.__packedPos=-65281&this.__packedPos|e<<8}},y:{enumerable:!0,get:function(){return 255&this.__packedPos},set:function(e){if(e<0||e>49||e!=e)throw new Error(\"Invalid coordinate\");this.__packedPos=-256&this.__packedPos|e}},roomName:{enumerable:!0,get:function(){var e=t[this.__packedPos>>>16];return void 0===e?y.getRoomNameFromXY((this.__packedPos>>>24)-128,(this.__packedPos>>>16&255)-128):e},set:function(e){var t=\"sim\"===e?[-128,-128]:y.roomNameToXY(e);if(t[0]+=128,t[1]+=128,t[0]<0||t[0]>256||t[0]!=t[0]||t[1]<0||t[1]>256||t[1]!=t[1])throw new Error(\"Invalid roomName\");this.__packedPos=65535&this.__packedPos|t[0]<<24|t[1]<<16}}}),r.prototype.toJSON=u.wrapFn(function(){return Object.assign({x:this.x,y:this.y,roomName:this.roomName},this)}),r.prototype.toString=u.wrapFn(function(){return\"[room \"+this.roomName+\" pos \"+this.x+\",\"+this.y+\"]\"}),r.prototype.inRangeTo=u.wrapFn(function(e,t,r){var n=e,o=t,i=r,a=this.roomName;if(m.isUndefined(r)){var s=e;s.pos&&(s=s.pos),n=s.x,o=s.y,a=s.roomName,i=t}return E(n-this.x)<=i&&E(o-this.y)<=i&&a==this.roomName}),r.prototype.isNearTo=u.wrapFn(function(e,t){var r=y.fetchXYArguments(e,t,c),n=o(r,3),i=n[0],a=n[1],s=n[2];return E(i-this.x)<=1&&E(a-this.y)<=1&&(!s||s==this.roomName)}),r.prototype.getDirectionTo=u.wrapFn(function(e,t){var r=y.fetchXYArguments(e,t,c),n=o(r,3),i=n[0],a=n[1],s=n[2];if(!s||s==this.roomName)return y.getDirection(i-this.x,a-this.y);var u=y.roomNameToXY(this.roomName),l=o(u,2),p=l[0],f=l[1],d=y.roomNameToXY(s),h=o(d,2),m=h[0],_=h[1];return y.getDirection(50*m+i-50*p-this.x,50*_+a-50*f-this.y)}),r.prototype.findPathTo=u.wrapFn(function(e,t,r){var n=y.fetchXYArguments(e,t,c),i=o(n,3),a=i[0],s=i[1],l=i[2],p=u.rooms[this.roomName];if(m.isObject(t)&&(r=m.clone(t)),r=r||{},l=l||this.roomName,!p)throw new Error(\"Could not access room \"+this.roomName);if(l==this.roomName||u._useNewPathFinder)return p.findPath(this,new c.RoomPosition(a,s,l),r);var f=p.findExitTo(l);if(f<0)return[];var d=this.findClosestByPath(f,r);return d?p.findPath(this,d,r):[]}),r.prototype.findClosestByPath=u.wrapFn(function(e,t){var r=this;t=m.clone(t||{});var n=u.rooms[this.roomName];if(!n)throw new Error(\"Could not access room \"+this.roomName);if(m.isUndefined(e))return null;if(u._useNewPathFinder)return function(e,t,r){if(r=r||{},m.isNumber(t)?t=u.rooms[e.roomName].find(t,{filter:r.filter}):r.filter&&(t=m.filter(t,r.filter)),!t.length)return null;var n=m.find(t,function(t){return e.isEqualTo(t)});if(n)return n;var o=m.map(t,function(e){return e.pos&&(e=e.pos),{range:1,pos:e}});r.avoid&&u.deprecated(\"`avoid` option cannot be used when `PathFinder.use()` is enabled. Use `costCallback` instead.\"),r.ignore&&u.deprecated(\"`ignore` option cannot be used when `PathFinder.use()` is enabled. Use `costCallback` instead.\");var i={roomCallback:function(e){if(u.objectsByRoom[e]){var t=A(e,r);if(\"function\"==typeof r.costCallback){t=t.clone();var n=r.costCallback(e,t);n instanceof c.PathFinder.CostMatrix&&(t=n)}return t}},maxOps:r.maxOps,maxRooms:1};r.ignoreRoads||(i.plainCost=2,i.swampCost=10);var a=c.PathFinder.search(e,o,i),s=null,l=e;return a.path.length&&(l=a.path[a.path.length-1]),t.forEach(function(e){l.isNearTo(e)&&(s=e)}),s}(this,e,t);t.serialize=!1;var o,i=null,a=n.getEndNodes(e,t);if(!t.algorithm){var s,l=0;a.objects.forEach(function(e){var t=e.x,n=e.y;e.roomName;e.pos&&(t=e.pos.x,n=e.pos.y,e.pos.roomName);var o=g(E(r.x-t),E(r.y-n));(m.isUndefined(s)||s>o)&&(s=o),l+=o}),t.algorithm=l>10*s?\"dijkstra\":\"astar\"}if(\"dijkstra\"==t.algorithm&&(o=1,a.objects.forEach(function(e){var t=r.isEqualTo(e)?-1:r.isNearTo(e)?0:1;t<o&&(i=e,o=t)}),1==o)){var p=n.findPath(this,a.key,t);if(p.length>0){var f=p[p.length-1],d=n.getPositionAt(f.x,f.y);i=m.find(a.objects,function(e){return d.isEqualTo(e)})}}return\"astar\"==t.algorithm&&a.objects.forEach(function(e){var a,s=r.isEqualTo(e)?-1:r.isNearTo(e)?0:(a=r.findPathTo(e,t))&&a.length>0&&n.getPositionAt(a[a.length-1].x,a[a.length-1].y).isNearTo(e)?a.length:void 0;(m.isUndefined(o)||s<=o)&&!m.isUndefined(s)&&(o=s,i=e)}),i}),r.prototype.findInRange=u.wrapFn(function(e,t,r){var n=this,o=u.rooms[this.roomName];if(!o)throw new Error(\"Could not access room \"+this.roomName);r=m.clone(r||{});var i=[],a=[];return m.isNumber(e)&&(i=o.find(e,r)),m.isArray(e)&&(i=r.filter?m.filter(e,r.filter):e),i.forEach(function(e){n.inRangeTo(e,t)&&a.push(e)}),a}),r.prototype.findClosestByRange=u.wrapFn(function(e,t){var r=this,n=u.rooms[this.roomName];if(!n)throw new Error(\"Could not access room \"+this.roomName);t=m.clone(t||{});var o=[];m.isNumber(e)&&(o=n.find(e,t)),m.isArray(e)&&(o=t.filter?m.filter(e,t.filter):e);var i=null,a=1/0;return o.forEach(function(e){var t=r.getRangeTo(e);t<a&&(a=t,i=e)}),i}),r.prototype.isEqualTo=u.wrapFn(function(e,t){if(void 0!==e.__packedPos)return e.__packedPos===this.__packedPos;var r=y.fetchXYArguments(e,t,c),n=o(r,3),i=n[0],a=n[1],s=n[2];return i==this.x&&a==this.y&&(!s||s==this.roomName)}),r.prototype.getRangeTo=u.wrapFn(function(e,t){var r=y.fetchXYArguments(e,t,c),n=o(r,3),i=n[0],a=n[1],s=n[2];return s&&s!=this.roomName?1/0:g(E(this.x-i),E(this.y-a))}),r.prototype.look=u.wrapFn(function(){var e=u.rooms[this.roomName];if(!e)throw new Error(\"Could not access room \"+this.roomName);return e.lookAt(this)}),r.prototype.lookFor=u.wrapFn(function(e){if(\"terrain\"==e){var t=a.staticTerrainData[this.roomName][50*this.y+this.x];return t&_.TERRAIN_MASK_WALL?[\"wall\"]:t&_.TERRAIN_MASK_SWAMP?[\"swamp\"]:[\"plain\"]}var r=u.rooms[this.roomName];if(!r)throw new Error(\"Could not access room \"+this.roomName);return r.lookForAt(e,this)}),r.prototype.createFlag=u.wrapFn(function(e,t,r){var n=u.rooms[this.roomName];if(!n)throw new Error(\"Could not access room \"+this.roomName);return n.createFlag(this,e,t,r)}),r.prototype.createConstructionSite=u.wrapFn(function(e,t){var r=u.rooms[this.roomName];if(!r)throw new Error(\"Could not access room \"+this.roomName);return r.createConstructionSite(this.x,this.y,e,t)}),Object.defineProperty(c,\"RoomPosition\",{enumerable:!0,value:r});var n=u.wrapFn(function(e,t,r,n){this.room=u.rooms[r],this.pos=new c.RoomPosition(e,t,r),n&&(this.effects=m(n).map(function(e){return{power:e.power,level:e.level,ticksRemaining:e.endTime-a.time}}).filter(function(e){return e.ticksRemaining>0}).value())});Object.defineProperty(c,\"RoomObject\",{enumerable:!0,value:n})}}},{\"./../utils\":184,\"@screeps/pathfinding\":37,lodash:61}],32:[function(e,t,r){\"use strict\";var n,o,i,a=e(\"./../utils\");e(\"./rooms\"),a.getRuntimeDriver().constants;r.make=function(e,t,r,s){if(n=e,t,o=r,!(i=s).Source){var u=function(e){if(!n.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return n.roomObjects[e]},c=o.wrapFn(function(e){var t=u(e);i.RoomObject.call(this,t.x,t.y,t.room,t.effects),this.id=e});c.prototype=Object.create(i.RoomObject.prototype),c.prototype.constructor=c,a.defineGameObjectProperties(c.prototype,u,{energy:function(e){return e.energy},energyCapacity:function(e){return e.energyCapacity},ticksToRegeneration:function(e){return e.nextRegenerationTime?e.nextRegenerationTime-n.time:void 0}}),c.prototype.toString=o.wrapFn(function(){return\"[source #\"+this.id+\"]\"}),Object.defineProperty(i,\"Source\",{enumerable:!0,value:c})}}},{\"./../utils\":184,\"./rooms\":31}],33:[function(e,t,r){\"use strict\";var n,o,i,a,s,u,c=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),l=e(\"./../utils\"),p=(e(\"./rooms\"),l.getRuntimeDriver().constants),f=e(\"lodash\");function d(e){if(!n.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return n.roomObjects[e]}function h(e){var t={energy:0};return p.RESOURCES_ALL.forEach(function(r){e[r]&&(t[r]=e[r])}),t}function m(e,t,r){return i.deprecated(\"`Structure*.transfer` is considered deprecated and will be removed soon. Please use `Creep.withdraw` instead.\"),e&&e.id&&i.creeps[e.id]&&e instanceof a.Creep&&!e.spawning?e.my?!1===this.my&&f.any(this.pos.lookFor(\"structure\"),function(e){return e.structureType==p.STRUCTURE_RAMPART})?p.ERR_NOT_OWNER:this.room.controller&&!this.room.controller.my&&this.room.controller.safeMode?p.ERR_NOT_OWNER:d(this.id)[t]?(r||(r=Math.min(d(this.id)[t],d(e.id).energyCapacity-l.calcResources(d(e.id)))),d(this.id)[t]<r||r<0?p.ERR_NOT_ENOUGH_ENERGY:d(e.id).energyCapacity&&(!r||l.calcResources(d(e.id))+r>d(e.id).energyCapacity)?p.ERR_FULL:e.pos.isNearTo(this.pos)?(o.set(d(this.id)._id,\"transfer\",{id:e.id,amount:r,resourceType:t}),p.OK):p.ERR_NOT_IN_RANGE):p.ERR_NOT_ENOUGH_ENERGY:p.ERR_NOT_OWNER:(i.assertTargetObject(e),p.ERR_INVALID_TARGET)}function y(e,t){return i.deprecated(\"`Structure*.transferEnergy` is considered deprecated and will be removed soon. Please use `Creep.withdraw` instead.\"),e&&e.id&&i.creeps[e.id]&&e instanceof a.Creep&&!e.spawning?e.my?!1===this.my&&f.any(this.pos.lookFor(\"structure\"),function(e){return e.structureType==p.STRUCTURE_RAMPART})?p.ERR_NOT_OWNER:d(this.id).energy?(t||(t=d(e.id).energyCapacity?Math.min(d(this.id).energy,d(e.id).energyCapacity-l.calcResources(d(e.id))):d(this.id).energy),this.energy<t||t<0?p.ERR_NOT_ENOUGH_ENERGY:d(e.id).energyCapacity&&(!t||l.calcResources(d(e.id))+t>d(e.id).energyCapacity)?p.ERR_FULL:e.pos.isNearTo(this.pos)?(o.set(this.id,\"transfer\",{id:e.id,amount:t,resourceType:\"energy\"}),p.OK):p.ERR_NOT_IN_RANGE):p.ERR_NOT_ENOUGH_ENERGY:p.ERR_NOT_OWNER:(i.assertTargetObject(e),p.ERR_INVALID_TARGET)}r.make=function(t,r,_,R){if(n=t,o=r,i=_,s=[],u=null,!(a=R).Structure){var E=i.wrapFn(function(e){var t=d(e);a.RoomObject.call(this,t.x,t.y,t.room,t.effects),this.id=e;var r=d(e);r.type==p.STRUCTURE_CONTROLLER&&(i.rooms[r.room].controller=this),r.type==p.STRUCTURE_STORAGE&&(i.rooms[r.room].storage=this),r.type==p.STRUCTURE_TERMINAL&&(i.rooms[r.room].terminal=this)});E.prototype=Object.create(a.RoomObject.prototype),E.prototype.constructor=E,l.defineGameObjectProperties(E.prototype,d,{hits:function(e){return e.hits},hitsMax:function(e){return e.hitsMax},structureType:function(e){return e.type}}),E.prototype.toString=i.wrapFn(function(){return\"[structure (\"+d(this.id).type+\") #\"+this.id+\"]\"}),E.prototype.destroy=i.wrapFn(function(){return this.room.controller&&this.room.controller.my?this.room.find(p.FIND_HOSTILE_CREEPS).length>0||this.room.find(p.FIND_HOSTILE_POWER_CREEPS).length>0?p.ERR_BUSY:(o.pushByName(\"room\",\"destroyStructure\",{roomName:this.room.name,id:this.id}),p.OK):p.ERR_NOT_OWNER}),E.prototype.notifyWhenAttacked=i.wrapFn(function(e){return!1===this.my||this.room.controller&&this.room.controller.owner&&!this.room.controller.my?p.ERR_NOT_OWNER:f.isBoolean(e)?(e!=d(this.id).notifyWhenAttacked&&o.set(this.id,\"notifyWhenAttacked\",{enabled:e}),p.OK):p.ERR_INVALID_ARGS}),E.prototype.isActive=i.wrapFn(function(){return!this.owner||(!p.CONTROLLER_STRUCTURES[d(this.id).type]||!!this.room.controller&&l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id)))}),Object.defineProperty(a,\"Structure\",{enumerable:!0,value:E});var g=i.wrapFn(function(e){E.call(this,e)});g.prototype=Object.create(E.prototype),g.prototype.constructor=g,l.defineGameObjectProperties(g.prototype,d,{owner:function(e){return f.isUndefined(e.user)||null===e.user?void 0:{username:n.users[e.user].username}},my:function(e){return f.isUndefined(e.user)?void 0:e.user==n.user._id}}),Object.defineProperty(a,\"OwnedStructure\",{enumerable:!0,value:g});var v=i.wrapFn(function(e){E.call(this,e)});v.prototype=Object.create(E.prototype),v.prototype.constructor=v,l.defineGameObjectProperties(v.prototype,d,{store:h,storeCapacity:function(e){return e.energyCapacity},ticksToDecay:function(e){return e.nextDecayTime?e.nextDecayTime-n.time:e.decayTime?e.decayTime-n.time:void 0}}),v.prototype.transfer=i.wrapFn(m),Object.defineProperty(a,\"StructureContainer\",{enumerable:!0,value:v});var O=i.wrapFn(function(e){g.call(this,e)});O.prototype=Object.create(g.prototype),O.prototype.constructor=O,l.defineGameObjectProperties(O.prototype,d,{ticksToDowngrade:function(e){return e.downgradeTime?e.downgradeTime-n.time:void 0},reservation:function(e){return e.reservation?{username:n.users[e.reservation.user].username,ticksToEnd:e.reservation.endTime-n.time}:void 0},level:function(e){return e.level},progress:function(e){return e.level>0?e.progress:void 0},progressTotal:function(e){return e.level>0&&e.level<8?p.CONTROLLER_LEVELS[e.level]:void 0},upgradeBlocked:function(e){return e.upgradeBlocked&&e.upgradeBlocked>n.time?e.upgradeBlocked-n.time:void 0},safeMode:function(e){return e.safeMode&&e.safeMode>n.time?e.safeMode-n.time:void 0},safeModeCooldown:function(e){return e.safeModeCooldown&&e.safeModeCooldown>n.time?e.safeModeCooldown-n.time:void 0},safeModeAvailable:function(e){return e.safeModeAvailable||0},sign:function(e){return e.hardSign?{username:p.SYSTEM_USERNAME,text:e.hardSign.text,time:e.hardSign.time,datetime:new Date(e.hardSign.datetime)}:e.sign?{username:n.users[e.sign.user].username,text:e.sign.text,time:e.sign.time,datetime:new Date(e.sign.datetime)}:void 0},isPowerEnabled:function(e){return!!e.isPowerEnabled}}),O.prototype.unclaim=i.wrapFn(function(){return this.my?(o.set(this.id,\"unclaim\",{}),p.OK):p.ERR_NOT_OWNER}),O.prototype.activateSafeMode=i.wrapFn(function(){return this.my?this.safeModeAvailable<=0?p.ERR_NOT_ENOUGH_RESOURCES:this.safeModeCooldown||this.upgradeBlocked>0||this.ticksToDowngrade<p.CONTROLLER_DOWNGRADE[this.level]/2-p.CONTROLLER_DOWNGRADE_SAFEMODE_THRESHOLD?p.ERR_TIRED:f.any(i.structures,function(e){return\"controller\"==e.structureType&&e.my&&e.safeMode})?p.ERR_BUSY:(u&&o.remove(u,\"activateSafeMode\"),u=this.id,o.set(this.id,\"activateSafeMode\",{}),p.OK):p.ERR_NOT_OWNER}),Object.defineProperty(a,\"StructureController\",{enumerable:!0,value:O});var T=i.wrapFn(function(e){g.call(this,e)});T.prototype=Object.create(g.prototype),T.prototype.constructor=T,l.defineGameObjectProperties(T.prototype,d,{energy:function(e){return e.energy},energyCapacity:function(e){return e.energyCapacity}}),T.prototype.transferEnergy=i.wrapFn(y),Object.defineProperty(a,\"StructureExtension\",{enumerable:!0,value:T});var A=i.wrapFn(function(e){g.call(this,e)});A.prototype=Object.create(g.prototype),A.prototype.constructor=A,l.defineGameObjectProperties(A.prototype,d,{cooldown:function(e){return e.cooldown||0}}),Object.defineProperty(a,\"StructureExtractor\",{enumerable:!0,value:A});var b=i.wrapFn(function(e){g.call(this,e)});b.prototype=Object.create(g.prototype),b.prototype.constructor=b,l.defineGameObjectProperties(b.prototype,d,{my:function(){return!1},owner:function(){return{username:\"Source Keeper\"}},ticksToSpawn:function(e){return e.nextSpawnTime?e.nextSpawnTime-n.time:void 0}}),Object.defineProperty(a,\"StructureKeeperLair\",{enumerable:!0,value:b});var w=i.wrapFn(function(e){g.call(this,e)});w.prototype=Object.create(g.prototype),w.prototype.constructor=w,l.defineGameObjectProperties(w.prototype,d,{energy:function(e){return e.energy},energyCapacity:function(e){return e.energyCapacity},cooldown:function(e){return e.cooldown||0},mineralAmount:function(e){return e.mineralAmount},mineralCapacity:function(e){return e.mineralCapacity},mineralType:function(e){return e.mineralType}}),w.prototype.transfer=i.wrapFn(function(e,t,r){if(!e||!e.id||!i.creeps[e.id]||!(e instanceof a.Creep)||e.spawning)return i.assertTargetObject(e),p.ERR_INVALID_TARGET;if(!e.my)return p.ERR_NOT_OWNER;if(!1===this.my&&f.any(this.pos.lookFor(\"structure\"),function(e){return e.structureType==p.STRUCTURE_RAMPART}))return p.ERR_NOT_OWNER;if(t!=p.RESOURCE_ENERGY&&d(this.id).mineralType!=t)return p.ERR_INVALID_ARGS;var n=t==p.RESOURCE_ENERGY?d(this.id).energy:d(this.id).mineralAmount;return n?(r||(r=Math.min(n,d(e.id).energyCapacity-l.calcResources(d(e.id)))),n<r||r<0?p.ERR_NOT_ENOUGH_ENERGY:d(e.id).energyCapacity&&(!r||l.calcResources(d(e.id))+r>d(e.id).energyCapacity)?p.ERR_FULL:e.pos.isNearTo(this.pos)?(o.set(d(this.id)._id,\"transfer\",{id:e.id,amount:r,resourceType:t}),p.OK):p.ERR_NOT_IN_RANGE):p.ERR_NOT_ENOUGH_RESOURCES}),w.prototype.runReaction=i.wrapFn(function(e,t){if(!this.my)return p.ERR_NOT_OWNER;if(this.cooldown>0)return p.ERR_TIRED;if(!l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id)))return p.ERR_RCL_NOT_ENOUGH;if(!(e&&e.id&&i.structures[e.id]&&e instanceof a.Structure&&e.structureType==p.STRUCTURE_LAB&&e.id!=this.id))return i.assertTargetObject(e),p.ERR_INVALID_TARGET;if(!(t&&e.id&&i.structures[t.id]&&t instanceof a.Structure&&t.structureType==p.STRUCTURE_LAB&&t.id!=this.id))return i.assertTargetObject(t),p.ERR_INVALID_TARGET;if(this.pos.getRangeTo(e)>2||this.pos.getRangeTo(t)>2)return p.ERR_NOT_IN_RANGE;var r=p.LAB_REACTION_AMOUNT,n=f.find(this.effects,function(e){return e.power==p.PWR_OPERATE_LAB});return n&&n.ticksRemaining>0&&(r+=p.POWER_INFO[p.PWR_OPERATE_LAB].effect[n.level-1]),this.mineralAmount>this.mineralCapacity-r?p.ERR_FULL:e.mineralAmount<r||t.mineralAmount<r?p.ERR_NOT_ENOUGH_RESOURCES:e.mineralType in p.REACTIONS&&p.REACTIONS[e.mineralType][t.mineralType]&&(!this.mineralType||this.mineralType==p.REACTIONS[e.mineralType][t.mineralType])?(o.set(this.id,\"runReaction\",{lab1:e.id,lab2:t.id}),p.OK):p.ERR_INVALID_ARGS}),w.prototype.boostCreep=i.wrapFn(function(e,t){var r=this;if(!this.my)return p.ERR_NOT_OWNER;if(!l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id)))return p.ERR_RCL_NOT_ENOUGH;if(!e||!e.id||!i.creeps[e.id]||!(e instanceof a.Creep)||e.spawning)return i.assertTargetObject(e),p.ERR_INVALID_TARGET;if(!this.pos.isNearTo(e))return p.ERR_NOT_IN_RANGE;if(d(this.id).energy<p.LAB_BOOST_ENERGY)return p.ERR_NOT_ENOUGH_RESOURCES;if(d(this.id).mineralAmount<p.LAB_BOOST_MINERAL)return p.ERR_NOT_ENOUGH_RESOURCES;t=t||0;var n=f(e.body).filter(function(e){return!e.boost&&p.BOOSTS[e.type]&&p.BOOSTS[e.type][d(r.id).mineralType]}).size();return!n||t&&t>n?p.ERR_NOT_FOUND:(o.set(this.id,\"boostCreep\",{id:e.id,bodyPartsCount:t}),p.OK)}),w.prototype.unboostCreep=i.wrapFn(function(e){return e&&e.id&&i.creeps[e.id]&&e instanceof a.Creep?this.my&&e.my?l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id))?this.cooldown>0?p.ERR_TIRED:f.some(e.body,function(e){return!!e.boost})?this.pos.isNearTo(e)?(o.set(this.id,\"unboostCreep\",{id:e.id}),p.OK):p.ERR_NOT_IN_RANGE:p.ERR_NOT_FOUND:p.ERR_RCL_NOT_ENOUGH:p.ERR_NOT_OWNER:(i.assertTargetObject(e),p.ERR_INVALID_TARGET)}),Object.defineProperty(a,\"StructureLab\",{enumerable:!0,value:w});var N=i.wrapFn(function(e){g.call(this,e)});N.prototype=Object.create(g.prototype),N.prototype.constructor=N,l.defineGameObjectProperties(N.prototype,d,{energy:function(e){return e.energy},energyCapacity:function(e){return e.energyCapacity},cooldown:function(e){return e.cooldown||0}}),N.prototype.transferEnergy=i.wrapFn(function(e,t){if(t<0)return p.ERR_INVALID_ARGS;if(!(e&&e.id&&(i.structures[e.id]||i.creeps[e.id])&&(e instanceof a.Structure||e instanceof a.Creep&&e.spawning)&&e!==this))return i.assertTargetObject(e),p.ERR_INVALID_TARGET;if(!e.my)return p.ERR_NOT_OWNER;if(!1===this.my&&f.any(this.pos.lookFor(\"structure\"),function(e){return e.structureType==p.STRUCTURE_RAMPART}))return p.ERR_NOT_OWNER;if(e instanceof a.Structure){if(e.structureType!=p.STRUCTURE_LINK)return i.assertTargetObject(e),p.ERR_INVALID_TARGET;if(this.cooldown>0)return p.ERR_TIRED;if(!this.room.controller)return p.ERR_RCL_NOT_ENOUGH;if(!l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id)))return p.ERR_RCL_NOT_ENOUGH}return e instanceof a.Creep&&(i.deprecated(\"`StructureLink.transferEnergy` applied to creeps is considered deprecated and will be removed soon. Please use `Creep.withdraw` instead.\"),!this.pos.isNearTo(e))?p.ERR_NOT_IN_RANGE:d(this.id).energy?(t||(t=d(e.id).energyCapacity?Math.min(d(this.id).energy,d(e.id).energyCapacity-d(e.id).energy):d(this.id).energy),this.energy<t?p.ERR_NOT_ENOUGH_ENERGY:d(e.id).energyCapacity&&(!t||d(e.id).energy+t>d(e.id).energyCapacity)?p.ERR_FULL:e.pos.roomName!=this.pos.roomName?p.ERR_NOT_IN_RANGE:(o.set(this.id,\"transfer\",{id:e.id,amount:t,resourceType:\"energy\"}),p.OK)):p.ERR_NOT_ENOUGH_ENERGY}),Object.defineProperty(a,\"StructureLink\",{enumerable:!0,value:N});var C=i.wrapFn(function(e){g.call(this,e)});C.prototype=Object.create(g.prototype),C.prototype.constructor=C,C.prototype.observeRoom=i.wrapFn(function(e){if(!this.my)return p.ERR_NOT_OWNER;if(!f.isString(e)||!/^(W|E)\\d+(S|N)\\d+$/.test(e))return p.ERR_INVALID_ARGS;if(!l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id)))return p.ERR_RCL_NOT_ENOUGH;var t=l.roomNameToXY(e),r=c(t,2),n=r[0],a=r[1],s=l.roomNameToXY(d(this.id).room),u=c(s,2),h=u[0],m=u[1],y=f.find(this.effects,function(e){return e.power==p.PWR_OPERATE_OBSERVER});return(!y||y.ticksRemaining<=0)&&(Math.abs(n-h)>p.OBSERVER_RANGE||Math.abs(a-m)>p.OBSERVER_RANGE)?p.ERR_NOT_IN_RANGE:(o.set(this.id,\"observeRoom\",{roomName:e}),p.OK)}),Object.defineProperty(a,\"StructureObserver\",{enumerable:!0,value:C});var S=i.wrapFn(function(e){g.call(this,e)});S.prototype=Object.create(g.prototype),S.prototype.constructor=S,l.defineGameObjectProperties(S.prototype,d,{power:function(e){return e.power},ticksToDecay:function(e){return e.nextDecayTime?e.nextDecayTime-n.time:e.decayTime?e.decayTime-n.time:void 0},my:function(){return!1},owner:function(){return{username:\"Power Bank\"}}}),Object.defineProperty(a,\"StructurePowerBank\",{enumerable:!0,value:S});var I=i.wrapFn(function(e){g.call(this,e)});I.prototype=Object.create(g.prototype),I.prototype.constructor=I,l.defineGameObjectProperties(I.prototype,d,{energy:function(e){return e.energy},energyCapacity:function(e){return e.energyCapacity},power:function(e){return e.power},powerCapacity:function(e){return e.powerCapacity}}),I.prototype.transferEnergy=i.wrapFn(y),I.prototype.processPower=i.wrapFn(function(){if(!this.my)return p.ERR_NOT_OWNER;if(!l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id)))return p.ERR_RCL_NOT_ENOUGH;var e=1,t=f.find(this.effects,function(e){return e.power==p.PWR_OPERATE_POWER});return t&&t.ticksRemaining>0&&(e+=p.POWER_INFO[p.PWR_OPERATE_POWER].effect[t.level-1]),this.power<e||this.energy<e*p.POWER_SPAWN_ENERGY_RATIO?p.ERR_NOT_ENOUGH_RESOURCES:(o.set(this.id,\"processPower\",{}),p.OK)}),Object.defineProperty(a,\"StructurePowerSpawn\",{enumerable:!0,value:I});var x=i.wrapFn(function(e){g.call(this,e)});x.prototype=Object.create(g.prototype),x.prototype.constructor=x,l.defineGameObjectProperties(x.prototype,d,{ticksToDecay:function(e){return e.nextDecayTime?e.nextDecayTime-n.time:e.decayTime?e.decayTime-n.time:void 0},isPublic:function(e){return!!e.isPublic}}),x.prototype.setPublic=i.wrapFn(function(e){return this.my?(o.set(this.id,\"setPublic\",{isPublic:!!e}),p.OK):p.ERR_NOT_OWNER}),Object.defineProperty(a,\"StructureRampart\",{enumerable:!0,value:x});var L=i.wrapFn(function(e){E.call(this,e)});L.prototype=Object.create(E.prototype),L.prototype.constructor=L,l.defineGameObjectProperties(L.prototype,d,{ticksToDecay:function(e){return e.nextDecayTime?e.nextDecayTime-n.time:e.decayTime?e.decayTime-n.time:void 0}}),Object.defineProperty(a,\"StructureRoad\",{enumerable:!0,value:L});var P=i.wrapFn(function(e){g.call(this,e)});P.prototype=Object.create(g.prototype),P.prototype.constructor=P,l.defineGameObjectProperties(P.prototype,d,{store:h,storeCapacity:function(e){return e.energyCapacity}}),P.prototype.transfer=i.wrapFn(m),Object.defineProperty(a,\"StructureStorage\",{enumerable:!0,value:P});var M=i.wrapFn(function(e){g.call(this,e)});M.prototype=Object.create(g.prototype),M.prototype.constructor=M,l.defineGameObjectProperties(M.prototype,d,{store:h,storeCapacity:function(e){return e.energyCapacity},cooldown:function(e){return e.cooldownTime&&e.cooldownTime>n.time?e.cooldownTime-n.time:0}}),M.prototype.transfer=i.wrapFn(m),M.prototype.send=i.wrapFn(function(e,t,r,a){if(!this.my)return p.ERR_NOT_OWNER;if(!l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id)))return p.ERR_RCL_NOT_ENOUGH;if(!/^(W|E)\\d+(N|S)\\d+$/.test(r))return p.ERR_INVALID_ARGS;if(!f.contains(p.RESOURCES_ALL,e))return p.ERR_INVALID_ARGS;if(t<p.TERMINAL_MIN_SEND)return p.ERR_INVALID_ARGS;if(!d(this.id)[e]||d(this.id)[e]<t)return p.ERR_NOT_ENOUGH_RESOURCES;if(d(this.id).cooldownTime>n.time)return p.ERR_TIRED;var s=l.calcRoomsDistance(d(this.id).room,r,!0),u=l.calcTerminalEnergyCost(t,s);return e!=p.RESOURCE_ENERGY&&d(this.id).energy<u||e==p.RESOURCE_ENERGY&&d(this.id).energy<t+u?p.ERR_NOT_ENOUGH_RESOURCES:a&&(!f.isString(a)||a.length>100)?p.ERR_INVALID_ARGS:(o.set(this.id,\"send\",{resourceType:e,amount:t,targetRoomName:r,description:a}),p.OK)}),Object.defineProperty(a,\"StructureTerminal\",{enumerable:!0,value:M});var k=i.wrapFn(function(e){g.call(this,e)});k.prototype=Object.create(g.prototype),k.prototype.constructor=k,l.defineGameObjectProperties(k.prototype,d,{energy:function(e){return e.energy},energyCapacity:function(e){return e.energyCapacity}}),k.prototype.transferEnergy=i.wrapFn(y),k.prototype.attack=i.wrapFn(function(e){return this.my?e&&e.id&&(i.creeps[e.id]||i.powerCreeps[e.id]||i.structures[e.id])&&(e instanceof a.Creep||e instanceof a.PowerCreep||e instanceof a.StructureSpawn||e instanceof a.Structure)?d(this.id).energy<p.TOWER_ENERGY_COST?p.ERR_NOT_ENOUGH_ENERGY:l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id))?(o.set(this.id,\"attack\",{id:e.id}),p.OK):p.ERR_RCL_NOT_ENOUGH:(i.assertTargetObject(e),p.ERR_INVALID_TARGET):p.ERR_NOT_OWNER}),k.prototype.heal=i.wrapFn(function(e){return this.my?e&&e.id&&(i.creeps[e.id]||i.powerCreeps[e.id])&&(e instanceof a.Creep||e instanceof a.PowerCreep)?d(this.id).energy<p.TOWER_ENERGY_COST?p.ERR_NOT_ENOUGH_ENERGY:l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id))?(o.set(this.id,\"heal\",{id:e.id}),p.OK):p.ERR_RCL_NOT_ENOUGH:(i.assertTargetObject(e),p.ERR_INVALID_TARGET):p.ERR_NOT_OWNER}),k.prototype.repair=i.wrapFn(function(e){return this.my?e&&e.id&&i.structures[e.id]&&(e instanceof a.Structure||e instanceof a.StructureSpawn)?d(this.id).energy<p.TOWER_ENERGY_COST?p.ERR_NOT_ENOUGH_ENERGY:l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id))?(o.set(this.id,\"repair\",{id:e.id}),p.OK):p.ERR_RCL_NOT_ENOUGH:(i.assertTargetObject(e),p.ERR_INVALID_TARGET):p.ERR_NOT_OWNER}),Object.defineProperty(a,\"StructureTower\",{enumerable:!0,value:k});var D=i.wrapFn(function(e){E.call(this,e)});D.prototype=Object.create(E.prototype),D.prototype.constructor=D,l.defineGameObjectProperties(D.prototype,d,{ticksToLive:function(e){return e.ticksToLive}}),Object.defineProperty(a,\"StructureWall\",{enumerable:!0,value:D});var U=i.wrapFn(function(e){g.call(this,e)});U.prototype=Object.create(g.prototype),U.prototype.constructor=U,l.defineGameObjectProperties(U.prototype,d,{name:function(e){return e.name},energy:function(e){return e.energy},energyCapacity:function(e){return e.energyCapacity},spawning:function(e,t){return e.spawning?new U.Spawning(t):null}}),Object.defineProperty(U.prototype,\"memory\",{get:function(){if(this.my&&((f.isUndefined(a.Memory.spawns)||\"undefined\"===a.Memory.spawns)&&(a.Memory.spawns={}),f.isObject(a.Memory.spawns)))return a.Memory.spawns[d(this.id).name]=a.Memory.spawns[d(this.id).name]||{}},set:function(e){if(!this.my)throw new Error(\"Could not set other player's spawn memory\");if((f.isUndefined(a.Memory.spawns)||\"undefined\"===a.Memory.spawns)&&(a.Memory.spawns={}),!f.isObject(a.Memory.spawns))throw new Error(\"Could not set spawn memory\");a.Memory.spawns[d(this.id).name]=e}}),U.prototype.toString=i.wrapFn(function(){return\"[spawn \"+(d(this.id).user==n.user._id?d(this.id).name:\"#\"+this.id)+\"]\"}),U.prototype.canCreateCreep=i.wrapFn(function(e,t){if(!this.my)return p.ERR_NOT_OWNER;if(d(this.id).spawning)return p.ERR_BUSY;if(!e||!f.isArray(e)||0==e.length||e.length>p.MAX_CREEP_SIZE)return p.ERR_INVALID_ARGS;for(var r=0;r<e.length;r++)if(!f.contains(p.BODYPARTS_ALL,e[r]))return p.ERR_INVALID_ARGS;return this.room.energyAvailable<l.calcCreepCost(e)?p.ERR_NOT_ENOUGH_ENERGY:n.roomObjects[this.id].off?p.ERR_RCL_NOT_ENOUGH:t&&(a.Game.creeps[t]||-1!=s.indexOf(t))?p.ERR_NAME_EXISTS:p.OK}),U.prototype.createCreep=i.wrapFn(function(t,r,i){var u=this;f.isObject(r)&&f.isUndefined(i)&&(i=r,r=void 0);var c=this.canCreateCreep(t,r);return c!=p.OK?c:(r||(r=e(\"./names\").getUniqueName(function(e){return f.any(n.roomObjects,{type:\"creep\",user:d(u.id).user,name:e})||-1!=s.indexOf(e)})),s.push(r),f.isUndefined(a.Memory.creeps)&&(a.Memory.creeps={}),f.isObject(a.Memory.creeps)&&(f.isUndefined(i)?a.Memory.creeps[r]=a.Memory.creeps[r]||{}:a.Memory.creeps[r]=i),a.Game.creeps[r]=new a.Creep,a.RoomObject.call(a.Game.creeps[r],this.pos.x,this.pos.y,this.pos.roomName),Object.defineProperties(a.Game.creeps[r],{name:{enumerable:!0,get:function(){return r}},spawning:{enumerable:!0,get:function(){return!0}},my:{enumerable:!0,get:function(){return!0}},body:{enumerable:!0,get:function(){return f.map(t,function(e){return{type:e,hits:100}})}},owner:{enumerable:!0,get:function(){return new Object({username:n.user.username})}},ticksToLive:{enumerable:!0,get:function(){return p.CREEP_LIFE_TIME}},carryCapacity:{enumerable:!0,get:function(){return f.reduce(t,function(e,t){return e+(t==p.CARRY?p.CARRY_CAPACITY:0)},0)}},carry:{enumerable:!0,get:function(){return{energy:0}}},fatigue:{enumerable:!0,get:function(){return 0}},hits:{enumerable:!0,get:function(){return 100*t.length}},hitsMax:{enumerable:!0,get:function(){return 100*t.length}},saying:{enumerable:!0,get:function(){}}}),o.set(this.id,\"createCreep\",{name:r,body:t}),r)}),U.prototype.spawnCreep=i.wrapFn(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||!f.isObject(r))return p.ERR_INVALID_ARGS;if(a.Game.creeps[t]||-1!=s.indexOf(t))return p.ERR_NAME_EXISTS;var i=r.energyStructures&&f.uniq(f.map(r.energyStructures,\"id\")),u=r.directions;if(void 0!==u){if(!f.isArray(u))return p.ERR_INVALID_ARGS;if(0==(u=f.uniq(f.map(u,function(e){return+e}))).length||!f.all(u,function(e){return e>=1&&e<=8&&e===(0|e)}))return p.ERR_INVALID_ARGS}if(!this.my)return p.ERR_NOT_OWNER;if(d(this.id).spawning)return p.ERR_BUSY;if(d(this.id).off)return p.ERR_RCL_NOT_ENOUGH;if(!e||!f.isArray(e)||0===e.length||e.length>p.MAX_CREEP_SIZE)return p.ERR_INVALID_ARGS;for(var c=0;c<e.length;c++)if(!f.contains(p.BODYPARTS_ALL,e[c]))return p.ERR_INVALID_ARGS;return(i?function(e,t){return f.sum(t,function(t){return!e[t]||e[t].off||\"spawn\"!==e[t].type&&\"extension\"!==e[t].type?0:e[t].energy})}(n.roomObjects,i):this.room.energyAvailable)<l.calcCreepCost(e)?p.ERR_NOT_ENOUGH_ENERGY:r.dryRun?p.OK:(s.push(t),f.isUndefined(a.Memory.creeps)&&(a.Memory.creeps={}),f.isObject(a.Memory.creeps)&&(a.Memory.creeps[t]=r.memory||a.Memory.creeps[t]||{}),a.Game.creeps[t]=new a.Creep,a.RoomObject.call(a.Game.creeps[t],this.pos.x,this.pos.y,this.pos.roomName),Object.defineProperties(a.Game.creeps[t],{name:{enumerable:!0,get:function(){return t}},spawning:{enumerable:!0,get:function(){return!0}},my:{enumerable:!0,get:function(){return!0}},body:{enumerable:!0,get:function(){return f.map(e,function(e){return{type:e,hits:100}})}},owner:{enumerable:!0,get:function(){return new Object({username:n.user.username})}},ticksToLive:{enumerable:!0,get:function(){return p.CREEP_LIFE_TIME}},carryCapacity:{enumerable:!0,get:function(){return f.reduce(e,function(e,t){return e+(t===p.CARRY?p.CARRY_CAPACITY:0)},0)}},carry:{enumerable:!0,get:function(){return{energy:0}}},fatigue:{enumerable:!0,get:function(){return 0}},hits:{enumerable:!0,get:function(){return 100*e.length}},hitsMax:{enumerable:!0,get:function(){return 100*e.length}},saying:{enumerable:!0,get:function(){}}}),o.set(this.id,\"createCreep\",{name:t,body:e,energyStructures:i,directions:u}),p.OK)}),U.prototype.transferEnergy=i.wrapFn(function(e,t){return i.deprecated(\"`StructureSpawn.transferEnergy` is considered deprecated and will be removed soon. Please use `Creep.withdraw` instead.\"),this.my?e&&e.id&&i.creeps[e.id]&&e instanceof a.Creep&&!e.spawning?n.roomObjects[this.id].off?p.ERR_RCL_NOT_ENOUGH:d(this.id).energy?(t||(t=d(e.id).energyCapacity?Math.min(d(this.id).energy,d(e.id).energyCapacity-d(e.id).energy):d(this.id).energy),this.energy<t||t<0?p.ERR_NOT_ENOUGH_ENERGY:d(e.id).energy==d(e.id).energyCapacity?p.ERR_FULL:e.pos.isNearTo(this.pos)?(o.set(this.id,\"transferEnergy\",{id:e.id,amount:t}),p.OK):p.ERR_NOT_IN_RANGE):p.ERR_NOT_ENOUGH_ENERGY:(i.assertTargetObject(e),p.ERR_INVALID_TARGET):p.ERR_NOT_OWNER}),U.prototype.notifyWhenAttacked=i.wrapFn(function(e){return this.my?f.isBoolean(e)?(e!=d(this.id).notifyWhenAttacked&&o.set(this.id,\"notifyWhenAttacked\",{enabled:e}),p.OK):p.ERR_INVALID_ARGS:p.ERR_NOT_OWNER}),U.prototype.renewCreep=i.wrapFn(function(e){return this.spawning?p.ERR_BUSY:e&&e.id&&i.creeps[e.id]&&e instanceof a.Creep&&!e.spawning?this.my&&e.my?n.roomObjects[this.id].off?p.ERR_RCL_NOT_ENOUGH:e.pos.isNearTo(this.pos)?this.room.energyAvailable<Math.ceil(p.SPAWN_RENEW_RATIO*l.calcCreepCost(e.body)/p.CREEP_SPAWN_TIME/e.body.length)?p.ERR_NOT_ENOUGH_ENERGY:e.ticksToLive+Math.floor(p.SPAWN_RENEW_RATIO*p.CREEP_LIFE_TIME/p.CREEP_SPAWN_TIME/e.body.length)>p.CREEP_LIFE_TIME?p.ERR_FULL:(f.any(e.body,function(e){return!!e.boost})&&i.deprecated(\"Using `StructureSpawn.renewCreep` on a boosted creep is deprecated and will throw an error soon. Please remove boosts using `StructureLab.unboostCreep` before renewing.\"),o.set(this.id,\"renewCreep\",{id:e.id}),p.OK):p.ERR_NOT_IN_RANGE:p.ERR_NOT_OWNER:(i.assertTargetObject(e),p.ERR_INVALID_TARGET)}),U.prototype.recycleCreep=i.wrapFn(function(e){return this.my?e&&e.id&&i.creeps[e.id]&&e instanceof a.Creep&&!e.spawning?n.roomObjects[this.id].off?p.ERR_RCL_NOT_ENOUGH:e.my?e.pos.isNearTo(this.pos)?(o.set(this.id,\"recycleCreep\",{id:e.id}),p.OK):p.ERR_NOT_IN_RANGE:p.ERR_NOT_OWNER:(i.assertTargetObject(e),p.ERR_INVALID_TARGET):p.ERR_NOT_OWNER}),Object.defineProperty(a,\"StructureSpawn\",{enumerable:!0,value:U}),Object.defineProperty(a,\"Spawn\",{enumerable:!0,value:U}),U.Spawning=i.wrapFn(function(e){Object.defineProperty(this,\"spawn\",{enumerable:!1,value:i._objects[e]}),this.name=d(e).spawning.name,this.needTime=d(e).spawning.needTime,this.remainingTime=d(e).spawning.remainingTime,this.directions=d(e).spawning.directions}),U.Spawning.prototype.setDirections=i.wrapFn(function(e){return this.spawn.my?f.isArray(e)&&e.length>0&&(e=f.uniq(f.map(e,function(e){return+e})),!f.any(e,function(e){return e<1||e>8||e!==(0|e)}))?(o.set(this.spawn.id,\"setSpawnDirections\",{directions:e}),p.OK):p.ERR_INVALID_ARGS:p.ERR_NOT_OWNER}),U.Spawning.prototype.cancel=i.wrapFn(function(){return this.spawn.my?(o.set(this.spawn.id,\"cancelSpawning\",{}),p.OK):p.ERR_NOT_OWNER});var j=i.wrapFn(function(e){g.call(this,e)});j.prototype=Object.create(g.prototype),j.prototype.constructor=j,l.defineGameObjectProperties(j.prototype,d,{energy:function(e){return e.energy},energyCapacity:function(e){return e.energyCapacity},ghodium:function(e){return e.G},ghodiumCapacity:function(e){return e.GCapacity},cooldown:function(e){return e.cooldownTime&&e.cooldownTime>n.time?e.cooldownTime-n.time:0}}),j.prototype.launchNuke=i.wrapFn(function(e){if(!this.my)return p.ERR_NOT_OWNER;if(n.rooms[this.room.name].novice>Date.now()||n.rooms[this.room.name].respawnArea>Date.now())return p.ERR_INVALID_TARGET;if(!(e instanceof a.RoomPosition))return p.ERR_INVALID_TARGET;if(this.cooldown>0)return p.ERR_TIRED;if(!l.checkStructureAgainstController(d(this.id),i.objectsByRoom[d(this.id).room],d(this.room.controller.id)))return p.ERR_RCL_NOT_ENOUGH;var t=l.roomNameToXY(e.roomName),r=c(t,2),s=r[0],u=r[1],f=l.roomNameToXY(d(this.id).room),h=c(f,2),m=h[0],y=h[1];return Math.abs(s-m)>p.NUKE_RANGE||Math.abs(u-y)>p.NUKE_RANGE?p.ERR_NOT_IN_RANGE:this.energy<this.energyCapacity||this.ghodium<this.ghodiumCapacity?p.ERR_NOT_ENOUGH_RESOURCES:(o.set(this.id,\"launchNuke\",{roomName:e.roomName,x:e.x,y:e.y}),p.OK)}),Object.defineProperty(a,\"StructureNuker\",{enumerable:!0,value:j});var W=i.wrapFn(function(e){E.call(this,e)});W.prototype=Object.create(E.prototype),W.prototype.constructor=W,l.defineGameObjectProperties(W.prototype,d,{destination:function(e){return e.destination.shard?{shard:e.destination.shard,room:e.destination.room}:new a.RoomPosition(e.destination.x,e.destination.y,e.destination.room)},ticksToDecay:function(e){return e.decayTime?e.decayTime-n.time:void 0}}),Object.defineProperty(a,\"StructurePortal\",{enumerable:!0,value:W})}}},{\"./../utils\":184,\"./names\":25,\"./rooms\":31,lodash:61}],34:[function(e,t,r){\"use strict\";var n,o,i,a=e(\"./../utils\"),s=a.getRuntimeDriver().constants,u=e(\"lodash\");function c(e){var t={energy:0};return s.RESOURCES_ALL.forEach(function(r){e[r]&&(t[r]=e[r])}),t}r.make=function(e,t,r,l){if(n=e,t,o=r,!(i=l).Tombstone){var p=function(e){if(!n.roomObjects[e])throw new Error(\"Could not find an object with ID \"+e);return n.roomObjects[e]},f=o.wrapFn(function(e){var t=p(e);i.RoomObject.call(this,t.x,t.y,t.room,t.effects),this.id=e});f.prototype=Object.create(i.RoomObject.prototype),f.prototype.constructor=f,a.defineGameObjectProperties(f.prototype,p,{deathTime:function(e){return e.deathTime},store:c,ticksToDecay:function(e){return e.decayTime-n.time},creep:function(e){if(e.creepId){var t=new i.Creep;return i.RoomObject.call(t,e.x,e.y,e.room),Object.defineProperties(t,{id:{enumerable:!0,get:function(){return e.creepId}},name:{enumerable:!0,get:function(){return e.creepName}},spawning:{enumerable:!0,get:function(){return!1}},my:{enumerable:!0,get:function(){return e.user==n.user._id}},body:{enumerable:!0,get:function(){return u.map(e.creepBody,function(e){return{type:e,hits:0}})}},owner:{enumerable:!0,get:function(){return u.isUndefined(e.user)||null===e.user?void 0:{username:n.users[e.user].username}}},ticksToLive:{enumerable:!0,get:function(){return e.creepTicksToLive}},carryCapacity:{enumerable:!0,get:function(){return u.reduce(e.creepBody,function(e,t){return e+(t===s.CARRY?s.CARRY_CAPACITY:0)},0)}},carry:{enumerable:!0,get:function(){return{energy:0}}},fatigue:{enumerable:!0,get:function(){return 0}},hits:{enumerable:!0,get:function(){return 0}},hitsMax:{enumerable:!0,get:function(){return 100*e.creepBody.length}},saying:{enumerable:!0,get:function(){return e.creepSaying}}}),t}if(e.powerCreepId){var r=new i.PowerCreep;return i.RoomObject.call(r,e.x,e.y,e.room),Object.defineProperties(r,{id:{enumerable:!0,get:function(){return e.powerCreepId}},name:{enumerable:!0,get:function(){return e.powerCreepName}},className:{enumerable:!0,get:function(){return e.powerCreepClassName}},level:{enumerable:!0,get:function(){return e.powerCreepLevel}},my:{enumerable:!0,get:function(){return e.user==n.user._id}},body:{enumerable:!0,get:function(){return u.map(e.creepBody,function(e){return{type:e,hits:0}})}},owner:{enumerable:!0,get:function(){return u.isUndefined(e.user)||null===e.user?void 0:{username:n.users[e.user].username}}},ticksToLive:{enumerable:!0,get:function(){return e.powerCreepTicksToLive}},carryCapacity:{enumerable:!0,get:function(){return 100*e.powerCreepLevel}},carry:{enumerable:!0,get:function(){return{energy:0}}},hits:{enumerable:!0,get:function(){return 0}},hitsMax:{enumerable:!0,get:function(){return 1e3*e.powerCreepLevel}},saying:{enumerable:!0,get:function(){return e.powerCreepSaying}},powers:{enumerable:!0,get:function(){return e.powerCreepPowers}}}),r}}}),f.prototype.toString=o.wrapFn(function(){return\"[Tombstone #\"+this.id+\"]\"}),Object.defineProperty(i,\"Tombstone\",{enumerable:!0,value:f})}}},{\"./../utils\":184,lodash:61}],35:[function(e,t,r){\"use strict\";t.exports={ptr:!1}},{}],36:[function(e,t,r){(function(t){\"use strict\";var r,n,o,i=e(\"q\"),a=e(\"lodash\"),s=e(\"./utils\").getDriver(),u=(e(\"./config\"),0);function c(){var l,p=t.hrtime?t.hrtime():Date.now(),f=\"start\";s.config.emit(\"mainLoopStage\",f),\"undefined\"==typeof self&&(l=setInterval(function(){s.queue.resetAll()},s.config.mainLoopResetInterval)),s.notifyTickStarted().then(function(){return f=\"getUsers\",s.config.emit(\"mainLoopStage\",f),s.getAllUsers()}).then(function(e){return f=\"addUsersToQueue\",s.config.emit(\"mainLoopStage\",f,e),i.all([r.addMulti(e.legacy.map(function(e){return e._id.toString()})),o.addMulti(e.ivm.map(function(e){return e._id.toString()}))])}).then(function(){return f=\"waitForUsers\",s.config.emit(\"mainLoopStage\",f),i.all([r.whenAllDone().then(function(){return s.config.emit(\"mainLoopStage\",f,\"legacyDone\")}),o.whenAllDone().then(function(){return s.config.emit(\"mainLoopStage\",f,\"ivmDone\")})])}).then(function(){return f=\"getRooms\",s.config.emit(\"mainLoopStage\",f),s.getAllRooms()}).then(function(e){return f=\"addRoomsToQueue\",s.config.emit(\"mainLoopStage\",f,e),n.addMulti(a.map(e,function(e){return e._id.toString()}))}).then(function(){return f=\"waitForRooms\",s.config.emit(\"mainLoopStage\",f),n.whenAllDone()}).then(function(){return f=\"commit1\",s.config.emit(\"mainLoopStage\",f),s.commitDbBulk()}).then(function(){return f=\"global\",s.config.emit(\"mainLoopStage\",f),e(\"./processor/global\")()}).then(function(){return f=\"commit2\",s.config.emit(\"mainLoopStage\",f),s.commitDbBulk()}).then(function(){return f=\"incrementGameTime\",s.config.emit(\"mainLoopStage\",f),s.incrementGameTime()}).then(function(e){return+e>u+20&&(s.updateAccessibleRoomsList(),u=+e),f=\"notifyRoomsDone\",s.config.emit(\"mainLoopStage\",f),s.notifyRoomsDone(e)}).then(function(){return f=\"custom\",s.config.emit(\"mainLoopStage\",f),s.config.mainLoopCustomStage()}).catch(function(e){}).finally(function(){var e;l&&clearInterval(l),e=t.hrtime?1e3*(e=t.hrtime(p))[0]+e[1]/1e6:Date.now()-p,s.config.emit(\"mainLoopStage\",\"finish\"),setTimeout(c,Math.max(s.config.mainLoopMinDuration-e,0))}).catch(function(e){})}s.connect(\"main\").then(function(){return i.all([s.queue.create(\"usersLegacy\",\"write\"),s.queue.create(\"rooms\",\"write\"),s.queue.create(\"usersIvm\",\"write\")])}).then(function(e){r=e[0],n=e[1],o=e[2],c()}).catch(function(e){}),\"undefined\"==typeof self&&setInterval(function(){i.getUnhandledReasons().forEach(function(e){}),i.resetUnhandledRejections()},1e3)}).call(this,e(\"_process\"))},{\"./config\":1,\"./processor/global\":74,\"./utils\":184,_process:188,lodash:61,q:62}],37:[function(e,t,r){t.exports=e(\"./src/PathFinding\")},{\"./src/PathFinding\":38}],38:[function(e,t,r){t.exports={Heap:e(\"heap\"),Node:e(\"./core/Node\"),Grid:e(\"./core/Grid\"),Util:e(\"./core/Util\"),DiagonalMovement:e(\"./core/DiagonalMovement\"),Heuristic:e(\"./core/Heuristic\"),AStarFinder:e(\"./finders/AStarFinder\"),BestFirstFinder:e(\"./finders/BestFirstFinder\"),BreadthFirstFinder:e(\"./finders/BreadthFirstFinder\"),DijkstraFinder:e(\"./finders/DijkstraFinder\"),BiAStarFinder:e(\"./finders/BiAStarFinder\"),BiBestFirstFinder:e(\"./finders/BiBestFirstFinder\"),BiBreadthFirstFinder:e(\"./finders/BiBreadthFirstFinder\"),BiDijkstraFinder:e(\"./finders/BiDijkstraFinder\"),IDAStarFinder:e(\"./finders/IDAStarFinder\"),JumpPointFinder:e(\"./finders/JumpPointFinder\")}},{\"./core/DiagonalMovement\":39,\"./core/Grid\":40,\"./core/Heuristic\":41,\"./core/Node\":42,\"./core/Util\":43,\"./finders/AStarFinder\":44,\"./finders/BestFirstFinder\":45,\"./finders/BiAStarFinder\":46,\"./finders/BiBestFirstFinder\":47,\"./finders/BiBreadthFirstFinder\":48,\"./finders/BiDijkstraFinder\":49,\"./finders/BreadthFirstFinder\":50,\"./finders/DijkstraFinder\":51,\"./finders/IDAStarFinder\":52,\"./finders/JumpPointFinder\":57,heap:59}],39:[function(e,t,r){t.exports={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4}},{}],40:[function(e,t,r){var n=e(\"./Node\"),o=e(\"./DiagonalMovement\");function i(e,t,r){this.width=e,this.height=t,this.nodes=this._buildNodes(e,t,r)}i.prototype._buildNodes=function(e,t,r){var o,i,a=new Array(t);for(o=0;o<t;++o)for(a[o]=new Array(e),i=0;i<e;++i)a[o][i]=new n(i,o);if(void 0===r)return a;if(r.length!==t||r[0].length!==e)throw new Error(\"Matrix size does not fit\");for(o=0;o<t;++o)for(i=0;i<e;++i)r[o][i]&&(a[o][i].walkable=!1),a[o][i].weight=r[o][i];return a},i.prototype.getNodeAt=function(e,t){return this.nodes[t][e]},i.prototype.isWalkableAt=function(e,t){return this.isInside(e,t)&&this.nodes[t][e].weight>0},i.prototype.isInside=function(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height},i.prototype.setWalkableAt=function(e,t,r){this.nodes[t][e].weight=1},i.prototype.getNeighbors=function(e,t){var r=e.x,n=e.y,i=[],a=!1,s=!1,u=!1,c=!1,l=!1,p=!1,f=!1,d=!1,h=this.nodes;if(this.isWalkableAt(r,n-1)&&(i.push(h[n-1][r]),a=!0),this.isWalkableAt(r+1,n)&&(i.push(h[n][r+1]),u=!0),this.isWalkableAt(r,n+1)&&(i.push(h[n+1][r]),l=!0),this.isWalkableAt(r-1,n)&&(i.push(h[n][r-1]),f=!0),t===o.Never)return i;if(t===o.OnlyWhenNoObstacles)s=f&&a,c=a&&u,p=u&&l,d=l&&f;else if(t===o.IfAtMostOneObstacle)s=f||a,c=a||u,p=u||l,d=l||f;else{if(t!==o.Always)throw new Error(\"Incorrect value of diagonalMovement\");s=!0,c=!0,p=!0,d=!0}return s&&this.isWalkableAt(r-1,n-1)&&i.push(h[n-1][r-1]),c&&this.isWalkableAt(r+1,n-1)&&i.push(h[n-1][r+1]),p&&this.isWalkableAt(r+1,n+1)&&i.push(h[n+1][r+1]),d&&this.isWalkableAt(r-1,n+1)&&i.push(h[n+1][r-1]),i},i.prototype.clone=function(){var e,t,r=this.width,o=this.height,a=this.nodes,s=new i(r,o),u=new Array(o);for(e=0;e<o;++e)for(u[e]=new Array(r),t=0;t<r;++t)u[e][t]=new n(t,e,a[e][t].walkable,a[e][t].weight);return s.nodes=u,s},t.exports=i},{\"./DiagonalMovement\":39,\"./Node\":42}],41:[function(e,t,r){t.exports={manhattan:function(e,t){return e+t},euclidean:function(e,t){return Math.sqrt(e*e+t*t)},octile:function(e,t){var r=Math.SQRT2-1;return e<t?r*e+t:r*t+e},chebyshev:function(e,t){return Math.max(e,t)}}},{}],42:[function(e,t,r){t.exports=function(e,t,r,n){this.x=e,this.y=t,this.walkable=void 0===r||r,this.weight=n}},{}],43:[function(e,t,r){function n(e){for(var t=[[e.x,e.y]];e.parent;)e=e.parent,t.push([e.x,e.y]);return t.reverse()}function o(e,t,r,n){var o,i,a,s,u,c,l=Math.abs,p=[];for(a=l(r-e),s=l(n-t),o=e<r?1:-1,i=t<n?1:-1,u=a-s;p.push([e,t]),e!==r||t!==n;)(c=2*u)>-s&&(u-=s,e+=o),c<a&&(u+=a,t+=i);return p}r.backtrace=n,r.biBacktrace=function(e,t){var r=n(e),o=n(t);return r.concat(o.reverse())},r.pathLength=function(e){var t,r,n,o,i,a=0;for(t=1;t<e.length;++t)r=e[t-1],n=e[t],o=r[0]-n[0],i=r[1]-n[1],a+=Math.sqrt(o*o+i*i);return a},r.interpolate=o,r.expandPath=function(e){var t,r,n,i,a,s,u=[],c=e.length;if(c<2)return u;for(a=0;a<c-1;++a)for(t=e[a],r=e[a+1],i=(n=o(t[0],t[1],r[0],r[1])).length,s=0;s<i-1;++s)u.push(n[s]);return u.push(e[c-1]),u},r.smoothenPath=function(e,t){var r,n,i,a,s,u,c,l,p,f=t.length,d=t[0][0],h=t[0][1],m=t[f-1][0],y=t[f-1][1];for(i=[[r=d,n=h]],a=2;a<f;++a){for(c=o(r,n,(u=t[a])[0],u[1]),p=!1,s=1;s<c.length;++s)if(l=c[s],!e.isWalkableAt(l[0],l[1])){p=!0;break}p&&(lastValidCoord=t[a-1],i.push(lastValidCoord),r=lastValidCoord[0],n=lastValidCoord[1])}return i.push([m,y]),i},r.compressPath=function(e){if(e.length<3)return e;var t,r,n,o,i,a,s=[],u=e[0][0],c=e[0][1],l=e[1][0],p=e[1][1],f=l-u,d=p-c;for(f/=i=Math.sqrt(f*f+d*d),d/=i,s.push([u,c]),a=2;a<e.length;a++)t=l,r=p,n=f,o=d,f=(l=e[a][0])-t,d=(p=e[a][1])-r,d/=i=Math.sqrt(f*f+d*d),(f/=i)===n&&d===o||s.push([t,r]);return s.push([l,p]),s}},{}],44:[function(e,t,r){var n=e(\"heap\"),o=e(\"../core/Util\"),i=e(\"../core/Heuristic\"),a=e(\"../core/DiagonalMovement\");function s(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.heuristic=e.heuristic||i.manhattan,this.weight=e.weight||1,this.maxOpsLimit=e.maxOpsLimit,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=a.OnlyWhenNoObstacles:this.diagonalMovement=a.IfAtMostOneObstacle:this.diagonalMovement=a.Never),this.diagonalMovement===a.Never?this.heuristic=e.heuristic||i.manhattan:this.heuristic=e.heuristic||i.octile}s.prototype.findPath=function(e,t,r,i,a){var s,u,c,l,p,f,d,h,m=new n(function(e,t){return e.f-t.f}),y=a.getNodeAt(e,t),_=-999!=r?a.getNodeAt(r,i):null,R=this.heuristic,E=this.diagonalMovement,g=this.weight,v=Math.abs,O=(Math.SQRT2,y),T=0;for(y.g=0,y.f=0,y.h=_?g*R(v(e-r),v(t-i)):0,m.push(y),y.opened=!0;!m.empty();){if((s=m.pop()).closed=!0,s===_||999==s.weight)return o.backtrace(s);if(T++,this.maxOpsLimit&&T>this.maxOpsLimit)break;for(l=0,p=(u=a.getNeighbors(s,E)).length;l<p;++l)(c=u[l]).closed||(f=c.x,d=c.y,h=s.g+c.weight*(f-s.x==0||d-s.y==0?1:1.00000001),(!c.opened||h<c.g)&&(c.g=h,c.h=c.h||g*R(v(f-r),v(d-i)),c.f=c.g+c.h,c.parent=s,(c.h<O.h||c.h===O.h&&c.g<O.g)&&(O=c),c.opened?m.updateItem(c):(m.push(c),c.opened=!0)))}return o.backtrace(O)},t.exports=s},{\"../core/DiagonalMovement\":39,\"../core/Heuristic\":41,\"../core/Util\":43,heap:59}],45:[function(e,t,r){var n=e(\"./AStarFinder\");function o(e){n.call(this,e);var t=this.heuristic;this.heuristic=function(e,r){return 1e6*t(e,r)}}o.prototype=new n,o.prototype.constructor=o,t.exports=o},{\"./AStarFinder\":44}],46:[function(e,t,r){var n=e(\"heap\"),o=e(\"../core/Util\"),i=e(\"../core/Heuristic\"),a=e(\"../core/DiagonalMovement\");function s(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.heuristic=e.heuristic||i.manhattan,this.weight=e.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=a.OnlyWhenNoObstacles:this.diagonalMovement=a.IfAtMostOneObstacle:this.diagonalMovement=a.Never),this.diagonalMovement===a.Never?this.heuristic=e.heuristic||i.manhattan:this.heuristic=e.heuristic||i.octile}s.prototype.findPath=function(e,t,r,i,a){var s,u,c,l,p,f,d,h,m=function(e,t){return e.f-t.f},y=new n(m),_=new n(m),R=a.getNodeAt(e,t),E=a.getNodeAt(r,i),g=this.heuristic,v=this.diagonalMovement,O=this.weight,T=Math.abs,A=Math.SQRT2;for(R.g=0,R.f=0,y.push(R),R.opened=1,E.g=0,E.f=0,_.push(E),E.opened=2;!y.empty()&&!_.empty();){for((s=y.pop()).closed=!0,l=0,p=(u=a.getNeighbors(s,v)).length;l<p;++l)if(!(c=u[l]).closed){if(2===c.opened)return o.biBacktrace(s,c);f=c.x,d=c.y,h=s.g+(f-s.x==0||d-s.y==0?1:A),(!c.opened||h<c.g)&&(c.g=h,c.h=c.h||O*g(T(f-r),T(d-i)),c.f=c.g+c.h,c.parent=s,c.opened?y.updateItem(c):(y.push(c),c.opened=1))}for((s=_.pop()).closed=!0,l=0,p=(u=a.getNeighbors(s,v)).length;l<p;++l)if(!(c=u[l]).closed){if(1===c.opened)return o.biBacktrace(c,s);f=c.x,d=c.y,h=s.g+(f-s.x==0||d-s.y==0?1:A),(!c.opened||h<c.g)&&(c.g=h,c.h=c.h||O*g(T(f-e),T(d-t)),c.f=c.g+c.h,c.parent=s,c.opened?_.updateItem(c):(_.push(c),c.opened=2))}}return[]},t.exports=s},{\"../core/DiagonalMovement\":39,\"../core/Heuristic\":41,\"../core/Util\":43,heap:59}],47:[function(e,t,r){var n=e(\"./BiAStarFinder\");function o(e){n.call(this,e);var t=this.heuristic;this.heuristic=function(e,r){return 1e6*t(e,r)}}o.prototype=new n,o.prototype.constructor=o,t.exports=o},{\"./BiAStarFinder\":46}],48:[function(e,t,r){var n=e(\"../core/Util\"),o=e(\"../core/DiagonalMovement\");function i(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=o.OnlyWhenNoObstacles:this.diagonalMovement=o.IfAtMostOneObstacle:this.diagonalMovement=o.Never)}i.prototype.findPath=function(e,t,r,o,i){var a,s,u,c,l,p=i.getNodeAt(e,t),f=i.getNodeAt(r,o),d=[],h=[],m=this.diagonalMovement;for(d.push(p),p.opened=!0,p.by=0,h.push(f),f.opened=!0,f.by=1;d.length&&h.length;){for((u=d.shift()).closed=!0,c=0,l=(a=i.getNeighbors(u,m)).length;c<l;++c)if(!(s=a[c]).closed)if(s.opened){if(1===s.by)return n.biBacktrace(u,s)}else d.push(s),s.parent=u,s.opened=!0,s.by=0;for((u=h.shift()).closed=!0,c=0,l=(a=i.getNeighbors(u,m)).length;c<l;++c)if(!(s=a[c]).closed)if(s.opened){if(0===s.by)return n.biBacktrace(s,u)}else h.push(s),s.parent=u,s.opened=!0,s.by=1}return[]},t.exports=i},{\"../core/DiagonalMovement\":39,\"../core/Util\":43}],49:[function(e,t,r){var n=e(\"./BiAStarFinder\");function o(e){n.call(this,e),this.heuristic=function(e,t){return 0}}o.prototype=new n,o.prototype.constructor=o,t.exports=o},{\"./BiAStarFinder\":46}],50:[function(e,t,r){var n=e(\"../core/Util\"),o=e(\"../core/DiagonalMovement\");function i(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=o.OnlyWhenNoObstacles:this.diagonalMovement=o.IfAtMostOneObstacle:this.diagonalMovement=o.Never)}i.prototype.findPath=function(e,t,r,o,i){var a,s,u,c,l,p=[],f=this.diagonalMovement,d=i.getNodeAt(e,t),h=i.getNodeAt(r,o);for(p.push(d),d.opened=!0;p.length;){if((u=p.shift()).closed=!0,u===h)return n.backtrace(h);for(c=0,l=(a=i.getNeighbors(u,f)).length;c<l;++c)(s=a[c]).closed||s.opened||(p.push(s),s.opened=!0,s.parent=u)}return[]},t.exports=i},{\"../core/DiagonalMovement\":39,\"../core/Util\":43}],51:[function(e,t,r){var n=e(\"./AStarFinder\");function o(e){n.call(this,e),this.heuristic=function(e,t){return 0}}o.prototype=new n,o.prototype.constructor=o,t.exports=o},{\"./AStarFinder\":44}],52:[function(e,t,r){e(\"../core/Util\");var n=e(\"../core/Heuristic\"),o=e(\"../core/Node\"),i=e(\"../core/DiagonalMovement\");function a(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.heuristic=e.heuristic||n.manhattan,this.weight=e.weight||1,this.trackRecursion=e.trackRecursion||!1,this.timeLimit=e.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=i.OnlyWhenNoObstacles:this.diagonalMovement=i.IfAtMostOneObstacle:this.diagonalMovement=i.Never),this.diagonalMovement===i.Never?this.heuristic=e.heuristic||n.manhattan:this.heuristic=e.heuristic||n.octile}a.prototype.findPath=function(e,t,r,n,i){var a,s,u,c=(new Date).getTime(),l=function(e,t){return this.heuristic(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}.bind(this),p=function(e,t){return e.x===t.x||e.y===t.y?1:Math.SQRT2},f=function(e,t,r,n,a){if(0,this.timeLimit>0&&(new Date).getTime()-c>1e3*this.timeLimit)return 1/0;var s,u,d,m,y=t+l(e,h)*this.weight;if(y>r)return y;if(e==h)return n[a]=[e.x,e.y],e;var _=i.getNeighbors(e,this.diagonalMovement);for(d=0,s=1/0;m=_[d];++d){if(this.trackRecursion&&(m.retainCount=m.retainCount+1||1,!0!==m.tested&&(m.tested=!0)),(u=f(m,t+p(e,m),r,n,a+1))instanceof o)return n[a]=[e.x,e.y],u;this.trackRecursion&&0==--m.retainCount&&(m.tested=!1),u<s&&(s=u)}return s}.bind(this),d=i.getNodeAt(e,t),h=i.getNodeAt(r,n),m=l(d,h);for(a=0;;++a){if((u=f(d,0,m,s=[],0))===1/0)return[];if(u instanceof o)return s;m=u}return[]},t.exports=a},{\"../core/DiagonalMovement\":39,\"../core/Heuristic\":41,\"../core/Node\":42,\"../core/Util\":43}],53:[function(e,t,r){var n=e(\"./JumpPointFinderBase\"),o=e(\"../core/DiagonalMovement\");function i(e){n.call(this,e)}i.prototype=new n,i.prototype.constructor=i,i.prototype._jump=function(e,t,r,n){var o=this.grid,i=e-r,a=t-n;if(!o.isWalkableAt(e,t))return null;if(!0===this.trackJumpRecursion&&(o.getNodeAt(e,t).tested=!0),o.getNodeAt(e,t)===this.endNode)return[e,t];if(0!==i&&0!==a){if(o.isWalkableAt(e-i,t+a)&&!o.isWalkableAt(e-i,t)||o.isWalkableAt(e+i,t-a)&&!o.isWalkableAt(e,t-a))return[e,t];if(this._jump(e+i,t,e,t)||this._jump(e,t+a,e,t))return[e,t]}else if(0!==i){if(o.isWalkableAt(e+i,t+1)&&!o.isWalkableAt(e,t+1)||o.isWalkableAt(e+i,t-1)&&!o.isWalkableAt(e,t-1))return[e,t]}else if(o.isWalkableAt(e+1,t+a)&&!o.isWalkableAt(e+1,t)||o.isWalkableAt(e-1,t+a)&&!o.isWalkableAt(e-1,t))return[e,t];return this._jump(e+i,t+a,e,t)},i.prototype._findNeighbors=function(e){var t,r,n,i,a,s,u,c,l=e.parent,p=e.x,f=e.y,d=this.grid,h=[];if(l)t=l.x,r=l.y,n=(p-t)/Math.max(Math.abs(p-t),1),i=(f-r)/Math.max(Math.abs(f-r),1),0!==n&&0!==i?(d.isWalkableAt(p,f+i)&&h.push([p,f+i]),d.isWalkableAt(p+n,f)&&h.push([p+n,f]),d.isWalkableAt(p+n,f+i)&&h.push([p+n,f+i]),d.isWalkableAt(p-n,f)||h.push([p-n,f+i]),d.isWalkableAt(p,f-i)||h.push([p+n,f-i])):0===n?(d.isWalkableAt(p,f+i)&&h.push([p,f+i]),d.isWalkableAt(p+1,f)||h.push([p+1,f+i]),d.isWalkableAt(p-1,f)||h.push([p-1,f+i])):(d.isWalkableAt(p+n,f)&&h.push([p+n,f]),d.isWalkableAt(p,f+1)||h.push([p+n,f+1]),d.isWalkableAt(p,f-1)||h.push([p+n,f-1]));else for(u=0,c=(a=d.getNeighbors(e,o.Always)).length;u<c;++u)s=a[u],h.push([s.x,s.y]);return h},t.exports=i},{\"../core/DiagonalMovement\":39,\"./JumpPointFinderBase\":58}],54:[function(e,t,r){var n=e(\"./JumpPointFinderBase\"),o=e(\"../core/DiagonalMovement\");function i(e){n.call(this,e)}i.prototype=new n,i.prototype.constructor=i,i.prototype._jump=function(e,t,r,n){var o=this.grid,i=e-r,a=t-n;if(!o.isWalkableAt(e,t))return null;if(!0===this.trackJumpRecursion&&(o.getNodeAt(e,t).tested=!0),o.getNodeAt(e,t)===this.endNode)return[e,t];if(0!==i&&0!==a){if(o.isWalkableAt(e-i,t+a)&&!o.isWalkableAt(e-i,t)||o.isWalkableAt(e+i,t-a)&&!o.isWalkableAt(e,t-a))return[e,t];if(this._jump(e+i,t,e,t)||this._jump(e,t+a,e,t))return[e,t]}else if(0!==i){if(o.isWalkableAt(e+i,t+1)&&!o.isWalkableAt(e,t+1)||o.isWalkableAt(e+i,t-1)&&!o.isWalkableAt(e,t-1))return[e,t]}else if(o.isWalkableAt(e+1,t+a)&&!o.isWalkableAt(e+1,t)||o.isWalkableAt(e-1,t+a)&&!o.isWalkableAt(e-1,t))return[e,t];return o.isWalkableAt(e+i,t)||o.isWalkableAt(e,t+a)?this._jump(e+i,t+a,e,t):null},i.prototype._findNeighbors=function(e){var t,r,n,i,a,s,u,c,l=e.parent,p=e.x,f=e.y,d=this.grid,h=[];if(l)t=l.x,r=l.y,n=(p-t)/Math.max(Math.abs(p-t),1),i=(f-r)/Math.max(Math.abs(f-r),1),0!==n&&0!==i?(d.isWalkableAt(p,f+i)&&h.push([p,f+i]),d.isWalkableAt(p+n,f)&&h.push([p+n,f]),(d.isWalkableAt(p,f+i)||d.isWalkableAt(p+n,f))&&h.push([p+n,f+i]),!d.isWalkableAt(p-n,f)&&d.isWalkableAt(p,f+i)&&h.push([p-n,f+i]),!d.isWalkableAt(p,f-i)&&d.isWalkableAt(p+n,f)&&h.push([p+n,f-i])):0===n?d.isWalkableAt(p,f+i)&&(h.push([p,f+i]),d.isWalkableAt(p+1,f)||h.push([p+1,f+i]),d.isWalkableAt(p-1,f)||h.push([p-1,f+i])):d.isWalkableAt(p+n,f)&&(h.push([p+n,f]),d.isWalkableAt(p,f+1)||h.push([p+n,f+1]),d.isWalkableAt(p,f-1)||h.push([p+n,f-1]));else for(u=0,c=(a=d.getNeighbors(e,o.IfAtMostOneObstacle)).length;u<c;++u)s=a[u],h.push([s.x,s.y]);return h},t.exports=i},{\"../core/DiagonalMovement\":39,\"./JumpPointFinderBase\":58}],55:[function(e,t,r){var n=e(\"./JumpPointFinderBase\"),o=e(\"../core/DiagonalMovement\");function i(e){n.call(this,e)}i.prototype=new n,i.prototype.constructor=i,i.prototype._jump=function(e,t,r,n){var o=this.grid,i=e-r,a=t-n;if(!o.isWalkableAt(e,t))return null;if(!0===this.trackJumpRecursion&&(o.getNodeAt(e,t).tested=!0),o.getNodeAt(e,t)===this.endNode)return[e,t];if(0!==i&&0!==a){if(this._jump(e+i,t,e,t)||this._jump(e,t+a,e,t))return[e,t]}else if(0!==i){if(o.isWalkableAt(e,t-1)&&!o.isWalkableAt(e-i,t-1)||o.isWalkableAt(e,t+1)&&!o.isWalkableAt(e-i,t+1))return[e,t]}else if(0!==a&&(o.isWalkableAt(e-1,t)&&!o.isWalkableAt(e-1,t-a)||o.isWalkableAt(e+1,t)&&!o.isWalkableAt(e+1,t-a)))return[e,t];return o.isWalkableAt(e+i,t)&&o.isWalkableAt(e,t+a)?this._jump(e+i,t+a,e,t):null},i.prototype._findNeighbors=function(e){var t,r,n,i,a,s,u,c,l,p=e.parent,f=e.x,d=e.y,h=this.grid,m=[];if(p){if(t=p.x,r=p.y,n=(f-t)/Math.max(Math.abs(f-t),1),i=(d-r)/Math.max(Math.abs(d-r),1),0!==n&&0!==i)h.isWalkableAt(f,d+i)&&m.push([f,d+i]),h.isWalkableAt(f+n,d)&&m.push([f+n,d]),h.isWalkableAt(f,d+i)&&h.isWalkableAt(f+n,d)&&m.push([f+n,d+i]);else if(0!==n){l=h.isWalkableAt(f+n,d);var y=h.isWalkableAt(f,d+1),_=h.isWalkableAt(f,d-1);l&&(m.push([f+n,d]),y&&m.push([f+n,d+1]),_&&m.push([f+n,d-1])),y&&m.push([f,d+1]),_&&m.push([f,d-1])}else if(0!==i){l=h.isWalkableAt(f,d+i);var R=h.isWalkableAt(f+1,d),E=h.isWalkableAt(f-1,d);l&&(m.push([f,d+i]),R&&m.push([f+1,d+i]),E&&m.push([f-1,d+i])),R&&m.push([f+1,d]),E&&m.push([f-1,d])}}else for(u=0,c=(a=h.getNeighbors(e,o.OnlyWhenNoObstacles)).length;u<c;++u)s=a[u],m.push([s.x,s.y]);return m},t.exports=i},{\"../core/DiagonalMovement\":39,\"./JumpPointFinderBase\":58}],56:[function(e,t,r){var n=e(\"./JumpPointFinderBase\"),o=e(\"../core/DiagonalMovement\");function i(e){n.call(this,e)}i.prototype=new n,i.prototype.constructor=i,i.prototype._jump=function(e,t,r,n){var o=this.grid,i=e-r,a=t-n;if(!o.isWalkableAt(e,t))return null;if(!0===this.trackJumpRecursion&&(o.getNodeAt(e,t).tested=!0),o.getNodeAt(e,t)===this.endNode)return[e,t];if(0!==i){if(o.isWalkableAt(e,t-1)&&!o.isWalkableAt(e-i,t-1)||o.isWalkableAt(e,t+1)&&!o.isWalkableAt(e-i,t+1))return[e,t]}else{if(0===a)throw new Error(\"Only horizontal and vertical movements are allowed\");if(o.isWalkableAt(e-1,t)&&!o.isWalkableAt(e-1,t-a)||o.isWalkableAt(e+1,t)&&!o.isWalkableAt(e+1,t-a))return[e,t];if(this._jump(e+1,t,e,t)||this._jump(e-1,t,e,t))return[e,t]}return this._jump(e+i,t+a,e,t)},i.prototype._findNeighbors=function(e){var t,r,n,i,a,s,u,c,l=e.parent,p=e.x,f=e.y,d=this.grid,h=[];if(l)t=l.x,r=l.y,n=(p-t)/Math.max(Math.abs(p-t),1),i=(f-r)/Math.max(Math.abs(f-r),1),0!==n?(d.isWalkableAt(p,f-1)&&h.push([p,f-1]),d.isWalkableAt(p,f+1)&&h.push([p,f+1]),d.isWalkableAt(p+n,f)&&h.push([p+n,f])):0!==i&&(d.isWalkableAt(p-1,f)&&h.push([p-1,f]),d.isWalkableAt(p+1,f)&&h.push([p+1,f]),d.isWalkableAt(p,f+i)&&h.push([p,f+i]));else for(u=0,c=(a=d.getNeighbors(e,o.Never)).length;u<c;++u)s=a[u],h.push([s.x,s.y]);return h},t.exports=i},{\"../core/DiagonalMovement\":39,\"./JumpPointFinderBase\":58}],57:[function(e,t,r){var n=e(\"../core/DiagonalMovement\"),o=e(\"./JPFNeverMoveDiagonally\"),i=e(\"./JPFAlwaysMoveDiagonally\"),a=e(\"./JPFMoveDiagonallyIfNoObstacles\"),s=e(\"./JPFMoveDiagonallyIfAtMostOneObstacle\");t.exports=function(e){return(e=e||{}).diagonalMovement===n.Never?new o(e):e.diagonalMovement===n.Always?new i(e):e.diagonalMovement===n.OnlyWhenNoObstacles?new a(e):new s(e)}},{\"../core/DiagonalMovement\":39,\"./JPFAlwaysMoveDiagonally\":53,\"./JPFMoveDiagonallyIfAtMostOneObstacle\":54,\"./JPFMoveDiagonallyIfNoObstacles\":55,\"./JPFNeverMoveDiagonally\":56}],58:[function(e,t,r){var n=e(\"heap\"),o=e(\"../core/Util\"),i=e(\"../core/Heuristic\");e(\"../core/DiagonalMovement\");function a(e){e=e||{},this.heuristic=e.heuristic||i.manhattan,this.trackJumpRecursion=e.trackJumpRecursion||!1}a.prototype.findPath=function(e,t,r,i,a){var s,u=this.openList=new n(function(e,t){return e.f-t.f}),c=this.startNode=a.getNodeAt(e,t),l=this.endNode=a.getNodeAt(r,i);for(this.grid=a,c.g=0,c.f=0,u.push(c),c.opened=!0;!u.empty();){if((s=u.pop()).closed=!0,s===l)return o.expandPath(o.backtrace(l));this._identifySuccessors(s)}return[]},a.prototype._identifySuccessors=function(e){var t,r,n,o,a,s,u,c,l,p,f=this.grid,d=this.heuristic,h=this.openList,m=this.endNode.x,y=this.endNode.y,_=e.x,R=e.y,E=Math.abs;Math.max;for(o=0,a=(t=this._findNeighbors(e)).length;o<a;++o)if(r=t[o],n=this._jump(r[0],r[1],_,R)){if(s=n[0],u=n[1],(p=f.getNodeAt(s,u)).closed)continue;c=i.octile(E(s-_),E(u-R)),l=e.g+c,(!p.opened||l<p.g)&&(p.g=l,p.h=p.h||d(E(s-m),E(u-y)),p.f=p.g+p.h,p.parent=e,p.opened?h.updateItem(p):(h.push(p),p.opened=!0))}},t.exports=a},{\"../core/DiagonalMovement\":39,\"../core/Heuristic\":41,\"../core/Util\":43,heap:59}],59:[function(e,t,r){t.exports=e(\"./lib/heap\")},{\"./lib/heap\":60}],60:[function(e,t,r){(function(){var e,r,n,o,i,a,s,u,c,l,p,f,d,h,m;n=Math.floor,l=Math.min,r=function(e,t){return e<t?-1:e>t?1:0},c=function(e,t,o,i,a){var s;if(null==o&&(o=0),null==a&&(a=r),o<0)throw new Error(\"lo must be non-negative\");for(null==i&&(i=e.length);o<i;)a(t,e[s=n((o+i)/2)])<0?i=s:o=s+1;return[].splice.apply(e,[o,o-o].concat(t)),t},a=function(e,t,n){return null==n&&(n=r),e.push(t),h(e,0,e.length-1,n)},i=function(e,t){var n,o;return null==t&&(t=r),n=e.pop(),e.length?(o=e[0],e[0]=n,m(e,0,t)):o=n,o},u=function(e,t,n){var o;return null==n&&(n=r),o=e[0],e[0]=t,m(e,0,n),o},s=function(e,t,n){var o;return null==n&&(n=r),e.length&&n(e[0],t)<0&&(t=(o=[e[0],t])[0],e[0]=o[1],m(e,0,n)),t},o=function(e,t){var o,i,a,s,u,c;for(null==t&&(t=r),u=[],i=0,a=(s=function(){c=[];for(var t=0,r=n(e.length/2);0<=r?t<r:t>r;0<=r?t++:t--)c.push(t);return c}.apply(this).reverse()).length;i<a;i++)o=s[i],u.push(m(e,o,t));return u},d=function(e,t,n){var o;if(null==n&&(n=r),-1!==(o=e.indexOf(t)))return h(e,0,o,n),m(e,o,n)},p=function(e,t,n){var i,a,u,c,l;if(null==n&&(n=r),!(a=e.slice(0,t)).length)return a;for(o(a,n),u=0,c=(l=e.slice(t)).length;u<c;u++)i=l[u],s(a,i,n);return a.sort(n).reverse()},f=function(e,t,n){var a,s,u,p,f,d,h,m,y;if(null==n&&(n=r),10*t<=e.length){if(!(u=e.slice(0,t).sort(n)).length)return u;for(s=u[u.length-1],p=0,d=(h=e.slice(t)).length;p<d;p++)n(a=h[p],s)<0&&(c(u,a,0,null,n),u.pop(),s=u[u.length-1]);return u}for(o(e,n),y=[],f=0,m=l(t,e.length);0<=m?f<m:f>m;0<=m?++f:--f)y.push(i(e,n));return y},h=function(e,t,n,o){var i,a,s;for(null==o&&(o=r),i=e[n];n>t&&o(i,a=e[s=n-1>>1])<0;)e[n]=a,n=s;return e[n]=i},m=function(e,t,n){var o,i,a,s,u;for(null==n&&(n=r),i=e.length,u=t,a=e[t],o=2*t+1;o<i;)(s=o+1)<i&&!(n(e[o],e[s])<0)&&(o=s),e[t]=e[o],o=2*(t=o)+1;return e[t]=a,h(e,u,t,n)},e=function(){function e(e){this.cmp=null!=e?e:r,this.nodes=[]}return e.push=a,e.pop=i,e.replace=u,e.pushpop=s,e.heapify=o,e.updateItem=d,e.nlargest=p,e.nsmallest=f,e.prototype.push=function(e){return a(this.nodes,e,this.cmp)},e.prototype.pop=function(){return i(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return u(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return s(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return o(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return d(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return(t=new e).nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),(void 0!==t&&null!==t?t.exports:void 0)?t.exports=e:window.Heap=e}).call(this)},{}],61:[function(e,t,r){(function(e){(function(){var n,o=\"3.10.1\",i=1,a=2,s=4,u=8,c=16,l=32,p=64,f=128,d=256,h=30,m=\"...\",y=150,_=16,R=200,E=1,g=2,v=\"Expected a function\",O=\"__lodash_placeholder__\",T=\"[object Arguments]\",A=\"[object Array]\",b=\"[object Boolean]\",w=\"[object Date]\",N=\"[object Error]\",C=\"[object Function]\",S=\"[object Number]\",I=\"[object Object]\",x=\"[object RegExp]\",L=\"[object String]\",P=\"[object ArrayBuffer]\",M=\"[object Float32Array]\",k=\"[object Float64Array]\",D=\"[object Int8Array]\",U=\"[object Int16Array]\",j=\"[object Int32Array]\",W=\"[object Uint8Array]\",G=\"[object Uint8ClampedArray]\",F=\"[object Uint16Array]\",B=\"[object Uint32Array]\",H=/\\b__p \\+= '';/g,Y=/\\b(__p \\+=) '' \\+/g,K=/(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g,V=/&(?:amp|lt|gt|quot|#39|#96);/g,X=/[&<>\"'`]/g,q=RegExp(V.source),z=RegExp(X.source),J=/<%-([\\s\\S]+?)%>/g,Z=/<%([\\s\\S]+?)%>/g,$=/<%=([\\s\\S]+?)%>/g,Q=/\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\n\\\\]|\\\\.)*?\\1)\\]/,ee=/^\\w*$/,te=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\n\\\\]|\\\\.)*?)\\2)\\]/g,re=/^[:!,]|[\\\\^$.*+?()[\\]{}|\\/]|(^[0-9a-fA-Fnrtuvx])|([\\n\\r\\u2028\\u2029])/g,ne=RegExp(re.source),oe=/[\\u0300-\\u036f\\ufe20-\\ufe23]/g,ie=/\\\\(\\\\)?/g,ae=/\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g,se=/\\w*$/,ue=/^0[xX]/,ce=/^\\[object .+?Constructor\\]$/,le=/^\\d+$/,pe=/[\\xc0-\\xd6\\xd8-\\xde\\xdf-\\xf6\\xf8-\\xff]/g,fe=/($^)/,de=/['\\n\\r\\u2028\\u2029\\\\]/g,he=function(){var e=\"[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]\",t=\"[a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff]+\";return RegExp(e+\"+(?=\"+e+t+\")|\"+e+\"?\"+t+\"|\"+e+\"+|[0-9]+\",\"g\")}(),me=[\"Array\",\"ArrayBuffer\",\"Date\",\"Error\",\"Float32Array\",\"Float64Array\",\"Function\",\"Int8Array\",\"Int16Array\",\"Int32Array\",\"Math\",\"Number\",\"Object\",\"RegExp\",\"Set\",\"String\",\"_\",\"clearTimeout\",\"isFinite\",\"parseFloat\",\"parseInt\",\"setTimeout\",\"TypeError\",\"Uint8Array\",\"Uint8ClampedArray\",\"Uint16Array\",\"Uint32Array\",\"WeakMap\"],ye=-1,_e={};_e[M]=_e[k]=_e[D]=_e[U]=_e[j]=_e[W]=_e[G]=_e[F]=_e[B]=!0,_e[T]=_e[A]=_e[P]=_e[b]=_e[w]=_e[N]=_e[C]=_e[\"[object Map]\"]=_e[S]=_e[I]=_e[x]=_e[\"[object Set]\"]=_e[L]=_e[\"[object WeakMap]\"]=!1;var Re={};Re[T]=Re[A]=Re[P]=Re[b]=Re[w]=Re[M]=Re[k]=Re[D]=Re[U]=Re[j]=Re[S]=Re[I]=Re[x]=Re[L]=Re[W]=Re[G]=Re[F]=Re[B]=!0,Re[N]=Re[C]=Re[\"[object Map]\"]=Re[\"[object Set]\"]=Re[\"[object WeakMap]\"]=!1;var Ee={\"À\":\"A\",\"Á\":\"A\",\"Â\":\"A\",\"Ã\":\"A\",\"Ä\":\"A\",\"Å\":\"A\",\"à\":\"a\",\"á\":\"a\",\"â\":\"a\",\"ã\":\"a\",\"ä\":\"a\",\"å\":\"a\",\"Ç\":\"C\",\"ç\":\"c\",\"Ð\":\"D\",\"ð\":\"d\",\"È\":\"E\",\"É\":\"E\",\"Ê\":\"E\",\"Ë\":\"E\",\"è\":\"e\",\"é\":\"e\",\"ê\":\"e\",\"ë\":\"e\",\"Ì\":\"I\",\"Í\":\"I\",\"Î\":\"I\",\"Ï\":\"I\",\"ì\":\"i\",\"í\":\"i\",\"î\":\"i\",\"ï\":\"i\",\"Ñ\":\"N\",\"ñ\":\"n\",\"Ò\":\"O\",\"Ó\":\"O\",\"Ô\":\"O\",\"Õ\":\"O\",\"Ö\":\"O\",\"Ø\":\"O\",\"ò\":\"o\",\"ó\":\"o\",\"ô\":\"o\",\"õ\":\"o\",\"ö\":\"o\",\"ø\":\"o\",\"Ù\":\"U\",\"Ú\":\"U\",\"Û\":\"U\",\"Ü\":\"U\",\"ù\":\"u\",\"ú\":\"u\",\"û\":\"u\",\"ü\":\"u\",\"Ý\":\"Y\",\"ý\":\"y\",\"ÿ\":\"y\",\"Æ\":\"Ae\",\"æ\":\"ae\",\"Þ\":\"Th\",\"þ\":\"th\",\"ß\":\"ss\"},ge={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"`\":\"&#96;\"},ve={\"&amp;\":\"&\",\"&lt;\":\"<\",\"&gt;\":\">\",\"&quot;\":'\"',\"&#39;\":\"'\",\"&#96;\":\"`\"},Oe={function:!0,object:!0},Te={0:\"x30\",1:\"x31\",2:\"x32\",3:\"x33\",4:\"x34\",5:\"x35\",6:\"x36\",7:\"x37\",8:\"x38\",9:\"x39\",A:\"x41\",B:\"x42\",C:\"x43\",D:\"x44\",E:\"x45\",F:\"x46\",a:\"x61\",b:\"x62\",c:\"x63\",d:\"x64\",e:\"x65\",f:\"x66\",n:\"x6e\",r:\"x72\",t:\"x74\",u:\"x75\",v:\"x76\",x:\"x78\"},Ae={\"\\\\\":\"\\\\\",\"'\":\"'\",\"\\n\":\"n\",\"\\r\":\"r\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"},be=Oe[typeof r]&&r&&!r.nodeType&&r,we=Oe[typeof t]&&t&&!t.nodeType&&t,Ne=be&&we&&\"object\"==typeof e&&e&&e.Object&&e,Ce=Oe[typeof self]&&self&&self.Object&&self,Se=Oe[typeof window]&&window&&window.Object&&window,Ie=we&&we.exports===be&&be,xe=Ne||Se!==(this&&this.window)&&Se||Ce||this;function Le(e,t){if(e!==t){var r=null===e,o=e===n,i=e==e,a=null===t,s=t===n,u=t==t;if(e>t&&!a||!i||r&&!s&&u||o&&u)return 1;if(e<t&&!r||!u||a&&!o&&i||s&&i)return-1}return 0}function Pe(e,t,r){for(var n=e.length,o=r?n:-1;r?o--:++o<n;)if(t(e[o],o,e))return o;return-1}function Me(e,t,r){if(t!=t)return Ye(e,r);for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}function ke(e){return\"function\"==typeof e||!1}function De(e){return null==e?\"\":e+\"\"}function Ue(e,t){for(var r=-1,n=e.length;++r<n&&t.indexOf(e.charAt(r))>-1;);return r}function je(e,t){for(var r=e.length;r--&&t.indexOf(e.charAt(r))>-1;);return r}function We(e,t){return Le(e.criteria,t.criteria)||e.index-t.index}function Ge(e){return Ee[e]}function Fe(e){return ge[e]}function Be(e,t,r){return t?e=Te[e]:r&&(e=Ae[e]),\"\\\\\"+e}function He(e){return\"\\\\\"+Ae[e]}function Ye(e,t,r){for(var n=e.length,o=t+(r?0:-1);r?o--:++o<n;){var i=e[o];if(i!=i)return o}return-1}function Ke(e){return!!e&&\"object\"==typeof e}function Ve(e){return e<=160&&e>=9&&e<=13||32==e||160==e||5760==e||6158==e||e>=8192&&(e<=8202||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}function Xe(e,t){for(var r=-1,n=e.length,o=-1,i=[];++r<n;)e[r]===t&&(e[r]=O,i[++o]=r);return i}function qe(e){for(var t=-1,r=e.length;++t<r&&Ve(e.charCodeAt(t)););return t}function ze(e){for(var t=e.length;t--&&Ve(e.charCodeAt(t)););return t}function Je(e){return ve[e]}var Ze=function e(t){var r=(t=t?Ze.defaults(xe.Object(),t,Ze.pick(xe,me)):xe).Array,Ee=t.Date,ge=t.Error,ve=t.Function,Oe=t.Math,Te=t.Number,Ae=t.Object,be=t.RegExp,we=t.String,Ne=t.TypeError,Ce=r.prototype,Se=Ae.prototype,Ie=we.prototype,Ve=ve.prototype.toString,$e=Se.hasOwnProperty,Qe=0,et=Se.toString,tt=xe._,rt=be(\"^\"+Ve.call($e).replace(/[\\\\^$.*+?()[\\]{}|]/g,\"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,\"$1.*?\")+\"$\"),nt=t.ArrayBuffer,ot=t.clearTimeout,it=t.parseFloat,at=Oe.pow,st=Se.propertyIsEnumerable,ut=Rn(t,\"Set\"),ct=t.setTimeout,lt=Ce.splice,pt=t.Uint8Array,ft=Rn(t,\"WeakMap\"),dt=Oe.ceil,ht=Rn(Ae,\"create\"),mt=Oe.floor,yt=Rn(r,\"isArray\"),_t=t.isFinite,Rt=Rn(Ae,\"keys\"),Et=Oe.max,gt=Oe.min,vt=Rn(Ee,\"now\"),Ot=t.parseInt,Tt=Oe.random,At=Te.NEGATIVE_INFINITY,bt=Te.POSITIVE_INFINITY,wt=4294967295,Nt=wt-1,Ct=wt>>>1,St=9007199254740991,It=ft&&new ft,xt={};function Lt(e){if(Ke(e)&&!Ko(e)&&!(e instanceof kt)){if(e instanceof Mt)return e;if($e.call(e,\"__chain__\")&&$e.call(e,\"__wrapped__\"))return Mn(e)}return new Mt(e)}function Pt(){}function Mt(e,t,r){this.__wrapped__=e,this.__actions__=r||[],this.__chain__=!!t}Lt.support={};function kt(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=bt,this.__views__=[]}function Dt(){this.__data__={}}function Ut(e){var t=e?e.length:0;for(this.data={hash:ht(null),set:new ut};t--;)this.push(e[t])}function jt(e,t){var r=e.data;return(\"string\"==typeof t||zo(t)?r.set.has(t):r.hash[t])?0:-1}function Wt(e,t){var n=-1,o=e.length;for(t||(t=r(o));++n<o;)t[n]=e[n];return t}function Gt(e,t){for(var r=-1,n=e.length;++r<n&&!1!==t(e[r],r,e););return e}function Ft(e,t){for(var r=-1,n=e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function Bt(e,t){for(var r=-1,n=e.length,o=-1,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[++o]=a)}return i}function Ht(e,t){for(var n=-1,o=e.length,i=r(o);++n<o;)i[n]=t(e[n],n,e);return i}function Yt(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}function Kt(e,t,r,n){var o=-1,i=e.length;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}function Vt(e,t){for(var r=-1,n=e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function Xt(e,t,r,o){return e!==n&&$e.call(o,r)?e:t}function qt(e,t,r){for(var o=-1,i=yi(t),a=i.length;++o<a;){var s=i[o],u=e[s],c=r(u,t[s],s,e,t);(c==c?c===u:u!=u)&&(u!==n||s in e)||(e[s]=c)}return e}function zt(e,t){return null==t?e:Zt(t,yi(t),e)}function Jt(e,t){for(var o=-1,i=null==e,a=!i&&gn(e),s=a?e.length:0,u=t.length,c=r(u);++o<u;){var l=t[o];c[o]=a?vn(l,s)?e[l]:n:i?n:e[l]}return c}function Zt(e,t,r){r||(r={});for(var n=-1,o=t.length;++n<o;){var i=t[n];r[i]=e[i]}return r}function $t(e,t,r){var o=typeof e;return\"function\"==o?t===n?e:kr(e,t,r):null==e?Di:\"object\"==o?Er(e):t===n?Bi(e):gr(e,t)}function Qt(e,t,r,o,i,a,s){var u;if(r&&(u=i?r(e,o,i):r(e)),u!==n)return u;if(!zo(e))return e;var c=Ko(e);if(c){if(u=function(e){var t=e.length,r=new e.constructor(t);return t&&\"string\"==typeof e[0]&&$e.call(e,\"index\")&&(r.index=e.index,r.input=e.input),r}(e),!t)return Wt(e,u)}else{var l=et.call(e),p=l==C;if(l!=I&&l!=T&&(!p||i))return Re[l]?function(e,t,r){var n=e.constructor;switch(t){case P:return Dr(e);case b:case w:return new n(+e);case M:case k:case D:case U:case j:case W:case G:case F:case B:var o=e.buffer;return new n(r?Dr(o):o,e.byteOffset,e.length);case S:case L:return new n(e);case x:var i=new n(e.source,se.exec(e));i.lastIndex=e.lastIndex}return i}(e,l,t):i?e:{};if(u=function(e){var t=e.constructor;return\"function\"==typeof t&&t instanceof t||(t=Ae),new t}(p?{}:e),!t)return zt(u,e)}a||(a=[]),s||(s=[]);for(var f=a.length;f--;)if(a[f]==e)return s[f];return a.push(e),s.push(u),(c?Gt:fr)(e,function(n,o){u[o]=Qt(n,t,r,o,e,a,s)}),u}Lt.templateSettings={escape:J,evaluate:Z,interpolate:$,variable:\"\",imports:{_:Lt}};var er=function(){function e(){}return function(t){if(zo(t)){e.prototype=t;var r=new e;e.prototype=n}return r||{}}}();function tr(e,t,r){if(\"function\"!=typeof e)throw new Ne(v);return ct(function(){e.apply(n,r)},t)}function rr(e,t){var r=e?e.length:0,n=[];if(!r)return n;var o=-1,i=mn(),a=i==Me,s=a&&t.length>=R?Hr(t):null,u=t.length;s&&(i=jt,a=!1,t=s);e:for(;++o<r;){var c=e[o];if(a&&c==c){for(var l=u;l--;)if(t[l]===c)continue e;n.push(c)}else i(t,c,0)<0&&n.push(c)}return n}var nr=Fr(fr),or=Fr(dr,!0);function ir(e,t){var r=!0;return nr(e,function(e,n,o){return r=!!t(e,n,o)}),r}function ar(e,t){var r=[];return nr(e,function(e,n,o){t(e,n,o)&&r.push(e)}),r}function sr(e,t,r,n){var o;return r(e,function(e,r,i){if(t(e,r,i))return o=n?r:e,!1}),o}function ur(e,t,r,n){n||(n=[]);for(var o=-1,i=e.length;++o<i;){var a=e[o];Ke(a)&&gn(a)&&(r||Ko(a)||Yo(a))?t?ur(a,t,r,n):Yt(n,a):r||(n[n.length]=a)}return n}var cr=Br(),lr=Br(!0);function pr(e,t){return cr(e,t,_i)}function fr(e,t){return cr(e,t,yi)}function dr(e,t){return lr(e,t,yi)}function hr(e,t){for(var r=-1,n=t.length,o=-1,i=[];++r<n;){var a=t[r];qo(e[a])&&(i[++o]=a)}return i}function mr(e,t,r){if(null!=e){r!==n&&r in Ln(e)&&(t=[r]);for(var o=0,i=t.length;null!=e&&o<i;)e=e[t[o++]];return o&&o==i?e:n}}function yr(e,t,r,o,i,a){return e===t||(null==e||null==t||!zo(e)&&!Ke(t)?e!=e&&t!=t:function(e,t,r,o,i,a,s){var u=Ko(e),c=Ko(t),l=A,p=A;u||((l=et.call(e))==T?l=I:l!=I&&(u=ti(e))),c||((p=et.call(t))==T?p=I:p!=I&&(c=ti(t)));var f=l==I,d=p==I,h=l==p;if(h&&!u&&!f)return function(e,t,r){switch(r){case b:case w:return+e==+t;case N:return e.name==t.name&&e.message==t.message;case S:return e!=+e?t!=+t:e==+t;case x:case L:return e==t+\"\"}return!1}(e,t,l);if(!i){var m=f&&$e.call(e,\"__wrapped__\"),y=d&&$e.call(t,\"__wrapped__\");if(m||y)return r(m?e.value():e,y?t.value():t,o,i,a,s)}if(!h)return!1;a||(a=[]),s||(s=[]);for(var _=a.length;_--;)if(a[_]==e)return s[_]==t;a.push(e),s.push(t);var R=(u?function(e,t,r,o,i,a,s){var u=-1,c=e.length,l=t.length;if(c!=l&&!(i&&l>c))return!1;for(;++u<c;){var p=e[u],f=t[u],d=o?o(i?f:p,i?p:f,u):n;if(d!==n){if(d)continue;return!1}if(i){if(!Vt(t,function(e){return p===e||r(p,e,o,i,a,s)}))return!1}else if(p!==f&&!r(p,f,o,i,a,s))return!1}return!0}:function(e,t,r,o,i,a,s){var u=yi(e),c=u.length,l=yi(t).length;if(c!=l&&!i)return!1;for(var p=c;p--;){var f=u[p];if(!(i?f in t:$e.call(t,f)))return!1}for(var d=i;++p<c;){f=u[p];var h=e[f],m=t[f],y=o?o(i?m:h,i?h:m,f):n;if(!(y===n?r(h,m,o,i,a,s):y))return!1;d||(d=\"constructor\"==f)}if(!d){var _=e.constructor,R=t.constructor;if(_!=R&&\"constructor\"in e&&\"constructor\"in t&&!(\"function\"==typeof _&&_ instanceof _&&\"function\"==typeof R&&R instanceof R))return!1}return!0})(e,t,r,o,i,a,s);return a.pop(),s.pop(),R}(e,t,yr,r,o,i,a))}function _r(e,t,r){var o=t.length,i=o,a=!r;if(null==e)return!i;for(e=Ln(e);o--;){var s=t[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){var u=(s=t[o])[0],c=e[u],l=s[1];if(a&&s[2]){if(c===n&&!(u in e))return!1}else{var p=r?r(c,l,u):n;if(!(p===n?yr(l,c,r,!0):p))return!1}}return!0}function Rr(e,t){var n=-1,o=gn(e)?r(e.length):[];return nr(e,function(e,r,i){o[++n]=t(e,r,i)}),o}function Er(e){var t=_n(e);if(1==t.length&&t[0][2]){var r=t[0][0],o=t[0][1];return function(e){return null!=e&&e[r]===o&&(o!==n||r in Ln(e))}}return function(e){return _r(e,t)}}function gr(e,t){var r=Ko(e),o=Tn(e)&&wn(t),i=e+\"\";return e=Pn(e),function(a){if(null==a)return!1;var s=i;if(a=Ln(a),(r||!o)&&!(s in a)){if(null==(a=1==e.length?a:mr(a,br(e,0,-1))))return!1;s=Hn(e),a=Ln(a)}return a[s]===t?t!==n||s in a:yr(t,a[s],n,!0)}}function vr(e){return function(t){return null==t?n:t[e]}}function Or(e,t){for(var r=e?t.length:0;r--;){var n=t[r];if(n!=o&&vn(n)){var o=n;lt.call(e,n,1)}}return e}function Tr(e,t){return e+mt(Tt()*(t-e+1))}var Ar=It?function(e,t){return It.set(e,t),e}:Di;function br(e,t,o){var i=-1,a=e.length;(t=null==t?0:+t||0)<0&&(t=-t>a?0:a+t),(o=o===n||o>a?a:+o||0)<0&&(o+=a),a=t>o?0:o-t>>>0,t>>>=0;for(var s=r(a);++i<a;)s[i]=e[i+t];return s}function wr(e,t){var r;return nr(e,function(e,n,o){return!(r=t(e,n,o))}),!!r}function Nr(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function Cr(e,t,r){var n=fn(),o=-1;return t=Ht(t,function(e){return n(e)}),Nr(Rr(e,function(e){return{criteria:Ht(t,function(t){return t(e)}),index:++o,value:e}}),function(e,t){return function(e,t,r){for(var n=-1,o=e.criteria,i=t.criteria,a=o.length,s=r.length;++n<a;){var u=Le(o[n],i[n]);if(u){if(n>=s)return u;var c=r[n];return u*(\"asc\"===c||!0===c?1:-1)}}return e.index-t.index}(e,t,r)})}function Sr(e,t){var r=-1,n=mn(),o=e.length,i=n==Me,a=i&&o>=R,s=a?Hr():null,u=[];s?(n=jt,i=!1):(a=!1,s=t?[]:u);e:for(;++r<o;){var c=e[r],l=t?t(c,r,e):c;if(i&&c==c){for(var p=s.length;p--;)if(s[p]===l)continue e;t&&s.push(l),u.push(c)}else n(s,l,0)<0&&((t||a)&&s.push(l),u.push(c))}return u}function Ir(e,t){for(var n=-1,o=t.length,i=r(o);++n<o;)i[n]=e[t[n]];return i}function xr(e,t,r,n){for(var o=e.length,i=n?o:-1;(n?i--:++i<o)&&t(e[i],i,e););return r?br(e,n?0:i,n?i+1:o):br(e,n?i+1:0,n?o:i)}function Lr(e,t){var r=e;r instanceof kt&&(r=r.value());for(var n=-1,o=t.length;++n<o;){var i=t[n];r=i.func.apply(i.thisArg,Yt([r],i.args))}return r}function Pr(e,t,r){var n=0,o=e?e.length:n;if(\"number\"==typeof t&&t==t&&o<=Ct){for(;n<o;){var i=n+o>>>1,a=e[i];(r?a<=t:a<t)&&null!==a?n=i+1:o=i}return o}return Mr(e,t,Di,r)}function Mr(e,t,r,o){t=r(t);for(var i=0,a=e?e.length:0,s=t!=t,u=null===t,c=t===n;i<a;){var l=mt((i+a)/2),p=r(e[l]),f=p!==n,d=p==p;if(s)var h=d||o;else h=u?d&&f&&(o||null!=p):c?d&&(o||f):null!=p&&(o?p<=t:p<t);h?i=l+1:a=l}return gt(a,Nt)}function kr(e,t,r){if(\"function\"!=typeof e)return Di;if(t===n)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 3:return function(r,n,o){return e.call(t,r,n,o)};case 4:return function(r,n,o,i){return e.call(t,r,n,o,i)};case 5:return function(r,n,o,i,a){return e.call(t,r,n,o,i,a)}}return function(){return e.apply(t,arguments)}}function Dr(e){var t=new nt(e.byteLength);return new pt(t).set(new pt(e)),t}function Ur(e,t,n){for(var o=n.length,i=-1,a=Et(e.length-o,0),s=-1,u=t.length,c=r(u+a);++s<u;)c[s]=t[s];for(;++i<o;)c[n[i]]=e[i];for(;a--;)c[s++]=e[i++];return c}function jr(e,t,n){for(var o=-1,i=n.length,a=-1,s=Et(e.length-i,0),u=-1,c=t.length,l=r(s+c);++a<s;)l[a]=e[a];for(var p=a;++u<c;)l[p+u]=t[u];for(;++o<i;)l[p+n[o]]=e[a++];return l}function Wr(e,t){return function(r,n,o){var i=t?t():{};if(n=fn(n,o,3),Ko(r))for(var a=-1,s=r.length;++a<s;){var u=r[a];e(i,u,n(u,a,r),r)}else nr(r,function(t,r,o){e(i,t,n(t,r,o),o)});return i}}function Gr(e){return Bo(function(t,r){var o=-1,i=null==t?0:r.length,a=i>2?r[i-2]:n,s=i>2?r[2]:n,u=i>1?r[i-1]:n;for(\"function\"==typeof a?(a=kr(a,u,5),i-=2):i-=(a=\"function\"==typeof u?u:n)?1:0,s&&On(r[0],r[1],s)&&(a=i<3?n:a,i=1);++o<i;){var c=r[o];c&&e(t,c,a)}return t})}function Fr(e,t){return function(r,n){var o=r?yn(r):0;if(!bn(o))return e(r,n);for(var i=t?o:-1,a=Ln(r);(t?i--:++i<o)&&!1!==n(a[i],i,a););return r}}function Br(e){return function(t,r,n){for(var o=Ln(t),i=n(t),a=i.length,s=e?a:-1;e?s--:++s<a;){var u=i[s];if(!1===r(o[u],u,o))break}return t}}function Hr(e){return ht&&ut?new Ut(e):null}function Yr(e){return function(t){for(var r=-1,n=Pi(bi(t)),o=n.length,i=\"\";++r<o;)i=e(i,n[r],r);return i}}function Kr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=er(e.prototype),n=e.apply(r,t);return zo(n)?n:r}}function Vr(e){return function t(r,o,i){i&&On(r,o,i)&&(o=n);var a=pn(r,e,n,n,n,n,n,o);return a.placeholder=t.placeholder,a}}function Xr(e,t){return Bo(function(r){var o=r[0];return null==o?o:(r.push(t),e.apply(n,r))})}function qr(e,t){return function(r,o,i){if(i&&On(r,o,i)&&(o=n),1==(o=fn(o,i,3)).length){var a=function(e,t,r,n){for(var o=-1,i=e.length,a=n,s=a;++o<i;){var u=e[o],c=+t(u);r(c,a)&&(a=c,s=u)}return s}(r=Ko(r)?r:xn(r),o,e,t);if(!r.length||a!==t)return a}return function(e,t,r,n){var o=n,i=o;return nr(e,function(e,a,s){var u=+t(e,a,s);(r(u,o)||u===n&&u===i)&&(o=u,i=e)}),i}(r,o,e,t)}}function zr(e,t){return function(r,o,i){if(o=fn(o,i,3),Ko(r)){var a=Pe(r,o,t);return a>-1?r[a]:n}return sr(r,o,e)}}function Jr(e){return function(t,r,n){return t&&t.length?Pe(t,r=fn(r,n,3),e):-1}}function Zr(e){return function(t,r,n){return sr(t,r=fn(r,n,3),e,!0)}}function $r(e){return function(){for(var t,o=arguments.length,i=e?o:-1,a=0,s=r(o);e?i--:++i<o;){var c=s[a++]=arguments[i];if(\"function\"!=typeof c)throw new Ne(v);!t&&Mt.prototype.thru&&\"wrapper\"==hn(c)&&(t=new Mt([],!0))}for(i=t?-1:o;++i<o;){var p=hn(c=s[i]),h=\"wrapper\"==p?dn(c):n;t=h&&An(h[0])&&h[1]==(f|u|l|d)&&!h[4].length&&1==h[9]?t[hn(h[0])].apply(t,h[3]):1==c.length&&An(c)?t[p]():t.thru(c)}return function(){var e=arguments,r=e[0];if(t&&1==e.length&&Ko(r)&&r.length>=R)return t.plant(r).value();for(var n=0,i=o?s[n].apply(this,e):r;++n<o;)i=s[n].call(this,i);return i}}}function Qr(e,t){return function(r,o,i){return\"function\"==typeof o&&i===n&&Ko(r)?e(r,o):t(r,kr(o,i,3))}}function en(e){return function(t,r,o){return\"function\"==typeof r&&o===n||(r=kr(r,o,3)),e(t,r,_i)}}function tn(e){return function(t,r,o){return\"function\"==typeof r&&o===n||(r=kr(r,o,3)),e(t,r)}}function rn(e){return function(t,r,n){var o={};return r=fn(r,n,3),fr(t,function(t,n,i){var a=r(t,n,i);n=e?a:n,t=e?t:a,o[n]=t}),o}}function nn(e){return function(t,r,n){return t=De(t),(e?t:\"\")+un(t,r,n)+(e?\"\":t)}}function on(e){var t=Bo(function(r,o){var i=Xe(o,t.placeholder);return pn(r,e,n,o,i)});return t}function an(e,t){return function(r,o,i,a){var s=arguments.length<3;return\"function\"==typeof o&&a===n&&Ko(r)?e(r,o,i,s):function(e,t,r,n,o){return o(e,function(e,o,i){r=n?(n=!1,e):t(r,e,o,i)}),r}(r,fn(o,a,4),i,s,t)}}function sn(e,t,o,d,h,m,y,_,R,E){var g=t&f,v=t&i,O=t&a,T=t&u,A=t&s,b=t&c,w=O?n:Kr(e);return function s(){for(var u=arguments.length,c=u,f=r(u);c--;)f[c]=arguments[c];if(d&&(f=Ur(f,d,h)),m&&(f=jr(f,m,y)),T||b){var N=s.placeholder,C=Xe(f,N);if((u-=C.length)<E){var S=_?Wt(_):n,I=Et(E-u,0);t|=T?l:p,t&=~(T?p:l),A||(t&=~(i|a));var x=[e,t,o,T?f:n,T?C:n,T?n:f,T?n:C,S,R,I],L=sn.apply(n,x);return An(e)&&Sn(L,x),L.placeholder=N,L}}var P=v?o:this,M=O?P[e]:e;return _&&(f=function(e,t){for(var r=e.length,o=gt(t.length,r),i=Wt(e);o--;){var a=t[o];e[o]=vn(a,r)?i[a]:n}return e}(f,_)),g&&R<f.length&&(f.length=R),this&&this!==xe&&this instanceof s&&(M=w||Kr(e)),M.apply(P,f)}}function un(e,t,r){var n=e.length;if(n>=(t=+t)||!_t(t))return\"\";var o=t-n;return Si(r=null==r?\" \":r+\"\",dt(o/r.length)).slice(0,o)}function cn(e){var t=Oe[e];return function(e,r){return(r=r===n?0:+r||0)?(r=at(10,r),t(e*r)/r):t(e)}}function ln(e){return function(t,r,n,o){var i=fn(n);return null==n&&i===$t?Pr(t,r,e):Mr(t,r,i(n,o,1),e)}}function pn(e,t,o,c,h,m,y,_){var R=t&a;if(!R&&\"function\"!=typeof e)throw new Ne(v);var E=c?c.length:0;if(E||(t&=~(l|p),c=h=n),E-=h?h.length:0,t&p){var g=c,T=h;c=h=n}var A=R?n:dn(e),b=[e,t,o,c,h,g,T,m,y,_];if(A&&(function(e,t){var r=e[1],n=t[1],o=r|n,a=o<f,c=n==f&&r==u||n==f&&r==d&&e[7].length<=t[8]||n==(f|d)&&r==u;if(!a&&!c)return e;n&i&&(e[2]=t[2],o|=r&i?0:s);var l=t[3];if(l){var p=e[3];e[3]=p?Ur(p,l,t[4]):Wt(l),e[4]=p?Xe(e[3],O):Wt(t[4])}(l=t[5])&&(p=e[5],e[5]=p?jr(p,l,t[6]):Wt(l),e[6]=p?Xe(e[5],O):Wt(t[6])),(l=t[7])&&(e[7]=Wt(l)),n&f&&(e[8]=null==e[8]?t[8]:gt(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(b,A),t=b[1],_=b[9]),b[9]=null==_?R?0:e.length:Et(_-E,0)||0,t==i)var w=function(e,t){var r=Kr(e);return function n(){return(this&&this!==xe&&this instanceof n?r:e).apply(t,arguments)}}(b[0],b[2]);else w=t!=l&&t!=(i|l)||b[4].length?sn.apply(n,b):function(e,t,n,o){var a=t&i,s=Kr(e);return function t(){for(var i=-1,u=arguments.length,c=-1,l=o.length,p=r(l+u);++c<l;)p[c]=o[c];for(;u--;)p[c++]=arguments[++i];return(this&&this!==xe&&this instanceof t?s:e).apply(a?n:this,p)}}.apply(n,b);return(A?Ar:Sn)(w,b)}function fn(e,t,r){var n=Lt.callback||ki;return n=n===ki?$t:n,r?n(e,t,r):n}var dn=It?function(e){return It.get(e)}:Fi;function hn(e){for(var t=e.name,r=xt[t],n=r?r.length:0;n--;){var o=r[n],i=o.func;if(null==i||i==e)return o.name}return t}function mn(e,t,r){var n=Lt.indexOf||Fn;return n=n===Fn?Me:n,e?n(e,t,r):n}var yn=vr(\"length\");function _n(e){for(var t=vi(e),r=t.length;r--;)t[r][2]=wn(t[r][1]);return t}function Rn(e,t){var r=null==e?n:e[t];return Jo(r)?r:n}function En(e,t,r){null==e||Tn(t,e)||(e=1==(t=Pn(t)).length?e:mr(e,br(t,0,-1)),t=Hn(t));var o=null==e?e:e[t];return null==o?n:o.apply(e,r)}function gn(e){return null!=e&&bn(yn(e))}function vn(e,t){return e=\"number\"==typeof e||le.test(e)?+e:-1,t=null==t?St:t,e>-1&&e%1==0&&e<t}function On(e,t,r){if(!zo(r))return!1;var n=typeof t;if(\"number\"==n?gn(r)&&vn(t,r.length):\"string\"==n&&t in r){var o=r[t];return e==e?e===o:o!=o}return!1}function Tn(e,t){var r=typeof e;return!!(\"string\"==r&&ee.test(e)||\"number\"==r)||!Ko(e)&&(!Q.test(e)||null!=t&&e in Ln(t))}function An(e){var t=hn(e);if(!(t in kt.prototype))return!1;var r=Lt[t];if(e===r)return!0;var n=dn(r);return!!n&&e===n[0]}function bn(e){return\"number\"==typeof e&&e>-1&&e%1==0&&e<=St}function wn(e){return e==e&&!zo(e)}function Nn(e,t){e=Ln(e);for(var r=-1,n=t.length,o={};++r<n;){var i=t[r];i in e&&(o[i]=e[i])}return o}function Cn(e,t){var r={};return pr(e,function(e,n,o){t(e,n,o)&&(r[n]=e)}),r}var Sn=function(){var e=0,t=0;return function(r,n){var o=bo(),i=_-(o-t);if(t=o,i>0){if(++e>=y)return r}else e=0;return Ar(r,n)}}();function In(e){for(var t=_i(e),r=t.length,n=r&&e.length,o=!!n&&bn(n)&&(Ko(e)||Yo(e)),i=-1,a=[];++i<r;){var s=t[i];(o&&vn(s,n)||$e.call(e,s))&&a.push(s)}return a}function xn(e){return null==e?[]:gn(e)?zo(e)?e:Ae(e):Ti(e)}function Ln(e){return zo(e)?e:Ae(e)}function Pn(e){if(Ko(e))return e;var t=[];return De(e).replace(te,function(e,r,n,o){t.push(n?o.replace(ie,\"$1\"):r||e)}),t}function Mn(e){return e instanceof kt?e.clone():new Mt(e.__wrapped__,e.__chain__,Wt(e.__actions__))}var kn=Bo(function(e,t){return Ke(e)&&gn(e)?rr(e,ur(t,!1,!0)):[]});function Dn(e,t,r){return e&&e.length?((r?On(e,t,r):null==t)&&(t=1),br(e,t<0?0:t)):[]}function Un(e,t,r){var n=e?e.length:0;return n?((r?On(e,t,r):null==t)&&(t=1),br(e,0,(t=n-(+t||0))<0?0:t)):[]}var jn=Jr(),Wn=Jr(!0);function Gn(e){return e?e[0]:n}function Fn(e,t,r){var n=e?e.length:0;if(!n)return-1;if(\"number\"==typeof r)r=r<0?Et(n+r,0):r;else if(r){var o=Pr(e,t);return o<n&&(t==t?t===e[o]:e[o]!=e[o])?o:-1}return Me(e,t,r||0)}var Bn=Bo(function(e){for(var t=e.length,n=t,o=r(p),i=mn(),a=i==Me,s=[];n--;){var u=e[n]=gn(u=e[n])?u:[];o[n]=a&&u.length>=120?Hr(n&&u):null}var c=e[0],l=-1,p=c?c.length:0,f=o[0];e:for(;++l<p;)if(u=c[l],(f?jt(f,u):i(s,u,0))<0){for(n=t;--n;){var d=o[n];if((d?jt(d,u):i(e[n],u,0))<0)continue e}f&&f.push(u),s.push(u)}return s});function Hn(e){var t=e?e.length:0;return t?e[t-1]:n}var Yn=Bo(function(e,t){var r=Jt(e,t=ur(t));return Or(e,t.sort(Le)),r});function Kn(e){return Dn(e,1)}var Vn=ln(),Xn=ln(!0);var qn=Bo(function(e){return Sr(ur(e,!1,!0))});function zn(e,t,r,o){if(!e||!e.length)return[];null!=t&&\"boolean\"!=typeof t&&(r=On(e,t,o=r)?n:t,t=!1);var i=fn();return null==r&&i===$t||(r=i(r,o,3)),t&&mn()==Me?function(e,t){for(var r,n=-1,o=e.length,i=-1,a=[];++n<o;){var s=e[n],u=t?t(s,n,e):s;n&&r===u||(r=u,a[++i]=s)}return a}(e,r):Sr(e,r)}function Jn(e){if(!e||!e.length)return[];var t=-1,n=0;e=Bt(e,function(e){if(gn(e))return n=Et(e.length,n),!0});for(var o=r(n);++t<n;)o[t]=Ht(e,vr(t));return o}function Zn(e,t,r){if(!e||!e.length)return[];var o=Jn(e);return null==t?o:(t=kr(t,r,4),Ht(o,function(e){return Kt(e,t,n,!0)}))}var $n=Bo(function(e,t){return gn(e)?rr(e,t):[]});var Qn=Bo(Jn);function eo(e,t){var r=-1,n=e?e.length:0,o={};for(!n||t||Ko(e[0])||(t=[]);++r<n;){var i=e[r];t?o[i]=t[r]:i&&(o[i[0]]=i[1])}return o}var to=Bo(function(e){var t=e.length,r=t>2?e[t-2]:n,o=t>1?e[t-1]:n;return t>2&&\"function\"==typeof r?t-=2:(r=t>1&&\"function\"==typeof o?(--t,o):n,o=n),e.length=t,Zn(e,r,o)});function ro(e){var t=Lt(e);return t.__chain__=!0,t}function no(e,t,r){return t.call(r,e)}var oo=Bo(function(e){return e=ur(e),this.thru(function(t){return function(e,t){for(var n=-1,o=e.length,i=-1,a=t.length,s=r(o+a);++n<o;)s[n]=e[n];for(;++i<a;)s[n++]=t[i];return s}(Ko(t)?t:[Ln(t)],e)})});var io=Bo(function(e,t){return Jt(e,ur(t))}),ao=Wr(function(e,t,r){$e.call(e,r)?++e[r]:e[r]=1});function so(e,t,r){var o=Ko(e)?Ft:ir;return r&&On(e,t,r)&&(t=n),\"function\"==typeof t&&r===n||(t=fn(t,r,3)),o(e,t)}function uo(e,t,r){return(Ko(e)?Bt:ar)(e,t=fn(t,r,3))}var co=zr(nr),lo=zr(or,!0);var po=Qr(Gt,nr),fo=Qr(function(e,t){for(var r=e.length;r--&&!1!==t(e[r],r,e););return e},or),ho=Wr(function(e,t,r){$e.call(e,r)?e[r].push(t):e[r]=[t]});function mo(e,t,r,n){var o=e?yn(e):0;return bn(o)||(o=(e=Ti(e)).length),r=\"number\"!=typeof r||n&&On(t,r,n)?0:r<0?Et(o+r,0):r||0,\"string\"==typeof e||!Ko(e)&&ei(e)?r<=o&&e.indexOf(t,r)>-1:!!o&&mn(e,t,r)>-1}var yo=Wr(function(e,t,r){e[r]=t}),_o=Bo(function(e,t,o){var i=-1,a=\"function\"==typeof t,s=Tn(t),u=gn(e)?r(e.length):[];return nr(e,function(e){var r=a?t:s&&null!=e?e[t]:n;u[++i]=r?r.apply(e,o):En(e,t,o)}),u});function Ro(e,t,r){return(Ko(e)?Ht:Rr)(e,t=fn(t,r,3))}var Eo=Wr(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]});var go=an(Kt,nr),vo=an(function(e,t,r,n){var o=e.length;for(n&&o&&(r=e[--o]);o--;)r=t(r,e[o],o,e);return r},or);function Oo(e,t,r){if(r?On(e,t,r):null==t)return(o=(e=xn(e)).length)>0?e[Tr(0,o-1)]:n;var o,i=-1,a=ni(e),s=(o=a.length)-1;for(t=gt(t<0?0:+t||0,o);++i<t;){var u=Tr(i,s),c=a[u];a[u]=a[i],a[i]=c}return a.length=t,a}function To(e,t,r){var o=Ko(e)?Vt:wr;return r&&On(e,t,r)&&(t=n),\"function\"==typeof t&&r===n||(t=fn(t,r,3)),o(e,t)}var Ao=Bo(function(e,t){if(null==e)return[];var r=t[2];return r&&On(t[0],t[1],r)&&(t.length=1),Cr(e,ur(t),[])});var bo=vt||function(){return(new Ee).getTime()};function wo(e,t){var r;if(\"function\"!=typeof t){if(\"function\"!=typeof e)throw new Ne(v);var o=e;e=t,t=o}return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=n),r}}var No=Bo(function(e,t,r){var n=i;if(r.length){var o=Xe(r,No.placeholder);n|=l}return pn(e,n,t,r,o)}),Co=Bo(function(e,t){for(var r=-1,n=(t=t.length?ur(t):mi(e)).length;++r<n;){var o=t[r];e[o]=pn(e[o],i,e)}return e}),So=Bo(function(e,t,r){var n=i|a;if(r.length){var o=Xe(r,So.placeholder);n|=l}return pn(t,n,e,r,o)}),Io=Vr(u),xo=Vr(c);function Lo(e,t,r){var o,i,a,s,u,c,l,p=0,f=!1,d=!0;if(\"function\"!=typeof e)throw new Ne(v);if(t=t<0?0:+t||0,!0===r){var h=!0;d=!1}else zo(r)&&(h=!!r.leading,f=\"maxWait\"in r&&Et(+r.maxWait||0,t),d=\"trailing\"in r?!!r.trailing:d);function m(t,r){r&&ot(r),i=c=l=n,t&&(p=bo(),a=e.apply(u,o),c||i||(o=u=n))}function y(){var e=t-(bo()-s);e<=0||e>t?m(l,i):c=ct(y,e)}function _(){m(d,c)}function R(){if(o=arguments,s=bo(),u=this,l=d&&(c||!h),!1===f)var r=h&&!c;else{i||h||(p=s);var m=f-(s-p),R=m<=0||m>f;R?(i&&(i=ot(i)),p=s,a=e.apply(u,o)):i||(i=ct(_,m))}return R&&c?c=ot(c):c||t===f||(c=ct(y,t)),r&&(R=!0,a=e.apply(u,o)),!R||c||i||(o=u=n),a}return R.cancel=function(){c&&ot(c),i&&ot(i),p=0,i=c=l=n},R}var Po=Bo(function(e,t){return tr(e,1,t)}),Mo=Bo(function(e,t,r){return tr(e,t,r)}),ko=$r(),Do=$r(!0);function Uo(e,t){if(\"function\"!=typeof e||t&&\"function\"!=typeof t)throw new Ne(v);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new Uo.Cache,r}var jo=Bo(function(e,t){if(t=ur(t),\"function\"!=typeof e||!Ft(t,ke))throw new Ne(v);var r=t.length;return Bo(function(n){for(var o=gt(n.length,r);o--;)n[o]=t[o](n[o]);return e.apply(this,n)})});var Wo=on(l),Go=on(p),Fo=Bo(function(e,t){return pn(e,d,n,n,n,ur(t))});function Bo(e,t){if(\"function\"!=typeof e)throw new Ne(v);return t=Et(t===n?e.length-1:+t||0,0),function(){for(var n=arguments,o=-1,i=Et(n.length-t,0),a=r(i);++o<i;)a[o]=n[t+o];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,n[0],a);case 2:return e.call(this,n[0],n[1],a)}var s=r(t+1);for(o=-1;++o<t;)s[o]=n[o];return s[t]=a,e.apply(this,s)}}function Ho(e,t){return e>t}function Yo(e){return Ke(e)&&gn(e)&&$e.call(e,\"callee\")&&!st.call(e,\"callee\")}var Ko=yt||function(e){return Ke(e)&&bn(e.length)&&et.call(e)==A};function Vo(e,t,r,o){var i=(r=\"function\"==typeof r?kr(r,o,3):n)?r(e,t):n;return i===n?yr(e,t,r):!!i}function Xo(e){return Ke(e)&&\"string\"==typeof e.message&&et.call(e)==N}function qo(e){return zo(e)&&et.call(e)==C}function zo(e){var t=typeof e;return!!e&&(\"object\"==t||\"function\"==t)}function Jo(e){return null!=e&&(qo(e)?rt.test(Ve.call(e)):Ke(e)&&ce.test(e))}function Zo(e){return\"number\"==typeof e||Ke(e)&&et.call(e)==S}function $o(e){var t,r;return!(!Ke(e)||et.call(e)!=I||Yo(e)||!($e.call(e,\"constructor\")||\"function\"!=typeof(t=e.constructor)||t instanceof t))&&(pr(e,function(e,t){r=t}),r===n||$e.call(e,r))}function Qo(e){return zo(e)&&et.call(e)==x}function ei(e){return\"string\"==typeof e||Ke(e)&&et.call(e)==L}function ti(e){return Ke(e)&&bn(e.length)&&!!_e[et.call(e)]}function ri(e,t){return e<t}function ni(e){var t=e?yn(e):0;return bn(t)?t?Wt(e):[]:Ti(e)}function oi(e){return Zt(e,_i(e))}var ii=Gr(function e(t,r,o,i,a){if(!zo(t))return t;var s=gn(r)&&(Ko(r)||ti(r)),u=s?n:yi(r);return Gt(u||r,function(c,l){if(u&&(c=r[l=c]),Ke(c))i||(i=[]),a||(a=[]),function(e,t,r,o,i,a,s){for(var u=a.length,c=t[r];u--;)if(a[u]==c)return void(e[r]=s[u]);var l=e[r],p=i?i(l,c,r,e,t):n,f=p===n;f&&(p=c,gn(c)&&(Ko(c)||ti(c))?p=Ko(l)?l:gn(l)?Wt(l):[]:$o(c)||Yo(c)?p=Yo(l)?oi(l):$o(l)?l:{}:f=!1),a.push(c),s.push(p),f?e[r]=o(p,c,i,a,s):(p==p?p!==l:l==l)&&(e[r]=p)}(t,r,l,e,o,i,a);else{var p=t[l],f=o?o(p,c,l,t,r):n,d=f===n;d&&(f=c),f===n&&(!s||l in t)||!d&&(f==f?f===p:p!=p)||(t[l]=f)}}),t}),ai=Gr(function(e,t,r){return r?qt(e,t,r):zt(e,t)});var si=Xr(ai,function(e,t){return e===n?t:e}),ui=Xr(ii,function e(t,r){return t===n?r:ii(t,r,e)}),ci=Zr(fr),li=Zr(dr),pi=en(cr),fi=en(lr),di=tn(fr),hi=tn(dr);function mi(e){return hr(e,_i(e))}var yi=Rt?function(e){var t=null==e?n:e.constructor;return\"function\"==typeof t&&t.prototype===e||\"function\"!=typeof e&&gn(e)?In(e):zo(e)?Rt(e):[]}:In;function _i(e){if(null==e)return[];zo(e)||(e=Ae(e));var t=e.length;t=t&&bn(t)&&(Ko(e)||Yo(e))&&t||0;for(var n=e.constructor,o=-1,i=\"function\"==typeof n&&n.prototype===e,a=r(t),s=t>0;++o<t;)a[o]=o+\"\";for(var u in e)s&&vn(u,t)||\"constructor\"==u&&(i||!$e.call(e,u))||a.push(u);return a}var Ri=rn(!0),Ei=rn(),gi=Bo(function(e,t){if(null==e)return{};if(\"function\"!=typeof t[0])return t=Ht(ur(t),we),Nn(e,rr(_i(e),t));var r=kr(t[0],t[1],3);return Cn(e,function(e,t,n){return!r(e,t,n)})});function vi(e){e=Ln(e);for(var t=-1,n=yi(e),o=n.length,i=r(o);++t<o;){var a=n[t];i[t]=[a,e[a]]}return i}var Oi=Bo(function(e,t){return null==e?{}:\"function\"==typeof t[0]?Cn(e,kr(t[0],t[1],3)):Nn(e,ur(t))});function Ti(e){return Ir(e,yi(e))}var Ai=Yr(function(e,t,r){return t=t.toLowerCase(),e+(r?t.charAt(0).toUpperCase()+t.slice(1):t)});function bi(e){return(e=De(e))&&e.replace(pe,Ge).replace(oe,\"\")}var wi=Yr(function(e,t,r){return e+(r?\"-\":\"\")+t.toLowerCase()});var Ni=nn(),Ci=nn(!0);function Si(e,t){var r=\"\";if(e=De(e),(t=+t)<1||!e||!_t(t))return r;do{t%2&&(r+=e),t=mt(t/2),e+=e}while(t);return r}var Ii=Yr(function(e,t,r){return e+(r?\"_\":\"\")+t.toLowerCase()}),xi=Yr(function(e,t,r){return e+(r?\" \":\"\")+(t.charAt(0).toUpperCase()+t.slice(1))});function Li(e,t,r){var n=e;return(e=De(e))?(r?On(n,t,r):null==t)?e.slice(qe(e),ze(e)+1):(t+=\"\",e.slice(Ue(e,t),je(e,t)+1)):e}function Pi(e,t,r){return r&&On(e,t,r)&&(t=n),(e=De(e)).match(t||he)||[]}var Mi=Bo(function(e,t){try{return e.apply(n,t)}catch(e){return Xo(e)?e:new ge(e)}});function ki(e,t,r){return r&&On(e,t,r)&&(t=n),Ke(e)?Ui(e):$t(e,t)}function Di(e){return e}function Ui(e){return Er(Qt(e,!0))}var ji=Bo(function(e,t){return function(r){return En(r,e,t)}}),Wi=Bo(function(e,t){return function(r){return En(e,r,t)}});function Gi(e,t,r){if(null==r){var o=zo(t),i=o?yi(t):n,a=i&&i.length?hr(t,i):n;(a?a.length:o)||(a=!1,r=t,t=e,e=this)}a||(a=hr(t,yi(t)));var s=!0,u=-1,c=qo(e),l=a.length;!1===r?s=!1:zo(r)&&\"chain\"in r&&(s=r.chain);for(;++u<l;){var p=a[u],f=t[p];e[p]=f,c&&(e.prototype[p]=function(t){return function(){var r=this.__chain__;if(s||r){var n=e(this.__wrapped__);return(n.__actions__=Wt(this.__actions__)).push({func:t,args:arguments,thisArg:e}),n.__chain__=r,n}return t.apply(e,Yt([this.value()],arguments))}}(f))}return e}function Fi(){}function Bi(e){return Tn(e)?vr(e):function(e){var t=e+\"\";return e=Pn(e),function(r){return mr(r,e,t)}}(e)}var Hi=cn(\"ceil\"),Yi=cn(\"floor\"),Ki=qr(Ho,At),Vi=qr(ri,bt),Xi=cn(\"round\");return Lt.prototype=Pt.prototype,Mt.prototype=er(Pt.prototype),Mt.prototype.constructor=Mt,kt.prototype=er(Pt.prototype),kt.prototype.constructor=kt,Dt.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Dt.prototype.get=function(e){return\"__proto__\"==e?n:this.__data__[e]},Dt.prototype.has=function(e){return\"__proto__\"!=e&&$e.call(this.__data__,e)},Dt.prototype.set=function(e,t){return\"__proto__\"!=e&&(this.__data__[e]=t),this},Ut.prototype.push=function(e){var t=this.data;\"string\"==typeof e||zo(e)?t.set.add(e):t.hash[e]=!0},Uo.Cache=Dt,Lt.after=function(e,t){if(\"function\"!=typeof t){if(\"function\"!=typeof e)throw new Ne(v);var r=e;e=t,t=r}return e=_t(e=+e)?e:0,function(){if(--e<1)return t.apply(this,arguments)}},Lt.ary=function(e,t,r){return r&&On(e,t,r)&&(t=n),t=e&&null==t?e.length:Et(+t||0,0),pn(e,f,n,n,n,n,t)},Lt.assign=ai,Lt.at=io,Lt.before=wo,Lt.bind=No,Lt.bindAll=Co,Lt.bindKey=So,Lt.callback=ki,Lt.chain=ro,Lt.chunk=function(e,t,n){t=(n?On(e,t,n):null==t)?1:Et(mt(t)||1,1);for(var o=0,i=e?e.length:0,a=-1,s=r(dt(i/t));o<i;)s[++a]=br(e,o,o+=t);return s},Lt.compact=function(e){for(var t=-1,r=e?e.length:0,n=-1,o=[];++t<r;){var i=e[t];i&&(o[++n]=i)}return o},Lt.constant=function(e){return function(){return e}},Lt.countBy=ao,Lt.create=function(e,t,r){var o=er(e);return r&&On(e,t,r)&&(t=n),t?zt(o,t):o},Lt.curry=Io,Lt.curryRight=xo,Lt.debounce=Lo,Lt.defaults=si,Lt.defaultsDeep=ui,Lt.defer=Po,Lt.delay=Mo,Lt.difference=kn,Lt.drop=Dn,Lt.dropRight=Un,Lt.dropRightWhile=function(e,t,r){return e&&e.length?xr(e,fn(t,r,3),!0,!0):[]},Lt.dropWhile=function(e,t,r){return e&&e.length?xr(e,fn(t,r,3),!0):[]},Lt.fill=function(e,t,r,o){var i=e?e.length:0;return i?(r&&\"number\"!=typeof r&&On(e,t,r)&&(r=0,o=i),function(e,t,r,o){var i=e.length;for((r=null==r?0:+r||0)<0&&(r=-r>i?0:i+r),(o=o===n||o>i?i:+o||0)<0&&(o+=i),i=r>o?0:o>>>0,r>>>=0;r<i;)e[r++]=t;return e}(e,t,r,o)):[]},Lt.filter=uo,Lt.flatten=function(e,t,r){var n=e?e.length:0;return r&&On(e,t,r)&&(t=!1),n?ur(e,t):[]},Lt.flattenDeep=function(e){return e&&e.length?ur(e,!0):[]},Lt.flow=ko,Lt.flowRight=Do,Lt.forEach=po,Lt.forEachRight=fo,Lt.forIn=pi,Lt.forInRight=fi,Lt.forOwn=di,Lt.forOwnRight=hi,Lt.functions=mi,Lt.groupBy=ho,Lt.indexBy=yo,Lt.initial=function(e){return Un(e,1)},Lt.intersection=Bn,Lt.invert=function(e,t,r){r&&On(e,t,r)&&(t=n);for(var o=-1,i=yi(e),a=i.length,s={};++o<a;){var u=i[o],c=e[u];t?$e.call(s,c)?s[c].push(u):s[c]=[u]:s[c]=u}return s},Lt.invoke=_o,Lt.keys=yi,Lt.keysIn=_i,Lt.map=Ro,Lt.mapKeys=Ri,Lt.mapValues=Ei,Lt.matches=Ui,Lt.matchesProperty=function(e,t){return gr(e,Qt(t,!0))},Lt.memoize=Uo,Lt.merge=ii,Lt.method=ji,Lt.methodOf=Wi,Lt.mixin=Gi,Lt.modArgs=jo,Lt.negate=function(e){if(\"function\"!=typeof e)throw new Ne(v);return function(){return!e.apply(this,arguments)}},Lt.omit=gi,Lt.once=function(e){return wo(2,e)},Lt.pairs=vi,Lt.partial=Wo,Lt.partialRight=Go,Lt.partition=Eo,Lt.pick=Oi,Lt.pluck=function(e,t){return Ro(e,Bi(t))},Lt.property=Bi,Lt.propertyOf=function(e){return function(t){return mr(e,Pn(t),t+\"\")}},Lt.pull=function(){var e=arguments,t=e[0];if(!t||!t.length)return t;for(var r=0,n=mn(),o=e.length;++r<o;)for(var i=0,a=e[r];(i=n(t,a,i))>-1;)lt.call(t,i,1);return t},Lt.pullAt=Yn,Lt.range=function(e,t,o){o&&On(e,t,o)&&(t=o=n),e=+e||0,o=null==o?1:+o||0,null==t?(t=e,e=0):t=+t||0;for(var i=-1,a=Et(dt((t-e)/(o||1)),0),s=r(a);++i<a;)s[i]=e,e+=o;return s},Lt.rearg=Fo,Lt.reject=function(e,t,r){var n=Ko(e)?Bt:ar;return t=fn(t,r,3),n(e,function(e,r,n){return!t(e,r,n)})},Lt.remove=function(e,t,r){var n=[];if(!e||!e.length)return n;var o=-1,i=[],a=e.length;for(t=fn(t,r,3);++o<a;){var s=e[o];t(s,o,e)&&(n.push(s),i.push(o))}return Or(e,i),n},Lt.rest=Kn,Lt.restParam=Bo,Lt.set=function(e,t,r){if(null==e)return e;for(var n=t+\"\",o=-1,i=(t=null!=e[n]||Tn(t,e)?[n]:Pn(t)).length,a=i-1,s=e;null!=s&&++o<i;){var u=t[o];zo(s)&&(o==a?s[u]=r:null==s[u]&&(s[u]=vn(t[o+1])?[]:{})),s=s[u]}return e},Lt.shuffle=function(e){return Oo(e,bt)},Lt.slice=function(e,t,r){var n=e?e.length:0;return n?(r&&\"number\"!=typeof r&&On(e,t,r)&&(t=0,r=n),br(e,t,r)):[]},Lt.sortBy=function(e,t,r){if(null==e)return[];r&&On(e,t,r)&&(t=n);var o=-1;return t=fn(t,r,3),Nr(Rr(e,function(e,r,n){return{criteria:t(e,r,n),index:++o,value:e}}),We)},Lt.sortByAll=Ao,Lt.sortByOrder=function(e,t,r,o){return null==e?[]:(o&&On(t,r,o)&&(r=n),Ko(t)||(t=null==t?[]:[t]),Ko(r)||(r=null==r?[]:[r]),Cr(e,t,r))},Lt.spread=function(e){if(\"function\"!=typeof e)throw new Ne(v);return function(t){return e.apply(this,t)}},Lt.take=function(e,t,r){return e&&e.length?((r?On(e,t,r):null==t)&&(t=1),br(e,0,t<0?0:t)):[]},Lt.takeRight=function(e,t,r){var n=e?e.length:0;return n?((r?On(e,t,r):null==t)&&(t=1),br(e,(t=n-(+t||0))<0?0:t)):[]},Lt.takeRightWhile=function(e,t,r){return e&&e.length?xr(e,fn(t,r,3),!1,!0):[]},Lt.takeWhile=function(e,t,r){return e&&e.length?xr(e,fn(t,r,3)):[]},Lt.tap=function(e,t,r){return t.call(r,e),e},Lt.throttle=function(e,t,r){var n=!0,o=!0;if(\"function\"!=typeof e)throw new Ne(v);return!1===r?n=!1:zo(r)&&(n=\"leading\"in r?!!r.leading:n,o=\"trailing\"in r?!!r.trailing:o),Lo(e,t,{leading:n,maxWait:+t,trailing:o})},Lt.thru=no,Lt.times=function(e,t,n){if((e=mt(e))<1||!_t(e))return[];var o=-1,i=r(gt(e,wt));for(t=kr(t,n,1);++o<e;)o<wt?i[o]=t(o):t(o);return i},Lt.toArray=ni,Lt.toPlainObject=oi,Lt.transform=function(e,t,r,o){var i=Ko(e)||ti(e);if(t=fn(t,o,4),null==r)if(i||zo(e)){var a=e.constructor;r=i?Ko(e)?new a:[]:er(qo(a)?a.prototype:n)}else r={};return(i?Gt:fr)(e,function(e,n,o){return t(r,e,n,o)}),r},Lt.union=qn,Lt.uniq=zn,Lt.unzip=Jn,Lt.unzipWith=Zn,Lt.values=Ti,Lt.valuesIn=function(e){return Ir(e,_i(e))},Lt.where=function(e,t){return uo(e,Er(t))},Lt.without=$n,Lt.wrap=function(e,t){return pn(t=null==t?Di:t,l,n,[e],[])},Lt.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var r=arguments[e];if(gn(r))var n=n?Yt(rr(n,r),rr(r,n)):r}return n?Sr(n):[]},Lt.zip=Qn,Lt.zipObject=eo,Lt.zipWith=to,Lt.backflow=Do,Lt.collect=Ro,Lt.compose=Do,Lt.each=po,Lt.eachRight=fo,Lt.extend=ai,Lt.iteratee=ki,Lt.methods=mi,Lt.object=eo,Lt.select=uo,Lt.tail=Kn,Lt.unique=zn,Gi(Lt,Lt),Lt.add=function(e,t){return(+e||0)+(+t||0)},Lt.attempt=Mi,Lt.camelCase=Ai,Lt.capitalize=function(e){return(e=De(e))&&e.charAt(0).toUpperCase()+e.slice(1)},Lt.ceil=Hi,Lt.clone=function(e,t,r,n){return t&&\"boolean\"!=typeof t&&On(e,t,r)?t=!1:\"function\"==typeof t&&(n=r,r=t,t=!1),\"function\"==typeof r?Qt(e,t,kr(r,n,1)):Qt(e,t)},Lt.cloneDeep=function(e,t,r){return\"function\"==typeof t?Qt(e,!0,kr(t,r,1)):Qt(e,!0)},Lt.deburr=bi,Lt.endsWith=function(e,t,r){t+=\"\";var o=(e=De(e)).length;return r=r===n?o:gt(r<0?0:+r||0,o),(r-=t.length)>=0&&e.indexOf(t,r)==r},Lt.escape=function(e){return(e=De(e))&&z.test(e)?e.replace(X,Fe):e},Lt.escapeRegExp=function(e){return(e=De(e))&&ne.test(e)?e.replace(re,Be):e||\"(?:)\"},Lt.every=so,Lt.find=co,Lt.findIndex=jn,Lt.findKey=ci,Lt.findLast=lo,Lt.findLastIndex=Wn,Lt.findLastKey=li,Lt.findWhere=function(e,t){return co(e,Er(t))},Lt.first=Gn,Lt.floor=Yi,Lt.get=function(e,t,r){var o=null==e?n:mr(e,Pn(t),t+\"\");return o===n?r:o},Lt.gt=Ho,Lt.gte=function(e,t){return e>=t},Lt.has=function(e,t){if(null==e)return!1;var r=$e.call(e,t);if(!r&&!Tn(t)){if(null==(e=1==(t=Pn(t)).length?e:mr(e,br(t,0,-1))))return!1;t=Hn(t),r=$e.call(e,t)}return r||bn(e.length)&&vn(t,e.length)&&(Ko(e)||Yo(e))},Lt.identity=Di,Lt.includes=mo,Lt.indexOf=Fn,Lt.inRange=function(e,t,r){return t=+t||0,r===n?(r=t,t=0):r=+r||0,e>=gt(t,r)&&e<Et(t,r)},Lt.isArguments=Yo,Lt.isArray=Ko,Lt.isBoolean=function(e){return!0===e||!1===e||Ke(e)&&et.call(e)==b},Lt.isDate=function(e){return Ke(e)&&et.call(e)==w},Lt.isElement=function(e){return!!e&&1===e.nodeType&&Ke(e)&&!$o(e)},Lt.isEmpty=function(e){return null==e||(gn(e)&&(Ko(e)||ei(e)||Yo(e)||Ke(e)&&qo(e.splice))?!e.length:!yi(e).length)},Lt.isEqual=Vo,Lt.isError=Xo,Lt.isFinite=function(e){return\"number\"==typeof e&&_t(e)},Lt.isFunction=qo,Lt.isMatch=function(e,t,r,o){return r=\"function\"==typeof r?kr(r,o,3):n,_r(e,_n(t),r)},Lt.isNaN=function(e){return Zo(e)&&e!=+e},Lt.isNative=Jo,Lt.isNull=function(e){return null===e},Lt.isNumber=Zo,Lt.isObject=zo,Lt.isPlainObject=$o,Lt.isRegExp=Qo,Lt.isString=ei,Lt.isTypedArray=ti,Lt.isUndefined=function(e){return e===n},Lt.kebabCase=wi,Lt.last=Hn,Lt.lastIndexOf=function(e,t,r){var n=e?e.length:0;if(!n)return-1;var o=n;if(\"number\"==typeof r)o=(r<0?Et(n+r,0):gt(r||0,n-1))+1;else if(r){var i=e[o=Pr(e,t,!0)-1];return(t==t?t===i:i!=i)?o:-1}if(t!=t)return Ye(e,o,!0);for(;o--;)if(e[o]===t)return o;return-1},Lt.lt=ri,Lt.lte=function(e,t){return e<=t},Lt.max=Ki,Lt.min=Vi,Lt.noConflict=function(){return xe._=tt,this},Lt.noop=Fi,Lt.now=bo,Lt.pad=function(e,t,r){t=+t;var n=(e=De(e)).length;if(n>=t||!_t(t))return e;var o=(t-n)/2,i=mt(o);return(r=un(\"\",dt(o),r)).slice(0,i)+e+r},Lt.padLeft=Ni,Lt.padRight=Ci,Lt.parseInt=function(e,t,r){return(r?On(e,t,r):null==t)?t=0:t&&(t=+t),e=Li(e),Ot(e,t||(ue.test(e)?16:10))},Lt.random=function(e,t,r){r&&On(e,t,r)&&(t=r=n);var o=null==e,i=null==t;if(null==r&&(i&&\"boolean\"==typeof e?(r=e,e=1):\"boolean\"==typeof t&&(r=t,i=!0)),o&&i&&(t=1,i=!1),e=+e||0,i?(t=e,e=0):t=+t||0,r||e%1||t%1){var a=Tt();return gt(e+a*(t-e+it(\"1e-\"+((a+\"\").length-1))),t)}return Tr(e,t)},Lt.reduce=go,Lt.reduceRight=vo,Lt.repeat=Si,Lt.result=function(e,t,r){var o=null==e?n:e[t];return o===n&&(null==e||Tn(t,e)||(o=null==(e=1==(t=Pn(t)).length?e:mr(e,br(t,0,-1)))?n:e[Hn(t)]),o=o===n?r:o),qo(o)?o.call(e):o},Lt.round=Xi,Lt.runInContext=e,Lt.size=function(e){var t=e?yn(e):0;return bn(t)?t:yi(e).length},Lt.snakeCase=Ii,Lt.some=To,Lt.sortedIndex=Vn,Lt.sortedLastIndex=Xn,Lt.startCase=xi,Lt.startsWith=function(e,t,r){return e=De(e),r=null==r?0:gt(r<0?0:+r||0,e.length),e.lastIndexOf(t,r)==r},Lt.sum=function(e,t,r){return r&&On(e,t,r)&&(t=n),1==(t=fn(t,r,3)).length?function(e,t){for(var r=e.length,n=0;r--;)n+=+t(e[r])||0;return n}(Ko(e)?e:xn(e),t):function(e,t){var r=0;return nr(e,function(e,n,o){r+=+t(e,n,o)||0}),r}(e,t)},Lt.template=function(e,t,r){var o=Lt.templateSettings;r&&On(e,t,r)&&(t=r=n),e=De(e);var i,a,s=qt(zt({},(t=qt(zt({},r||t),o,Xt)).imports),o.imports,Xt),u=yi(s),c=Ir(s,u),l=0,p=t.interpolate||fe,f=\"__p += '\",d=be((t.escape||fe).source+\"|\"+p.source+\"|\"+(p===$?ae:fe).source+\"|\"+(t.evaluate||fe).source+\"|$\",\"g\"),h=\"//# sourceURL=\"+(\"sourceURL\"in t?t.sourceURL:\"lodash.templateSources[\"+ ++ye+\"]\")+\"\\n\";e.replace(d,function(t,r,n,o,s,u){return n||(n=o),f+=e.slice(l,u).replace(de,He),r&&(i=!0,f+=\"' +\\n__e(\"+r+\") +\\n'\"),s&&(a=!0,f+=\"';\\n\"+s+\";\\n__p += '\"),n&&(f+=\"' +\\n((__t = (\"+n+\")) == null ? '' : __t) +\\n'\"),l=u+t.length,t}),f+=\"';\\n\";var m=t.variable;m||(f=\"with (obj) {\\n\"+f+\"\\n}\\n\"),f=(a?f.replace(H,\"\"):f).replace(Y,\"$1\").replace(K,\"$1;\"),f=\"function(\"+(m||\"obj\")+\") {\\n\"+(m?\"\":\"obj || (obj = {});\\n\")+\"var __t, __p = ''\"+(i?\", __e = _.escape\":\"\")+(a?\", __j = Array.prototype.join;\\nfunction print() { __p += __j.call(arguments, '') }\\n\":\";\\n\")+f+\"return __p\\n}\";var y=Mi(function(){return ve(u,h+\"return \"+f).apply(n,c)});if(y.source=f,Xo(y))throw y;return y},Lt.trim=Li,Lt.trimLeft=function(e,t,r){var n=e;return(e=De(e))?(r?On(n,t,r):null==t)?e.slice(qe(e)):e.slice(Ue(e,t+\"\")):e},Lt.trimRight=function(e,t,r){var n=e;return(e=De(e))?(r?On(n,t,r):null==t)?e.slice(0,ze(e)+1):e.slice(0,je(e,t+\"\")+1):e},Lt.trunc=function(e,t,r){r&&On(e,t,r)&&(t=n);var o=h,i=m;if(null!=t)if(zo(t)){var a=\"separator\"in t?t.separator:a;o=\"length\"in t?+t.length||0:o,i=\"omission\"in t?De(t.omission):i}else o=+t||0;if(o>=(e=De(e)).length)return e;var s=o-i.length;if(s<1)return i;var u=e.slice(0,s);if(null==a)return u+i;if(Qo(a)){if(e.slice(s).search(a)){var c,l,p=e.slice(0,s);for(a.global||(a=be(a.source,(se.exec(a)||\"\")+\"g\")),a.lastIndex=0;c=a.exec(p);)l=c.index;u=u.slice(0,null==l?s:l)}}else if(e.indexOf(a,s)!=s){var f=u.lastIndexOf(a);f>-1&&(u=u.slice(0,f))}return u+i},Lt.unescape=function(e){return(e=De(e))&&q.test(e)?e.replace(V,Je):e},Lt.uniqueId=function(e){var t=++Qe;return De(e)+t},Lt.words=Pi,Lt.all=so,Lt.any=To,Lt.contains=mo,Lt.eq=Vo,Lt.detect=co,Lt.foldl=go,Lt.foldr=vo,Lt.head=Gn,Lt.include=mo,Lt.inject=go,Gi(Lt,function(){var e={};return fr(Lt,function(t,r){Lt.prototype[r]||(e[r]=t)}),e}(),!1),Lt.sample=Oo,Lt.prototype.sample=function(e){return this.__chain__||null!=e?this.thru(function(t){return Oo(t,e)}):Oo(this.value())},Lt.VERSION=o,Gt([\"bind\",\"bindKey\",\"curry\",\"curryRight\",\"partial\",\"partialRight\"],function(e){Lt[e].placeholder=Lt}),Gt([\"drop\",\"take\"],function(e,t){kt.prototype[e]=function(r){var n=this.__filtered__;if(n&&!t)return new kt(this);r=null==r?1:Et(mt(r)||0,0);var o=this.clone();return n?o.__takeCount__=gt(o.__takeCount__,r):o.__views__.push({size:r,type:e+(o.__dir__<0?\"Right\":\"\")}),o},kt.prototype[e+\"Right\"]=function(t){return this.reverse()[e](t).reverse()}}),Gt([\"filter\",\"map\",\"takeWhile\"],function(e,t){var r=t+1,n=r!=g;kt.prototype[e]=function(e,t){var o=this.clone();return o.__iteratees__.push({iteratee:fn(e,t,1),type:r}),o.__filtered__=o.__filtered__||n,o}}),Gt([\"first\",\"last\"],function(e,t){var r=\"take\"+(t?\"Right\":\"\");kt.prototype[e]=function(){return this[r](1).value()[0]}}),Gt([\"initial\",\"rest\"],function(e,t){var r=\"drop\"+(t?\"\":\"Right\");kt.prototype[e]=function(){return this.__filtered__?new kt(this):this[r](1)}}),Gt([\"pluck\",\"where\"],function(e,t){var r=t?\"filter\":\"map\",n=t?Er:Bi;kt.prototype[e]=function(e){return this[r](n(e))}}),kt.prototype.compact=function(){return this.filter(Di)},kt.prototype.reject=function(e,t){return e=fn(e,t,1),this.filter(function(t){return!e(t)})},kt.prototype.slice=function(e,t){e=null==e?0:+e||0;var r=this;return r.__filtered__&&(e>0||t<0)?new kt(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==n&&(r=(t=+t||0)<0?r.dropRight(-t):r.take(t-e)),r)},kt.prototype.takeRightWhile=function(e,t){return this.reverse().takeWhile(e,t).reverse()},kt.prototype.toArray=function(){return this.take(bt)},fr(kt.prototype,function(e,t){var r=/^(?:filter|map|reject)|While$/.test(t),o=/^(?:first|last)$/.test(t),i=Lt[o?\"take\"+(\"last\"==t?\"Right\":\"\"):t];i&&(Lt.prototype[t]=function(){var t=o?[1]:arguments,a=this.__chain__,s=this.__wrapped__,u=!!this.__actions__.length,c=s instanceof kt,l=t[0],p=c||Ko(s);p&&r&&\"function\"==typeof l&&1!=l.length&&(c=p=!1);var f=function(e){return o&&a?i(e,1)[0]:i.apply(n,Yt([e],t))},d={func:no,args:[f],thisArg:n},h=c&&!u;if(o&&!a)return h?((s=s.clone()).__actions__.push(d),e.call(s)):i.call(n,this.value())[0];if(!o&&p){s=h?s:new kt(this);var m=e.apply(s,t);return m.__actions__.push(d),new Mt(m,a)}return this.thru(f)})}),Gt([\"join\",\"pop\",\"push\",\"replace\",\"shift\",\"sort\",\"splice\",\"split\",\"unshift\"],function(e){var t=(/^(?:replace|split)$/.test(e)?Ie:Ce)[e],r=/^(?:push|sort|unshift)$/.test(e)?\"tap\":\"thru\",n=/^(?:join|pop|replace|shift)$/.test(e);Lt.prototype[e]=function(){var e=arguments;return n&&!this.__chain__?t.apply(this.value(),e):this[r](function(r){return t.apply(r,e)})}}),fr(kt.prototype,function(e,t){var r=Lt[t];if(r){var n=r.name;(xt[n]||(xt[n]=[])).push({name:t,func:r})}}),xt[sn(n,a).name]=[{name:\"wrapper\",func:n}],kt.prototype.clone=function(){var e=new kt(this.__wrapped__);return e.__actions__=Wt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Wt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Wt(this.__views__),e},kt.prototype.reverse=function(){if(this.__filtered__){var e=new kt(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},kt.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=Ko(e),n=t<0,o=r?e.length:0,i=function(e,t,r){for(var n=-1,o=r.length;++n<o;){var i=r[n],a=i.size;switch(i.type){case\"drop\":e+=a;break;case\"dropRight\":t-=a;break;case\"take\":t=gt(t,e+a);break;case\"takeRight\":e=Et(e,t-a)}}return{start:e,end:t}}(0,o,this.__views__),a=i.start,s=i.end,u=s-a,c=n?s:a-1,l=this.__iteratees__,p=l.length,f=0,d=gt(u,this.__takeCount__);if(!r||o<R||o==u&&d==u)return Lr(n&&r?e.reverse():e,this.__actions__);var h=[];e:for(;u--&&f<d;){for(var m=-1,y=e[c+=t];++m<p;){var _=l[m],v=_.iteratee,O=_.type,T=v(y);if(O==g)y=T;else if(!T){if(O==E)continue e;break e}}h[f++]=y}return h},Lt.prototype.chain=function(){return ro(this)},Lt.prototype.commit=function(){return new Mt(this.value(),this.__chain__)},Lt.prototype.concat=oo,Lt.prototype.plant=function(e){for(var t,r=this;r instanceof Pt;){var n=Mn(r);t?o.__wrapped__=n:t=n;var o=n;r=r.__wrapped__}return o.__wrapped__=e,t},Lt.prototype.reverse=function(){var e=this.__wrapped__,t=function(e){return r&&r.__dir__<0?e:e.reverse()};if(e instanceof kt){var r=e;return this.__actions__.length&&(r=new kt(this)),(r=r.reverse()).__actions__.push({func:no,args:[t],thisArg:n}),new Mt(r,this.__chain__)}return this.thru(t)},Lt.prototype.toString=function(){return this.value()+\"\"},Lt.prototype.run=Lt.prototype.toJSON=Lt.prototype.valueOf=Lt.prototype.value=function(){return Lr(this.__wrapped__,this.__actions__)},Lt.prototype.collect=Lt.prototype.map,Lt.prototype.head=Lt.prototype.first,Lt.prototype.select=Lt.prototype.filter,Lt.prototype.tail=Lt.prototype.rest,Lt}();\"function\"==typeof define&&\"object\"==typeof define.amd&&define.amd?(xe._=Ze,define(function(){return Ze})):be&&we?Ie?(we.exports=Ze)._=Ze:be._=Ze:xe._=Ze}).call(this)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],62:[function(e,t,r){(function(e,n){!function(e){\"use strict\";if(\"function\"==typeof bootstrap)bootstrap(\"promise\",e);else if(\"object\"==typeof r&&\"object\"==typeof t)t.exports=e();else if(\"function\"==typeof define&&define.amd)define(e);else if(\"undefined\"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if(\"undefined\"==typeof window&&\"undefined\"==typeof self)throw new Error(\"This environment was not anticipated by Q. Please file a bug.\");var n=\"undefined\"!=typeof window?window:self,o=n.Q;n.Q=e(),n.Q.noConflict=function(){return n.Q=o,this}}}(function(){\"use strict\";var t=!1;try{throw new Error}catch(e){t=!!e.stack}var r,o=T(),i=function(){},a=function(){var t={task:void 0,next:null},r=t,o=!1,i=void 0,s=!1,u=[];function c(){for(var e,r;t.next;)e=(t=t.next).task,t.task=void 0,(r=t.domain)&&(t.domain=void 0,r.enter()),l(e,r);for(;u.length;)l(e=u.pop());o=!1}function l(e,t){try{e()}catch(e){if(s)throw t&&t.exit(),setTimeout(c,0),t&&t.enter(),e;setTimeout(function(){throw e},0)}t&&t.exit()}if(a=function(t){r=r.next={task:t,domain:s&&e.domain,next:null},o||(o=!0,i())},\"object\"==typeof e&&\"[object process]\"===e.toString()&&e.nextTick)s=!0,i=function(){e.nextTick(c)};else if(\"function\"==typeof n)i=\"undefined\"!=typeof window?n.bind(window,c):function(){n(c)};else if(\"undefined\"!=typeof MessageChannel){var p=new MessageChannel;p.port1.onmessage=function(){i=f,p.port1.onmessage=c,c()};var f=function(){p.port2.postMessage(0)};i=function(){setTimeout(c,0),f()}}else i=function(){setTimeout(c,0)};return a.runAfter=function(e){u.push(e),o||(o=!0,i())},a}(),s=Function.call;function u(e){return function(){return s.apply(e,arguments)}}var c,l=u(Array.prototype.slice),p=u(Array.prototype.reduce||function(e,t){var r=0,n=this.length;if(1===arguments.length)for(;;){if(r in this){t=this[r++];break}if(++r>=n)throw new TypeError}for(;r<n;r++)r in this&&(t=e(t,this[r],r));return t}),f=u(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),d=u(Array.prototype.map||function(e,t){var r=this,n=[];return p(r,function(o,i,a){n.push(e.call(t,i,a,r))},void 0),n}),h=Object.create||function(e){function t(){}return t.prototype=e,new t},m=u(Object.prototype.hasOwnProperty),y=Object.keys||function(e){var t=[];for(var r in e)m(e,r)&&t.push(r);return t},_=u(Object.prototype.toString);c=\"undefined\"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var R=\"From previous event:\";function E(e,r){if(t&&r.stack&&\"object\"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(R)){for(var n=[],o=r;o;o=o.source)o.stack&&n.unshift(o.stack);n.unshift(e.stack);var i=n.join(\"\\n\"+R+\"\\n\");e.stack=function(e){for(var t=e.split(\"\\n\"),r=[],n=0;n<t.length;++n){var o=t[n];O(o)||g(o)||!o||r.push(o)}return r.join(\"\\n\")}(i)}}function g(e){return-1!==e.indexOf(\"(module.js:\")||-1!==e.indexOf(\"(node.js:\")}function v(e){var t=/at .+ \\((.+):(\\d+):(?:\\d+)\\)$/.exec(e);if(t)return[t[1],Number(t[2])];var r=/at ([^ ]+):(\\d+):(?:\\d+)$/.exec(e);if(r)return[r[1],Number(r[2])];var n=/.*@(.+):(\\d+)$/.exec(e);return n?[n[1],Number(n[2])]:void 0}function O(e){var t=v(e);if(!t)return!1;var n=t[0],i=t[1];return n===r&&i>=o&&i<=K}function T(){if(t)try{throw new Error}catch(t){var e=t.stack.split(\"\\n\"),n=v(e[0].indexOf(\"@\")>0?e[1]:e[2]);if(!n)return;return r=n[0],n[1]}}function A(e){return e instanceof C?e:L(e)?function(e){var t=b();return A.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}}),t.promise}(e):W(e)}function b(){var e,r=[],n=[],o=h(b.prototype),i=h(C.prototype);if(i.promiseDispatch=function(t,o,i){var a=l(arguments);r?(r.push(a),\"when\"===o&&i[1]&&n.push(i[1])):A.nextTick(function(){e.promiseDispatch.apply(e,a)})},i.valueOf=function(){if(r)return i;var t=I(e);return x(t)&&(e=t),t},i.inspect=function(){return e?e.inspect():{state:\"pending\"}},A.longStackSupport&&t)try{throw new Error}catch(e){i.stack=e.stack.substring(e.stack.indexOf(\"\\n\")+1)}function a(t){e=t,i.source=t,p(r,function(e,r){A.nextTick(function(){t.promiseDispatch.apply(t,r)})},void 0),r=void 0,n=void 0}return o.promise=i,o.resolve=function(t){e||a(A(t))},o.fulfill=function(t){e||a(W(t))},o.reject=function(t){e||a(j(t))},o.notify=function(t){e||p(n,function(e,r){A.nextTick(function(){r(t)})},void 0)},o}function w(e){if(\"function\"!=typeof e)throw new TypeError(\"resolver must be a function.\");var t=b();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function N(e){return w(function(t,r){for(var n=0,o=e.length;n<o;n++)A(e[n]).then(t,r)})}function C(e,t,r){void 0===t&&(t=function(e){return j(new Error(\"Promise does not support operation: \"+e))}),void 0===r&&(r=function(){return{state:\"unknown\"}});var n=h(C.prototype);if(n.promiseDispatch=function(r,o,i){var a;try{a=e[o]?e[o].apply(n,i):t.call(n,o,i)}catch(e){a=j(e)}r&&r(a)},n.inspect=r,r){var o=r();\"rejected\"===o.state&&(n.exception=o.reason),n.valueOf=function(){var e=r();return\"pending\"===e.state||\"rejected\"===e.state?n:e.value}}return n}function S(e,t,r,n){return A(e).then(t,r,n)}function I(e){if(x(e)){var t=e.inspect();if(\"fulfilled\"===t.state)return t.value}return e}function x(e){return e instanceof C}function L(e){return function(e){return e===Object(e)}(e)&&\"function\"==typeof e.then}A.resolve=A,A.nextTick=a,A.longStackSupport=!1,\"object\"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(A.longStackSupport=!0),A.defer=b,b.prototype.makeNodeResolver=function(){var e=this;return function(t,r){t?e.reject(t):arguments.length>2?e.resolve(l(arguments,1)):e.resolve(r)}},A.Promise=w,A.promise=w,w.race=N,w.all=B,w.reject=j,w.resolve=A,A.passByCopy=function(e){return e},C.prototype.passByCopy=function(){return this},A.join=function(e,t){return A(e).join(t)},C.prototype.join=function(e){return A([this,e]).spread(function(e,t){if(e===t)return e;throw new Error(\"Can't join: not the same: \"+e+\" \"+t)})},A.race=N,C.prototype.race=function(){return this.then(A.race)},A.makePromise=C,C.prototype.toString=function(){return\"[object Promise]\"},C.prototype.then=function(e,t,r){var n=this,o=b(),i=!1;return A.nextTick(function(){n.promiseDispatch(function(t){i||(i=!0,o.resolve(function(t){try{return\"function\"==typeof e?e(t):t}catch(e){return j(e)}}(t)))},\"when\",[function(e){i||(i=!0,o.resolve(function(e){if(\"function\"==typeof t){E(e,n);try{return t(e)}catch(e){return j(e)}}return j(e)}(e)))}])}),n.promiseDispatch(void 0,\"when\",[void 0,function(e){var t,n=!1;try{t=function(e){return\"function\"==typeof r?r(e):e}(e)}catch(e){if(n=!0,!A.onerror)throw e;A.onerror(e)}n||o.notify(t)}]),o.promise},A.tap=function(e,t){return A(e).tap(t)},C.prototype.tap=function(e){return e=A(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},A.when=S,C.prototype.thenResolve=function(e){return this.then(function(){return e})},A.thenResolve=function(e,t){return A(e).thenResolve(t)},C.prototype.thenReject=function(e){return this.then(function(){throw e})},A.thenReject=function(e,t){return A(e).thenReject(t)},A.nearer=I,A.isPromise=x,A.isPromiseAlike=L,A.isPending=function(e){return x(e)&&\"pending\"===e.inspect().state},C.prototype.isPending=function(){return\"pending\"===this.inspect().state},A.isFulfilled=function(e){return!x(e)||\"fulfilled\"===e.inspect().state},C.prototype.isFulfilled=function(){return\"fulfilled\"===this.inspect().state},A.isRejected=function(e){return x(e)&&\"rejected\"===e.inspect().state},C.prototype.isRejected=function(){return\"rejected\"===this.inspect().state};var P=[],M=[],k=[],D=!0;function U(){P.length=0,M.length=0,D||(D=!0)}function j(t){var r=C({when:function(r){return r&&function(t){if(D){var r=f(M,t);-1!==r&&(\"object\"==typeof e&&\"function\"==typeof e.emit&&A.nextTick.runAfter(function(){var n=f(k,t);-1!==n&&(e.emit(\"rejectionHandled\",P[r],t),k.splice(n,1))}),M.splice(r,1),P.splice(r,1))}}(this),r?r(t):this}},function(){return this},function(){return{state:\"rejected\",reason:t}});return function(t,r){D&&(\"object\"==typeof e&&\"function\"==typeof e.emit&&A.nextTick.runAfter(function(){-1!==f(M,t)&&(e.emit(\"unhandledRejection\",r,t),k.push(t))}),M.push(t),r&&void 0!==r.stack?P.push(r.stack):P.push(\"(no stack) \"+r))}(r,t),r}function W(e){return C({when:function(){return e},get:function(t){return e[t]},set:function(t,r){e[t]=r},delete:function(t){delete e[t]},post:function(t,r){return null===t||void 0===t?e.apply(void 0,r):e[t].apply(e,r)},apply:function(t,r){return e.apply(t,r)},keys:function(){return y(e)}},void 0,function(){return{state:\"fulfilled\",value:e}})}function G(e,t,r){return A(e).spread(t,r)}function F(e,t,r){return A(e).dispatch(t,r)}function B(e){return S(e,function(e){var t=0,r=b();return p(e,function(n,o,i){var a;x(o)&&\"fulfilled\"===(a=o.inspect()).state?e[i]=a.value:(++t,S(o,function(n){e[i]=n,0==--t&&r.resolve(e)},r.reject,function(e){r.notify({index:i,value:e})}))},void 0),0===t&&r.resolve(e),r.promise})}function H(e){if(0===e.length)return A.resolve();var t=A.defer(),r=0;return p(e,function(n,o,i){var a=e[i];r++,S(a,function(e){t.resolve(e)},function(){0==--r&&t.reject(new Error(\"Can't get fulfillment value from any promise, all promises were rejected.\"))},function(e){t.notify({index:i,value:e})})},void 0),t.promise}function Y(e){return S(e,function(e){return e=d(e,A),S(B(d(e,function(e){return S(e,i,i)})),function(){return e})})}A.resetUnhandledRejections=U,A.getUnhandledReasons=function(){return P.slice()},A.stopUnhandledRejectionTracking=function(){U(),D=!1},U(),A.reject=j,A.fulfill=W,A.master=function(e){return C({isDef:function(){}},function(t,r){return F(e,t,r)},function(){return A(e).inspect()})},A.spread=G,C.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},A.async=function(e){return function(){function t(e,t){var i;if(\"undefined\"==typeof StopIteration){try{i=r[e](t)}catch(e){return j(e)}return i.done?A(i.value):S(i.value,n,o)}try{i=r[e](t)}catch(e){return function(e){return\"[object StopIteration]\"===_(e)||e instanceof c}(e)?A(e.value):j(e)}return S(i,n,o)}var r=e.apply(this,arguments),n=t.bind(t,\"next\"),o=t.bind(t,\"throw\");return n()}},A.spawn=function(e){A.done(A.async(e)())},A.return=function(e){throw new c(e)},A.promised=function(e){return function(){return G([this,B(arguments)],function(t,r){return e.apply(t,r)})}},A.dispatch=F,C.prototype.dispatch=function(e,t){var r=this,n=b();return A.nextTick(function(){r.promiseDispatch(n.resolve,e,t)}),n.promise},A.get=function(e,t){return A(e).dispatch(\"get\",[t])},C.prototype.get=function(e){return this.dispatch(\"get\",[e])},A.set=function(e,t,r){return A(e).dispatch(\"set\",[t,r])},C.prototype.set=function(e,t){return this.dispatch(\"set\",[e,t])},A.del=A.delete=function(e,t){return A(e).dispatch(\"delete\",[t])},C.prototype.del=C.prototype.delete=function(e){return this.dispatch(\"delete\",[e])},A.mapply=A.post=function(e,t,r){return A(e).dispatch(\"post\",[t,r])},C.prototype.mapply=C.prototype.post=function(e,t){return this.dispatch(\"post\",[e,t])},A.send=A.mcall=A.invoke=function(e,t){return A(e).dispatch(\"post\",[t,l(arguments,2)])},C.prototype.send=C.prototype.mcall=C.prototype.invoke=function(e){return this.dispatch(\"post\",[e,l(arguments,1)])},A.fapply=function(e,t){return A(e).dispatch(\"apply\",[void 0,t])},C.prototype.fapply=function(e){return this.dispatch(\"apply\",[void 0,e])},A.try=A.fcall=function(e){return A(e).dispatch(\"apply\",[void 0,l(arguments,1)])},C.prototype.fcall=function(){return this.dispatch(\"apply\",[void 0,l(arguments)])},A.fbind=function(e){var t=A(e),r=l(arguments,1);return function(){return t.dispatch(\"apply\",[this,r.concat(l(arguments))])}},C.prototype.fbind=function(){var e=this,t=l(arguments);return function(){return e.dispatch(\"apply\",[this,t.concat(l(arguments))])}},A.keys=function(e){return A(e).dispatch(\"keys\",[])},C.prototype.keys=function(){return this.dispatch(\"keys\",[])},A.all=B,C.prototype.all=function(){return B(this)},A.any=H,C.prototype.any=function(){return H(this)},A.allResolved=function(e,t,r){return function(){return\"undefined\"!=typeof console&&console.warn,e.apply(e,arguments)}}(Y),C.prototype.allResolved=function(){return Y(this)},A.allSettled=function(e){return A(e).allSettled()},C.prototype.allSettled=function(){return this.then(function(e){return B(d(e,function(e){function t(){return e.inspect()}return(e=A(e)).then(t,t)}))})},A.fail=A.catch=function(e,t){return A(e).then(void 0,t)},C.prototype.fail=C.prototype.catch=function(e){return this.then(void 0,e)},A.progress=function(e,t){return A(e).then(void 0,void 0,t)},C.prototype.progress=function(e){return this.then(void 0,void 0,e)},A.fin=A.finally=function(e,t){return A(e).finally(t)},C.prototype.fin=C.prototype.finally=function(e){return e=A(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},A.done=function(e,t,r,n){return A(e).done(t,r,n)},C.prototype.done=function(t,r,n){var o=function(e){A.nextTick(function(){if(E(e,i),!A.onerror)throw e;A.onerror(e)})},i=t||r||n?this.then(t,r,n):this;\"object\"==typeof e&&e&&e.domain&&(o=e.domain.bind(o)),i.then(void 0,o)},A.timeout=function(e,t,r){return A(e).timeout(t,r)},C.prototype.timeout=function(e,t){var r=b(),n=setTimeout(function(){t&&\"string\"!=typeof t||((t=new Error(t||\"Timed out after \"+e+\" ms\")).code=\"ETIMEDOUT\"),r.reject(t)},e);return this.then(function(e){clearTimeout(n),r.resolve(e)},function(e){clearTimeout(n),r.reject(e)},r.notify),r.promise},A.delay=function(e,t){return void 0===t&&(t=e,e=void 0),A(e).delay(t)},C.prototype.delay=function(e){return this.then(function(t){var r=b();return setTimeout(function(){r.resolve(t)},e),r.promise})},A.nfapply=function(e,t){return A(e).nfapply(t)},C.prototype.nfapply=function(e){var t=b(),r=l(e);return r.push(t.makeNodeResolver()),this.fapply(r).fail(t.reject),t.promise},A.nfcall=function(e){var t=l(arguments,1);return A(e).nfapply(t)},C.prototype.nfcall=function(){var e=l(arguments),t=b();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},A.nfbind=A.denodeify=function(e){var t=l(arguments,1);return function(){var r=t.concat(l(arguments)),n=b();return r.push(n.makeNodeResolver()),A(e).fapply(r).fail(n.reject),n.promise}},C.prototype.nfbind=C.prototype.denodeify=function(){var e=l(arguments);return e.unshift(this),A.denodeify.apply(void 0,e)},A.nbind=function(e,t){var r=l(arguments,2);return function(){var n=r.concat(l(arguments)),o=b();return n.push(o.makeNodeResolver()),A(function(){return e.apply(t,arguments)}).fapply(n).fail(o.reject),o.promise}},C.prototype.nbind=function(){var e=l(arguments,0);return e.unshift(this),A.nbind.apply(void 0,e)},A.nmapply=A.npost=function(e,t,r){return A(e).npost(t,r)},C.prototype.nmapply=C.prototype.npost=function(e,t){var r=l(t||[]),n=b();return r.push(n.makeNodeResolver()),this.dispatch(\"post\",[e,r]).fail(n.reject),n.promise},A.nsend=A.nmcall=A.ninvoke=function(e,t){var r=l(arguments,2),n=b();return r.push(n.makeNodeResolver()),A(e).dispatch(\"post\",[t,r]).fail(n.reject),n.promise},C.prototype.nsend=C.prototype.nmcall=C.prototype.ninvoke=function(e){var t=l(arguments,1),r=b();return t.push(r.makeNodeResolver()),this.dispatch(\"post\",[e,t]).fail(r.reject),r.promise},A.nodeify=function(e,t){return A(e).nodeify(t)},C.prototype.nodeify=function(e){if(!e)return this;this.then(function(t){A.nextTick(function(){e(null,t)})},function(t){A.nextTick(function(){e(t)})})},A.noConflict=function(){throw new Error(\"Q.noConflict only works when Q is used as a global\")};var K=T();return A})}).call(this,e(\"_process\"),e(\"timers\").setImmediate)},{_process:188,timers:189}],63:[function(e,t,r){\"use strict\";var n,o=e(\"q\"),i=e(\"lodash\"),a=e(\"./processor/intents/movement\"),s=e(\"./utils\").getDriver(),u=s.constants,c=(e(\"./config\"),e(\"./processor/common/fake-runtime\")),l=0,p=o.when(),f=\"3\",d=\"2\";function h(t,r){var n=r.intents,h=r.roomObjects,m=r.users,y=r.roomTerrain,_=r.gameTime,R=r.roomInfo,E=r.flags;return o.when().then(function(){var r=s.bulkObjectsWrite(),g=s.bulkUsersWrite(),v=s.bulkFlagsWrite(),O=s.bulkUsersPowerCreeps(),T=s.getRoomStatsUpdater(t),A={},b=[],w=[],N=[],C=[],S=[],I=i.clone(R);R.active=!1;var x=y[i.findKey(y)];x.terrain&&(y=x.terrain);var L=[],P={roomObjects:h,roomTerrain:y,bulk:r,bulkUsers:g,bulkUsersPowerCreeps:O,stats:T,flags:E,bulkFlags:v,gameTime:_,roomInfo:R,users:m,eventLog:L};i.forEach(h,function(e){e&&(\"creep\"==e.type&&(e._actionLog=e.actionLog,e._ticksToLive=e.ageTime-_,e.actionLog={attacked:null,healed:null,attack:null,rangedAttack:null,rangedMassAttack:null,rangedHeal:null,harvest:null,heal:null,repair:null,build:null,say:null,upgradeController:null,reserveController:null},e.user==f?C.push(e):e.user==d&&S.push(e)),\"link\"==e.type&&(e._actionLog=e.actionLog,e.actionLog={transferEnergy:null}),\"lab\"==e.type&&(e._actionLog=e.actionLog,e.actionLog={runReaction:null}),\"tower\"==e.type&&(e._actionLog=e.actionLog,e.actionLog={attack:null,heal:null,repair:null}),\"controller\"==e.type&&(P.roomController=e),\"observer\"==e.type&&(e.observeRoom=null),e.user&&\"3\"!=e.user&&!e.userNotActive&&\"flag\"!=e.type&&(R.active=!0),\"powerBank\"==e.type&&_>e.decayTime-500&&(R.active=!0),\"energy\"==e.type&&(R.active=!0),\"nuke\"==e.type&&(R.active=!0,N.push(e)),\"tombstone\"==e.type&&(R.active=!0),\"portal\"==e.type&&(R.active=!0),\"constructedWall\"==e.type&&e.decayTime&&e.user&&!0,\"extension\"==e.type&&w.push(e),\"spawn\"==e.type&&b.push(e),\"powerCreep\"==e.type&&(e._actionLog=e.actionLog,e.actionLog={spawned:null,attack:null,attacked:null,healed:null,power:null,say:null}),s.config.emit(\"processObject\",e,h,y,_,R,r,g))}),n=n||{users:{}},s.pathFinder.make({RoomPosition:c.RoomPosition});var M=!0,k=!1,D=void 0;try{for(var U,j=N[Symbol.iterator]();!(M=(U=j.next()).done);M=!0){var W=U.value;e(\"./processor/intents/nukes/pretick\")(W,n,P)}}catch(e){k=!0,D=e}finally{try{!M&&j.return&&j.return()}finally{if(k)throw D}}var G=!0,F=!1,B=void 0;try{for(var H,Y=function(){var t=H.value,r=e(\"./processor/intents/creeps/keepers/pretick\")(t,P);n.users[t.user]=n.users[t.user]||{},n.users[t.user].objects=n.users[t.user].objects||{};var o=n.users[t.user].objects;i.forEach(r,function(e,t){o[t]=i.assign(e,o[t]||{})})},K=C[Symbol.iterator]();!(G=(H=K.next()).done);G=!0)Y()}catch(e){F=!0,B=e}finally{try{!G&&K.return&&K.return()}finally{if(F)throw B}}var V=!0,X=!1,q=void 0;try{for(var z,J=function(){var t=z.value,r=e(\"./processor/intents/creeps/invaders/pretick\")(t,P);n.users[t.user]=n.users[t.user]||{},n.users[t.user].objects=n.users[t.user].objects||{};var o=n.users[t.user].objects;i.forEach(r,function(e,t){o[t]=i.assign(e,o[t]||{})})},Z=S[Symbol.iterator]();!(V=(z=Z.next()).done);V=!0)J()}catch(e){X=!0,q=e}finally{try{!V&&Z.return&&Z.return()}finally{if(X)throw q}}(b.length||w.length)&&e(\"./processor/intents/_calc_spawns\")(b,w,P),a.init(h,y),n&&i.forEach(n.users,function(t,n){for(var o in t.objectsManual&&(t.objects=t.objects||{},i.extend(t.objects,t.objectsManual)),t.objects){var a=t.objects[o],c=h[o];\"room\"!=o?!c||c._skip||c.user&&c.user!=n||(\"creep\"==c.type&&e(\"./processor/intents/creeps/intents\")(c,a,P),\"powerCreep\"==c.type&&e(\"./processor/intents/power-creeps/intents\")(c,a,P),\"link\"==c.type&&e(\"./processor/intents/links/intents\")(c,a,P),\"tower\"==c.type&&e(\"./processor/intents/towers/intents\")(c,a,P),\"lab\"==c.type&&e(\"./processor/intents/labs/intents\")(c,a,P),\"spawn\"==c.type&&e(\"./processor/intents/spawns/intents\")(c,a,P),c.type,\"rampart\"==c.type&&a.setPublic&&e(\"./processor/intents/ramparts/set-public\")(c,a.setPublic,P),\"terminal\"==c.type&&a.send&&e(\"./processor/intents/terminal/send\")(c,a.send,P),\"nuker\"==c.type&&a.launchNuke&&e(\"./processor/intents/nukers/launch-nuke\")(c,a.launchNuke,P),\"observer\"==c.type&&a.observeRoom&&(c.observeRoom=a.observeRoom.roomName),\"powerSpawn\"==c.type&&e(\"./processor/intents/power-spawns/intents\")(c,a,P),\"extension\"!=c.type&&\"storage\"!=c.type&&\"powerSpawn\"!=c.type&&\"terminal\"!=c.type&&\"container\"!=c.type||a.transfer&&e(\"./processor/intents/extensions/transfer\")(c,a.transfer,P),\"controller\"==c.type&&(a.unclaim&&e(\"./processor/intents/controllers/unclaim\")(c,a.unclaim,P),a.activateSafeMode&&e(\"./processor/intents/controllers/activateSafeMode\")(c,a.activateSafeMode,P)),a.notifyWhenAttacked&&(u.CONSTRUCTION_COST[c.type]||\"creep\"==c.type||\"powerCreep\"==c.type)&&r.update(c,{notifyWhenAttacked:!!a.notifyWhenAttacked.enabled}),s.config.emit(\"processObjectIntents\",c,n,a,h,y,_,R,r,g)):e(\"./processor/intents/room/intents\")(n,a,P)}}),a.check(!!(P.roomController&&P.roomController.safeMode>_)&&P.roomController.user),P.energyAvailable=i(h).filter(function(e){return!e.off&&(\"spawn\"==e.type||\"extension\"==e.type)}).sum(\"energy\");var $={w:[],r:[],pb:[],p:[],s:[],c:[],m:[],k:[]},Q=[];return i.forEach(h,function(t){if(t&&!t._skip){if(\"energy\"==t.type&&e(\"./processor/intents/energy/tick\")(t,P),\"source\"==t.type&&e(\"./processor/intents/sources/tick\")(t,P),\"mineral\"==t.type&&e(\"./processor/intents/minerals/tick\")(t,P),\"creep\"==t.type&&e(\"./processor/intents/creeps/tick\")(t,P),\"powerCreep\"==t.type&&e(\"./processor/intents/power-creeps/tick\")(t,P),\"spawn\"==t.type&&e(\"./processor/intents/spawns/tick\")(t,P),\"rampart\"==t.type&&e(\"./processor/intents/ramparts/tick\")(t,P),\"extension\"==t.type&&e(\"./processor/intents/extensions/tick\")(t,P),\"road\"==t.type&&e(\"./processor/intents/roads/tick\")(t,P),\"constructionSite\"==t.type&&e(\"./processor/intents/construction-sites/tick\")(t,P),\"keeperLair\"==t.type&&e(\"./processor/intents/keeper-lairs/tick\")(t,P),\"portal\"==t.type&&e(\"./processor/intents/portals/tick\")(t,P),\"constructedWall\"==t.type&&e(\"./processor/intents/constructedWalls/tick\")(t,P),\"link\"==t.type&&e(\"./processor/intents/links/tick\")(t,P),\"extractor\"==t.type&&e(\"./processor/intents/extractors/tick\")(t,P),\"tower\"==t.type&&e(\"./processor/intents/towers/tick\")(t,P),\"controller\"==t.type&&e(\"./processor/intents/controllers/tick\")(t,P),\"lab\"==t.type&&e(\"./processor/intents/labs/tick\")(t,P),\"container\"==t.type&&e(\"./processor/intents/containers/tick\")(t,P),\"terminal\"==t.type&&e(\"./processor/intents/terminal/tick\")(t,P),\"tombstone\"==t.type&&e(\"./processor/intents/tombstones/tick\")(t,P),\"nuke\"==t.type&&e(\"./processor/intents/nukes/tick\")(t,P),\"observer\"==t.type&&r.update(t,{observeRoom:t.observeRoom}),\"storage\"==t.type&&P.roomController){var n=P.roomController.level>0&&P.roomController.user==t.user&&u.CONTROLLER_STRUCTURES.storage[P.roomController.level]>0?u.STORAGE_CAPACITY:0;if(n>0){var o=i.find(t.effects,{power:u.PWR_OPERATE_STORAGE});o&&o.endTime>P.gameTime&&(n+=u.POWER_INFO[u.PWR_OPERATE_STORAGE].effect[o.level-1])}n!=t.energyCapacity&&r.update(t,{energyCapacity:n})}\"powerBank\"==t.type&&_>=t.decayTime-1&&(r.remove(t._id),delete h[t._id]),\"flag\"!=t.type&&(A[t._id]=t,\"creep\"!=t.type&&\"powerCreep\"!=t.type||(A[t._id]=JSON.parse(JSON.stringify(t)),A[t._id]._id=\"\"+t._id,delete A[t._id]._actionLog,delete A[t._id]._ticksToLive,t.actionLog.say&&!t.actionLog.say.isPublic&&delete A[t._id].actionLog.say)),t.user?\"constructionSite\"==t.type||t.newbieWall||\"rampart\"==t.type&&t.isPublic||($[t.user]=$[t.user]||[],$[t.user].push([t.x,t.y])):\"constructedWall\"==t.type?$.w.push([t.x,t.y]):\"road\"==t.type?$.r.push([t.x,t.y]):\"powerBank\"==t.type?$.pb.push([t.x,t.y]):\"portal\"==t.type?$.p.push([t.x,t.y]):\"source\"==t.type?$.s.push([t.x,t.y]):\"mineral\"==t.type?$.m.push([t.x,t.y]):\"controller\"==t.type?$.c.push([t.x,t.y]):\"keeperLair\"==t.type?$.k.push([t.x,t.y]):\"energy\"==t.type&&\"power\"==t.resourceType&&$.pb.push([t.x,t.y])}}),s.config.emit(\"processRoom\",t,R),s.config.emit(\"processorLoopStage\",\"saveRoom\",t),Q.push(s.mapViewSave(t,$)),Q.push(r.execute()),Q.push(g.execute()),Q.push(v.execute()),Q.push(s.saveRoomEventLog(t,L)),i.isEqual(R,I)||Q.push(s.saveRoomInfo(t,R)),R.active&&function(e,t,r){p.then(function(){var n=o.when();if(!(r%s.config.historyChunkSize)){var i=Math.floor((r-1)/s.config.historyChunkSize)*s.config.historyChunkSize;n=s.history.upload(e,i)}var a=JSON.stringify(t);return p=n.then(function(){return s.history.saveTick(e,r,a)})})}(t,A,_),Date.now()>l+3e4&&(s.roomsStatsSave(),l=Date.now()),o.all(Q)})}s.connect(\"processor\").then(function(){return s.queue.create(\"rooms\",\"read\")}).then(function(e){n=e,function e(){var t;s.config.emit(\"processorLoopStage\",\"start\"),n.fetch().then(function(e){return s.config.emit(\"processorLoopStage\",\"getRoomData\",e),t=e,o.all([s.getRoomIntents(e),s.getRoomObjects(e),s.getRoomTerrain(e),s.getGameTime(),s.getRoomInfo(e),s.getRoomFlags(e)])}).then(function(e){s.config.emit(\"processorLoopStage\",\"processRoom\",t),h(t,{intents:e[0],roomObjects:e[1].objects,users:e[1].users,roomTerrain:e[2],gameTime:e[3],roomInfo:e[4],flags:e[5]}).catch(function(e){}).then(function(){return s.clearRoomIntents(t)}).then(function(){return n.markDone(t)})}).catch(function(e){}).then(function(){s.config.emit(\"processorLoopStage\",\"finish\",t),setTimeout(e,0)})}()}).catch(function(e){}),\"undefined\"==typeof self&&setInterval(function(){o.getUnhandledReasons().forEach(function(e){}),o.resetUnhandledRejections()},1e3)},{\"./config\":1,\"./processor/common/fake-runtime\":64,\"./processor/intents/_calc_spawns\":75,\"./processor/intents/constructedWalls/tick\":77,\"./processor/intents/construction-sites/tick\":78,\"./processor/intents/containers/tick\":79,\"./processor/intents/controllers/activateSafeMode\":80,\"./processor/intents/controllers/tick\":81,\"./processor/intents/controllers/unclaim\":82,\"./processor/intents/creeps/intents\":98,\"./processor/intents/creeps/invaders/pretick\":102,\"./processor/intents/creeps/keepers/pretick\":104,\"./processor/intents/creeps/tick\":116,\"./processor/intents/energy/tick\":120,\"./processor/intents/extensions/tick\":121,\"./processor/intents/extensions/transfer\":122,\"./processor/intents/extractors/tick\":123,\"./processor/intents/keeper-lairs/tick\":124,\"./processor/intents/labs/intents\":126,\"./processor/intents/labs/tick\":128,\"./processor/intents/links/intents\":131,\"./processor/intents/links/tick\":132,\"./processor/intents/minerals/tick\":134,\"./processor/intents/movement\":135,\"./processor/intents/nukers/launch-nuke\":136,\"./processor/intents/nukes/pretick\":137,\"./processor/intents/nukes/tick\":138,\"./processor/intents/portals/tick\":139,\"./processor/intents/power-creeps/intents\":142,\"./processor/intents/power-creeps/tick\":147,\"./processor/intents/power-spawns/intents\":151,\"./processor/intents/ramparts/set-public\":153,\"./processor/intents/ramparts/tick\":154,\"./processor/intents/roads/tick\":155,\"./processor/intents/room/intents\":160,\"./processor/intents/sources/tick\":163,\"./processor/intents/spawns/intents\":168,\"./processor/intents/spawns/tick\":172,\"./processor/intents/terminal/send\":174,\"./processor/intents/terminal/tick\":175,\"./processor/intents/tombstones/tick\":176,\"./processor/intents/towers/intents\":179,\"./processor/intents/towers/tick\":181,\"./utils\":184,lodash:61,q:62}],64:[function(e,t,r){\"use strict\";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}();function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=e(\"lodash\"),a=e(\"../../utils\"),s=a.getDriver(),u=s.constants,c={},l=function(e,t,r){if(e=+e,t=+t,i.isNaN(e)||i.isNaN(t)||!i.isString(r))throw new Error(\"invalid arguments in RoomPosition constructor\");this.x=e,this.y=t,this.roomName=r};l.prototype.isEqualTo=function(e){return e.x==this.x&&e.y==this.y&&e.roomName==this.roomName},l.prototype.getRangeTo=function(e){return e.roomName==this.roomName?a.dist(e,this):1/0},l.prototype.getDirectionTo=function(e){if(e.roomName==this.roomName)return a.getDirection(e.x-this.x,e.y-this.y);var t=a.roomNameToXY(this.roomName),r=n(t,2),o=r[0],i=r[1],s=a.roomNameToXY(e.roomName),u=n(s,2),c=u[0],l=u[1];return a.getDirection(50*c+e.x-50*o-this.x,50*l+e.y-50*i-this.y)},l.prototype.lookFor=function(e){if(e!=u.LOOK_TERRAIN)return null;if(!c[this.roomName])return\"wall\";return[[\"plain\",\"wall\",\"swamp\",\"wall\"][c[this.roomName][50*this.y+this.x]]]};var p=function(e,t){var r=0;return r<<=6,r|=e,r<<=6,r|=t,String.fromCharCode(32+r)};l.prototype.sPackLocal=function(){return p(this.x,this.y)},l.sUnpackLocal=function(e,t){var r=e.codePointAt(0);if(r<32)throw new Error(\"Invalid uint value \"+r);var n=63&(r-=32),o=63&(r>>>=6);return r>>>=6,new l(o,n,t)};var f=function(){this._bits=new Uint8Array(2500)};f.prototype.set=function(e,t,r){e|=0,t|=0,this._bits[50*e+t]=Math.min(Math.max(0,r),255)},f.prototype.get=function(e,t){return e|=0,t|=0,this._bits[50*e+t]},f.prototype.clone=function(){var e=new f;return e._bits=new Uint8Array(this._bits),e};var d=function(e,t,r,n){var a=n.roomTerrain,p=n.roomObjects;c=o({},e.room,a);var d=i.clone(r);d.maxRooms=1,d.roomCallback=function(t){var n=function(e,t,r,n){if(r.room!=e)return!1;var o=new f,a=i.clone(u.OBSTACLE_OBJECT_TYPES);return a.push(u.STRUCTURE_PORTAL),t.ignoreDestructibleStructures&&(a=i.without(a,\"constructedWall\",\"rampart\",\"spawn\",\"extension\",\"link\",\"storage\",\"observer\",\"tower\",\"powerBank\",\"powerSpawn\",\"lab\",\"terminal\")),t.ignoreCreeps&&(a=i.without(a,\"creep\")),i.forEach(n,function(e){(i.contains(a,e.type)||!t.ignoreDestructibleStructures&&\"rampart\"==e.type&&!e.isPublic&&e.user!=r.user||!t.ignoreDestructibleStructures&&\"constructionSite\"==e.type&&e.user==r.user&&i.contains(u.OBSTACLE_OBJECT_TYPES,e.structureType))&&o.set(e.x,e.y,1/0),\"swamp\"==e.type&&0==o.get(e.x,e.y)&&o.set(e.x,e.y,t.ignoreRoads?5:10),!t.ignoreRoads&&\"road\"==e.type&&o.get(e.x,e.y)<1/0&&o.set(e.x,e.y,1)}),o}(t,r,e,p);if(\"function\"==typeof r.costCallback){n=n.clone();var o=r.costCallback(t,n);o instanceof f&&(n=o)}return n},d.ignoreRoads||(d.plainCost=2,d.swampCost=10);var h=new l(e.x,e.y,e.room),m=s.pathFinder.search(h,t,d);return t instanceof l&&!r.range&&(m.path.length&&1===m.path[m.path.length-1].getRangeTo(t)||!m.path.length&&1===h.getRangeTo(t))&&m.path.push(t),m},h=function(e,t){var r=t.indexOf(p(e.x,e.y));if(r==t.length-1)return 0;var n=void 0;if(r<0){var o=l.sUnpackLocal(t[0],e.room);a.dist(e,o)<=1&&(n=o)}else n=l.sUnpackLocal(t[1+r],e.room);return n?a.getDirection(n.x-e.x,n.y-e.y):0};t.exports.findPath=d,t.exports.findClosestByPath=function(e,t,r,n){if(!i.some(t))return null;var s=n.roomTerrain;c=o({},e.room,s),r=r||{},i.isUndefined(r.range)&&(r.range=0);var u=i.find(t,function(t){return 0==a.dist(e,t)});if(u)return u;var p=i.map(t,function(e){return{range:1,pos:new l(e.x,e.y,e.room)}}),f=d(e,p,r,n);if(!f.path)return null;var h=null,m=e;return f.path.length&&(m=f.path[f.path.length-1]),t.forEach(function(e){a.dist(m,e)<=1&&(h=e)}),h},t.exports.moveTo=function(e,t,r,n){var o=n.bulk,s=n.gameTime;if(r=r||{},i.isUndefined(r.reusePath)&&(r.reusePath=5),i.isUndefined(r.range)&&(r.range=0),a.dist(e,t)<=r.range)return 0;var u=new l(t.x,t.y,t.room);if(!e.memory_move||i.isUndefined(e.memory_move.dest)||e.memory_move.dest!=u.sPackLocal()||i.isUndefined(e.memory_move.time)||s>e.memory_move.time+r.reusePath){var c=d(e,{range:r.range,pos:new l(t.x,t.y,t.room)},r,n);if(!c.path)return 0;var p={dest:u.sPackLocal(),path:function(e){return i.reduce(e,function(e,t){return\"\"+e+t.sPackLocal()},\"\")}(c.path),time:s};o.update(e,{memory_move:p})}return h(e,e.memory_move.path)},t.exports.flee=function(e,t,r,n,o){var s=t.map(function(e){return{pos:new l(e.x,e.y,e.room),range:r}}),u=d(e,s,{flee:!0},o);if(!i.some(u.path))return 0;var c=u.path[0];return a.getDirection(c.x-e.x,c.y-e.y)},t.exports.RoomPosition=l,t.exports.CostMatrix=f,t.exports.hasActiveBodyparts=function(e,t){return!!e.body&&i.some(e.body,function(e){return e.hits>0&&e.type==t})}},{\"../../utils\":184,lodash:61}],65:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"q\"),i=e(\"lodash\"),a=e(\"../../utils\"),s=a.getDriver(),u=s.constants;t.exports=function(e){var t=e.orders,r=e.userIntents,c=e.usersById,l=e.gameTime,p=e.roomObjectsByType,f=e.bulkObjects,d=e.bulkUsers,h=e.bulkTransactions,m=e.bulkUsersMoney,y=e.bulkUsersResources,_=e.bulkMarketOrders,R=e.bulkMarketIntershardOrders,E=p.terminal,g=i.indexBy(E,\"room\");function v(e,t,r,o,s,c){if(c=c||{},!e||!t||!s)return!1;if(e.user&&(!e[r]||e[r]<o))return!1;if(t.user){var p=a.calcResources(t),d=Math.max(0,t.energyCapacity-p);o=Math.min(o,d)}if(o>0){var m=a.calcRoomsDistance(e.room,t.room,!0),y=a.calcTerminalEnergyCost(o,m),_=i.find(s.effects,{power:u.PWR_OPERATE_TERMINAL});return _&&_.endTime>l&&(y=Math.ceil(y*u.POWER_INFO[u.PWR_OPERATE_TERMINAL].effect[_.level-1])),s===e&&(r!=u.RESOURCE_ENERGY&&e.energy<y||r==u.RESOURCE_ENERGY&&e.energy<o+y)||s===t&&t.energy<y?!1:(t.user&&(t[r]=t[r]||0,t[r]+=o,f.update(t,n({},r,t[r]))),f.update(e,n({},r,e[r]-o)),f.update(s,{energy:s.energy-y}),h.insert(i.extend({time:+l,sender:e.user?\"\"+e.user:void 0,recipient:t.user?\"\"+t.user:void 0,resourceType:r,amount:o,from:e.room,to:t.room},c)),!0)}}i.filter(E,function(e){return!!e.send}).forEach(function(e){var t=e.send;if(f.update(e,{send:null}),!(e.cooldownTime>l)&&g[t.targetRoomName]&&g[t.targetRoomName].user){var r=u.TERMINAL_COOLDOWN,n=i.find(e.effects,{power:u.PWR_OPERATE_TERMINAL});n&&n.endTime>l&&(r=Math.round(r*u.POWER_INFO[u.PWR_OPERATE_TERMINAL].effect[n.level-1])),v(e,g[t.targetRoomName],t.resourceType,t.amount,e,{description:t.description?t.description.replace(/</g,\"&lt;\"):void 0})&&f.update(e,{cooldownTime:l+r})}});var O=i.indexBy(t,\"_id\"),T=[],A=[],b=(new Date).getTime();return r&&r.forEach(function(e){var t=c[e.user];e.intents.createOrder&&e.intents.createOrder.forEach(function(r){if(r.price&&r.totalAmount&&(i.contains(u.RESOURCES_ALL,r.resourceType)||i.contains(u.INTERSHARD_RESOURCES,r.resourceType))&&(i.contains(u.INTERSHARD_RESOURCES,r.resourceType)||g[r.roomName]&&g[r.roomName].user==e.user)&&!(r.price<=0||r.totalAmount<=0)){var n=Math.ceil(r.price*r.totalAmount*u.MARKET_FEE);if(!(t.money<n)){d.inc(t,\"money\",-n);var o=i.extend({createdTimestamp:b,user:e.user,active:!1,type:r.type==u.ORDER_SELL?u.ORDER_SELL:u.ORDER_BUY,amount:0,remainingAmount:r.totalAmount},r),a=R;i.contains(u.INTERSHARD_RESOURCES,r.resourceType)||(a=_,o.created=l),a.insert(o),r.price/=1e3,m.insert({date:new Date,tick:l,user:e.user,type:\"market.fee\",balance:t.money/1e3,change:-n/1e3,market:{order:r}})}}}),e.intents.changeOrderPrice&&e.intents.changeOrderPrice.forEach(function(r){var n=O[r.orderId];if(n&&n.user==e.user&&r.newPrice&&!(r.newPrice<=0)){if(r.newPrice>n.price){var o=Math.ceil((r.newPrice-n.price)*n.remainingAmount*u.MARKET_FEE);if(t.money<o)return;d.inc(t,\"money\",-o),m.insert({date:new Date,tick:l,user:e.user,type:\"market.fee\",balance:t.money/1e3,change:-o/1e3,market:{changeOrderPrice:{orderId:r.orderId,oldPrice:n.price/1e3,newPrice:r.newPrice/1e3}}})}(i.contains(u.INTERSHARD_RESOURCES,n.resourceType)?R:_).inc(n,\"price\",r.newPrice-n.price)}}),e.intents.extendOrder&&e.intents.extendOrder.forEach(function(r){var n=O[r.orderId];if(n&&n.user==e.user&&r.addAmount&&!(r.addAmount<=0)){var o=Math.ceil(n.price*r.addAmount*u.MARKET_FEE);if(!(t.money<o)){d.inc(t,\"money\",-o),m.insert({date:new Date,tick:l,user:e.user,type:\"market.fee\",balance:t.money/1e3,change:-o/1e3,market:{extendOrder:{orderId:r.orderId,addAmount:r.addAmount}}});var a=i.contains(u.INTERSHARD_RESOURCES,n.resourceType)?R:_;a.inc(n,\"remainingAmount\",r.addAmount),a.inc(n,\"totalAmount\",r.addAmount)}}}),e.intents.cancelOrder&&e.intents.cancelOrder.forEach(function(t){O[t.orderId]&&O[t.orderId].user==e.user&&(O[t.orderId].remainingAmount=0,O[t.orderId]._cancelled=!0)}),e.intents.deal&&e.intents.deal.forEach(function(t){t.user=e.user,O[t.orderId]&&(t.amount<=0||(i.contains(u.INTERSHARD_RESOURCES,O[t.orderId].resourceType)?A.push(t):g[t.targetRoomName]&&g[t.targetRoomName].user==e.user&&T.push(t)))})}),T.sort(function(e,t){return a.calcRoomsDistance(e.targetRoomName,O[e.orderId].roomName,!0)-a.calcRoomsDistance(t.targetRoomName,O[t.orderId].roomName,!0)}),T.forEach(function(e){var t,r,n=O[e.orderId],o=g[n.roomName],s=g[e.targetRoomName];if(o&&s&&!(s.cooldownTime>l)){n.type==u.ORDER_SELL?(t=s,r=o):(r=s,t=o);var p=Math.min(e.amount,n.remainingAmount);if(r.user&&(p=Math.min(p,r[n.resourceType]||0)),t.user){var h=a.calcResources(t),y=Math.max(0,t.energyCapacity-h);p=Math.min(p,y)}if(p>0){var R=p*n.price;if((!t.user||(R=Math.min(R,c[t.user].money||0),R=(p=Math.floor(R/n.price))*n.price,p))&&v(r,t,n.resourceType,p,s,{order:{id:\"\"+n._id,type:n.type,price:n.price/1e3}})){r.user&&(d.inc(c[r.user],\"money\",R),m.insert({date:new Date,tick:l,user:r.user,type:\"market.sell\",balance:c[r.user].money/1e3,change:R/1e3,market:{resourceType:n.resourceType,roomName:n.roomName,targetRoomName:e.targetRoomName,price:n.price/1e3,npc:!t.user,owner:n.user,dealer:e.user,amount:p}})),t.user&&(d.inc(c[t.user],\"money\",-R),m.insert({date:new Date,tick:l,user:t.user,type:\"market.buy\",balance:c[t.user].money/1e3,change:-R/1e3,market:{resourceType:n.resourceType,roomName:n.roomName,targetRoomName:e.targetRoomName,price:n.price/1e3,npc:!r.user,owner:n.user,dealer:e.user,amount:p}})),_.update(n,{amount:n.amount-p,remainingAmount:n.remainingAmount-p});var E=u.TERMINAL_COOLDOWN,T=i.find(s.effects,{power:u.PWR_OPERATE_TERMINAL});T&&T.endTime>l&&(E=Math.round(E*u.POWER_INFO[u.PWR_OPERATE_TERMINAL].effect[T.level-1])),f.update(s,{cooldownTime:l+E})}}}}),(A=i.shuffle(A)).forEach(function(e){var t,r,o=O[e.orderId],a=n({},u.SUBSCRIPTION_TOKEN,\"subscriptionTokens\");if(o.type==u.ORDER_SELL?(t=c[e.user],r=c[o.user]):(r=c[e.user],t=c[o.user]),r&&t){var s=Math.min(e.amount,o.remainingAmount,r[a[o.resourceType]]||0);if(s&&!(s<0)){var p=s*o.price;if(!t.user||t.money&&!(t.money<p)){d.inc(r,\"money\",p),d.inc(r,a[o.resourceType],-s),m.insert({date:new Date,tick:l,user:\"\"+r._id,type:\"market.sell\",balance:r.money/1e3,change:p/1e3,market:{resourceType:o.resourceType,price:o.price/1e3,amount:s}}),y.insert({date:new Date,resourceType:o.resourceType,user:\"\"+r._id,change:-s,balance:r[a[o.resourceType]],marketOrderId:\"\"+o._id,market:{orderId:\"\"+o._id,anotherUser:\"\"+t._id}}),d.inc(t,\"money\",-p),d.inc(t,a[o.resourceType],s),m.insert({date:new Date,tick:l,user:\"\"+t._id,type:\"market.buy\",balance:t.money/1e3,change:-p/1e3,market:{resourceType:o.resourceType,price:o.price/1e3,amount:s}});var f=i.contains(u.INTERSHARD_RESOURCES,o.resourceType)?R:_;f.inc(o,\"amount\",-s),f.inc(o,\"remainingAmount\",-s),y.insert({date:new Date,resourceType:o.resourceType,user:\"\"+t._id,change:s,balance:t[a[o.resourceType]],market:{orderId:\"\"+o._id,anotherUser:\"\"+r._id}})}}}}),t&&t.forEach(function(e){var t=i.contains(u.INTERSHARD_RESOURCES,e.resourceType)?R:_;if(e._cancelled)t.remove(e._id);else if(e.user){var r=g[e.roomName];if(e.type==u.ORDER_SELL){var n=e.resourceType==u.SUBSCRIPTION_TOKEN?c[e.user].subscriptionTokens||0:r&&r.user==e.user&&r[e.resourceType]||0;if(n=Math.min(n,e.remainingAmount),e.active){if(!n||n<0)return void t.update(e,{active:!1,amount:0});e.amount!=n&&t.update(e,{amount:n})}else n>0&&t.update(e,{active:!0,amount:n})}if(e.type==u.ORDER_BUY){var o=c[e.user].money||0,s=i.contains(u.INTERSHARD_RESOURCES,e.resourceType)||!!r&&r.user==e.user,l=Math.min(Math.floor(o/e.price),e.remainingAmount);if(r&&r.user){var p=a.calcResources(r),f=Math.max(0,r.energyCapacity-p);l=Math.min(l,f)}var d=s&&l>0;e.amount==l&&e.active==d||t.update(e,{amount:l,active:d})}}}),function(){return o.all([d.execute(),_.execute(),R.execute(),m.execute(),h.execute(),y.execute(),s.clearMarketIntents()])}}},{\"../../utils\":184,lodash:61,q:62}],66:[function(e,t,r){\"use strict\";e(\"q\"),e(\"lodash\");var n=e(\"../../utils\").getDriver(),o=(e(\"path\"),n.constants,[\"spawnPowerCreep\",\"suicidePowerCreep\",\"deletePowerCreep\",\"upgradePowerCreep\",\"createPowerCreep\",\"renamePowerCreep\"]),i={_diePowerCreep:e(\"./power/_diePowerCreep.js\"),createPowerCreep:e(\"./power/createPowerCreep.js\"),deletePowerCreep:e(\"./power/deletePowerCreep.js\"),renamePowerCreep:e(\"./power/renamePowerCreep.js\"),spawnPowerCreep:e(\"./power/spawnPowerCreep.js\"),suicidePowerCreep:e(\"./power/suicidePowerCreep.js\"),upgradePowerCreep:e(\"./power/upgradePowerCreep.js\")};t.exports=function(t){var r=t.usersById,n=t.userIntents,a=t.roomObjectsByType,s=t.gameTime;n&&n.forEach(function(e){var n=r[e.user];o.forEach(function(r){e.intents[r]&&e.intents[r].forEach(function(e){i[r](e,n,t)})})}),a.powerCreep&&a.powerCreep.forEach(function(r){(s>=r.ageTime-1||r.hits<=0)&&e(\"./power/_diePowerCreep\")(r,t)})}},{\"../../utils\":184,\"./power/_diePowerCreep\":67,\"./power/_diePowerCreep.js\":67,\"./power/createPowerCreep.js\":68,\"./power/deletePowerCreep.js\":69,\"./power/renamePowerCreep.js\":70,\"./power/spawnPowerCreep.js\":71,\"./power/suicidePowerCreep.js\":72,\"./power/upgradePowerCreep.js\":73,lodash:61,path:187,q:62}],67:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(e,t){var r=t.roomObjects,a=t.bulkObjects,s=t.bulkUsersPowerCreeps,u=t.gameTime,c={type:\"tombstone\",room:e.room,x:e.x,y:e.y,user:e.user,deathTime:u,decayTime:u+i.TOMBSTONE_DECAY_POWER_CREEP,powerCreepId:\"\"+e._id,powerCreepName:e.name,powerCreepTicksToLive:e.ageTime-u,powerCreepClassName:e.className,powerCreepLevel:e.level,powerCreepPowers:n.mapValues(e.powers,function(e){return{level:e.level}}),powerCreepSaying:e.actionLog&&e.actionLog.say&&e.actionLog.say.isPublic?e.actionLog.say.message:void 0},l=n.find(r,{type:\"container\",x:e.x,y:e.y});i.RESOURCES_ALL.forEach(function(t){if(e[t]>0){var r=e[t];if(l&&l.hits>0){var n=o.calcResources(l),i=Math.min(r,l.energyCapacity-n);i>0&&(l[t]=l[t]||0,l[t]+=i,a.update(l,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},t,l[t])),r-=i)}r>0&&(c[t]=(c[t]||0)+r)}}),a.insert(c),a.remove(e._id),s.update(e._id,{shard:null,spawnCooldownTime:Date.now()+i.POWER_CREEP_SPAWN_COOLDOWN})}},{\"../../../utils\":184,lodash:61}],68:[function(e,t,r){\"use strict\";e(\"q\");var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.userPowerCreeps,a=r.bulkUsersPowerCreeps,s=n.filter(i,function(e){return e.user==t._id}),u=Math.floor(Math.pow((t.power||0)/o.POWER_LEVEL_MULTIPLY,1/o.POWER_LEVEL_POW));if(!(s.length+n.sum(s,\"level\")+(t._usedPowerLevels||0)>=u)&&-1!==Object.values(o.POWER_CLASS).indexOf(e.className)){var c=e.name.substring(0,50);n.any(s,{name:c})||(a.insert({name:c,className:e.className,user:\"\"+t._id,level:0,hitsMax:1e3,energyCapacity:100,spawnCooldownTime:0,powers:{}}),t._usedPowerLevels=(t._usedPowerLevels||0)+1)}}},{\"../../../utils\":184,lodash:61,q:62}],69:[function(e,t,r){\"use strict\";e(\"q\");var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.userPowerCreeps,a=(r.bulkObjects,r.bulkUsersPowerCreeps),s=n.find(i,function(r){return r.user==t._id&&r._id==e.id});if(s&&null!==s.spawnCooldownTime)if(e.cancel)a.update(s._id,{deleteTime:null});else{if(t.powerExperimentationTime>Date.now())return void a.remove(s._id);if(s.deleteTime)return;a.update(s._id,{deleteTime:Date.now()+o.POWER_CREEP_DELETE_COOLDOWN})}}},{\"../../../utils\":184,lodash:61,q:62}],70:[function(e,t,r){\"use strict\";e(\"q\");var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var o=r.userPowerCreeps,i=(r.bulkObjects,r.bulkUsersPowerCreeps),a=n.filter(o,function(e){return e.user==t._id}),s=n.find(a,function(t){return t._id==e.id});if(s&&null!==s.spawnCooldownTime){var u=e.name.substring(0,50);n.any(a,{name:u})||i.update(s._id,{name:u})}}},{\"../../../utils\":184,lodash:61,q:62}],71:[function(e,t,r){\"use strict\";e(\"q\");var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjectsByType,a=r.userPowerCreeps,s=r.bulkObjects,u=r.bulkUsersPowerCreeps,c=r.shardName,l=r.gameTime,p=n.find(i.powerSpawn,function(t){return t._id==e.id});if(p&&p.user==t._id&&!p._justSpawned){var f=n.find(a,function(r){return r.user==t._id&&r.name==e.name});!f||null===f.spawnCooldownTime||f.spawnCooldownTime>Date.now()||n.any(i.powerCreep,{room:p.room,x:p.x,y:p.y})||(u.update(f,{shard:c,spawnCooldownTime:null,deleteTime:null}),s.insert(Object.assign({},f,{type:\"powerCreep\",room:p.room,x:p.x,y:p.y,hits:f.hitsMax,ageTime:l+o.POWER_CREEP_LIFE_TIME,actionLog:{spawned:!0},notifyWhenAttacked:!0}),f._id),p._justSpawned=!0)}}},{\"../../../utils\":184,lodash:61,q:62}],72:[function(e,t,r){\"use strict\";e(\"q\");var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,o){var i=o.roomObjectsByType,a=n.find(i.powerCreep,function(e){return e.user==r._id&&e._id==t.id});a&&e(\"./_diePowerCreep\")(a,o)}},{\"../../../utils\":184,\"./_diePowerCreep\":67,lodash:61,q:62}],73:[function(e,t,r){\"use strict\";e(\"q\");var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjectsByType,a=r.userPowerCreeps,s=(r.gameTime,r.bulkObjects),u=r.bulkUsersPowerCreeps,c=n.filter(a,function(e){return e.user==t._id}),l=Math.floor(Math.pow((t.power||0)/o.POWER_LEVEL_MULTIPLY,1/o.POWER_LEVEL_POW));if(!(c.length+n.sum(c,\"level\")+(t._usedPowerLevels||0)>=l)){var p=n.find(c,function(t){return t._id==e.id});if(p&&!(p.level>=o.POWER_CREEP_MAX_LEVEL)){var f=o.POWER_INFO[e.power];if(f&&f.className===p.className){var d=p.level;if(p.powers[e.power]||(p.powers[e.power]={level:0}),5!=p.powers[e.power].level&&!(d<f.level[p.powers[e.power].level])){d++;var h=p.energyCapacity+100,m=p.hitsMax+1e3;p.powers[e.power].level++;var y=n.find(i.powerCreep,function(t){return t._id==e.id});y&&s.update(y,{level:d,hitsMax:m,energyCapacity:h,powers:p.powers}),u.update(p,{level:d,hitsMax:m,energyCapacity:h,powers:p.powers})}}}}}},{\"../../../utils\":184,lodash:61,q:62}],74:[function(e,t,r){\"use strict\";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),o=e(\"q\"),i=e(\"lodash\"),a=e(\"../utils\").getDriver(),s=(a.constants,e(\"./global-intents/market\")),u=e(\"./global-intents/power\");t.exports=function(){return a.getInterRoom().then(function(e){if(e){var t=n(e,5),r=t[0],c=t[1],l=t[2],p=t[3],f=t[4],d=(f=void 0===f?{}:f).orders,h=f.users,m=f.userPowerCreeps,y=f.userIntents,_=f.shardName,R=a.bulkObjectsWrite(),E=a.bulkRoomsWrite(),g=a.bulkUsersWrite(),v=a.bulkTransactionsWrite(),O=a.bulkUsersMoney(),T=a.bulkUsersResources(),A=a.bulkUsersPowerCreeps(),b=a.bulkMarketOrders(),w=a.bulkMarketIntershardOrders(),N={},C=i.indexBy(h,\"_id\"),S=i.groupBy(p,\"type\");return c.forEach(function(e){l[e.interRoom.room]&&(N[e.interRoom.room]||E.update(e.interRoom.room,{active:!0}),N[e.interRoom.room]=!0,R.update(e,{room:e.interRoom.room,x:e.interRoom.x,y:e.interRoom.y,interRoom:null}))}),u({userIntents:y,usersById:C,roomObjectsByType:S,userPowerCreeps:m,gameTime:r,bulkObjects:R,bulkUsers:g,bulkUsersPowerCreeps:A,shardName:_}),s({orders:d,userIntents:y,usersById:C,gameTime:r,roomObjectsByType:S,bulkObjects:R,bulkUsers:g,bulkTransactions:v,bulkUsersMoney:O,bulkUsersResources:T,bulkMarketOrders:b,bulkMarketIntershardOrders:w}),o.all([R.execute(),E.execute(),g.execute(),b.execute(),w.execute(),O.execute(),v.execute(),T.execute(),A.execute(),a.clearGlobalIntents()])}})}},{\"../utils\":184,\"./global-intents/market\":65,\"./global-intents/power\":66,lodash:61,q:62}],75:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../utils\"),i=o.getDriver().constants;t.exports=function(e,t,r){var a=r.roomController,s=r.bulk,u=e;u.length>i.CONTROLLER_STRUCTURES.spawn[0|a.level]?(u.sort(o.comparatorDistance(a)),u=n.take(u,i.CONTROLLER_STRUCTURES.spawn[0|a.level]),e.forEach(function(e){return e._off=!n.contains(u,e)})):e.forEach(function(e){return e._off=!1}),e.forEach(function(e){e._off!==e.off&&s.update(e._id,{off:e._off})});var c=t;c.length>i.CONTROLLER_STRUCTURES.extension[0|a.level]?(c.sort(o.comparatorDistance(a)),c=n.take(c,i.CONTROLLER_STRUCTURES.extension[0|a.level]),t.forEach(function(e){return e._off=!n.contains(c,e)})):t.forEach(function(e){return e._off=!1}),t.forEach(function(e){e._off!==e.off&&s.update(e._id,{off:e._off})})}},{\"../../utils\":184,lodash:61}],76:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a,s,u){var c=u.roomObjects,l=u.bulk,p=u.roomController,f=u.gameTime,d=u.roomInfo,h=u.eventLog;if(r.hits){var m=0;if(\"creep\"==r.type)s!=i.EVENT_ATTACK_TYPE_MELEE||n.any(c,{type:\"rampart\",x:t.x,y:t.y})||(m=o.calcBodyEffectiveness(r.body,i.ATTACK,\"attack\",i.ATTACK_POWER)),r._damageToApply=(r._damageToApply||0)+a;else if(\"powerCreep\"==r.type)r._damageToApply=(r._damageToApply||0)+a;else{if(s!=i.EVENT_ATTACK_TYPE_NUKE&&(\"constructedWall\"==r.type||\"rampart\"==r.type)){var y=n.find(r.effects,{power:i.PWR_FORTIFY});if(y&&y.endTime>f)return}r.hits-=a}if(\"powerBank\"==r.type&&(m=a*i.POWER_BANK_HIT_BACK),p&&p.user==t.user&&p.safeMode>f&&(m=0),\"constructedWall\"==r.type&&r.decayTime)e(\"./creeps/_clear-newbie-walls\")(u);else if(r.hits<=0){if(\"creep\"!=r.type&&\"powerCreep\"!=r.type&&(i.RESOURCES_ALL.forEach(function(t){r[t]>0&&e(\"./creeps/_create-energy\")(r.x,r.y,r.room,r[t],t,u)}),l.remove(r._id),delete c[r._id],h.push({event:i.EVENT_OBJECT_DESTROYED,objectId:t._id,type:t.type})),\"spawn\"==r.type&&r.spawning){var _=n.find(c,{user:r.user,name:r.spawning.name});_&&l.remove(_._id)}}else\"creep\"!=r.type&&\"powerCreep\"!=r.type&&l.update(r,{hits:r.hits});t.actionLog&&\"creep\"==t.type&&(s!=i.EVENT_ATTACK_TYPE_MELEE&&s!=i.EVENT_ATTACK_TYPE_DISMANTLE||(t.actionLog.attack={x:r.x,y:r.y}),s==i.EVENT_ATTACK_TYPE_RANGED&&(t.actionLog.rangedAttack={x:r.x,y:r.y})),r.actionLog&&(r.actionLog.attacked={x:t.x,y:t.y}),\"2\"!=t.user&&\"3\"!=t.user&&(r.notifyWhenAttacked&&o.sendAttackingNotification(r,p),d&&t.user&&r.user&&t.user!=r.user&&\"2\"!=r.user&&\"3\"!=r.user&&(d.lastPvpTime=f)),m&&(t._damageToApply=(t._damageToApply||0)+m,t.actionLog.attacked={x:r.x,y:r.y},h.push({event:i.EVENT_ATTACK,objectId:r._id,data:{targetId:t._id,damage:m,attackType:i.EVENT_ATTACK_TYPE_HIT_BACK}})),h.push({event:i.EVENT_ATTACK,objectId:t._id,data:{targetId:r._id,damage:a,attackType:s}})}}},{\"../../utils\":184,\"./creeps/_clear-newbie-walls\":84,\"./creeps/_create-energy\":85,lodash:61}],77:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver(),i=o.constants;t.exports=function(e,t){var r=t.roomObjects,a=t.bulk,s=t.roomController,u=t.gameTime;if(e&&\"constructedWall\"==e.type){if(s&&!e.newbieWall){var c=i.CONTROLLER_STRUCTURES.constructedWall[s.level]?i.WALL_HITS_MAX:0;c!=e.hitsMax&&a.update(e,{hitsMax:c})}e.ticksToLive>0&&a.update(e,{decayTime:u+e.ticksToLive,ticksToLive:null}),e.decayTime&&(n.isObject(e.decayTime)||((u>=e.decayTime-1||s&&!s.user)&&(a.remove(e._id),delete r[e._id]),e.user&&u==e.decayTime-5e3&&o.sendNotification(e.user,\"Attention! Your room protection will be removed soon.\\nLearn how to defend your room against intruders from <a href='http://support.screeps.com/hc/en-us/articles/203339002-Defending-your-room'>this article</a>.\")),n.isObject(e.decayTime)&&Date.now()>e.decayTime.timestamp&&(a.remove(e._id),delete r[e._id]))}}},{\"../../../utils\":184,lodash:61}],78:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){!function(e){if(null==e)throw new TypeError(\"Cannot destructure undefined\")}(t),e&&e.type}},{\"../../../utils\":184,lodash:61}],79:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\").getDriver().constants;t.exports=function(t,r){var o=r.roomObjects,i=r.bulk,a=r.roomController,s=r.gameTime;r.eventLog;(!t.nextDecayTime||s>=t.nextDecayTime-1)&&(t.hits=t.hits||0,t.hits-=n.CONTAINER_DECAY,t.hits<=0?(n.RESOURCES_ALL.forEach(function(n){t[n]>0&&e(\"../creeps/_create-energy\")(t.x,t.y,t.room,t[n],n,r)}),i.remove(t._id),delete o[t._id]):(t.nextDecayTime=s+(a&&a.level>0?n.CONTAINER_DECAY_TIME_OWNED:n.CONTAINER_DECAY_TIME),i.update(t,{hits:t.hits,nextDecayTime:t.nextDecayTime})))}},{\"../../../utils\":184,\"../creeps/_create-energy\":85,lodash:61}],80:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var o=r.bulk,i=r.gameTime,a=r.roomInfo;e.user&&e.level&&e.safeModeAvailable>0&&(e.safeModeCooldown>=i||e.upgradeBlocked>i||e.downgradeTime<i+n.CONTROLLER_DOWNGRADE[e.level]/2-n.CONTROLLER_DOWNGRADE_SAFEMODE_THRESHOLD||o.update(e,{safeModeAvailable:e.safeModeAvailable-1,safeMode:i+n.SAFE_MODE_DURATION,safeModeCooldown:a.novice>Date.now()?null:i+n.SAFE_MODE_COOLDOWN}))}},{\"../../../utils\":184,lodash:61}],81:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\").getDriver(),o=n.constants;t.exports=function(e,t){var r=t.bulk,i=t.bulkUsers,a=t.gameTime,s=t.roomInfo,u=t.users;if(e&&\"controller\"==e.type&&(e.reservation&&(a>=e.reservation.endTime-1||e.user)&&r.update(e,{reservation:null}),e.user))if(n.addRoomToUser(e.room,u[e.user],i),e._upgradeBlocked&&(r.update(e,{upgradeBlocked:e._upgradeBlocked}),delete e._upgradeBlocked),e.downgradeTime&&!e.tutorial)if(e._upgraded)r.update(e,{downgradeTime:Math.min(e.downgradeTime+o.CONTROLLER_DOWNGRADE_RESTORE+1,a+o.CONTROLLER_DOWNGRADE[e.level]+1)});else for(a==e.downgradeTime-3e3&&n.sendNotification(e.user,\"Attention! Your Controller in room \"+e.room+\" will be downgraded to level \"+(e.level-1)+\" in 3000 ticks (~2 hours)! Upgrade it to prevent losing of this room. <a href='http://support.screeps.com/hc/en-us/articles/203086021-Territory-control'>Learn more</a>\");a>=e.downgradeTime-1&&e.level>0;)e.level--,n.sendNotification(e.user,\"Your Controller in room \"+e.room+\" has been downgraded to level \"+e.level+\" due to absence of upgrading activity!\"),0==e.level?(n.removeRoomFromUser(e.room,u[e.user],i),e.progress=0,e.user=null,e.downgradeTime=null,e.upgradeBlocked=null,e.safeMode=null,e.safeModeAvailable=0,e.safeModeCooldown=s.novice>Date.now()?null:a+o.SAFE_MODE_COOLDOWN,e.isPowerEnabled=!1):(e.downgradeTime+=o.CONTROLLER_DOWNGRADE[e.level]/2+1,e.progress+=Math.round(.9*o.CONTROLLER_LEVELS[e.level]),e.safeModeAvailable=0,e.safeModeCooldown=s.novice>Date.now()?null:a+o.SAFE_MODE_COOLDOWN),r.update(e,{downgradeTime:e.downgradeTime,level:e.level,progress:e.progress,user:e.user,upgradeBlocked:e.upgradeBlocked,safeMode:e.safeMode,safeModeCooldown:e.safeModeCooldown,safeModeAvailable:e.safeModeAvailable,isPowerEnabled:e.isPowerEnabled});else r.update(e,{downgradeTime:a+o.CONTROLLER_DOWNGRADE[e.level]+1})}},{\"../../../utils\":184,lodash:61}],82:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\").getDriver(),o=n.constants;t.exports=function(e,t,r){var i=r.bulk,a=r.bulkUsers,s=r.gameTime,u=r.roomInfo,c=r.users;\"controller\"==e.type&&e.user&&e.level&&(n.removeRoomFromUser(e.room,c[e.user],a),i.update(e,{user:null,level:0,progress:0,downgradeTime:null,safeMode:null,safeModeAvailable:0,safeModeCooldown:u.novice>Date.now()?null:s+o.SAFE_MODE_COOLDOWN,isPowerEnabled:!1}))}},{\"../../../utils\":184,lodash:61}],83:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var o=r.roomObjects,i=r.bulk;if(n.isUndefined(e._fatigue)&&(e._fatigue=e.fatigue),e._fatigue>0&&t<0){var a=Math.min(e._fatigue,-t);e._fatigue-=a,t+=a;var s=Math.max(0,e._fatigue);if(e.fatigue!=s&&i.update(e,{fatigue:s}),0==t)return}for(;e._pulled&&o[e._pulled];)e=o[e._pulled];n.isUndefined(e._fatigue)&&(e._fatigue=e.fatigue),e._fatigue+=t;var u=Math.max(0,e._fatigue);e.fatigue!=u&&i.update(e,{fatigue:u})}},{\"../../../utils\":184,lodash:61}],84:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e){var t=e.roomObjects,r=e.bulk;n.forEach(t,function(e){\"constructedWall\"==e.type&&e.decayTime&&e.user&&(r.remove(e._id),delete t[e._id])})}},{\"../../../utils\":184,lodash:61}],85:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"lodash\"),i=e(\"../../../utils\");i.getDriver().constants;t.exports=function(e,t,r,a,s,u){var c=u.roomObjects,l=u.bulk;if(s=s||\"energy\",!((a=Math.round(a))<=0)){var p=o.find(c,{type:\"container\",x:e,y:t});if(p&&p.hits>0){var f=i.calcResources(p),d=Math.min(a,p.energyCapacity-f);d>0&&(p[s]=p[s]||0,p[s]+=d,l.update(p,n({},s,p[s])),a-=d)}if(a>0){var h,m=o.find(c,{type:\"energy\",x:e,y:t,resourceType:s});if(m)l.update(m,n({},s,m[s]+a));else l.insert((n(h={type:\"energy\",x:e,y:t,room:r},s,a),n(h,\"resourceType\",s),h))}}}},{\"../../../utils\":184,lodash:61}],86:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants;t.exports=function(e,t,r,s){var u=s.roomObjects,c=s.bulk,l=s.stats,p=s.gameTime,f=s.eventLog;void 0===t&&(t=a.CREEP_CORPSE_RATE),c.remove(e._id),delete u[e._id];var d=e.body.length*a.TOMBSTONE_DECAY_PER_PART;e.tombstoneDecay&&(d=e.tombstoneDecay);var h={type:\"tombstone\",room:e.room,x:e.x,y:e.y,user:e.user,deathTime:p,decayTime:p+d,creepId:\"\"+e._id,creepName:e.name,creepTicksToLive:e.ageTime-p,creepBody:o.map(e.body,function(e){return e.type}),creepSaying:e.actionLog&&e.actionLog.say&&e.actionLog.say.isPublic?e.actionLog.say.message:void 0},m=o.find(u,{type:\"container\",x:e.x,y:e.y});if(t>0&&!e.userSummoned){var y=o.any(e.body,{type:a.CLAIM})?a.CREEP_CLAIM_LIFE_TIME:a.CREEP_LIFE_TIME,_=t*e._ticksToLive/y,R={energy:0};e.body.forEach(function(e){e.boost&&(R[e.boost]=R[e.boost]||0,R[e.boost]+=a.LAB_BOOST_MINERAL*_,R.energy+=a.LAB_BOOST_ENERGY*_),R.energy+=Math.min(a.CREEP_PART_MAX_ENERGY,a.BODYPART_COST[e.type]*_)}),o.forEach(R,function(e,t){if((e=Math.floor(e))>0){if(m&&m.hits>0){var r=i.calcResources(m),o=Math.min(e,m.energyCapacity-r);o>0&&(m[t]=m[t]||0,m[t]+=o,c.update(m,n({},t,m[t])),e-=o)}e>0&&(h[t]=(h[t]||0)+e)}}),a.RESOURCES_ALL.forEach(function(t){if(e[t]>0){var r=e[t];if(m&&m.hits>0){var o=i.calcResources(m),a=Math.min(r,m.energyCapacity-o);a>0&&(m[t]=m[t]||0,m[t]+=a,c.update(m,n({},t,m[t])),r-=a)}r>0&&(h[t]=(h[t]||0)+r)}})}c.insert(h),f.push({event:a.EVENT_OBJECT_DESTROYED,objectId:e._id,type:\"creep\"}),r&&l&&\"3\"!=e.user&&\"2\"!=e.user&&l.inc(\"creepsLost\",e.user,e.body.length)}},{\"../../../utils\":184,lodash:61}],87:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\"),o=n.getDriver().constants;t.exports=function(t,r){for(var i=0;i<o.RESOURCES_ALL.length;i++){var a=o.RESOURCES_ALL[i],s=n.calcResources(t);if(s<=t.energyCapacity)break;t[a]&&e(\"./drop\")(t,{amount:Math.min(t[a],s-t.energyCapacity),resourceType:a},r)}}},{\"../../../utils\":184,\"./drop\":94,lodash:61}],88:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\"),o=n.getDriver().constants;t.exports=function(e){for(var t=e.hits,r=e.body.length-1;r>=0;r--)e.body[r]._oldHits=e.body[r]._oldHits||e.body[r].hits,e.body[r].hits=t>100?100:t,(t-=100)<0&&(t=0);e.noCapacityRecalc||(e.energyCapacity=n.calcBodyEffectiveness(e.body,o.CARRY,\"capacity\",o.CARRY_CAPACITY,!0))}},{\"../../../utils\":184,lodash:61}],89:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){var s=a.roomObjects,u=a.roomController,c=a.gameTime;if(\"creep\"==t.type&&!t.spawning){var l=s[r.id];if(l&&l!=t&&!(Math.abs(l.x-t.x)>1||Math.abs(l.y-t.y)>1)&&(\"creep\"!=l.type||!l.spawning)&&l.hits&&!(u&&u.user!=t.user&&u.safeMode>c)){var p=n.find(s,{type:\"rampart\",x:l.x,y:l.y});p&&(l=p);var f=o.calcBodyEffectiveness(t.body,i.ATTACK,\"attack\",i.ATTACK_POWER);e(\"../_damage\")(t,l,f,i.EVENT_ATTACK_TYPE_MELEE,a),t._attack=!0}}}},{\"../../../utils\":184,\"../_damage\":76,lodash:61}],90:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.bulk,s=r.roomController,u=r.gameTime,c=r.eventLog;if(\"creep\"==e.type&&!e.spawning){var l=i[t.id];if(l&&\"controller\"==l.type&&!(Math.abs(l.x-e.x)>1||Math.abs(l.y-e.y)>1)&&(l.user||l.reservation)&&!(s&&s.user!=e.user&&s.safeMode>u||s.upgradeBlocked>u)){if(l.reservation){if(!(f=Math.floor(n.filter(e.body,function(e){return e.hits>0&&e.type==o.CLAIM}).length*o.CONTROLLER_RESERVE)))return;var p=l.reservation.endTime-f;a.update(l,{reservation:{endTime:p}})}if(l.user){var f;if(!(f=Math.floor(n.filter(e.body,function(e){return e.hits>0&&e.type==o.CLAIM}).length*o.CONTROLLER_CLAIM_DOWNGRADE)))return;var d=l.downgradeTime-f;a.update(l,{downgradeTime:d}),l._upgradeBlocked=u+o.CONTROLLER_ATTACK_BLOCKED_UPGRADE}e.actionLog.attack={x:l.x,y:l.y},c.push({event:o.EVENT_ATTACK_CONTROLLER,objectId:e._id})}}}},{\"../../../utils\":184,lodash:61}],91:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../config\"),i=e(\"../../../utils\"),a=i.getDriver().constants,s=0;t.exports=function(e,t,r){var u=r.roomObjects,c=r.roomTerrain,l=r.bulk,p=r.roomController,f=r.stats,d=r.gameTime,h=r.eventLog;if(\"creep\"==e.type&&!(e.spawning||e.energy<=0)){var m=u[t.id];if(m&&\"constructionSite\"==m.type&&a.CONSTRUCTION_COST[m.structureType]&&!(Math.abs(m.x-e.x)>3||Math.abs(m.y-e.y)>3)){var y=[],_=[],R=[],E=null;if(n.forEach(u,function(t){if(t.x==m.x&&t.y==m.y){if(t.type==m.structureType)return void(E=t);\"creep\"==t.type?(_.push(t),t.user==e.user&&R.push(t)):y.push(t)}}),!E){if(n.contains(a.OBSTACLE_OBJECT_TYPES,m.structureType)){if(n.any(y,function(e){return n.contains(a.OBSTACLE_OBJECT_TYPES,e.type)}))return;var g=p&&p.user==e.user&&p.safeMode>d?R:_;if(n.any(g))return}if(\"extractor\"==m.structureType||\"road\"==m.structureType||!i.checkTerrain(c,m.x,m.y,a.TERRAIN_MASK_WALL)){var v=n.filter(e.body,function(e){return(e.hits>0||e._oldHits>0)&&e.type==a.WORK}).length*a.BUILD_POWER||0,O=m.progressTotal-m.progress,T=Math.min(v,O,e.energy),A=n.map(e.body,function(e){return e.type==a.WORK&&e.boost&&a.BOOSTS[a.WORK][e.boost].build>0?(a.BOOSTS[a.WORK][e.boost].build-1)*a.BUILD_POWER:0});A.sort(function(e,t){return t-e}),A=A.slice(0,T);var b=Math.min(Math.floor(T+n.sum(A)),O);if(m.progress+=b,e.energy-=T,f.inc(\"energyConstruction\",e.user,T),e.actionLog.build={x:m.x,y:m.y},l.update(e,{energy:e.energy}),h.push({event:a.EVENT_BUILD,objectId:e._id,data:{targetId:m._id,amount:b}}),m.progress<m.progressTotal)l.update(m,{progress:m.progress});else{l.remove(m._id);var w={type:m.structureType,x:m.x,y:m.y,room:m.room,notifyWhenAttacked:!0};\"spawn\"==m.structureType&&n.extend(w,{name:m.name,user:m.user,energy:0,energyCapacity:a.SPAWN_ENERGY_CAPACITY,hits:a.SPAWN_HITS,hitsMax:a.SPAWN_HITS}),\"extension\"==m.structureType&&n.extend(w,{user:m.user,energy:0,energyCapacity:0,hits:a.EXTENSION_HITS,hitsMax:a.EXTENSION_HITS}),\"link\"==m.structureType&&n.extend(w,{user:m.user,energy:0,energyCapacity:a.LINK_CAPACITY,cooldown:0,hits:a.LINK_HITS,hitsMax:a.LINK_HITS_MAX}),\"storage\"==m.structureType&&n.extend(w,{user:m.user,energy:0,energyCapacity:a.STORAGE_CAPACITY,hits:a.STORAGE_HITS,hitsMax:a.STORAGE_HITS});var N=p&&p.user==e.user&&a.RAMPART_HITS_MAX[p.level]||0;if(\"rampart\"==m.structureType&&n.extend(w,{user:m.user,hits:a.RAMPART_HITS,hitsMax:N,nextDecayTime:d+a.RAMPART_DECAY_TIME}),\"road\"==m.structureType){var C=a.ROAD_HITS;(n.any(u,{x:m.x,y:m.y,type:\"swamp\"})||i.checkTerrain(c,m.x,m.y,a.TERRAIN_MASK_SWAMP))&&(C*=a.CONSTRUCTION_COST_ROAD_SWAMP_RATIO),(n.any(u,{x:m.x,y:m.y,type:\"wall\"})||i.checkTerrain(c,m.x,m.y,a.TERRAIN_MASK_WALL))&&(C*=a.CONSTRUCTION_COST_ROAD_WALL_RATIO),n.extend(w,{hits:C,hitsMax:C,nextDecayTime:d+a.ROAD_DECAY_TIME})}\"constructedWall\"==m.structureType&&n.extend(w,{hits:a.WALL_HITS,hitsMax:a.WALL_HITS_MAX}),\"tower\"==m.structureType&&n.extend(w,{user:m.user,energy:0,energyCapacity:a.TOWER_CAPACITY,hits:a.TOWER_HITS,hitsMax:a.TOWER_HITS}),\"observer\"==m.structureType&&n.extend(w,{user:m.user,hits:a.OBSERVER_HITS,hitsMax:a.OBSERVER_HITS}),\"extractor\"==m.structureType&&n.extend(w,{user:m.user,hits:a.EXTRACTOR_HITS,hitsMax:a.EXTRACTOR_HITS}),\"lab\"==m.structureType&&n.extend(w,{user:m.user,hits:a.LAB_HITS,hitsMax:a.LAB_HITS,mineralAmount:0,cooldown:0,mineralType:null,mineralCapacity:a.LAB_MINERAL_CAPACITY,energy:0,energyCapacity:a.LAB_ENERGY_CAPACITY}),\"powerSpawn\"==m.structureType&&n.extend(w,{user:m.user,power:0,powerCapacity:a.POWER_SPAWN_POWER_CAPACITY,energy:0,energyCapacity:a.POWER_SPAWN_ENERGY_CAPACITY,hits:a.POWER_SPAWN_HITS,hitsMax:a.POWER_SPAWN_HITS}),\"terminal\"==m.structureType&&n.extend(w,{user:m.user,energy:0,energyCapacity:a.TERMINAL_CAPACITY,hits:a.TERMINAL_HITS,hitsMax:a.TERMINAL_HITS}),\"container\"==m.structureType&&n.extend(w,{energy:0,energyCapacity:a.CONTAINER_CAPACITY,hits:a.CONTAINER_HITS,hitsMax:a.CONTAINER_HITS,nextDecayTime:d+a.CONTAINER_DECAY_TIME}),\"nuker\"==m.structureType&&n.extend(w,{user:m.user,energy:0,energyCapacity:o.ptr?1:a.NUKER_ENERGY_CAPACITY,G:0,GCapacity:o.ptr?1:a.NUKER_GHODIUM_CAPACITY,hits:a.NUKER_HITS,hitsMax:a.NUKER_HITS,cooldownTime:d+(o.ptr?100:a.NUKER_COOLDOWN)}),l.insert(w),u[\"createdStructure\"+s]=w,s++,delete u[t.id]}}}}}}},{\"../../../config\":1,\"../../../utils\":184,lodash:61}],92:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver(),a=i.constants;t.exports=function(e,t,r){var s=r.roomObjects,u=r.bulk,c=r.bulkUsers,l=r.users;if(\"creep\"==e.type&&!e.spawning){var p=s[t.id];if(p&&\"controller\"==p.type&&!(Math.abs(p.x-e.x)>1||Math.abs(p.y-e.y)>1||p.bindUser&&e.user!=p.bindUser||p.level>0||0===n.filter(e.body,function(e){return e.hits>0&&e.type==a.CLAIM}).length||p.reservation&&p.reservation.user!=e.user)){var f=l[e.user],d=f.rooms?f.rooms.length:0;if(!(f.gcl<o.calcNeededGcl(d+1))){u.update(p,{user:e.user,level:1,progress:0,downgradeTime:null,reservation:null}),i.addRoomToUser(e.room,l[e.user],c)}}}}},{\"../../../utils\":184,lodash:61}],93:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){var s=a.roomObjects,u=(a.roomTerrain,a.bulk),c=a.roomController,l=a.gameTime;if(\"creep\"==t.type&&!t.spawning){var p=s[r.id];if(p&&i.CONSTRUCTION_COST[p.type]&&!(Math.abs(p.x-t.x)>1||Math.abs(p.y-t.y)>1||c&&c.user!=t.user&&c.safeMode>l)){var f=n.find(s,{type:\"rampart\",x:p.x,y:p.y});f&&t.user!=f.user&&!f.isPublic&&(p=f);var d=o.calcBodyEffectiveness(t.body,i.WORK,\"dismantle\",i.DISMANTLE_POWER),h=Math.min(d,p.hits),m=Math.floor(h*i.DISMANTLE_COST),y=n.find(p.effects,{power:i.PWR_SHIELD});y&&y.endTime>=l&&(m=0),h&&(t.energy+=m,u.update(t,{energy:t.energy}),t.energy>t.energyCapacity&&e(\"./drop\")(t,{amount:t.energy-t.energyCapacity,resourceType:\"energy\"},a),e(\"../_damage\")(t,p,h,i.EVENT_ATTACK_TYPE_DISMANTLE,a))}}}},{\"../../../utils\":184,\"../_damage\":76,\"./drop\":94,lodash:61}],94:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,i){var a=i.bulk;n.contains(o.RESOURCES_ALL,r.resourceType)&&!t.spawning&&t[r.resourceType]>=r.amount&&(r.amount>0&&(t[r.resourceType]-=r.amount,e(\"./_create-energy\")(t.x,t.y,t.room,r.amount,r.resourceType,i)),a.update(t,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},r.resourceType,t[r.resourceType])))}},{\"../../../utils\":184,\"./_create-energy\":85,lodash:61}],95:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var o=r.roomObjects,i=r.bulk;if(!e.spawning){var a=o[t.id];a&&\"controller\"==a.type&&(Math.abs(a.x-e.x)>1||Math.abs(a.y-e.y)>1||e[n.RESOURCE_GHODIUM]>=n.SAFE_MODE_COST&&(i.update(a,{safeModeAvailable:(a.safeModeAvailable||0)+1}),i.update(e,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},n.RESOURCE_GHODIUM,e[n.RESOURCE_GHODIUM]-n.SAFE_MODE_COST))))}}},{\"../../../utils\":184,lodash:61}],96:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){var s=a.roomObjects,u=(a.roomTerrain,a.bulk),c=a.roomController,l=a.stats,p=a.eventLog;if(\"creep\"==t.type&&!t.spawning){var f=s[r.id];if(f&&!(Math.abs(f.x-t.x)>1||Math.abs(f.y-t.y)>1)){if(\"source\"==f.type){if(!f.energy)return;if(c&&(c.user&&c.user!=t.user||c.reservation&&c.reservation.user!=t.user))return;var d=o.calcBodyEffectiveness(t.body,i.WORK,\"harvest\",i.HARVEST_POWER);if(d){var h=Math.min(f.energy,d);f.energy-=h,t.energy+=h;var m=(f.invaderHarvested||0)+h;u.update(t,{energy:t.energy}),u.update(f,{energy:f.energy,invaderHarvested:m});var y=o.calcResources(t);y>t.energyCapacity&&e(\"./drop\")(t,{amount:Math.min(t.energy,y-t.energyCapacity),resourceType:\"energy\"},a),t.actionLog.harvest={x:f.x,y:f.y},l.inc(\"energyHarvested\",t.user,h),p.push({event:i.EVENT_HARVEST,objectId:t._id,data:{targetId:f._id,amount:h}})}}if(\"mineral\"==f.type){if(!f.mineralAmount)return;var _=n.find(s,function(e){return e.type==i.STRUCTURE_EXTRACTOR&&e.x==f.x&&e.y==f.y});if(!_)return;if(_.user&&_.user!=t.user)return;if(!o.checkStructureAgainstController(_,s,c))return;if(_.cooldown)return;var R=o.calcBodyEffectiveness(t.body,i.WORK,\"harvest\",i.HARVEST_MINERAL_POWER);if(R){var E=Math.min(f.mineralAmount,R);u.update(f,{mineralAmount:f.mineralAmount-E}),u.update(t,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},f.mineralType,(t[f.mineralType]||0)+E));var g=o.calcResources(t);g>t.energyCapacity&&e(\"./drop\")(t,{amount:Math.min(t[f.mineralType],g-t.energyCapacity),resourceType:f.mineralType},a),t.actionLog.harvest={x:f.x,y:f.y},_._cooldown=i.EXTRACTOR_COOLDOWN,p.push({event:i.EVENT_HARVEST,objectId:t._id,data:{targetId:f._id,amount:R}})}}}}}},{\"../../../utils\":184,\"./drop\":94,lodash:61}],97:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\"),o=n.getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.roomController,s=r.gameTime,u=r.eventLog;if(\"creep\"==e.type&&!e.spawning){var c=i[t.id];if(c&&(\"creep\"==c.type||\"powerCreep\"==c.type)&&!c.spawning&&!(Math.abs(c.x-e.x)>1||Math.abs(c.y-e.y)>1||a&&a.user!=e.user&&a.safeMode>s)){var l=n.calcBodyEffectiveness(e.body,o.HEAL,\"heal\",o.HEAL_POWER);c._healToApply=(c._healToApply||0)+l,e.actionLog.heal={x:c.x,y:c.y},c.actionLog.healed={x:e.x,y:e.y},u.push({event:o.EVENT_HEAL,objectId:e._id,data:{targetId:c._id,amount:l,healType:o.EVENT_HEAL_TYPE_MELEE}})}}}},{\"../../../utils\":184,lodash:61}],98:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o={rangedHeal:[\"heal\"],attackController:[\"rangedHeal\",\"heal\"],dismantle:[\"attackController\",\"rangedHeal\",\"heal\"],repair:[\"dismantle\",\"attackController\",\"rangedHeal\",\"heal\"],build:[\"repair\",\"dismantle\",\"attackController\",\"rangedHeal\",\"heal\"],attack:[\"build\",\"repair\",\"dismantle\",\"attackController\",\"rangedHeal\",\"heal\"],harvest:[\"attack\",\"build\",\"repair\",\"dismantle\",\"attackController\",\"rangedHeal\",\"heal\"],rangedMassAttack:[\"build\",\"repair\",\"rangedHeal\"],rangedAttack:[\"rangedMassAttack\",\"build\",\"repair\",\"rangedHeal\"]},i=[\"drop\",\"transfer\",\"withdraw\",\"pickup\",\"heal\",\"rangedHeal\",\"dismantle\",\"attack\",\"harvest\",\"move\",\"repair\",\"build\",\"rangedMassAttack\",\"rangedAttack\",\"say\",\"suicide\",\"claimController\",\"upgradeController\",\"reserveController\",\"attackController\",\"generateSafeMode\",\"signController\",\"pull\"],a={\"_add-fatigue\":e(\"./_add-fatigue.js\"),\"_clear-newbie-walls\":e(\"./_clear-newbie-walls.js\"),\"_create-energy\":e(\"./_create-energy.js\"),_die:e(\"./_die.js\"),\"_drop-resources-without-space\":e(\"./_drop-resources-without-space.js\"),\"_recalc-body\":e(\"./_recalc-body.js\"),attack:e(\"./attack.js\"),attackController:e(\"./attackController.js\"),build:e(\"./build.js\"),claimController:e(\"./claimController.js\"),dismantle:e(\"./dismantle.js\"),drop:e(\"./drop.js\"),generateSafeMode:e(\"./generateSafeMode.js\"),harvest:e(\"./harvest.js\"),heal:e(\"./heal.js\"),intents:e(\"./intents.js\"),move:e(\"./move.js\"),pickup:e(\"./pickup.js\"),pull:e(\"./pull.js\"),rangedAttack:e(\"./rangedAttack.js\"),rangedHeal:e(\"./rangedHeal.js\"),rangedMassAttack:e(\"./rangedMassAttack.js\"),repair:e(\"./repair.js\"),reserveController:e(\"./reserveController.js\"),say:e(\"./say.js\"),signController:e(\"./signController.js\"),suicide:e(\"./suicide.js\"),tick:e(\"./tick.js\"),transfer:e(\"./transfer.js\"),upgradeController:e(\"./upgradeController.js\"),withdraw:e(\"./withdraw.js\")};t.exports=function(e,t,r){i.forEach(function(i){(function(e,t){return e[t]&&(!o[t]||!n.any(o[t],function(t){return!!e[t]}))})(t,i)&&a[i](e,t[i],r)})}},{\"./_add-fatigue.js\":83,\"./_clear-newbie-walls.js\":84,\"./_create-energy.js\":85,\"./_die.js\":86,\"./_drop-resources-without-space.js\":87,\"./_recalc-body.js\":88,\"./attack.js\":89,\"./attackController.js\":90,\"./build.js\":91,\"./claimController.js\":92,\"./dismantle.js\":93,\"./drop.js\":94,\"./generateSafeMode.js\":95,\"./harvest.js\":96,\"./heal.js\":97,\"./intents.js\":98,\"./move.js\":105,\"./pickup.js\":106,\"./pull.js\":107,\"./rangedAttack.js\":108,\"./rangedHeal.js\":109,\"./rangedMassAttack.js\":110,\"./repair.js\":111,\"./reserveController.js\":112,\"./say.js\":113,\"./signController.js\":114,\"./suicide.js\":115,\"./tick.js\":116,\"./transfer.js\":117,\"./upgradeController.js\":118,\"./withdraw.js\":119,lodash:61}],99:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../../utils\"),i=o.getDriver().constants,a=e(\"../../../common/fake-runtime\"),s=e(\"./flee\");t.exports=function(e,t){var r=t.scope,u=t.intents,c=t.healers,l=t.hostiles,p=t.fortifications,f=r.roomObjects,d=r.roomController,h=function(e,t){p.forEach(function(e){return t.set(e.x,e.y,0)})},m=a.hasActiveBodyparts(e,i.ATTACK);if(m||!a.hasActiveBodyparts(e,i.RANGED_ATTACK)||!s(e,3,t)){var y=void 0;if(e.hits<e.hitsMax/2&&n.some(c)&&!m)if(y=a.findClosestByPath(e,c,{ignoreRoads:!0},r)){var _=a.moveTo(e,y,{maxRooms:1,ignoreRoads:!0},r);_?u.set(e._id,\"move\",{direction:_}):y=null}else y=null;if(m){var R=n.find(l,function(t){return o.dist(e,t)<=1});R&&u.set(e._id,\"attack\",{id:R._id,x:R.x,y:R.y})}if(!y&&(y=a.findClosestByPath(e,l,{ignoreRoads:!0,ignoreCreeps:!0},r))&&(m||o.dist(e,y)>3)){var E=a.moveTo(e,y,{maxRooms:1,ignoreRoads:!0,ignoreCreeps:!0},r);E&&u.set(e._id,\"move\",{direction:E})}if(!y&&(y=a.findClosestByPath(e,l,{maxRooms:1,ignoreRoads:!0,costCallback:h},r))&&(m||o.dist(e,y)>3)){var g=a.moveTo(e,y,{maxRooms:1,ignoreRoads:!0,costCallback:h},r);g&&u.set(e._id,\"move\",{direction:g})}if(!y&&(y=a.findClosestByPath(e,l,{ignoreDestructibleStructures:!0,maxRooms:1,ignoreRoads:!0},r))&&(m||o.dist(e,y)>3)){var v=a.moveTo(e,y,{ignoreDestructibleStructures:!0,maxRooms:1,ignoreRoads:!0},r);v&&u.set(e._id,\"move\",{direction:v})}if(y){if(u.set(e._id,\"attack\",{id:y._id,x:y.x,y:y.y}),(m||a.hasActiveBodyparts(e,i.WORK))&&e.memory_move&&e.memory_move.path){if(!e.memory_move.path.length)return;var O=a.RoomPosition.sUnpackLocal(e.memory_move.path[0],e.room),T=n.filter(f,function(e){return!!i.CONTROLLER_STRUCTURES[e.type]&&\"spawn\"!=e.type&&e.x==O.x&&e.y==O.y});T.length>0&&(a.hasActiveBodyparts(e,i.WORK)?u.set(e._id,\"dismantle\",{id:T[0]._id}):u.set(e._id,\"attack\",{id:T[0]._id,x:T[0].x,y:T[0].y}))}}else{var A=n.filter(f,function(t){return\"spawn\"==t.type&&!function(e,t,r){var n=a.findPath(e,t,{},r).path;return!!n.length&&n[n.length-1].x==t.x&&n[n.length-1].y==t.y}(e,new a.RoomPosition(t.x,t.y,t.room),r)});if(!A.length&&d&&d.user)return void u.set(e._id,\"suicide\",{});if(y=A[0]){var b=a.moveTo(e,y,{ignoreDestructibleStructures:!0,maxRooms:1,ignoreRoads:!0},r);b&&u.set(e._id,\"move\",{direction:b})}}}}},{\"../../../../utils\":184,\"../../../common/fake-runtime\":64,\"./flee\":100,lodash:61}],100:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../../utils\"),i=(o.getDriver().constants,e(\"../../../common/fake-runtime\"));t.exports=function(e,t,r){var a=r.scope,s=r.intents,u=r.hostiles,c=n.filter(u,function(r){return o.dist(e,r)<t});if(n.some(c)){var l=i.flee(e,c,t,{},a);if(l)return s.set(e._id,\"move\",{direction:l}),!0}return!1}},{\"../../../../utils\":184,\"../../../common/fake-runtime\":64,lodash:61}],101:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../../utils\"),i=o.getDriver().constants,a=e(\"../../../common/fake-runtime\"),s=e(\"./flee\");t.exports=function(e,t){var r=t.scope,u=t.intents,c=t.invaders,l=n.filter(c,function(t){return o.dist(t,e)<=3});if(n.some(l)){var p=n.first(l.sort(function(e,t){return t.hitsMax-t.hits-(e.hitsMax-e.hits)}));o.dist(e,p)<=1?u.set(e._id,\"heal\",{id:p._id,x:p.x,y:p.y}):u.set(e._id,\"rangedHeal\",{id:p._id})}if(e.hits<e.hitsMax/2){if(!s(e,4,t)){var f=a.findClosestByPath(e,n.filter(c,function(t){return t!=e&&a.hasActiveBodyparts(t,i.HEAL)}),null,r);if(f){var d=a.moveTo(e,f,{range:1},r);d&&u.set(e._id,\"move\",{direction:d})}}}else{var h=a.findClosestByPath(e,n.filter(c,function(e){return e.hits<e.hitsMax}),null,r);if(!h){if(s(e,4,t))return;h=a.findClosestByPath(e,n.filter(c,function(t){return t!=e&&!a.hasActiveBodyparts(t,i.HEAL)}),null,r)}if(h){var m=0;(m=o.dist(e,h)<=1?o.getDirection(h.x-e.x,h.y-e.y):a.moveTo(e,h,{range:1},r))&&u.set(e._id,\"move\",{direction:m})}else u.set(e._id,\"suicide\",{})}}},{\"../../../../utils\":184,\"../../../common/fake-runtime\":64,\"./flee\":100,lodash:61}],102:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../../utils\").getDriver().constants,i=e(\"../../../common/fake-runtime\");t.exports=function(t,r){var a=r.roomObjects,s={list:{},set:function(e,t,r){this.list[e]=this.list[e]||{},this.list[e][t]=r}},u=[],c=[],l=[],p=[],f=[],d=[];n.forEach(a,function(e){(!e.spawning&&\"creep\"==e.type||\"powerCreep\"==e.type)&&(u.push(e),t.user==e.user?(c.push(e),i.hasActiveBodyparts(e,o.HEAL)&&l.push(e)):3!=e.user&&(p.push(e),n.some(e.body,function(e){return e.hits>0&&e.type==o.ATTACK||e.type==o.RANGED_ATTACK})&&f.push(e))),e.type!=o.STRUCTURE_RAMPART&&e.type!=o.STRUCTURE_WALL||d.push(e)});var h={scope:r,intents:s,roomObjects:a,creeps:u,invaders:c,healers:l,hostiles:p,defenders:f,fortifications:d};return n.some(t.body,{type:o.HEAL})?e(\"./healer\")(t,h):e(\"./findAttack\")(t,h),e(\"./shootAtWill\")(t,h),s.list}},{\"../../../../utils\":184,\"../../../common/fake-runtime\":64,\"./findAttack\":99,\"./healer\":101,\"./shootAtWill\":103,lodash:61}],103:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../../utils\"),i=o.getDriver().constants,a=e(\"../../../common/fake-runtime\");t.exports=function(e,t){if(a.hasActiveBodyparts(e,i.RANGED_ATTACK)){var r=t.intents,s=t.hostiles,u=t.fortifications,c=n.filter(s,function(t){return o.dist(e,t)<=3});if(n.some(c)||(c=n.filter(u,function(t){return o.dist(e,t)<=3})),n.some(c)){var l=n.min(c,\"hits\");r.set(e._id,\"rangedAttack\",{id:l._id})}}}},{\"../../../../utils\":184,\"../../../common/fake-runtime\":64,lodash:61}],104:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../../utils\"),i=(o.getDriver().constants,e(\"../../../common/fake-runtime\"));t.exports=function(e,t){var r=t.roomObjects,a=t.bulk,s=void 0,u=[],c=[],l=[],p={list:{},set:function(e,t,r){this.list[e]=this.list[e]||{},this.list[e][t]=r}};if(n.forEach(r,function(t){if(\"source\"!=t.type&&\"mineral\"!=t.type||u.push(t),(\"creep\"==t.type||\"powerCreep\"==t.type)&&2!=t.user&&3!=t.user){var r=o.dist(e,t);r<=1&&c.push(t),r<=3&&l.push(t)}}),e.memory_sourceId&&r[e.memory_sourceId]&&(s=r[e.memory_sourceId]),s||(s=n.find(u,function(t){return o.dist(e,t)<=5}))&&a.update(e,{memory_sourceId:s._id.toString()}),s&&o.dist(s,e)>1){var f=i.moveTo(e,s,{range:1,reusePath:50},t);f>0?p.set(e._id,\"move\",{direction:f}):a.update(e,{memory_move:null})}var d=n.min(c,\"hits\");if(d&&p.set(e._id,\"attack\",{id:d._id,x:d.x,y:d.y}),n.some(l)){var h=[10,10,4,1];if(n.sum(l,function(t){return h[o.dist(e,t)]})>13)p.set(e._id,\"rangedMassAttack\",{});else{var m=n.min(l,\"hits\");p.set(e._id,\"rangedAttack\",{id:m._id})}}return p.list}},{\"../../../../utils\":184,\"../../../common/fake-runtime\":64,lodash:61}],105:[function(e,t,r){\"use strict\";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants,s=e(\"../movement\");t.exports=function(e,t,r){var u=r.roomObjects;if(!e.spawning){e._oldFatigue=e.fatigue;var c=null;if(t.direction&&(c=i.getOffsetsByDirection(t.direction)),t.id){var l=u[t.id];l&&(c=[l.x-e.x,l.y-e.y])}if(c){var p=n(c,2),f=p[0],d=p[1];if(!(e.x+f<0||e.x+f>49||e.y+d<0||e.y+d>49)){var h=o.filter(u,{x:e.x+f,y:e.y+d});o.any(h,function(t){return o.contains(a.OBSTACLE_OBJECT_TYPES,t.type)&&\"creep\"!=t.type&&\"powerCreep\"!=t.type||\"rampart\"==t.type&&!t.isPublic&&e.user!=t.user||\"powerCreep\"==e.type&&\"portal\"==t.type&&t.destination.shard})||s.add(e,f,d)}}}}},{\"../../../utils\":184,\"../movement\":135,lodash:61}],106:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e(\"lodash\");var o=e(\"../../../utils\");o.getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.bulk,s=o.calcResources(e);if(!(e.spawning||s>=e.energyCapacity)){var u=i[t.id];if(u&&\"energy\"==u.type&&!(Math.abs(u.x-e.x)>1||Math.abs(u.y-e.y)>1)){var c=u.resourceType||\"energy\",l=Math.min(e.energyCapacity-s,u[c]);u[c]-=l,e[c]=e[c]||0,e[c]+=l,u[c]?a.update(u,n({},c,u[c])):(a.remove(u._id),delete i[u._id]),a.update(e,n({},c,e[c]))}}}},{\"../../../utils\":184,lodash:61}],107:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;var n=e(\"../movement\");t.exports=function(e,t,r){var o=r.roomObjects;if(\"creep\"==e.type&&!e.spawning){var i=o[t.id];i&&\"creep\"==i.type&&!i.spawning&&(Math.abs(i.x-e.x)>1||Math.abs(i.y-e.y)>1||n.addPulling(e,i))}}},{\"../../../utils\":184,\"../movement\":135,lodash:61}],108:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){var s=a.roomObjects,u=a.roomController,c=a.gameTime;if(\"creep\"==t.type&&!t.spawning){var l=s[r.id];if(l&&l!=t&&!(Math.abs(l.x-t.x)>3||Math.abs(l.y-t.y)>3)&&(\"creep\"!=l.type||!l.spawning)&&l.hits&&!(u&&u.user!=t.user&&u.safeMode>c)){var p=n.find(s,{type:\"rampart\",x:l.x,y:l.y});p&&(l=p);var f=o.calcBodyEffectiveness(t.body,i.RANGED_ATTACK,\"rangedAttack\",i.RANGED_ATTACK_POWER);e(\"../_damage\")(t,l,f,i.EVENT_ATTACK_TYPE_RANGED,a)}}}},{\"../../../utils\":184,\"../_damage\":76,lodash:61}],109:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\"),o=n.getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.roomController,s=r.gameTime,u=r.eventLog;if(\"creep\"==e.type&&!e.spawning){var c=i[t.id];if(c&&(\"creep\"==c.type||\"powerCreep\"==c.type)&&!c.spawning&&!(Math.abs(c.x-e.x)>3||Math.abs(c.y-e.y)>3||a&&a.user!=e.user&&a.safeMode>s)){var l=n.calcBodyEffectiveness(e.body,o.HEAL,\"rangedHeal\",o.RANGED_HEAL_POWER);c._healToApply=(c._healToApply||0)+l,e.actionLog.rangedHeal={x:c.x,y:c.y},c.actionLog.healed={x:e.x,y:e.y},u.push({event:o.EVENT_HEAL,objectId:e._id,data:{targetId:c._id,amount:l,healType:o.EVENT_HEAL_TYPE_RANGED}})}}}},{\"../../../utils\":184,lodash:61}],110:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){var s=a.roomObjects,u=a.roomController,c=a.gameTime;if(\"creep\"==t.type&&!t.spawning){var l=o.calcBodyEffectiveness(t.body,i.RANGED_ATTACK,\"rangedMassAttack\",i.RANGED_ATTACK_POWER);if(0!=l&&!(u&&u.user!=t.user&&u.safeMode>c)){var p=n.filter(s,function(e){return(!n.isUndefined(e.user)||\"powerBank\"==e.type)&&e.user!=t.user&&e.x>=t.x-3&&e.x<=t.x+3&&e.y>=t.y-3&&e.y<=t.y+3}),f={0:1,1:1,2:.4,3:.1};for(var d in p){var h=p[d];if((\"rampart\"==h.type||!n.find(s,{type:\"rampart\",x:h.x,y:h.y}))&&(h.hits&&(\"creep\"!=h.type||!h.spawning))){var m=Math.max(Math.abs(t.x-h.x),Math.abs(t.y-h.y)),y=Math.round(l*f[m]);e(\"../_damage\")(t,h,y,i.EVENT_ATTACK_TYPE_MASS_RANGED,a)}}t.actionLog.rangedMassAttack={}}}}},{\"../../../utils\":184,\"../_damage\":76,lodash:61}],111:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.bulk,s=r.stats,u=r.eventLog;if(\"creep\"==e.type&&!(e.spawning||e.energy<=0)){var c=i[t.id];if(c&&o.CONSTRUCTION_COST[c.type]&&!(c.hits>=c.hitsMax)&&!(Math.abs(c.x-e.x)>3||Math.abs(c.y-e.y)>3)&&c.hitsMax){var l=n.filter(e.body,function(e){return(e.hits>0||e._oldHits>0)&&e.type==o.WORK}).length*o.REPAIR_POWER||0,p=e.energy/o.REPAIR_COST,f=c.hitsMax-c.hits,d=Math.min(l,p,f),h=Math.min(e.energy,Math.ceil(d*o.REPAIR_COST)),m=n.map(e.body,function(e){return e.type==o.WORK&&e.boost&&o.BOOSTS[o.WORK][e.boost].repair>0?(o.BOOSTS[o.WORK][e.boost].repair-1)*o.REPAIR_POWER:0});m.sort(function(e,t){return t-e}),m=m.slice(0,d);var y=Math.min(Math.floor(d+n.sum(m)),f);y&&(c.hits+=y,e.energy-=h,s.inc(\"energyConstruction\",e.user,h),c.hits>c.hitsMax&&(c.hits=c.hitsMax),e.actionLog.repair={x:c.x,y:c.y},a.update(c,{hits:c.hits}),a.update(e,{energy:e.energy}),u.push({event:o.EVENT_REPAIR,objectId:e._id,data:{targetId:c._id,amount:y,energySpent:h}}))}}}},{\"../../../utils\":184,lodash:61}],112:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.bulk,s=r.gameTime,u=r.eventLog;if(\"creep\"==e.type&&!e.spawning){var c=i[t.id];if(c&&\"controller\"==c.type&&!(Math.abs(c.x-e.x)>1||Math.abs(c.y-e.y)>1||c.user||c.reservation&&c.reservation.user!=e.user)){var l=n.filter(e.body,function(e){return e.hits>0&&e.type==o.CLAIM}).length*o.CONTROLLER_RESERVE;l&&(c.reservation||(c.reservation={user:e.user,endTime:s+1}),c.reservation.endTime+=l,c.reservation.endTime>s+o.CONTROLLER_RESERVE_MAX||(e.actionLog.reserveController={x:c.x,y:c.y},a.update(c,{reservation:c.reservation}),u.push({event:o.EVENT_RESERVE_CONTROLLER,objectId:e._id,data:{amount:l}})))}}}},{\"../../../utils\":184,lodash:61}],113:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){!function(e){if(null==e)throw new TypeError(\"Cannot destructure undefined\")}(r),\"creep\"==e.type&&(e.spawning||n.isString(t.message)&&(e.actionLog.say={message:t.message.substring(0,10),isPublic:t.isPublic}))}},{\"../../../utils\":184,lodash:61}],114:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var n=r.roomObjects,o=r.bulk,i=r.gameTime;if(\"creep\"==e.type&&!e.spawning){var a=n[t.id];a&&\"controller\"==a.type&&(Math.abs(a.x-e.x)>1||Math.abs(a.y-e.y)>1||o.update(a,{sign:t.sign?{user:e.user,text:t.sign,time:i,datetime:Date.now()}:null}))}}},{\"../../../utils\":184,lodash:61}],115:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,n){\"creep\"==t.type&&(t.spawning||e(\"./_die\")(t,\"2\"==t.user?0:void 0,!1,n))}},{\"../../../utils\":184,\"./_die\":86,lodash:61}],116:[function(e,t,r){\"use strict\";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants,s=e(\"../movement\");t.exports=function(t,r){var u=r.roomObjects,c=r.bulk,l=r.roomController,p=r.gameTime,f=r.eventLog;if(t&&\"creep\"==t.type){if(t.spawning){var d=o.find(u,{type:\"spawn\",x:t.x,y:t.y});d?d.spawning&&d.spawning.name==t.name||e(\"../spawns/_born-creep\")(d,t,r):c.remove(t._id)}else{if(s.execute(t,r),i.isAtEdge(t)&&\"2\"!=t.user&&\"3\"!=t.user){var h=i.roomNameToXY(t.room),m=n(h,2),y=m[0],_=m[1],R=t.x,E=t.y,g=t.room;0==t.x?(R=49,g=i.getRoomNameFromXY(y-1,_)):0==t.y?(E=49,g=i.getRoomNameFromXY(y,_-1)):49==t.x?(R=0,g=i.getRoomNameFromXY(y+1,_)):49==t.y&&(E=0,g=i.getRoomNameFromXY(y,_+1)),c.update(t,{interRoom:{room:g,x:R,y:E}}),f.push({event:a.EVENT_EXIT,objectId:t._id,data:{room:g,x:R,y:E}})}if(t.ageTime){var v=o.find(u,function(e){return\"portal\"==e.type&&e.x==t.x&&e.y==t.y});v&&c.update(t,{interRoom:v.destination})}t.tutorial||(t.ageTime||(t.ageTime=p+(o.any(t.body,{type:a.CLAIM})?a.CREEP_CLAIM_LIFE_TIME:a.CREEP_LIFE_TIME),c.update(t,{ageTime:t.ageTime})),p>=t.ageTime-1&&e(\"./_die\")(t,void 0,!1,r)),o.isEqual(t.actionLog,t._actionLog)||c.update(t,{actionLog:t.actionLog})}var O=i.calcBodyEffectiveness(t.body,a.MOVE,\"fatigue\",1);O>0&&e(\"./_add-fatigue\")(t,-2*O,r),(o.isNaN(t.hits)||t.hits<=0)&&e(\"./_die\")(t,void 0,!0,r),t.userSummoned&&o.any(u,function(e){return\"creep\"==e.type&&\"2\"!=e.user&&e.user!=l.user})&&e(\"./_die\")(t,void 0,!1,r);var T=t.hits;t._damageToApply&&(!function(e,t){var r=0,n=t;if(o.any(e.body,function(e){return!!e.boost}))for(var i=0;i<e.body.length&&!(n<=0);i++){var s=e.body[i],u=1;s.boost&&a.BOOSTS[s.type][s.boost]&&a.BOOSTS[s.type][s.boost].damage&&(u=a.BOOSTS[s.type][s.boost].damage);var c=s.hits/u;r+=Math.min(c,n)*(1-u),n-=Math.min(c,n)}t-=Math.round(r),e.hits-=t}(t,t._damageToApply),delete t._damageToApply),t._healToApply&&(t.hits+=t._healToApply,delete t._healToApply),t.hits>t.hitsMax&&(t.hits=t.hitsMax),t.hits<=0?e(\"./_die\")(t,void 0,!0,r):t.hits!=T&&(e(\"./_recalc-body\")(t),t.hits<T&&e(\"./_drop-resources-without-space\")(t,r),c.update(t,{hits:t.hits,body:t.body,energyCapacity:t.energyCapacity}))}}},{\"../../../utils\":184,\"../movement\":135,\"../spawns/_born-creep\":164,\"./_add-fatigue\":83,\"./_die\":86,\"./_drop-resources-without-space\":87,\"./_recalc-body\":88,lodash:61}],117:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants;t.exports=function(e,t,r){var s=r.roomObjects,u=r.bulk,c=r.eventLog;if(o.contains(a.RESOURCES_ALL,t.resourceType)&&!e.spawning&&e[t.resourceType]>=t.amount&&!(t.amount<0)){var l=s[t.id];if(l&&(\"creep\"!=l.type||!l.spawning)&&!(Math.abs(l.x-e.x)>1||Math.abs(l.y-e.y)>1)){if(\"energy\"==t.resourceType){if(!o.contains([\"spawn\",\"creep\",\"powerCreep\",\"extension\",\"link\",\"storage\",\"tower\",\"powerSpawn\",\"lab\",\"terminal\",\"container\",\"nuker\"],l.type))return}else if(\"power\"==t.resourceType){if(!o.contains([\"creep\",\"powerCreep\",\"storage\",\"powerSpawn\",\"terminal\",\"container\"],l.type))return}else if(!o.contains([\"creep\",\"powerCreep\",\"storage\",\"lab\",\"terminal\",\"container\",\"nuker\"],l.type))return;var p=t.amount;if(\"lab\"==l.type){if(t.resourceType!=a.RESOURCE_ENERGY&&l.mineralType&&l.mineralType!=t.resourceType)return;var f=t.resourceType==a.RESOURCE_ENERGY?\"energyCapacity\":\"mineralCapacity\",d=t.resourceType==a.RESOURCE_ENERGY?\"energy\":\"mineralAmount\";if(l[d]>=l[f])return;l[d]+p>l[f]&&(p=l[f]-l[d]),l[d]+=p,u.update(l,n({},d,l[d])),l.mineralAmount&&!l.mineralType&&u.update(l,{mineralType:t.resourceType})}else{if(\"powerSpawn\"==l.type){if(l[t.resourceType]>=l[t.resourceType+\"Capacity\"])return;l[t.resourceType]+p>l[t.resourceType+\"Capacity\"]&&(p=l[t.resourceType+\"Capacity\"]-l[t.resourceType])}else if(\"nuker\"==l.type){if(t.resourceType!=a.RESOURCE_ENERGY&&t.resourceType!=a.RESOURCE_GHODIUM)return;if(l[t.resourceType]>=l[t.resourceType+\"Capacity\"])return;l[t.resourceType]+p>l[t.resourceType+\"Capacity\"]&&(p=l[t.resourceType+\"Capacity\"]-l[t.resourceType])}else{var h=i.calcResources(l);if(h>=l.energyCapacity)return;h+p>l.energyCapacity&&(p=l.energyCapacity-h)}l[t.resourceType]=l[t.resourceType]||0,l[t.resourceType]+=p,u.update(l,n({},t.resourceType,l[t.resourceType]))}e[t.resourceType]-=p,u.update(e,n({},t.resourceType,e[t.resourceType])),c.push({event:a.EVENT_TRANSFER,objectId:e._id,data:{targetId:l._id,resourceType:t.resourceType,amount:p}})}}}},{\"../../../utils\":184,lodash:61}],118:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver(),i=o.constants,a=e(\"../../../config\");t.exports=function(e,t,r){var s=r.roomObjects,u=r.bulk,c=r.bulkUsers,l=r.stats,p=r.gameTime,f=r.eventLog;if(\"creep\"==e.type&&!(e.spawning||e.energy<=0)){var d=s[t.id];if(d&&\"controller\"==d.type&&!(Math.abs(d.x-e.x)>3||Math.abs(d.y-e.y)>3||0==d.level||d.user!=e.user||d.upgradeBlocked&&d.upgradeBlocked>p)){d._upgraded=d._upgraded||0;var h=n.filter(e.body,function(e){return(e.hits>0||e._oldHits>0)&&e.type==i.WORK}).length*i.UPGRADE_CONTROLLER_POWER||0,m=Math.min(h,e.energy),y=n.map(e.body,function(e){return e.type==i.WORK&&e.boost&&i.BOOSTS[i.WORK][e.boost].upgradeController>0?i.BOOSTS[i.WORK][e.boost].upgradeController-1:0});if(8==d.level){var _=i.CONTROLLER_MAX_UPGRADE_PER_TICK,R=n.find(d.effects,{power:i.PWR_OPERATE_CONTROLLER});if(R&&R.endTime>=p&&(_+=i.POWER_INFO[i.PWR_OPERATE_CONTROLLER].effect[R.level-1]),d._upgraded>=_)return;m=Math.min(m,_-d._upgraded)}y.sort(function(e,t){return t-e}),y=y.slice(0,m);var E=Math.floor(m+n.sum(y));if(d.level<8){var g=i.CONTROLLER_LEVELS[d.level];a.ptr&&(g=1e3),d.tutorial&&1==d.level&&(g=4),d.progress+E>=g&&d.downgradeTime>=p+i.CONTROLLER_DOWNGRADE[d.level]?(d.progress=d.progress+E-g,d.level++,d.downgradeTime=p+i.CONTROLLER_DOWNGRADE[d.level]/2,o.sendNotification(d.user,\"Your Controller in room \"+d.room+\" has been upgraded to level \"+d.level+\".\"),8==d.level&&(d.progress=0),d.safeModeAvailable=(d.safeModeAvailable||0)+1):d.progress+=E}c.inc&&c.inc(d.user,\"gcl\",E),d._upgraded+=m,l.inc(\"energyControl\",e.user,E),e.energy-=m,e.actionLog.upgradeController={x:d.x,y:d.y},u.update(e,{energy:e.energy}),u.update(d,{level:d.level,progress:d.progress,safeModeAvailable:d.safeModeAvailable,downgradeTime:d.downgradeTime}),f.push({event:i.EVENT_UPGRADE_CONTROLLER,objectId:e._id,data:{amount:E,energySpent:m}})}}}},{\"../../../config\":1,\"../../../utils\":184,lodash:61}],119:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants;t.exports=function(e,t,r){var s=r.roomObjects,u=r.bulk,c=r.roomController,l=r.gameTime,p=r.eventLog;if(o.contains(a.RESOURCES_ALL,t.resourceType)){var f=i.calcResources(e),d=e.energyCapacity-f,h=Math.min(t.amount,d);if(!(e.spawning||h<0||c&&c.user!=e.user&&c.safeMode>l)){var m=s[t.id];if(m&&!(e.user!=m.user&&o.any(s,function(t){return t.type==a.STRUCTURE_RAMPART&&t.user!=e.user&&!t.isPublic&&t.x==m.x&&t.y==m.y})||Math.abs(m.x-e.x)>1||Math.abs(m.y-e.y)>1)){if(\"energy\"==t.resourceType){if(!o.contains([\"spawn\",\"creep\",\"powerCreep\",\"extension\",\"link\",\"storage\",\"tower\",\"powerSpawn\",\"lab\",\"terminal\",\"container\",\"tombstone\"],m.type))return}else if(\"power\"==t.resourceType){if(!o.contains([\"creep\",\"powerCreep\",\"storage\",\"powerSpawn\",\"terminal\",\"container\",\"tombstone\"],m.type))return}else if(!o.contains([\"creep\",\"powerCreep\",\"storage\",\"lab\",\"terminal\",\"container\",\"tombstone\"],m.type))return;if(\"lab\"==m.type){if(t.resourceType!=a.RESOURCE_ENERGY&&t.resourceType!=m.mineralType)return;t.resourceType,a.RESOURCE_ENERGY;var y=t.resourceType==a.RESOURCE_ENERGY?\"energy\":\"mineralAmount\";h>m[y]&&(h=m[y]),m[y]-=h,u.update(m,n({},y,m[y])),!m.mineralAmount&&m.mineralType&&u.update(m,{mineralType:null})}else{if(\"terminal\"==m.type){var _=o.find(m.effects,{power:a.PWR_DISRUPT_TERMINAL});if(_&&_.endTime>l)return}h>m[t.resourceType]&&(h=m[t.resourceType]),m[t.resourceType]-=h,u.update(m,n({},t.resourceType,m[t.resourceType]))}e[t.resourceType]=e[t.resourceType]||0,e[t.resourceType]+=h,u.update(e,n({},t.resourceType,e[t.resourceType])),p.push({event:a.EVENT_TRANSFER,objectId:m._id,data:{targetId:e._id,resourceType:t.resourceType,amount:h}})}}}}},{\"../../../utils\":184,lodash:61}],120:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.roomObjects,i=t.bulk;if(e&&\"energy\"==e.type){var a=e.resourceType||\"energy\";e[a]-=Math.ceil(e[a]/o.ENERGY_DECAY),e[a]<=0||!e[a]?(n.isNaN(e[a]),i.remove(e._id),delete r[e._id]):i.update(e,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},a,e[a]))}}},{\"../../../utils\":184,lodash:61}],121:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.bulk,o=t.roomController;if(e&&\"extension\"==e.type&&o){var i=n.EXTENSION_ENERGY_CAPACITY[o.level]||0;i!=e.energyCapacity&&r.update(e,{energyCapacity:i})}}},{\"../../../utils\":184,lodash:61}],122:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants;t.exports=function(e,t,r){var s=r.roomObjects,u=r.bulk,c=r.gameTime;if(o.contains(a.RESOURCES_ALL,t.resourceType)){if(\"terminal\"==e.type){var l=o.find(e.effects,{power:a.PWR_DISRUPT_TERMINAL});if(l&&l.endTime>c)return}var p=s[t.id];if(!(!p||\"creep\"!=p.type||p.spawning||i.calcResources(p)>=p.energyCapacity||t.amount<0||Math.abs(p.x-e.x)>1||Math.abs(p.y-e.y)>1)){var f=t.amount;i.calcResources(p)+f>p.energyCapacity&&(f=p.energyCapacity-i.calcResources(p)),e[t.resourceType]>=f&&(p[t.resourceType]=p[t.resourceType]||0,p[t.resourceType]+=f,e[t.resourceType]-=f,u.update(e,n({},t.resourceType,e[t.resourceType])),u.update(p,n({},t.resourceType,p[t.resourceType])))}}}},{\"../../../utils\":184,lodash:61}],123:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants,e(\"../movement\");t.exports=function(e,t){var r=t.bulk;e.cooldown>0&&(e.cooldown--,e.cooldown<0&&(e.cooldown=0),r.update(e,{cooldown:e.cooldown})),e._cooldown&&r.update(e,{cooldown:e._cooldown})}},{\"../../../utils\":184,\"../movement\":135,lodash:61}],124:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.roomObjects,i=t.bulk,a=t.gameTime;if(e&&\"keeperLair\"==e.type){if(!e.nextSpawnTime)(!(s=n.find(r,function(t){return\"creep\"==t.type&&\"3\"==t.user&&t.name==\"Keeper\"+e._id}))||s.hits<5e3)&&i.update(e,{nextSpawnTime:a+o.ENERGY_REGEN_TIME});if(e.nextSpawnTime&&a>=e.nextSpawnTime-1){var s;(s=n.find(r,function(t){return\"creep\"==t.type&&\"3\"==t.user&&t.name==\"Keeper\"+e._id}))&&i.remove(s._id);for(var u=[],c=0;c<17;c++)u.push({type:o.TOUGH,hits:100});for(c=0;c<13;c++)u.push({type:o.MOVE,hits:100});for(c=0;c<10;c++)u.push({type:o.ATTACK,hits:100}),u.push({type:o.RANGED_ATTACK,hits:100});i.insert({name:\"Keeper\"+e._id,x:e.x,y:e.y,body:u,energy:0,energyCapacity:0,type:\"creep\",room:e.room,user:\"3\",hits:5e3,hitsMax:5e3,spawning:!1,fatigue:0}),i.update(e,{nextSpawnTime:null})}}}},{\"../../../utils\":184,lodash:61}],125:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,i){var a=i.roomObjects,s=i.bulk;if(!(t.mineralAmount<o.LAB_BOOST_MINERAL||t.energy<o.LAB_BOOST_ENERGY)){var u=a[r.id];if(u&&\"creep\"==u.type&&!u.spawning&&!(Math.abs(u.x-t.x)>1||Math.abs(u.y-t.y)>1)){var c=n.filter(u.body,function(e){return!e.boost&&o.BOOSTS[e.type]&&o.BOOSTS[e.type][t.mineralType]});if(c.length){for(c[0].type!=o.TOUGH&&c.reverse(),r.bodyPartsCount&&(c=c.slice(0,r.bodyPartsCount));t.mineralAmount>=o.LAB_BOOST_MINERAL&&t.energy>=o.LAB_BOOST_ENERGY&&c.length;)c[0].boost=t.mineralType,t.mineralAmount-=o.LAB_BOOST_MINERAL,t.energy-=o.LAB_BOOST_ENERGY,c.splice(0,1);s.update(t,{mineralAmount:t.mineralAmount,energy:t.energy}),t.mineralAmount||s.update(t,{mineralType:null}),e(\"../creeps/_recalc-body\")(u),s.update(u,{body:u.body,energyCapacity:u.energyCapacity}),u.actionLog.healed={x:t.x,y:t.y}}}}}},{\"../../../utils\":184,\"../creeps/_recalc-body\":88,lodash:61}],126:[function(e,t,r){\"use strict\";t.exports=function(t,r,n){r.transfer&&e(\"./transfer\")(t,r.transfer,n),r.runReaction&&e(\"./run-reaction\")(t,r.runReaction,n),r.boostCreep&&e(\"./boost-creep\")(t,r.boostCreep,n),r.unboostCreep&&e(\"./unboost-creep\")(t,r.unboostCreep,n)}},{\"./boost-creep\":125,\"./run-reaction\":127,\"./transfer\":129,\"./unboost-creep\":130}],127:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.bulk,s=r.gameTime;if(!(e.cooldown>0)){var u=o.LAB_REACTION_AMOUNT,c=n.find(e.effects,{power:o.PWR_OPERATE_LAB});c&&c.endTime>s&&(u+=o.POWER_INFO[o.PWR_OPERATE_LAB].effect[c.level-1]);var l=i[t.lab1];if(l&&\"lab\"==l.type&&!(l.mineralAmount<u)&&!(Math.abs(l.x-e.x)>2||Math.abs(l.y-e.y)>2)){var p=i[t.lab2];if(p&&\"lab\"==p.type&&!(p.mineralAmount<u)&&!(Math.abs(p.x-e.x)>2||Math.abs(p.y-e.y)>2||e.mineralAmount>e.mineralCapacity-u)){var f=o.REACTIONS[l.mineralType][p.mineralType];if(f&&(!e.mineralType||e.mineralType==f)){var d=o.REACTION_TIME[f];a.update(e,{mineralAmount:e.mineralAmount+u,cooldown:d}),e.mineralType||a.update(e,{mineralType:f}),a.update(l,{mineralAmount:l.mineralAmount-u}),l.mineralAmount||a.update(l,{mineralType:null}),a.update(p,{mineralAmount:p.mineralAmount-u}),p.mineralAmount||a.update(p,{mineralType:null}),e.actionLog.runReaction={x1:l.x,y1:l.y,x2:p.x,y2:p.y}}}}}}},{\"../../../utils\":184,lodash:61}],128:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants,e(\"../movement\");t.exports=function(e,t){var r=t.bulk;e.cooldown>0?(e.cooldown--,e.cooldown<0&&(e.cooldown=0),r.update(e,{cooldown:e.cooldown,actionLog:e.actionLog})):n.isEqual(e._actionLog,e.actionLog)||r.update(e,{actionLog:e.actionLog})}},{\"../../../utils\":184,\"../movement\":135,lodash:61}],129:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants;t.exports=function(e,t,r){var s=r.roomObjects,u=r.bulk;if(o.contains(a.RESOURCES_ALL,t.resourceType)){var c=s[t.id];if(!(!c||\"creep\"!=c.type||c.spawning||i.calcResources(c)>=c.energyCapacity||t.amount<0||Math.abs(c.x-e.x)>1||Math.abs(c.y-e.y)>1)){var l=t.amount,p=t.resourceType==a.RESOURCE_ENERGY?\"energy\":\"mineralAmount\";i.calcResources(c)+l>c.energyCapacity&&(l=c.energyCapacity-i.calcResources(c)),e[p]<l||(c[t.resourceType]=c[t.resourceType]||0,c[t.resourceType]+=l,e[p]-=l,!e.mineralAmount&&e.mineralType&&u.update(e,{mineralType:null}),u.update(e,n({},p,e[p])),u.update(c,n({},t.resourceType,c[t.resourceType])))}}}},{\"../../../utils\":184,lodash:61}],130:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){if(!(t.cooldown>0)){var s=a.roomObjects,u=a.bulk,c=a.roomController,l=s[r.id];if(l&&\"creep\"==l.type&&l.user==t.user&&o.checkStructureAgainstController(t,s,c)&&!(Math.abs(l.x-t.x)>1||Math.abs(l.y-t.y)>1)){var p=n.mapValues(n.groupBy(n.filter(l.body,function(e){return!!e.boost}),\"boost\"),function(e){return e.length});if(n.some(p)){l.body.forEach(function(e){e.boost=null}),e(\"../creeps/_recalc-body\")(l),u.update(l,{body:l.body,energyCapacity:l.energyCapacity});var f=n.reduce(i.RESOURCES_ALL,function(t,r){if(!p[r])return t;var n=p[r]*i.LAB_UNBOOST_ENERGY;n>0&&e(\"../creeps/_create-energy\")(l.x,l.y,l.room,n,i.RESOURCE_ENERGY,a);var s=p[r]*i.LAB_UNBOOST_MINERAL;return s>0&&e(\"../creeps/_create-energy\")(l.x,l.y,l.room,s,r,a),t+p[r]*o.calcTotalReactionsTime(r)*i.LAB_UNBOOST_MINERAL/i.LAB_REACTION_AMOUNT},0);f>0&&u.update(t,{cooldown:f})}}}}},{\"../../../utils\":184,\"../creeps/_create-energy\":85,\"../creeps/_recalc-body\":88,lodash:61}],131:[function(e,t,r){\"use strict\";t.exports=function(t,r,n){r.transfer&&e(\"./transfer\")(t,r.transfer,n)}},{\"./transfer\":133}],132:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants,e(\"../movement\");t.exports=function(e,t){var r=t.bulk;e&&\"link\"==e.type&&(e.cooldown>0?(e.cooldown--,e.cooldown<0&&(e.cooldown=0),r.update(e,{cooldown:e.cooldown,actionLog:e.actionLog})):n.isEqual(e._actionLog,e.actionLog)||r.update(e,{actionLog:e.actionLog}))}},{\"../../../utils\":184,\"../movement\":135,lodash:61}],133:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(e,t,r){var a=r.roomObjects,s=r.bulk,u=r.roomController,c=r.eventLog;if(\"link\"==e.type&&!(e.energy<t.amount||t.amount<0)){var l=a[t.id];if(l&&n.contains([\"link\",\"creep\"],l.type)){var p;if(\"creep\"==l.type){if(l.spawning||Math.abs(l.x-e.x)>1||Math.abs(l.y-e.y)>1)return;p=o.calcResources(l)}if(\"link\"==l.type){if(e.cooldown>0)return;if(!o.checkStructureAgainstController(e,a,u))return;p=l.energy}if(p!=l.energyCapacity){var f=t.amount;p+f>l.energyCapacity&&(f=l.energyCapacity-p),l.energy+=f,e.energy-=f,\"link\"==l.type&&(l.energy-=Math.ceil(f*i.LINK_LOSS_RATIO),e.cooldown+=i.LINK_COOLDOWN*Math.max(Math.abs(l.x-e.x),Math.abs(l.y-e.y)),e.actionLog.transferEnergy={x:l.x,y:l.y}),s.update(e,{energy:e.energy,cooldown:e.cooldown,actionLog:e.actionLog}),s.update(l,{energy:l.energy}),c.push({event:i.EVENT_TRANSFER,objectId:e._id,data:{targetId:l._id,resourceType:i.RESOURCE_ENERGY,amount:f}})}}}}},{\"../../../utils\":184,lodash:61}],134:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.bulk,i=t.gameTime;if(!e.mineralAmount&&(e.nextRegenerationTime||(e.nextRegenerationTime=i+o.MINERAL_REGEN_TIME,r.update(e,{nextRegenerationTime:e.nextRegenerationTime})),i>=e.nextRegenerationTime-1)){var a={nextRegenerationTime:null,mineralAmount:o.MINERAL_DENSITY[e.density]};if(e.density==o.DENSITY_LOW||e.density==o.DENSITY_ULTRA||Math.random()<o.MINERAL_DENSITY_CHANGE){var s,u=e.density;do{var c=Math.random();for(var l in o.MINERAL_DENSITY_PROBABILITY)if(c<=o.MINERAL_DENSITY_PROBABILITY[l]){s=+l;break}}while(s==u);a.density=e.density=s}r.update(e,a)}var p=n.find(e.effects,{power:o.PWR_REGEN_MINERAL});if(p&&p.endTime>i&&!e.nextRegenerationTime&&e.mineralAmount){var f=o.POWER_INFO[o.PWR_REGEN_MINERAL];(p.endTime-i-1)%f.period==0&&r.update(e,{mineralAmount:e.mineralAmount+f.effect[p.level-1]})}}},{\"../../../utils\":184,lodash:61}],135:[function(e,t,r){\"use strict\";var n,o,i,a,s,u=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),c=e(\"lodash\"),l=e(\"../../utils\"),p=l.getDriver().constants;function f(e){return\"powerCreep\"==e.type||!!e._pulled||!e._oldFatigue&&c.some(e.body,function(e){return e.hits>0&&e.type==p.MOVE})}function d(e,t,r,n){var i=!1,u=!1;return c.forEach(a,function(a){if(a.x==e&&a.y==t)return(\"creep\"==a.type||\"powerCreep\"==a.type)&&!o[a._id]&&(!n||n!=r.user||n==r.user&&r.user==a.user)||\"creep\"!=a.type&&\"powerCreep\"!=a.type&&c.contains(p.OBSTACLE_OBJECT_TYPES,a.type)||\"rampart\"==a.type&&!a.isPublic&&a.user!=r.user||\"constructionSite\"==a.type&&a.user==r.user&&c.contains(p.OBSTACLE_OBJECT_TYPES,a.structureType)?(i=!0,!1):void(\"road\"==a.type&&(u=!0))}),!!i||l.checkTerrain(s,e,t,p.TERRAIN_MASK_WALL)&&!u}function h(e){var t=0,r=0;p.RESOURCES_ALL.forEach(function(r){t+=e[r]||0});for(var n=e.body.length-1;n>=0&&t;n--){var o=e.body[n];if(o.type==p.CARRY&&o.hits){var i=1;o.boost&&(i=p.BOOSTS[p.CARRY][o.boost].capacity||1),t-=Math.min(t,p.CARRY_CAPACITY*i),r++}}return r}r.init=function(e,t){n={},o={},i={},a=e,s=t},r.addPulling=function(e,t){(function t(r){return r._id==e._id||!!r._pull&&!!a[r._pull]&&t(a[r._pull])})(t)||(e._pull=t._id,t._pulled=e._id)},r.removePulling=function(e){e._pull&&a[e._pull]&&delete a[e._pull]._pulled,delete e._pull},r.add=function(e,t,r){var o=e.x+t,a=e.y+r;o>=50&&(o=49),a>=50&&(a=49),o<0&&(o=0),a<0&&(a=0);var s=o+\",\"+a;n[s]=n[s]||[],n[s].push(e),i[s]=i[s]+1||1},r.isTileBusy=function(e,t){return!!n[e+\",\"+t]},r.check=function(e){var t={};for(var r in n){var s,m=r.split(/,/),y=u(m,2),_=y[0],R=y[1];if(_=parseInt(_),R=parseInt(R),n[r].length>1){var E=c.map(n[r],function(e){var t=\"powerCreep\"==e.type?0:l.calcBodyEffectiveness(e.body,p.MOVE,\"fatigue\",1),r=\"powerCreep\"==e.type?0:c.filter(e.body,function(e){return e.type!=p.MOVE&&e.type!=p.CARRY}).length;r=(r+=\"powerCreep\"==e.type?0:h(e))||1;var o=e.x+\",\"+e.y,a=i[o]||0;return n[o]&&c.any(n[o],{x:_,y:R})&&(a=100),{object:e,rate1:a,rate2:e._pulled?1:0,rate3:e._pull?1:0,rate4:t/r}});E.sort(function(e,t){return t.rate1-e.rate1||t.rate2-e.rate2||t.rate3-e.rate3||t.rate4-e.rate4}),s=E[0].object}else s=n[r][0];o[s._id]={x:_,y:R},t[r]=s}function g(e){var t=n[e];if(o[n[e]._id]=null,delete n[e],t){var r=t.x+\",\"+t.y;n[r]&&g(r)}}for(var r in n=t){var v=r.split(/,/),O=u(v,2);_=O[0],R=O[1];_=parseInt(_),R=parseInt(R);var T=n[r];T._pulled&&a[T._pulled]&&(a[T._pulled]._pull==T._id&&r==a[T._pulled].x+\",\"+a[T._pulled].y||(delete a[T._pulled]._pull,delete T._pulled)),f(T)&&!d(_,R,T,e)||g(r)}},r.execute=function(t,r){var n=r.bulk,i=r.roomController,u=r.gameTime,d=o[t._id];if(d&&f(t)){var m=c.filter(a,function(e){return e.x==d.x&&e.y==d.y}),y=2;(c.any(m,{type:\"swamp\"})||l.checkTerrain(s,d.x,d.y,p.TERRAIN_MASK_SWAMP))&&(y=10);var _,R=c.find(m,{type:\"road\"});if(R&&(y=1,\"powerCreep\"==t.type?R.nextDecayTime-=p.ROAD_WEAROUT_POWER_CREEP:R.nextDecayTime-=p.ROAD_WEAROUT*t.body.length,n.update(R,{nextDecayTime:R.nextDecayTime})),!(i&&i.user!==t.user&&i.safeMode>u)){var E=c.find(m,function(e){return\"constructionSite\"==e.type&&e.user!=t.user});E&&(n.remove(E._id),E.progress>1&&e(\"./creeps/_create-energy\")(E.x,E.y,E.room,Math.floor(E.progress/2),\"energy\",r))}\"creep\"==t.type&&(_=c(t.body).filter(function(e){return e.type!=p.MOVE&&e.type!=p.CARRY}).size(),_+=h(t),_*=y),l.isAtEdge(d)&&!l.isAtEdge(t)?(_=0,t._fatigue=0,n.update(t,{x:d.x,y:d.y,fatigue:_})):(n.update(t,{x:d.x,y:d.y}),\"creep\"==t.type&&e(\"./creeps/_add-fatigue\")(t,_,r))}}},{\"../../utils\":184,\"./creeps/_add-fatigue\":83,\"./creeps/_create-energy\":85,lodash:61}],136:[function(e,t,r){\"use strict\";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),o=e(\"lodash\"),i=e(\"../../../config\"),a=e(\"../../../utils\"),s=a.getDriver().constants;t.exports=function(e,t,r){var u=r.roomObjects,c=r.bulk,l=r.roomController,p=r.gameTime,f=r.roomInfo;if(a.checkStructureAgainstController(e,u,l)&&!(e.G<e.GCapacity||e.energy<e.energyCapacity)&&!(e.cooldownTime>p)&&!(t.x<0||t.y<0||t.x>49||t.y>49)&&!(f.novice&&f.novice>Date.now()||f.respawnArea&&f.respawnArea>Date.now())&&o.isString(t.roomName)&&/^(W|E)\\d+(S|N)\\d+$/.test(t.roomName)){var d=a.roomNameToXY(t.roomName),h=n(d,2),m=h[0],y=h[1],_=a.roomNameToXY(e.room),R=n(_,2),E=R[0],g=R[1];Math.abs(m-E)>s.NUKE_RANGE||Math.abs(y-g)>s.NUKE_RANGE||(c.update(e,{energy:0,G:0,cooldownTime:p+(i.ptr?100:s.NUKER_COOLDOWN)}),c.insert({type:\"nuke\",room:t.roomName,x:t.x,y:t.y,landTime:p+(i.ptr?100:s.NUKE_LAND_TIME),launchRoomName:e.room}))}}},{\"../../../config\":1,\"../../../utils\":184,lodash:61}],137:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var o=r.gameTime;e.landTime==1+o&&n.forEach(t.users,function(e){n.forEach(e.objects,function(e){e.createCreep&&(e.createCreep=null)})})}},{\"../../../utils\":184,lodash:61}],138:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(t,r){var i=r.roomObjects,a=r.bulk,s=r.roomController,u=r.gameTime,c=r.roomInfo;if(c.novice&&c.novice>Date.now()||c.respawnArea&&c.respawnArea>Date.now())return a.remove(t._id),void delete i[t._id];if(u==t.landTime-1){n.forEach(i,function(t){t&&(\"creep\"==t.type&&e(\"../creeps/_die\")(t,0,!0,r),\"powerCreep\"==t.type&&a.update(t,{hits:0}),\"constructionSite\"!=t.type&&\"energy\"!=t.type||(a.remove(t._id),delete i[t._id]),\"spawn\"==t.type&&null!=t.spawning&&a.update(t,{spawning:null}))});for(var l=-2;l<=2;l++)for(var p=function(a){var s=t.x+l,u=t.y+a,c=0==Math.max(Math.abs(l),Math.abs(a))?o.NUKE_DAMAGE[0]:o.NUKE_DAMAGE[2],p=n.filter(i,{x:s,y:u}),f=n.find(p,{type:\"rampart\"});if(f){var d=f.hits;n.pull(p,f),e(\"../_damage\")(t,f,c,o.EVENT_ATTACK_TYPE_NUKE,r),c-=d}c>0&&p.forEach(function(n){e(\"../_damage\")(t,n,c,o.EVENT_ATTACK_TYPE_NUKE,r)})},f=-2;f<=2;f++)p(f);s&&(s.safeMode>u&&a.update(s,{safeMode:u,safeModeCooldown:null}),s.user&&a.update(s,{upgradeBlocked:u+o.CONTROLLER_NUKE_BLOCKED_UPGRADE}))}u>=t.landTime&&(a.remove(t._id),delete i[t._id])}},{\"../../../utils\":184,\"../_damage\":76,\"../creeps/_die\":86,lodash:61}],139:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.roomObjects,i=t.bulk,a=t.gameTime;if(e.unstableDate&&Date.now()>e.unstableDate&&i.update(e,{decayTime:a+o.PORTAL_DECAY,unstableDate:null}),e.decayTime&&a>e.decayTime){i.remove(e._id),delete r[e._id];var s=n.find(r,function(t){return\"constructedWall\"==t.type&&t.x==e.x+1&&t.y==e.y+1});s&&(i.remove(s._id),delete r[s._id])}}},{\"../../../utils\":184,lodash:61}],140:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,n){e(\"../creeps/drop\")(t,r,n)}},{\"../../../utils\":184,\"../creeps/drop\":94,lodash:61}],141:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\");n.getDriver().constants;t.exports=function(e,t,r){var o=r.roomObjects,i=r.bulk,a=r.gameTime,s=o[t.id];s&&\"controller\"==s.type&&(s.user!=e.user&&s.safeMode>a||n.dist(e,s)>1||(i.update(s,{isPowerEnabled:!0}),e.actionLog.attack={x:s.x,y:s.y}))}},{\"../../../utils\":184,lodash:61}],142:[function(e,t,r){\"use strict\";e(\"lodash\");var n=[\"move\",\"usePower\",\"withdraw\",\"transfer\",\"say\",\"drop\",\"pickup\",\"enableRoom\",\"renew\"],o={drop:e(\"./drop.js\"),enableRoom:e(\"./enableRoom.js\"),intents:e(\"./intents.js\"),move:e(\"./move.js\"),pickup:e(\"./pickup.js\"),renew:e(\"./renew.js\"),say:e(\"./say.js\"),tick:e(\"./tick.js\"),transfer:e(\"./transfer.js\"),usePower:e(\"./usePower.js\"),withdraw:e(\"./withdraw.js\")};t.exports=function(e,t,r){n.forEach(function(n){t[n]&&o[n](e,t[n],r)})}},{\"./drop.js\":140,\"./enableRoom.js\":141,\"./intents.js\":142,\"./move.js\":143,\"./pickup.js\":144,\"./renew.js\":145,\"./say.js\":146,\"./tick.js\":147,\"./transfer.js\":148,\"./usePower.js\":149,\"./withdraw.js\":150,lodash:61}],143:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants,e(\"../movement\");t.exports=function(t,r,n){e(\"../creeps/move\")(t,r,n)}},{\"../../../utils\":184,\"../creeps/move\":105,\"../movement\":135,lodash:61}],144:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,n){e(\"../creeps/pickup\")(t,r,n)}},{\"../../../utils\":184,\"../creeps/pickup\":106,lodash:61}],145:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\"),o=n.getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.bulk,s=r.gameTime,u=i[t.id];!u||\"powerBank\"!=u.type&&\"powerSpawn\"!=u.type||n.dist(e,u)>1||(a.update(e,{ageTime:s+o.POWER_CREEP_LIFE_TIME}),e.actionLog.healed={x:e.x,y:e.y})}},{\"../../../utils\":184,lodash:61}],146:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){!function(e){if(null==e)throw new TypeError(\"Cannot destructure undefined\")}(r),n.isString(t.message)&&(e.actionLog.say={message:t.message.substring(0,10),isPublic:t.isPublic})}},{\"../../../utils\":184,lodash:61}],147:[function(e,t,r){\"use strict\";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants,s=e(\"../movement\");t.exports=function(e,t){var r=t.roomObjects,u=t.bulk,c=(t.roomController,t.gameTime,t.eventLog);if(e&&\"powerCreep\"==e.type){if(s.execute(e,t),i.isAtEdge(e)&&\"2\"!=e.user&&\"3\"!=e.user){var l=i.roomNameToXY(e.room),p=n(l,2),f=p[0],d=p[1],h=e.x,m=e.y,y=e.room;0==e.x?(h=49,y=i.getRoomNameFromXY(f-1,d)):0==e.y?(m=49,y=i.getRoomNameFromXY(f,d-1)):49==e.x?(h=0,y=i.getRoomNameFromXY(f+1,d)):49==e.y&&(m=0,y=i.getRoomNameFromXY(f,d+1)),u.update(e,{interRoom:{room:y,x:h,y:m}}),c.push({event:a.EVENT_EXIT,objectId:e._id,data:{room:y,x:h,y:m}})}var _=o.find(r,function(t){return\"portal\"==t.type&&t.x==e.x&&t.y==e.y});_&&!_.destination.shard&&u.update(e,{interRoom:_.destination});var R=e.hits;e._damageToApply&&(R-=e._damageToApply,delete e._damageToApply),e._healToApply&&(R+=e._healToApply,delete e._healToApply),R>e.hitsMax&&(R=e.hitsMax),R!=e.hits&&u.update(e,{hits:R}),o.isEqual(e.actionLog,e._actionLog)||u.update(e,{actionLog:e.actionLog})}}},{\"../../../utils\":184,\"../movement\":135,lodash:61}],148:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,n){e(\"../creeps/transfer\")(t,r,n)}},{\"../../../utils\":184,\"../creeps/transfer\":117,lodash:61}],149:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants;t.exports=function(t,r,s){var u=s.roomObjects,c=s.roomTerrain,l=s.gameTime,p=s.bulk,f=s.eventLog,d=s.roomController;if(d){if(!d.isPowerEnabled)return;if(d.user!=t.user&&d.safeMode>l)return}var h=a.POWER_INFO[r.power];if(h){var m=t.powers[r.power],y=void 0;if(m&&0!=m.level&&!(m.cooldownTime>l)){var _=h.ops||0;if(o.isArray(_)&&(_=_[m.level-1]),!((t.ops||0)<_)){if(h.range){if(!(y=u[r.id]))return;if(i.dist(t,y)>h.range)return;var R=o.find(y.effects,function(e){return e.power==r.power});if(R&&R.level>m.level&&R.endTime>l)return}var E=!1;switch(r.power){case a.PWR_GENERATE_OPS:p.update(t,n({},a.RESOURCE_OPS,(t[a.RESOURCE_OPS]||0)+h.effect[m.level-1]));var g=i.calcResources(t);g>t.energyCapacity&&e(\"./drop\")(t,{amount:Math.min(t[a.RESOURCE_OPS],g-t.energyCapacity),resourceType:a.RESOURCE_OPS},s);break;case a.PWR_OPERATE_SPAWN:if(\"spawn\"!=y.type)return;E=!0;break;case a.PWR_OPERATE_TOWER:if(\"tower\"!=y.type)return;E=!0;break;case a.PWR_OPERATE_STORAGE:if(\"storage\"!=y.type)return;E=!0;break;case a.PWR_OPERATE_LAB:if(\"lab\"!=y.type)return;E=!0;break;case a.PWR_OPERATE_EXTENSION:if(\"storage\"!=y.type&&\"terminal\"!=y.type&&\"container\"!==y.type)return;var v=o.find(y.effects,{power:a.PWR_DISRUPT_TERMINAL});if(v&&v.endTime>l)return;var O=o.filter(u,function(e){return\"extension\"==e.type&&e.user==y.user&&!e.off}),T=0,A=Math.min(y.energy,h.effect[m.level-1]*o.sum(O,\"energyCapacity\"));if(O.sort(i.comparatorDistance(y)),O.every(function(e){var t=Math.min(A-T,e.energyCapacity-e.energy);return p.update(e,{energy:e.energy+t}),(T+=t)<A}),0===T)return;p.update(y,{energy:y.energy-T});break;case a.PWR_OPERATE_OBSERVER:if(\"observer\"!=y.type)return;E=!0;break;case a.PWR_OPERATE_TERMINAL:if(\"terminal\"!=y.type)return;E=!0;break;case a.PWR_DISRUPT_SPAWN:if(\"spawn\"!=y.type)return;E=!0;break;case a.PWR_DISRUPT_TOWER:if(\"tower\"!=y.type)return;E=!0;break;case a.PWR_DISRUPT_SOURCE:case a.PWR_REGEN_SOURCE:if(\"source\"!=y.type)return;E=!0;break;case a.PWR_REGEN_MINERAL:if(\"mineral\"!=y.type)return;if(0==y.mineralAmount)return;if(y.nextRegenerationTime)return;E=!0;break;case a.PWR_DISRUPT_TERMINAL:if(\"terminal\"!=y.type)return;E=!0;break;case a.PWR_OPERATE_CONTROLLER:if(\"controller\"!=y.type)return;E=!0;break;case a.PWR_OPERATE_POWER:if(\"powerSpawn\"!=y.type)return;E=!0;break;case a.PWR_FORTIFY:if(\"rampart\"!=y.type&&\"constructedWall\"!=y.type)return;E=!0;break;case a.PWR_SHIELD:var b=o.find(u,function(e){return e.x==t.x&&e.y==t.y&&\"constructionSite\"==e.type});if(b&&(p.remove(b._id),delete u[b._id]),!i.checkConstructionSite(u,\"rampart\",t.x,t.y)||!i.checkConstructionSite(c,\"rampart\",t.x,t.y))return;p.insert({type:\"rampart\",room:t.room,x:t.x,y:t.y,user:t.user,hits:h.effect[m.level-1],hitsMax:0,nextDecayTime:l+h.duration,effects:[{power:a.PWR_SHIELD,level:m.level,endTime:l+h.duration}]})}if(E){var w=Object.values(y.effects||[]);o.remove(w,{power:r.power}),w.push({power:r.power,level:m.level,endTime:l+(o.isArray(h.duration)?h.duration[m.level-1]:h.duration)}),p.update(y,{effects:null}),p.update(y,{effects:w})}p.update(t,{powers:n({},r.power,{cooldownTime:l+h.cooldown}),ops:(t.ops||0)-_}),f.push({event:a.EVENT_POWER,objectId:t._id,data:{power:r.power,targetId:r.id}}),t.actionLog.power={id:r.power,x:y?y.x:t.x,y:y?y.y:t.y}}}}}},{\"../../../utils\":184,\"./drop\":140,lodash:61}],150:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,n){e(\"../creeps/withdraw\")(t,r,n)}},{\"../../../utils\":184,\"../creeps/withdraw\":119,lodash:61}],151:[function(e,t,r){\"use strict\";t.exports=function(t,r,n){r.processPower&&e(\"./process-power\")(t,r.processPower,n)}},{\"./process-power\":152}],152:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(e,t,r){var a=r.roomObjects,s=r.bulk,u=r.bulkUsers,c=r.roomController,l=r.stats,p=r.gameTime;if(\"powerSpawn\"==e.type&&o.checkStructureAgainstController(e,a,c)){var f=1,d=n.find(e.effects,{power:i.PWR_OPERATE_POWER});d&&d.endTime>=p&&(f=Math.min(e.power,f+i.POWER_INFO[i.PWR_OPERATE_POWER].effect[d.level-1])),e.power<f||e.energy<f*i.POWER_SPAWN_ENERGY_RATIO||(e.power-=f,e.energy-=f*i.POWER_SPAWN_ENERGY_RATIO,l.inc(\"powerProcessed\",e.user,f),s.update(e,{energy:e.energy,power:e.power}),u.inc&&u.inc(e.user,\"power\",f))}}},{\"../../../utils\":184,lodash:61}],153:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){r.bulk.update(e,{isPublic:!!t.isPublic})}},{\"../../../utils\":184,lodash:61}],154:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.roomObjects,i=t.bulk,a=t.roomController,s=t.gameTime;if(e&&\"rampart\"==e.type){var u=n.find(e.effects,{power:o.PWR_SHIELD});if(u)u.endTime<=s&&(i.remove(e._id),delete r[e._id]);else{if(a){var c=e.user==a.user&&o.RAMPART_HITS_MAX[a.level]||0;c!=e.hitsMax&&i.update(e,{hitsMax:c})}(!e.nextDecayTime||s>=e.nextDecayTime-1)&&(e.hits=e.hits||0,e.hits-=o.RAMPART_DECAY_AMOUNT,e.hits<=0?(i.remove(e._id),delete r[e._id]):(e.nextDecayTime=s+o.RAMPART_DECAY_TIME,i.update(e,{hits:e.hits,nextDecayTime:e.nextDecayTime})))}}}},{\"../../../utils\":184,lodash:61}],155:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(e,t){var r=t.roomObjects,a=t.roomTerrain,s=t.bulk,u=t.gameTime;if(e&&\"road\"==e.type&&(!e.nextDecayTime||u>=e.nextDecayTime-1)){var c=i.ROAD_DECAY_AMOUNT;(n.any(r,function(t){return t.x==e.x&&t.y==e.y&&\"swamp\"==t.type})||o.checkTerrain(a,e.x,e.y,i.TERRAIN_MASK_SWAMP))&&(c*=i.CONSTRUCTION_COST_ROAD_SWAMP_RATIO),(n.any(r,function(t){return t.x==e.x&&t.y==e.y&&\"wall\"==t.type})||o.checkTerrain(a,e.x,e.y,i.TERRAIN_MASK_WALL))&&(c*=i.CONSTRUCTION_COST_ROAD_WALL_RATIO),e.hits-=c,e.hits<=0?(s.remove(e._id),delete r[e._id]):(e.nextDecayTime=u+i.ROAD_DECAY_TIME,s.update(e,{hits:e.hits,nextDecayTime:e.nextDecayTime}))}}},{\"../../../utils\":184,lodash:61}],156:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants,a=e(\"../../../config\"),s=0;t.exports=function(e,t,r){var u=r.roomObjects,c=r.roomTerrain,l=r.bulk,p=r.roomController;if(!(t.x<=0||t.x>=49||t.y<=0||t.y>=49)&&i.CONSTRUCTION_COST[t.structureType]){if(/^(W|E)/.test(t.roomName)){if(p&&(p.user&&p.user!=e||p.reservation&&p.reservation.user!=e))return;if(!o.checkControllerAvailability(t.structureType,u,p))return}if(o.checkConstructionSite(u,t.structureType,t.x,t.y)&&o.checkConstructionSite(c,t.structureType,t.x,t.y)){var f=i.CONSTRUCTION_COST[t.structureType];\"road\"==t.structureType&&((n.any(u,{x:t.x,y:t.y,type:\"swamp\"})||o.checkTerrain(c,t.x,t.y,i.TERRAIN_MASK_SWAMP))&&(f*=i.CONSTRUCTION_COST_ROAD_SWAMP_RATIO),(n.any(u,{x:t.x,y:t.y,type:\"wall\"})||o.checkTerrain(c,t.x,t.y,i.TERRAIN_MASK_WALL))&&(f*=i.CONSTRUCTION_COST_ROAD_WALL_RATIO)),a.ptr&&(f=1),\"sim\"==t.roomName&&\"tower\"==t.structureType&&(f=100);var d={structureType:t.structureType,x:t.x,y:t.y,type:\"constructionSite\",room:t.roomName,user:e,progress:0,progressTotal:f};\"spawn\"==t.structureType&&(d.name=t.name),l.insert(d),u[\"_createdConstructionSite\"+s]=d,s++}}}},{\"../../../config\":1,\"../../../utils\":184,lodash:61}],157:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.flags,a=t.name.replace(/\\|/g,\"$VLINE$\").replace(/~/g,\"$TILDE$\");if(!n.any(i,function(t){return t.user==e&&n.any(t._parsed,function(e){return e[0]==a})})&&t.color&&n.contains(o.COLORS_ALL,t.color)&&t.secondaryColor&&n.contains(o.COLORS_ALL,t.secondaryColor)&&!(t.x<0||t.x>49||t.y<0||t.y>49)){var s=n.find(i,{user:e});s||(s={user:e,room:t.roomName,_parsed:[]},i.push(s)),s._modified=!0,s._parsed.push([a,t.color,t.secondaryColor,t.x,t.y])}}},{\"../../../utils\":184,lodash:61}],158:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,i){var a=i.roomObjects,s=i.bulk,u=i.roomController,c=a[r.id];if(c&&o.CONSTRUCTION_COST[c.type]&&u&&u.user==t&&(c.type!=o.STRUCTURE_WALL||!c.decayTime||c.user)&&!n.any(a,function(e){return(\"creep\"==e.type||\"powerCreep\"==e.type)&&e.user!=t})){if(s.remove(c._id),delete a[c._id],\"spawn\"==c.type&&c.spawning){var l=n.find(a,{user:c.user,name:c.spawning.name});l&&s.remove(l._id)}o.RESOURCES_ALL.forEach(function(t){c[t]>0&&e(\"../creeps/_create-energy\")(c.x,c.y,c.room,c[t],t,i),c.mineralType===t&&c.mineralAmount>0&&e(\"../creeps/_create-energy\")(c.x,c.y,c.room,c.mineralAmount,t,i)}),\"constructedWall\"==c.type&&c.decayTime&&c.user&&e(\"../creeps/_clear-newbie-walls\")(i)}}},{\"../../../utils\":184,\"../creeps/_clear-newbie-walls\":84,\"../creeps/_create-energy\":85,lodash:61}],159:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(e,t,r){var a=r.roomObjects,s=r.roomTerrain,u=r.bulk;if(\"3\"==e){var c,l;do{c=Math.floor(48*Math.random())+1,l=Math.floor(48*Math.random())+1}while(n.any(a,function(e){return n.contains(i.OBSTACLE_OBJECT_TYPES,e.type)&&e.x==c&&e.y==l})||o.checkTerrain(s,c,l,i.TERRAIN_MASK_WALL));u.insert({x:c,y:l,type:\"energy\",energy:300,room:t.roomName})}}},{\"../../../utils\":184,lodash:61}],160:[function(e,t,r){\"use strict\";var n=e(\"lodash\");t.exports=function(t,r,o){var i=o.flags,a=o.bulkFlags;i.forEach(function(e){e._parsed=e.data.split(\"|\"),e._parsed=n.map(e._parsed,function(e){return e.split(\"~\")})}),r.removeFlag&&n.forEach(r.removeFlag,function(r){e(\"./remove-flag\")(t,r,o)}),r.createFlag&&n.forEach(r.createFlag,function(r){e(\"./create-flag\")(t,r,o)}),r.createConstructionSite&&n.forEach(r.createConstructionSite,function(r){e(\"./create-construction-site\")(t,r,o)}),r.removeConstructionSite&&n.forEach(r.removeConstructionSite,function(r){e(\"./remove-construction-site\")(t,r,o)}),r.destroyStructure&&n.forEach(r.destroyStructure,function(r){e(\"./destroy-structure\")(t,r,o)}),r.genEnergy&&e(\"./gen-energy\")(t,r.genEnergy,o),i.forEach(function(e){if(e._modified){var t=n.map(e._parsed,function(e){return e.join(\"~\")}).join(\"|\");e._id?a.update(e._id,{data:t}):a.insert({data:t,user:e.user,room:e.room})}})}},{\"./create-construction-site\":156,\"./create-flag\":157,\"./destroy-structure\":158,\"./gen-energy\":159,\"./remove-construction-site\":161,\"./remove-flag\":162,lodash:61}],161:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,n){var o=n.roomObjects,i=n.bulk,a=n.roomController,s=o[r.id];s&&\"constructionSite\"==s.type&&(s.user==t||a&&a.user==t)&&(i.remove(s._id),s.progress>1&&e(\"../creeps/_create-energy\")(s.x,s.y,s.room,Math.floor(s.progress/2),\"energy\",n))}},{\"../../../utils\":184,\"../creeps/_create-energy\":85,lodash:61}],162:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var o=r.flags,i=n.find(o,{user:e});if(i){var a=t.name.replace(/\\|/g,\"$VLINE$\").replace(/~/g,\"$TILDE$\");n.any(i._parsed,function(e){return e[0]==a})&&(i._modified=!0,n.remove(i._parsed,function(e){return e[0]==a}))}}},{\"../../../utils\":184,lodash:61}],163:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.bulk,i=t.roomController,a=t.gameTime;if(e&&\"source\"==e.type){if(e.energy<e.energyCapacity){e.nextRegenerationTime||(e.nextRegenerationTime=a+o.ENERGY_REGEN_TIME,r.update(e,{nextRegenerationTime:e.nextRegenerationTime}));var s=n.find(e.effects,{power:o.PWR_DISRUPT_SOURCE});if(s&&s.endTime>a&&r.update(e,{nextRegenerationTime:e.nextRegenerationTime+1}),a>=e.nextRegenerationTime-1&&r.update(e,{nextRegenerationTime:null,energy:e.energyCapacity}),(s=n.find(e.effects,{power:o.PWR_REGEN_SOURCE}))&&s.endTime>a){var u=o.POWER_INFO[o.PWR_REGEN_SOURCE];(s.endTime-a-1)%u.period==0&&r.update(e,{energy:Math.min(e.energyCapacity,e.energy+u.effect[s.level-1])})}}i?(i.user||i.reservation||e.energyCapacity==o.SOURCE_ENERGY_NEUTRAL_CAPACITY||r.update(e,{energyCapacity:o.SOURCE_ENERGY_NEUTRAL_CAPACITY,energy:Math.min(e.energy,o.SOURCE_ENERGY_NEUTRAL_CAPACITY)}),(i.user||i.reservation)&&e.energyCapacity!=o.SOURCE_ENERGY_CAPACITY&&r.update(e,{energyCapacity:o.SOURCE_ENERGY_CAPACITY})):e.energyCapacity!=o.SOURCE_ENERGY_KEEPER_CAPACITY&&r.update(e,{energyCapacity:o.SOURCE_ENERGY_KEEPER_CAPACITY})}}},{\"../../../utils\":184,lodash:61}],164:[function(e,t,r){\"use strict\";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),o=e(\"lodash\"),i=e(\"../../../utils\"),a=i.getDriver().constants,s=e(\"../movement\");t.exports=function(t,r,u){var c,l,p,f,d=u.roomObjects,h=u.roomTerrain,m=u.bulk,y=function(e){return e.x==c&&e.y==l&&(o.contains(a.OBSTACLE_OBJECT_TYPES,e.type)||\"constructionSite\"==e.type&&o.contains(a.OBSTACLE_OBJECT_TYPES,e.structureType))},_=[1,2,3,4,5,6,7,8];t.spawning&&t.spawning.directions&&(_=t.spawning.directions);var R=o.difference([1,2,3,4,5,6,7,8],_),E=!0,g=!1,v=void 0;try{for(var O,T=_[Symbol.iterator]();!(E=(O=T.next()).done);E=!0){var A=O.value,b=i.getOffsetsByDirection(A),w=n(b,2),N=w[0],C=w[1];if(c=t.x+N,l=t.y+C,!(p=o.any(d,y)||i.checkTerrain(h,c,l,a.TERRAIN_MASK_WALL)||s.isTileBusy(c,l)))break;f||(f=o.find(d,function(e){return e.x==c&&e.y==l&&\"creep\"==e.type&&e.user!=t.user}))}}catch(e){g=!0,v=e}finally{try{!E&&T.return&&T.return()}finally{if(g)throw v}}if(!p)return m.update(r,{x:c,y:l,spawning:!1}),!0;if(f){var S=!0,I=!1,x=void 0;try{for(var L,P=R[Symbol.iterator]();!(S=(L=P.next()).done);S=!0){A=L.value;var M=i.getOffsetsByDirection(A),k=n(M,2);N=k[0],C=k[1];if(c=t.x+N,l=t.y+C,!(p=o.any(d,y)||i.checkTerrain(h,c,l,a.TERRAIN_MASK_WALL)||s.isTileBusy(c,l)))return!1}}catch(e){I=!0,x=e}finally{try{!S&&P.return&&P.return()}finally{if(I)throw x}}return e(\"../creeps/_die\")(f,void 0,!0,u),m.update(r,{x:f.x,y:f.y,spawning:!1}),!0}return!1}},{\"../../../utils\":184,\"../creeps/_die\":86,\"../movement\":135,lodash:61}],165:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\");o.getDriver().constants;t.exports=function(e,t,r,i){return void 0===r?function(e,t,r){var i=r.roomObjects,a=r.bulk,s=n.filter(i,function(t){return\"spawn\"==t.type&&t.user==e.user&&!t.off}),u=n.filter(i,function(t){return\"extension\"==t.type&&t.user==e.user&&!t.off});return!(n.sum(u,\"energy\")+n.sum(s,\"energy\")<t)&&(s.sort(o.comparatorDistance(e)),s.forEach(function(e){var r=Math.min(t,e.energy);e.energy-=r,t-=r,a.update(e,{energy:e.energy})}),t<=0||(u.sort(o.comparatorDistance(e)),u.forEach(function(e){if(!(t<=0)){var r=Math.min(t,e.energy);e.energy-=r,t-=r,a.update(e,{energy:e.energy})}}),!0))}(e,t,i):function(e,t,r,o){var i=o.roomObjects,a=o.bulk;return r=n.filter(r,function(t){var r=i[t];return r&&!r.off&&r.user===e.user&&(\"spawn\"===r.type||\"extension\"===r.type)}),r=n.uniq(r),!(n.sum(r,function(e){return i[e].energy})<t||(n.forEach(r,function(e){var r=i[e],n=Math.min(t,r.energy);if(r.energy-=n,a.update(r,{energy:r.energy}),(t-=n)<=0)return!1}),0))}(e,t,r,i)}},{\"../../../utils\":184,lodash:61}],166:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var o=r.roomObjects,i=r.bulk;if(\"spawn\"==e.type&&e.spawning){var a=n.find(o,{type:\"creep\",name:e.spawning.name,x:e.x,y:e.y});i.remove(a._id),delete o[a._id],i.update(e,{spawning:null})}}},{\"../../../utils\":184,lodash:61}],167:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){var s=a.roomObjects,u=a.bulk,c=a.roomController,l=a.stats,p=a.gameTime;if(!t.spawning&&\"spawn\"==t.type&&o.checkStructureAgainstController(t,s,c)){var f=r.directions;if(void 0!==f){if(!n.isArray(f))return;if((f=n.uniq(n.map(f,function(e){return+e}))).length>0&&!n.all(f,function(e){return e>=1&&e<=8&&e===(0|e)}))return}r.body=r.body.slice(0,i.MAX_CREEP_SIZE);var d=o.calcCreepCost(r.body);if(e(\"./_charge-energy\")(t,d,r.energyStructures,a)){l.inc(\"energyCreeps\",t.user,d),l.inc(\"creepsProduced\",t.user,r.body.length);var h=i.CREEP_SPAWN_TIME*r.body.length,m=n.find(t.effects,{power:i.PWR_OPERATE_SPAWN});m&&m.endTime>p&&(h=Math.ceil(h*i.POWER_INFO[i.PWR_OPERATE_SPAWN].effect[m.level-1])),u.update(t,{spawning:{name:r.name,needTime:h,remainingTime:h,directions:f}});var y=[],_=0;r.body.forEach(function(e){n.contains(i.BODYPARTS_ALL,e)&&y.push({type:e,hits:100}),e==i.CARRY&&(_+=i.CARRY_CAPACITY)});var R={name:r.name,x:t.x,y:t.y,body:y,energy:0,energyCapacity:_,type:\"creep\",room:t.room,user:t.user,hits:100*y.length,hitsMax:100*y.length,spawning:!0,fatigue:0,notifyWhenAttacked:!0};t.tutorial&&(R.tutorial=!0),u.insert(R)}}}},{\"../../../utils\":184,\"./_charge-energy\":165,lodash:61}],168:[function(e,t,r){\"use strict\";t.exports=function(t,r,n){r.createCreep&&e(\"./create-creep\")(t,r.createCreep,n),r.transferEnergy&&e(\"./transfer-energy\")(t,r.transferEnergy,n),r.renewCreep&&e(\"./renew-creep\")(t,r.renewCreep,n),r.recycleCreep&&e(\"./recycle-creep\")(t,r.recycleCreep,n),r.setSpawnDirections&&e(\"./set-spawn-directions\")(t,r.setSpawnDirections,n),r.cancelSpawning&&e(\"./cancel-spawning\")(t,r.cancelSpawning,n)}},{\"./cancel-spawning\":166,\"./create-creep\":167,\"./recycle-creep\":169,\"./renew-creep\":170,\"./set-spawn-directions\":171,\"./transfer-energy\":173}],169:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(t,r,n){var o=n.roomObjects;if(\"spawn\"==t.type){var i=o[r.id];i&&\"creep\"==i.type&&i.user==t.user&&!i.spawning&&(Math.abs(i.x-t.x)>1||Math.abs(i.y-t.y)>1||e(\"../creeps/_die\")(i,1,!1,n))}}},{\"../../../utils\":184,\"../creeps/_die\":86,lodash:61}],170:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){var s=a.roomObjects,u=a.bulk,c=a.stats,l=a.gameTime;if(\"spawn\"==t.type&&!t.spawning){var p=s[r.id];if(p&&\"creep\"==p.type&&p.user==t.user&&!p.spawning&&!(Math.abs(p.x-t.x)>1||Math.abs(p.y-t.y)>1||n.filter(p.body,function(e){return e.type==i.CLAIM}).length>0)){var f=Math.floor(i.SPAWN_RENEW_RATIO*i.CREEP_LIFE_TIME/i.CREEP_SPAWN_TIME/p.body.length);if(!(p.ageTime+f>l+i.CREEP_LIFE_TIME)){var d=Math.ceil(i.SPAWN_RENEW_RATIO*o.calcCreepCost(p.body)/i.CREEP_SPAWN_TIME/p.body.length);e(\"./_charge-energy\")(t,d,void 0,a)&&(c.inc(\"energyCreeps\",t.user,d),p.actionLog.healed={x:t.x,y:t.y},u.inc(p,\"ageTime\",f),n.any(p.body,function(e){return!!e.boost})&&(p.body.forEach(function(e){e.boost=null}),e(\"../creeps/_recalc-body\")(p),e(\"../creeps/_drop-resources-without-space\")(p,a),u.update(p,{body:p.body,energyCapacity:p.energyCapacity})))}}}}},{\"../../../utils\":184,\"../creeps/_drop-resources-without-space\":87,\"../creeps/_recalc-body\":88,\"./_charge-energy\":165,lodash:61}],171:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var o=r.bulk;if(\"spawn\"==e.type&&e.spawning){var i=t.directions;if(n.isArray(i)&&i.length>0&&(i=n.uniq(n.map(i,function(e){return+e})),!n.any(i,function(e){return e<1||e>8||e!==(0|e)}))){var a=n.clone(e.spawning);a.directions=i,o.update(e,{spawning:null}),o.update(e,{spawning:a})}}}},{\"../../../utils\":184,lodash:61}],172:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r){var a=r.roomObjects,s=r.bulk,u=r.roomController,c=r.energyAvailable,l=r.gameTime;if(t&&\"spawn\"==t.type){var p=n.find(t.effects,{power:i.PWR_DISRUPT_SPAWN});if(t.spawning&&(!p||p.endTime<=l))if(t.spawning.remainingTime--,t.spawning.remainingTime<=0){var f=n.find(a,{type:\"creep\",name:t.spawning.name,x:t.x,y:t.y});e(\"./_born-creep\")(t,f,r)?s.update(t,{spawning:null}):s.update(t,{spawning:{remainingTime:0}})}else s.update(t,{spawning:{remainingTime:t.spawning.remainingTime}});if(u&&!(u.level<1)&&u.user==t.user){var d=n.filter(a,{type:\"spawn\"});d.length>i.CONTROLLER_STRUCTURES.spawn[u.level]&&(d.sort(o.comparatorDistance(u)),d=n.take(d,i.CONTROLLER_STRUCTURES.spawn[u.level]),!n.contains(d,t))||!t.tutorial&&c<i.SPAWN_ENERGY_CAPACITY&&t.energy<i.SPAWN_ENERGY_CAPACITY&&(t.energy++,s.update(t,{energy:t.energy}))}}}},{\"../../../utils\":184,\"./_born-creep\":164,lodash:61}],173:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var n=r.roomObjects,o=r.bulk;if(\"spawn\"==e.type){var i=n[t.id];if(!(!i||\"creep\"!=i.type||i.spawning||i.energy>=i.energyCapacity||t.amount<0||Math.abs(i.x-e.x)>1||Math.abs(i.y-e.y)>1)){var a=t.amount;i.energy+a>i.energyCapacity&&(a=i.energyCapacity-i.energy),e.energy<a||(i.energy+=a,e.energy-=a,o.update(e,{energy:e.energy}),o.update(i,{energy:i.energy}))}}}},{\"../../../utils\":184,lodash:61}],174:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(e,t,r){var a=r.bulk,s=r.gameTime;if(/^(W|E)\\d+(N|S)\\d+$/.test(t.targetRoomName)&&n.contains(i.RESOURCES_ALL,t.resourceType)&&t.amount&&e[t.resourceType]>=t.amount){var u=o.calcRoomsDistance(e.room,t.targetRoomName,!0),c=o.calcTerminalEnergyCost(t.amount,u),l=n.find(e.effects,{power:i.PWR_OPERATE_TERMINAL});l&&l.endTime>=s&&(c=Math.ceil(c*i.POWER_INFO[i.PWR_OPERATE_TERMINAL].effect[l.level-1])),t.resourceType!=i.RESOURCE_ENERGY&&e.energy<c||t.resourceType==i.RESOURCE_ENERGY&&e.energy<t.amount+c||a.update(e,{send:t})}}},{\"../../../utils\":184,lodash:61}],175:[function(e,t,r){\"use strict\";e(\"lodash\");var n=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.bulk,o=t.roomController;if(o){var i=o.level>0&&o.user==e.user&&n.CONTROLLER_STRUCTURES.terminal[o.level]?n.TERMINAL_CAPACITY:0;i!=e.energyCapacity&&r.update(e,{energyCapacity:i})}}},{\"../../../utils\":184,lodash:61}],176:[function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e(\"lodash\"),i=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t){var r=t.roomObjects,a=t.bulk,s=t.gameTime;(!e.decayTime||s>=e.decayTime-1)&&(i.RESOURCES_ALL.forEach(function(t){if(e[t]>0){var i,s=o.find(r,{type:\"energy\",x:e.x,y:e.y,resourceType:t});if(s)a.update(s,n({},t,s[t]+e[t]));else a.insert((n(i={type:\"energy\",x:e.x,y:e.y,room:e.room},t,e[t]),n(i,\"resourceType\",t),i))}}),a.remove(e._id),delete r[e._id])}},{\"../../../utils\":184,lodash:61}],177:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\"),i=o.getDriver().constants;t.exports=function(t,r,a){var s=a.roomObjects,u=a.bulk,c=a.roomController,l=a.gameTime;if(\"tower\"==t.type&&!t.spawning){var p=s[r.id];if(p&&p!=t&&(\"creep\"!=p.type||!p.spawning)&&p.hits&&!(t.energy<i.TOWER_ENERGY_COST)){var f=n.find(s,{type:\"rampart\",x:p.x,y:p.y});f&&(p=f);var d=Math.max(Math.abs(p.x-t.x),Math.abs(p.y-t.y)),h=i.TOWER_POWER_ATTACK;d>i.TOWER_OPTIMAL_RANGE&&(d>i.TOWER_FALLOFF_RANGE&&(d=i.TOWER_FALLOFF_RANGE),h-=h*i.TOWER_FALLOFF*(d-i.TOWER_OPTIMAL_RANGE)/(i.TOWER_FALLOFF_RANGE-i.TOWER_OPTIMAL_RANGE)),[i.PWR_OPERATE_TOWER,i.PWR_DISRUPT_TOWER].forEach(function(e){var r=n.find(t.effects,{power:e});r&&r.endTime>l&&(h*=i.POWER_INFO[e].effect[r.level-1])}),(h=Math.floor(h))&&(e(\"../_damage\")(t,p,h,i.EVENT_ATTACK_TYPE_RANGED,a),t.energy-=i.TOWER_ENERGY_COST,u.update(t,{energy:t.energy}),t.actionLog.attack={x:p.x,y:p.y},p.actionLog&&(p.actionLog.attacked={x:t.x,y:t.y}),p.notifyWhenAttacked&&o.sendAttackingNotification(p,c))}}}},{\"../../../utils\":184,\"../_damage\":76,lodash:61}],178:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.bulk,s=r.eventLog,u=r.gameTime;if(\"tower\"==e.type&&!e.spawning){var c=i[t.id];if(c&&(\"creep\"==c.type||\"powerCreep\"===c.type)&&!(c.spawning||e.energy<o.TOWER_ENERGY_COST)){var l=Math.max(Math.abs(c.x-e.x),Math.abs(c.y-e.y)),p=o.TOWER_POWER_HEAL;l>o.TOWER_OPTIMAL_RANGE&&(l>o.TOWER_FALLOFF_RANGE&&(l=o.TOWER_FALLOFF_RANGE),p-=p*o.TOWER_FALLOFF*(l-o.TOWER_OPTIMAL_RANGE)/(o.TOWER_FALLOFF_RANGE-o.TOWER_OPTIMAL_RANGE)),[o.PWR_OPERATE_TOWER,o.PWR_DISRUPT_TOWER].forEach(function(t){var r=n.find(e.effects,{power:t});r&&r.endTime>u&&(p*=o.POWER_INFO[t].effect[r.level-1])}),(p=Math.floor(p))&&(c._healToApply=(c._healToApply||0)+p,e.energy-=o.TOWER_ENERGY_COST,a.update(e,{energy:e.energy}),e.actionLog.heal={x:c.x,y:c.y},c.actionLog.healed={x:e.x,y:e.y},s.push({event:o.EVENT_HEAL,objectId:e._id,data:{targetId:c._id,amount:p,healType:o.EVENT_HEAL_TYPE_RANGED}}))}}}},{\"../../../utils\":184,lodash:61}],179:[function(e,t,r){\"use strict\";t.exports=function(t,r,n){r.transfer&&e(\"./transfer\")(t,r.transfer,n),r.heal?e(\"./heal\")(t,r.heal,n):r.repair?e(\"./repair\")(t,r.repair,n):r.attack&&e(\"./attack\")(t,r.attack,n)}},{\"./attack\":177,\"./heal\":178,\"./repair\":180,\"./transfer\":182}],180:[function(e,t,r){\"use strict\";var n=e(\"lodash\"),o=e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var i=r.roomObjects,a=r.bulk,s=r.stats,u=r.eventLog,c=r.gameTime;if(\"tower\"==e.type&&!e.spawning){var l=i[t.id];if(l&&o.CONSTRUCTION_COST[l.type]&&!(l.hits>=l.hitsMax)&&!(e.energy<o.TOWER_ENERGY_COST)){var p=Math.max(Math.abs(l.x-e.x),Math.abs(l.y-e.y)),f=o.TOWER_POWER_REPAIR;p>o.TOWER_OPTIMAL_RANGE&&(p>o.TOWER_FALLOFF_RANGE&&(p=o.TOWER_FALLOFF_RANGE),f-=f*o.TOWER_FALLOFF*(p-o.TOWER_OPTIMAL_RANGE)/(o.TOWER_FALLOFF_RANGE-o.TOWER_OPTIMAL_RANGE)),[o.PWR_OPERATE_TOWER,o.PWR_DISRUPT_TOWER].forEach(function(t){var r=n.find(e.effects,{power:t});r&&r.endTime>c&&(f*=o.POWER_INFO[t].effect[r.level-1])}),(f=Math.floor(f))&&(l.hits+=f,l.hits>l.hitsMax&&(l.hits=l.hitsMax),a.update(l,{hits:l.hits}),e.energy-=o.TOWER_ENERGY_COST,e.actionLog.repair={x:l.x,y:l.y},a.update(e,{energy:e.energy}),s.inc(\"energyConstruction\",e.user,o.TOWER_ENERGY_COST),u.push({event:o.EVENT_REPAIR,objectId:e._id,data:{targetId:l._id,amount:f,energySpent:o.TOWER_ENERGY_COST}}))}}}},{\"../../../utils\":184,lodash:61}],181:[function(e,t,r){\"use strict\";var n=e(\"lodash\");e(\"../../../utils\").getDriver().constants,e(\"../movement\");t.exports=function(e,t){var r=t.bulk;e&&\"tower\"==e.type&&(n.isEqual(e._actionLog,e.actionLog)||r.update(e,{actionLog:e.actionLog}))}},{\"../../../utils\":184,\"../movement\":135,lodash:61}],182:[function(e,t,r){\"use strict\";e(\"lodash\"),e(\"../../../utils\").getDriver().constants;t.exports=function(e,t,r){var n=r.roomObjects,o=r.bulk;if(\"tower\"==e.type&&!(e.energy<t.amount||t.amount<0)){var i=n[t.id];if(i&&\"creep\"==i.type&&!i.spawning&&!(Math.abs(i.x-e.x)>1||Math.abs(i.y-e.y)>1)&&i.energy!=i.energyCapacity){var a=t.amount;i.energy+a>i.energyCapacity&&(a=i.energyCapacity-i.energy),i.energy+=a,e.energy-=a,o.update(e,{energy:e.energy}),o.update(i,{energy:i.energy})}}}},{\"../../../utils\":184,lodash:61}],183:[function(e,t,r){\"use strict\";var n=e(\"q\"),o=(e(\"lodash\"),e(\"util\"),e(\"./utils\").getDriver());o.constants;o.connect(\"runner\").then(function(){return o.queue.create(\"users\",\"read\")}).then(function(e){var t=e;o.startLoop(\"runner\",function(){var e,r;return o.config.emit(\"runnerLoopStage\",\"start\"),t.fetch().then(function(t){var i,a=(e=r=t).match(/^Invader:(.*)$/);return a&&(e=\"2\",i=a[1]),function(e,t){return o.config.emit(\"runnerLoopStage\",\"runUser\",e,t),o.makeRuntime(e,t).then(r,r);function r(r){o.config.emit(\"runnerLoopStage\",\"saveResultStart\",r),r.console&&o.sendConsoleMessages(e,r.console);var i=[];return r.memory&&i.push(o.saveUserMemory(e,r.memory,t)),r.memorySegments&&i.push(o.saveUserMemorySegments(e,r.memorySegments)),r.interShardSegment&&i.push(o.saveUserMemoryInterShardSegment(e,r.interShardSegment)),r.intents&&i.push(o.saveUserIntents(e,r.intents)),n.all(i).then(function(){if(o.config.emit(\"runnerLoopStage\",\"saveResultFinish\",r),r.error)return n.reject(r.error)})}}(e,i)}).catch(function(t){return o.sendConsoleError(e,t)}).then(function(){return t.markDone(r)}).catch(function(e){}).finally(function(){return o.config.emit(\"runnerLoopStage\",\"finish\",e)})})}).catch(function(e){}),\"undefined\"==typeof self&&setInterval(function(){n.getUnhandledReasons().forEach(function(e){}),n.resetUnhandledRejections()},1e3)},{\"./utils\":184,lodash:61,q:62,util:191}],184:[function(require,module,exports){(function(process){\"use strict\";var _slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),_typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e};function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _=require(\"lodash\"),driver,C,offsetsByDirection;function loadDriver(){var e;_defineProperty(e={},(C=driver.constants).TOP,[0,-1]),_defineProperty(e,C.TOP_RIGHT,[1,-1]),_defineProperty(e,C.RIGHT,[1,0]),_defineProperty(e,C.BOTTOM_RIGHT,[1,1]),_defineProperty(e,C.BOTTOM,[0,1]),_defineProperty(e,C.BOTTOM_LEFT,[-1,1]),_defineProperty(e,C.LEFT,[-1,0]),_defineProperty(e,C.TOP_LEFT,[-1,-1]),offsetsByDirection=e}try{driver=require(\"~runtime-driver\"),loadDriver()}catch(e){}exports.getDriver=function(){return driver=void 0!==process&&process.env.DRIVER_MODULE?require(process.env.DRIVER_MODULE):require(\"./core/index\"),loadDriver(),driver},exports.getRuntimeDriver=function(){try{return require(\"~runtime-driver\")}catch(e){return exports.getDriver()}},exports.fetchXYArguments=function(e,t,r){var n,o,i;if(_.isUndefined(t)||!_.isNumber(t)){if(!_.isObject(e))return[void 0,void 0,void 0];e instanceof r.RoomPosition&&(n=e.x,o=e.y,i=e.roomName),e.pos&&e.pos instanceof r.RoomPosition&&(n=e.pos.x,o=e.pos.y,i=e.pos.roomName)}else n=e,o=t;return _.isNaN(n)&&(n=void 0),_.isNaN(o)&&(o=void 0),[n,o,i]},exports.getDirection=function(e,t){var r=Math.abs(e),n=Math.abs(t);return r>2*n?e>0?C.RIGHT:C.LEFT:n>2*r?t>0?C.BOTTOM:C.TOP:e>0&&t>0?C.BOTTOM_RIGHT:e>0&&t<0?C.TOP_RIGHT:e<0&&t>0?C.BOTTOM_LEFT:e<0&&t<0?C.TOP_LEFT:void 0},exports.getOffsetsByDirection=function(e){if(!offsetsByDirection[e])try{throw new Error}catch(e){}return offsetsByDirection[e]},exports.calcCreepCost=function(e){var t=0;return e.forEach(function(e){_.isObject(e)?t+=C.BODYPART_COST[e.type]:t+=C.BODYPART_COST[e]}),t},exports.checkConstructionSite=function(e,t,r,n){var o;if(\"road\"==t||\"container\"==t||1!=r&&48!=r&&1!=n&&48!=n||(1==r&&(o=[[0,n-1],[0,n],[0,n+1]]),48==r&&(o=[[49,n-1],[49,n],[49,n+1]]),1==n&&(o=[[r-1,0],[r,0],[r+1,0]]),48==n&&(o=[[r-1,49],[r,49],[r+1,49]])),_.isString(e)||e instanceof Uint8Array){if(o)for(var i in o)if(!exports.checkTerrain(e,o[i][0],o[i][1],C.TERRAIN_MASK_WALL))return!1;return\"extractor\"==t||(\"road\"==t||!exports.checkTerrain(e,r,n,C.TERRAIN_MASK_WALL))}if(e&&_.isArray(e[0])&&_.isString(e[0][0])){if(o)for(var i in o)if(!(e[o[i][1]][o[i][0]]&C.TERRAIN_MASK_WALL))return!1;return\"extractor\"==t||!(\"road\"!=t&&e[n][r]&C.TERRAIN_MASK_WALL)}return!_.any(e,{x:r,y:n,type:t})&&(!_.any(e,{x:r,y:n,type:\"constructionSite\"})&&(\"extractor\"==t?_.any(e,{x:r,y:n,type:\"mineral\"})&&!_.any(e,{x:r,y:n,type:\"extractor\"}):(\"rampart\"==t||\"road\"==t||!_.any(e,function(e){return e.x==r&&e.y==n&&\"rampart\"!=e.type&&\"road\"!=e.type&&C.CONSTRUCTION_COST[e.type]}))&&!(r<=0||n<=0||r>=49||n>=49)))},exports.getDiff=function(e,t){function r(e){var t={};return _.forEach(e,function(e){return t[e._id]=e}),t}var n={},o=r(e),i=r(t);return _.forEach(e,function(e){if(i[e._id]){var t=i[e._id],r=n[e._id]={};for(var o in e)if(\"_id\"!=o)if(_.isUndefined(t[o]))r[o]=null;else if(_typeof(e[o])!=_typeof(t[o])||e[o]&&!t[o])r[o]=t[o];else if(_.isObject(e[o])){for(var a in r[o]={},e[o])_.isEqual(e[o][a],t[o][a])||(r[o][a]=t[o][a]);for(var a in t[o])_.isUndefined(e[o][a])&&(r[o][a]=t[o][a]);_.size(r[o])||delete n[e._id][o]}else _.isEqual(e[o],t[o])||(r[o]=t[o]);for(var o in t)_.isUndefined(e[o])&&(r[o]=t[o]);_.size(r)||delete n[e._id]}else n[e._id]=null}),_.forEach(t,function(e){o[e._id]||(n[e._id]=e)}),n},exports.encodeTerrain=function(e){for(var t=\"\",r=0;r<50;r++)for(var n=0;n<50;n++){var o=_.filter(e,{x:n,y:r}),i=0;_.any(o,{type:\"wall\"})&&(i|=C.TERRAIN_MASK_WALL),_.any(o,{type:\"swamp\"})&&(i|=C.TERRAIN_MASK_SWAMP),t+=i}return t},exports.decodeTerrain=function(e){var t=[];for(var r in e)if(\"terrain\"==e[r].type)for(var n=0;n<50;n++)for(var o=0;o<50;o++){var i=e[r].terrain.charAt(50*n+o);i&C.TERRAIN_MASK_WALL&&t.push({room:e[r].room,x:o,y:n,type:\"wall\"}),i&C.TERRAIN_MASK_SWAMP&&t.push({room:e[r].room,x:o,y:n,type:\"swamp\"})}return t},exports.decodeTerrainByRoom=function(e){var t={spatial:{}};for(var r in e)if(\"terrain\"==e[r].type){t[e[r].room]=t[e[r].room]||[],t.spatial[e[r].room]=new Array(50);for(var n=0;n<50;n++){t.spatial[e[r].room][n]=new Array(50);for(var o=0;o<50;o++){var i=e[r].terrain.charAt(50*n+o);t.spatial[e[r].room][n][o]=i}}}return t},exports.checkTerrain=function(e,t,r,n){return((e instanceof Uint8Array?e[50*r+t]:Number(e.charAt(50*r+t)))&n)>0},exports.checkControllerAvailability=function(e,t,r,n){var o=0;return _.isObject(r)&&r.level&&(r.user||r.owner)&&(o=r.level),_.isNumber(r)&&(o=r),n=n||0,_(t).filter(function(t){return t.type==e||\"constructionSite\"==t.type&&t.structureType==e}).size()<C.CONTROLLER_STRUCTURES[e][o]+n},exports.getRoomNameFromXY=function(e,t){return\"\"+(e=e<0?\"W\"+(-e-1):\"E\"+e)+(t=t<0?\"N\"+(-t-1):\"S\"+t)},exports.roomNameToXY=function(e){var t=parseInt(e.substr(1),10),r=2;t>=100?r=4:t>=10&&(r=3);var n=parseInt(e.substr(r+1),10),o=e.charAt(0),i=e.charAt(r);return\"W\"!==o&&\"w\"!==o||(t=-t-1),\"N\"!==i&&\"n\"!==i||(n=-n-1),[t,n]},exports.comparatorDistance=function(e){return e.pos&&(e=e.pos),function(t,r){return t.pos&&(t=t.pos),r.pos&&(r=r.pos),Math.max(Math.abs(t.x-e.x),Math.abs(t.y-e.y))-Math.max(Math.abs(r.x-e.x),Math.abs(r.y-e.y))}},exports.storeIntents=function(e,t,r){var n={};for(var o in t)if(\"notify\"!=o)if(\"room\"!=o)if(\"global\"!=o){var i=r.userObjects[o]||r.roomObjects[o];if(i){var a=t[o];n[i.room]=n[i.room]||{};var s=n[i.room][o]={};a.transfer&&(s.transfer={id:\"\"+a.transfer.id,amount:parseInt(a.transfer.amount),resourceType:\"\"+a.transfer.resourceType}),a.move&&(s.move=a.move.id?{id:\"\"+a.move.id}:{direction:parseInt(a.move.direction)}),a.pull&&(s.pull={id:\"\"+a.pull.id}),a.harvest&&(s.harvest={id:\"\"+a.harvest.id}),a.attack&&(s.attack={id:\"\"+a.attack.id,x:parseInt(a.attack.x),y:parseInt(a.attack.y)}),a.rangedAttack&&(s.rangedAttack={id:\"\"+a.rangedAttack.id}),a.rangedMassAttack&&(s.rangedMassAttack={}),a.heal&&(s.heal={id:\"\"+a.heal.id,x:parseInt(a.heal.x),y:parseInt(a.heal.y)}),a.rangedHeal&&(s.rangedHeal={id:\"\"+a.rangedHeal.id}),a.repair&&(s.repair={id:\"\"+a.repair.id,x:parseInt(a.repair.x),y:parseInt(a.repair.y)}),a.build&&(s.build={id:\"\"+a.build.id,x:parseInt(a.build.x),y:parseInt(a.build.y)}),a.transferEnergy&&(s.transferEnergy={id:\"\"+a.transferEnergy.id,amount:parseInt(a.transferEnergy.amount)}),a.drop&&(s.drop={amount:parseInt(a.drop.amount),resourceType:\"\"+a.drop.resourceType}),a.pickup&&(s.pickup={id:\"\"+a.pickup.id}),a.createCreep&&(s.createCreep={name:\"\"+a.createCreep.name,body:_.filter(a.createCreep.body,function(e){return _.contains(C.BODYPARTS_ALL,e)}),energyStructures:a.createCreep.energyStructures,directions:a.createCreep.directions}),a.renewCreep&&(s.renewCreep={id:\"\"+a.renewCreep.id}),a.recycleCreep&&(s.recycleCreep={id:\"\"+a.recycleCreep.id}),a.suicide&&(s.suicide={}),a.remove&&(s.remove={}),a.unclaim&&(s.unclaim={}),a.say&&(s.say={message:a.say.message.substring(0,10),isPublic:!!a.say.isPublic}),a.claimController&&(s.claimController={id:\"\"+a.claimController.id}),a.attackController&&(s.attackController={id:\"\"+a.attackController.id}),a.unclaimController&&(s.unclaimController={id:\"\"+a.unclaimController.id}),a.upgradeController&&(s.upgradeController={id:\"\"+a.upgradeController.id}),a.reserveController&&(s.reserveController={id:\"\"+a.reserveController.id}),a.notifyWhenAttacked&&(s.notifyWhenAttacked={enabled:!!a.notifyWhenAttacked.enabled}),a.setPosition&&(s.setPosition={x:parseInt(a.setPosition.x),y:parseInt(a.setPosition.y),roomName:\"\"+a.setPosition.roomName}),a.setColor&&(s.setColor={color:\"\"+a.setColor.color,secondaryColor:\"\"+a.setColor.secondaryColor}),a.destroy&&(s.destroy={}),a.observeRoom&&(s.observeRoom={roomName:\"\"+a.observeRoom.roomName}),a.processPower&&(s.processPower={}),a.dismantle&&(s.dismantle={id:\"\"+a.dismantle.id}),a.runReaction&&(s.runReaction={lab1:\"\"+a.runReaction.lab1,lab2:\"\"+a.runReaction.lab2}),a.boostCreep&&(s.boostCreep={id:\"\"+a.boostCreep.id,bodyPartsCount:parseInt(a.boostCreep.bodyPartsCount)}),a.unboostCreep&&(s.unboostCreep={id:\"\"+a.unboostCreep.id}),a.send&&(s.send={targetRoomName:\"\"+a.send.targetRoomName,resourceType:\"\"+a.send.resourceType,amount:parseInt(a.send.amount),description:(\"\"+(a.send.description||\"\")).substring(0,100)}),a.launchNuke&&(s.launchNuke={roomName:\"\"+a.launchNuke.roomName,x:parseInt(a.launchNuke.x),y:parseInt(a.launchNuke.y)}),a.setPublic&&(s.setPublic={isPublic:!!a.setPublic.isPublic}),a.withdraw&&(s.withdraw={id:\"\"+a.withdraw.id,amount:parseInt(a.withdraw.amount),resourceType:\"\"+a.withdraw.resourceType}),a.activateSafeMode&&(s.activateSafeMode={}),a.generateSafeMode&&(s.generateSafeMode={id:\"\"+a.generateSafeMode.id}),a.signController&&(s.signController={id:\"\"+a.signController.id,sign:(\"\"+a.signController.sign).substring(0,100)}),a.setSpawnDirections&&(s.setSpawnDirections={directions:a.setSpawnDirections.directions}),a.cancelSpawning&&(s.cancelSpawning={}),a.usePower&&(s.usePower={power:+a.usePower.power,id:\"\"+a.usePower.id}),a.enableRoom&&(s.enableRoom={id:\"\"+a.enableRoom.id}),a.renew&&(s.renew={id:\"\"+a.renew.id})}}else{var u=t.global;u.createOrder&&_.forEach(u.createOrder,function(e){n.global=n.global||{},n.global.createOrder=n.global.createOrder||[],n.global.createOrder.push({type:\"\"+e.type,resourceType:\"\"+e.resourceType,price:parseInt(1e3*e.price),totalAmount:parseInt(e.totalAmount),roomName:e.roomName?\"\"+e.roomName:void 0})}),u.cancelOrder&&_.forEach(u.cancelOrder,function(e){n.global=n.global||{},n.global.cancelOrder=n.global.cancelOrder||[],n.global.cancelOrder.push({orderId:\"\"+e.orderId})}),u.changeOrderPrice&&_.forEach(u.changeOrderPrice,function(e){n.global=n.global||{},n.global.changeOrderPrice=n.global.changeOrderPrice||[],n.global.changeOrderPrice.push({orderId:\"\"+e.orderId,newPrice:parseInt(1e3*e.newPrice)})}),u.extendOrder&&_.forEach(u.extendOrder,function(e){n.global=n.global||{},n.global.extendOrder=n.global.extendOrder||[],n.global.extendOrder.push({orderId:\"\"+e.orderId,addAmount:parseInt(e.addAmount)})}),u.deal&&_.forEach(u.deal,function(e){n.global=n.global||{},n.global.deal=n.global.deal||[],n.global.deal.push({orderId:\"\"+e.orderId,amount:parseInt(e.amount),targetRoomName:\"\"+e.targetRoomName})}),u.spawnPowerCreep&&_.forEach(u.spawnPowerCreep,function(e){n.global=n.global||{},n.global.spawnPowerCreep=n.global.spawnPowerCreep||[],n.global.spawnPowerCreep.push({id:\"\"+e.id,name:\"\"+e.name})}),u.suicidePowerCreep&&_.forEach(u.suicidePowerCreep,function(e){n.global=n.global||{},n.global.suicidePowerCreep=n.global.suicidePowerCreep||[],n.global.suicidePowerCreep.push({id:\"\"+e.id})}),u.deletePowerCreep&&_.forEach(u.deletePowerCreep,function(e){n.global=n.global||{},n.global.deletePowerCreep=n.global.deletePowerCreep||[],n.global.deletePowerCreep.push({id:\"\"+e.id,cancel:!!e.cancel})}),u.upgradePowerCreep&&_.forEach(u.upgradePowerCreep,function(e){n.global=n.global||{},n.global.upgradePowerCreep=n.global.upgradePowerCreep||[],n.global.upgradePowerCreep.push({id:\"\"+e.id,power:+e.power})}),u.createPowerCreep&&_.forEach(u.createPowerCreep,function(e){n.global=n.global||{},n.global.createPowerCreep=n.global.createPowerCreep||[],n.global.createPowerCreep.push({name:\"\"+e.name,className:\"\"+e.className})}),u.renamePowerCreep&&_.forEach(u.renamePowerCreep,function(e){n.global=n.global||{},n.global.renamePowerCreep=n.global.renamePowerCreep||[],n.global.renamePowerCreep.push({id:\"\"+e.id,name:\"\"+e.name})})}else{var c=t.room;c.createFlag&&_.forEach(c.createFlag,function(e){n[e.roomName]=n[e.roomName]||{};var t=n[e.roomName].room=n[e.roomName].room||{};t.createFlag=t.createFlag||[],t.createFlag.push({x:parseInt(e.x),y:parseInt(e.y),name:\"\"+e.name,color:+e.color,secondaryColor:+e.secondaryColor,roomName:e.roomName})}),c.createConstructionSite&&_.forEach(c.createConstructionSite,function(e){n[e.roomName]=n[e.roomName]||{};var t=n[e.roomName].room=n[e.roomName].room||{};t.createConstructionSite=t.createConstructionSite||[],t.createConstructionSite.push({x:parseInt(e.x),y:parseInt(e.y),structureType:\"\"+e.structureType,name:\"\"+e.name,roomName:\"\"+e.roomName})}),c.removeConstructionSite&&_.forEach(c.removeConstructionSite,function(e){n[e.roomName]=n[e.roomName]||{};var t=n[e.roomName].room=n[e.roomName].room||{};t.removeConstructionSite=t.removeConstructionSite||[],t.removeConstructionSite.push({roomName:\"\"+e.roomName,id:\"\"+e.id})}),c.destroyStructure&&_.forEach(c.destroyStructure,function(e){n[e.roomName]=n[e.roomName]||{};var t=n[e.roomName].room=n[e.roomName].room||{};t.destroyStructure=t.destroyStructure||[],t.destroyStructure.push({roomName:\"\"+e.roomName,id:\"\"+e.id})}),c.removeFlag&&_.forEach(c.removeFlag,function(e){n[e.roomName]=n[e.roomName]||{};var t=n[e.roomName].room=n[e.roomName].room||{};t.removeFlag=t.removeFlag||[],t.removeFlag.push({roomName:\"\"+e.roomName,name:\"\"+e.name})})}else n.notify=[],_.isArray(t.notify)&&t.notify.forEach(function(e){n.notify.push({message:(\"\"+e.message).substring(0,1e3),groupInterval:+e.groupInterval})});return n},exports.sendAttackingNotification=function(e,t){var r,n=exports.getDriver();r=\"creep\"==e.type?\"creep \"+e.name:\"spawn\"==e.type?\"spawn \"+e.name:e.type+\" #\"+e._id;var o=e.user?e.user:t?t.user:null;o&&n.sendNotification(o,\"Your \"+r+\" in room \"+e.room+\" is under attack!\")},exports.checkStructureAgainstController=function(e,t,r){if(!e.user)return!0;if(!r||r.level<1||r.user!==e.user)return!1;var n=C.CONTROLLER_STRUCTURES[e.type][r.level];if(0===n)return!1;if(1===C.CONTROLLER_STRUCTURES[e.type][8])return 0!==n;for(var o=!1,i=Math.max(Math.abs(e.x-r.x),Math.abs(e.y-r.y)),a=_.keys(t),s=0;s<a.length;s++){var u=t[a[s]];if(u.type===e.type&&u.user===e.user){var c=Math.max(Math.abs(u.x-r.x),Math.abs(u.y-r.y));if(c<i){if(0===--n)return!1}else if(!o&&c===i)if(e===u)o=!0;else if(0===--n)return!1}}return!0},exports.defineGameObjectProperties=function(obj,dataFn,properties){var propertiesInfo={};for(var name in properties)eval(\"\\n            propertiesInfo['\"+name+\"'] = {\\n                enumerable: true,\\n                get() {\\n                    if(!this['_\"+name+\"']) {\\n                        this['_\"+name+\"'] = properties['\"+name+\"'](dataFn(this.id), this.id);\\n                    }\\n                    return this['_\"+name+\"'];\\n                }\\n            }\");Object.defineProperties(obj,propertiesInfo),obj.toJSON=function(){var e={};for(var t in this)\"_\"==t[0]||_.contains([\"toJSON\",\"toString\"],t)||(e[t]=this[t]);return e}},exports.isAtEdge=function(e){return e.pos&&(e=e.pos),0==e.x||49==e.x||0==e.y||49==e.y},exports.serializePath=function(e){if(!_.isArray(e))throw new Error(\"path is not an array\");var t=\"\";if(!e.length)return t;if(e[0].x<0||e[0].y<0)throw new Error(\"path coordinates cannot be negative\");t+=e[0].x>9?e[0].x:\"0\"+e[0].x,t+=e[0].y>9?e[0].y:\"0\"+e[0].y;for(var r=0;r<e.length;r++)t+=e[r].direction;return t},exports.deserializePath=function(e){if(!_.isString(e))throw new Error(\"`path` is not a string\");var t,r,n,o,i,a=[];if(!e.length)return a;if(t=parseInt(e.substring(0,2)),r=parseInt(e.substring(2,4)),_.isNaN(t)||_.isNaN(r))throw new Error(\"`path` is not a valid serialized path string\");for(var s=4;s<e.length;s++){if(n=parseInt(e.charAt(s)),!offsetsByDirection[n])throw new Error(\"`path` is not a valid serialized path string\");o=offsetsByDirection[n][0],i=offsetsByDirection[n][1],s>4&&(t+=o,r+=i),a.push({x:t,y:r,dx:o,dy:i,direction:n})}return a},exports.calcResources=function(e){return _.sum(C.RESOURCES_ALL,function(t){return\"object\"==_typeof(e[t])?e[t].amount:e[t]||0})},exports.calcBodyEffectiveness=function(e,t,r,n,o){var i=0;return e.forEach(function(e){if((e.hits||!o&&e._oldHits)&&e.type==t){var a=n;e.boost&&C.BOOSTS[t][e.boost]&&C.BOOSTS[t][e.boost][r]&&(a*=C.BOOSTS[t][e.boost][r]),i+=a}}),i},exports.dist=function(e,t){return e.pos&&(e=e.pos),t.pos&&(t=t.pos),Math.max(Math.abs(e.x-t.x),Math.abs(e.y-t.y))},exports.calcRoomsDistance=function(e,t,r){var n=exports.roomNameToXY(e),o=_slicedToArray(n,2),i=o[0],a=o[1],s=exports.roomNameToXY(t),u=_slicedToArray(s,2),c=u[0],l=u[1],p=Math.abs(c-i),f=Math.abs(l-a);if(r){var d=driver.getWorldSize();p=Math.min(d-p,p),f=Math.min(d-f,f)}return Math.max(p,f)},exports.calcTerminalEnergyCost=function(e,t){return Math.ceil(e*(1-Math.exp(-t/30)))},exports.calcNeededGcl=function(e){return C.GCL_MULTIPLY*Math.pow(e-1,C.GCL_POW)},exports.calcTotalReactionsTime=function(e){var t=_.reduce(C.REACTIONS,function(e,t,r){return _.forEach(t,function(t,n){return e[t]=[n,r]}),e},{});return function e(r){return C.REACTION_TIME[r]?C.REACTION_TIME[r]+e(t[r][0])+e(t[r][1]):0}(e)}}).call(this,require(\"_process\"))},{\"./core/index\":5,_process:188,lodash:61,\"~runtime-driver\":void 0}],185:[function(e,t,r){var n=Object.create||function(e){var t=function(){};return t.prototype=e,new t},o=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},i=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function a(){this._events&&Object.prototype.hasOwnProperty.call(this,\"_events\")||(this._events=n(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var s,u=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,\"x\",{value:0}),s=0===c.x}catch(e){s=!1}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function p(e,t,r,o){var i,a,s;if(\"function\"!=typeof r)throw new TypeError('\"listener\" argument must be a function');if((a=e._events)?(a.newListener&&(e.emit(\"newListener\",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=n(null),e._eventsCount=0),s){if(\"function\"==typeof s?s=a[t]=o?[r,s]:[s,r]:o?s.unshift(r):s.push(r),!s.warned&&(i=l(e))&&i>0&&s.length>i){s.warned=!0;var u=new Error(\"Possible EventEmitter memory leak detected. \"+s.length+' \"'+String(t)+'\" listeners added. Use emitter.setMaxListeners() to increase limit.');u.name=\"MaxListenersExceededWarning\",u.emitter=e,u.type=t,u.count=s.length,\"object\"==typeof console&&console.warn}}else s=a[t]=r,++e._eventsCount;return e}function f(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=i.call(f,n);return o.listener=r,n.wrapFn=o,o}function h(e,t,r){var n=e._events;if(!n)return[];var o=n[t];return o?\"function\"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):y(o,o.length):[]}function m(e){var t=this._events;if(t){var r=t[e];if(\"function\"==typeof r)return 1;if(r)return r.length}return 0}function y(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}s?Object.defineProperty(a,\"defaultMaxListeners\",{enumerable:!0,get:function(){return u},set:function(e){if(\"number\"!=typeof e||e<0||e!=e)throw new TypeError('\"defaultMaxListeners\" must be a positive number');u=e}}):a.defaultMaxListeners=u,a.prototype.setMaxListeners=function(e){if(\"number\"!=typeof e||e<0||isNaN(e))throw new TypeError('\"n\" argument must be a positive number');return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){var t,r,n,o,i,a,s=\"error\"===e;if(a=this._events)s=s&&null==a.error;else if(!s)return!1;if(s){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var u=new Error('Unhandled \"error\" event. ('+t+\")\");throw u.context=t,u}if(!(r=a[e]))return!1;var c=\"function\"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,o=y(e,n),i=0;i<n;++i)o[i].call(r)}(r,c,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var o=e.length,i=y(e,o),a=0;a<o;++a)i[a].call(r,n)}(r,c,this,arguments[1]);break;case 3:!function(e,t,r,n,o){if(t)e.call(r,n,o);else for(var i=e.length,a=y(e,i),s=0;s<i;++s)a[s].call(r,n,o)}(r,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,o,i){if(t)e.call(r,n,o,i);else for(var a=e.length,s=y(e,a),u=0;u<a;++u)s[u].call(r,n,o,i)}(r,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(n-1),i=1;i<n;i++)o[i-1]=arguments[i];!function(e,t,r,n){if(t)e.apply(r,n);else for(var o=e.length,i=y(e,o),a=0;a<o;++a)i[a].apply(r,n)}(r,c,this,o)}return!0},a.prototype.addListener=function(e,t){return p(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return p(this,e,t,!0)},a.prototype.once=function(e,t){if(\"function\"!=typeof t)throw new TypeError('\"listener\" argument must be a function');return this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if(\"function\"!=typeof t)throw new TypeError('\"listener\" argument must be a function');return this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,o,i,a,s;if(\"function\"!=typeof t)throw new TypeError('\"listener\" argument must be a function');if(!(o=this._events))return this;if(!(r=o[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=n(null):(delete o[e],o.removeListener&&this.emit(\"removeListener\",e,r.listener||t));else if(\"function\"!=typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(e,t){for(var r=t,n=r+1,o=e.length;n<o;r+=1,n+=1)e[r]=e[n];e.pop()}(r,i),1===r.length&&(o[e]=r[0]),o.removeListener&&this.emit(\"removeListener\",e,s||t)}return this},a.prototype.removeAllListeners=function(e){var t,r,i;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=n(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=n(null):delete r[e]),this;if(0===arguments.length){var a,s=o(r);for(i=0;i<s.length;++i)\"removeListener\"!==(a=s[i])&&this.removeAllListeners(a);return this.removeAllListeners(\"removeListener\"),this._events=n(null),this._eventsCount=0,this}if(\"function\"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return\"function\"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],186:[function(e,t,r){\"function\"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],187:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];\".\"===o?e.splice(n,1):\"..\"===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift(\"..\");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}r.resolve=function(){for(var r=\"\",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var a=i>=0?arguments[i]:e.cwd();if(\"string\"!=typeof a)throw new TypeError(\"Arguments to path.resolve must be strings\");a&&(r=a+\"/\"+r,o=\"/\"===a.charAt(0))}return r=t(n(r.split(\"/\"),function(e){return!!e}),!o).join(\"/\"),(o?\"/\":\"\")+r||\".\"},r.normalize=function(e){var i=r.isAbsolute(e),a=\"/\"===o(e,-1);return(e=t(n(e.split(\"/\"),function(e){return!!e}),!i).join(\"/\"))||i||(e=\".\"),e&&a&&(e+=\"/\"),(i?\"/\":\"\")+e},r.isAbsolute=function(e){return\"/\"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,function(e,t){if(\"string\"!=typeof e)throw new TypeError(\"Arguments to path.join must be strings\");return e}).join(\"/\"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&\"\"===e[t];t++);for(var r=e.length-1;r>=0&&\"\"===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var o=n(e.split(\"/\")),i=n(t.split(\"/\")),a=Math.min(o.length,i.length),s=a,u=0;u<a;u++)if(o[u]!==i[u]){s=u;break}var c=[];for(u=s;u<o.length;u++)c.push(\"..\");return(c=c.concat(i.slice(s))).join(\"/\")},r.sep=\"/\",r.delimiter=\":\",r.dirname=function(e){if(\"string\"!=typeof e&&(e+=\"\"),0===e.length)return\".\";for(var t=e.charCodeAt(0),r=47===t,n=-1,o=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!o){n=i;break}}else o=!1;return-1===n?r?\"/\":\".\":r&&1===n?\"/\":e.slice(0,n)},r.basename=function(e,t){var r=function(e){\"string\"!=typeof e&&(e+=\"\");var t,r=0,n=-1,o=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!o){r=t+1;break}}else-1===n&&(o=!1,n=t+1);return-1===n?\"\":e.slice(r,n)}(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){\"string\"!=typeof e&&(e+=\"\");for(var t=-1,r=0,n=-1,o=!0,i=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===n&&(o=!1,n=a+1),46===s?-1===t?t=a:1!==i&&(i=1):-1!==t&&(i=-1);else if(!o){r=a+1;break}}return-1===t||-1===n||0===i||1===i&&t===n-1&&t===r+1?\"\":e.slice(t,n)};var o=\"b\"===\"ab\".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,e(\"_process\"))},{_process:188}],188:[function(e,t,r){var n,o,i=t.exports={};function a(){throw new Error(\"setTimeout has not been defined\")}function s(){throw new Error(\"clearTimeout has not been defined\")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n=\"function\"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{o=\"function\"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var c,l=[],p=!1,f=-1;function d(){p&&c&&(p=!1,c.length?l=c.concat(l):f=-1,l.length&&h())}function h(){if(!p){var e=u(d);p=!0;for(var t=l.length;t;){for(c=l,l=[];++f<t;)c&&c[f].run();f=-1,t=l.length}c=null,p=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new m(e,t)),1!==l.length||p||u(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(e){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},{}],189:[function(e,t,r){(function(t,n){var o=e(\"process/browser.js\").nextTick,i=Function.prototype.apply,a=Array.prototype.slice,s={},u=0;function c(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new c(i.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new c(i.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r.setImmediate=\"function\"==typeof t?t:function(e){var t=u++,n=!(arguments.length<2)&&a.call(arguments,1);return s[t]=!0,o(function(){s[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))}),t},r.clearImmediate=\"function\"==typeof n?n:function(e){delete s[e]}}).call(this,e(\"timers\").setImmediate,e(\"timers\").clearImmediate)},{\"process/browser.js\":188,timers:189}],190:[function(e,t,r){t.exports=function(e){return e&&\"object\"==typeof e&&\"function\"==typeof e.copy&&\"function\"==typeof e.fill&&\"function\"==typeof e.readUInt8}},{}],191:[function(e,t,r){(function(t,n){var o=/%[sdj%]/g;r.format=function(e){if(!_(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(\" \")}r=1;for(var n=arguments,i=n.length,a=String(e).replace(o,function(e){if(\"%%\"===e)return\"%\";if(r>=i)return e;switch(e){case\"%s\":return String(n[r++]);case\"%d\":return Number(n[r++]);case\"%j\":try{return JSON.stringify(n[r++])}catch(e){return\"[Circular]\"}default:return e}}),u=n[r];r<i;u=n[++r])m(u)||!g(u)?a+=\" \"+u:a+=\" \"+s(u);return a},r.deprecate=function(e,o){if(R(n.process))return function(){return r.deprecate(e,o).apply(this,arguments)};if(!0===t.noDeprecation)return e;var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(o);t.traceDeprecation,i=!0}return e.apply(this,arguments)}};var i,a={};function s(e,t){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),h(t)?n.showHidden=t:t&&r._extend(n,t),R(n.showHidden)&&(n.showHidden=!1),R(n.depth)&&(n.depth=2),R(n.colors)&&(n.colors=!1),R(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),l(n,e,n.depth)}function u(e,t){var r=s.styles[t];return r?\"[\"+s.colors[r][0]+\"m\"+e+\"[\"+s.colors[r][1]+\"m\":e}function c(e,t){return e}function l(e,t,n){if(e.customInspect&&t&&T(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(n,e);return _(o)||(o=l(e,o,n)),o}var i=function(e,t){if(R(t))return e.stylize(\"undefined\",\"undefined\");if(_(t)){var r=\"'\"+JSON.stringify(t).replace(/^\"|\"$/g,\"\").replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"')+\"'\";return e.stylize(r,\"string\")}if(y(t))return e.stylize(\"\"+t,\"number\");if(h(t))return e.stylize(\"\"+t,\"boolean\");if(m(t))return e.stylize(\"null\",\"null\")}(e,t);if(i)return i;var a=Object.keys(t),s=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),O(t)&&(a.indexOf(\"message\")>=0||a.indexOf(\"description\")>=0))return p(t);if(0===a.length){if(T(t)){var u=t.name?\": \"+t.name:\"\";return e.stylize(\"[Function\"+u+\"]\",\"special\")}if(E(t))return e.stylize(RegExp.prototype.toString.call(t),\"regexp\");if(v(t))return e.stylize(Date.prototype.toString.call(t),\"date\");if(O(t))return p(t)}var c,g=\"\",A=!1,w=[\"{\",\"}\"];(d(t)&&(A=!0,w=[\"[\",\"]\"]),T(t))&&(g=\" [Function\"+(t.name?\": \"+t.name:\"\")+\"]\");return E(t)&&(g=\" \"+RegExp.prototype.toString.call(t)),v(t)&&(g=\" \"+Date.prototype.toUTCString.call(t)),O(t)&&(g=\" \"+p(t)),0!==a.length||A&&0!=t.length?n<0?E(t)?e.stylize(RegExp.prototype.toString.call(t),\"regexp\"):e.stylize(\"[Object]\",\"special\"):(e.seen.push(t),c=A?function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)b(t,String(a))?i.push(f(e,t,r,n,String(a),!0)):i.push(\"\");return o.forEach(function(o){o.match(/^\\d+$/)||i.push(f(e,t,r,n,o,!0))}),i}(e,t,n,s,a):a.map(function(r){return f(e,t,n,s,r,A)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return 0,t.indexOf(\"\\n\")>=0&&0,e+t.replace(/\\u001b\\[\\d\\d?m/g,\"\").length+1},0)>60)return r[0]+(\"\"===t?\"\":t+\"\\n \")+\" \"+e.join(\",\\n  \")+\" \"+r[1];return r[0]+t+\" \"+e.join(\", \")+\" \"+r[1]}(c,g,w)):w[0]+g+w[1]}function p(e){return\"[\"+Error.prototype.toString.call(e)+\"]\"}function f(e,t,r,n,o,i){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=u.set?e.stylize(\"[Getter/Setter]\",\"special\"):e.stylize(\"[Getter]\",\"special\"):u.set&&(s=e.stylize(\"[Setter]\",\"special\")),b(n,o)||(a=\"[\"+o+\"]\"),s||(e.seen.indexOf(u.value)<0?(s=m(r)?l(e,u.value,null):l(e,u.value,r-1)).indexOf(\"\\n\")>-1&&(s=i?s.split(\"\\n\").map(function(e){return\"  \"+e}).join(\"\\n\").substr(2):\"\\n\"+s.split(\"\\n\").map(function(e){return\"   \"+e}).join(\"\\n\")):s=e.stylize(\"[Circular]\",\"special\")),R(a)){if(i&&o.match(/^\\d+$/))return s;(a=JSON.stringify(\"\"+o)).match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,\"name\")):(a=a.replace(/'/g,\"\\\\'\").replace(/\\\\\"/g,'\"').replace(/(^\"|\"$)/g,\"'\"),a=e.stylize(a,\"string\"))}return a+\": \"+s}function d(e){return Array.isArray(e)}function h(e){return\"boolean\"==typeof e}function m(e){return null===e}function y(e){return\"number\"==typeof e}function _(e){return\"string\"==typeof e}function R(e){return void 0===e}function E(e){return g(e)&&\"[object RegExp]\"===A(e)}function g(e){return\"object\"==typeof e&&null!==e}function v(e){return g(e)&&\"[object Date]\"===A(e)}function O(e){return g(e)&&(\"[object Error]\"===A(e)||e instanceof Error)}function T(e){return\"function\"==typeof e}function A(e){return Object.prototype.toString.call(e)}r.debuglog=function(e){if(R(i)&&(i=t.env.NODE_DEBUG||\"\"),e=e.toUpperCase(),!a[e])if(new RegExp(\"\\\\b\"+e+\"\\\\b\",\"i\").test(i)){t.pid;a[e]=function(){r.format.apply(r,arguments)}}else a[e]=function(){};return a[e]},r.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:\"cyan\",number:\"yellow\",boolean:\"yellow\",undefined:\"grey\",null:\"bold\",string:\"green\",date:\"magenta\",regexp:\"red\"},r.isArray=d,r.isBoolean=h,r.isNull=m,r.isNullOrUndefined=function(e){return null==e},r.isNumber=y,r.isString=_,r.isSymbol=function(e){return\"symbol\"==typeof e},r.isUndefined=R,r.isRegExp=E,r.isObject=g,r.isDate=v,r.isError=O,r.isFunction=T,r.isPrimitive=function(e){return null===e||\"boolean\"==typeof e||\"number\"==typeof e||\"string\"==typeof e||\"symbol\"==typeof e||void 0===e},r.isBuffer=e(\"./support/isBuffer\");function b(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.log=function(){},r.inherits=e(\"inherits\"),r._extend=function(e,t){if(!t||!g(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e(\"_process\"),\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./support/isBuffer\":190,_process:188,inherits:186}],192:[function(e,t,r){var n=[];self.onmessage=function(t){if(\"launch\"==t.data.type){switch(t.data.name){case\"main\":e(\"../.engine/main.js\");break;case\"runner\":e(\"../.engine/runner.js\");break;case\"processor\":e(\"../.engine/processor.js\");break;case\"runtime\":e(\"../.engine/core/runtime.js\")}n.forEach(function(e){self.onmessage(e)})}else n.push(t)}},{\"../.engine/core/runtime.js\":14,\"../.engine/main.js\":36,\"../.engine/processor.js\":63,\"../.engine/runner.js\":183}]},{},[192]);"; return (window.URL || window.webkitURL || window).createObjectURL(new Blob([d], {type: 'text/javascript'})); })()