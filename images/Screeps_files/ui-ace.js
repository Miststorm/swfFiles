"use strict";angular.module("ui.ace",[]).constant("uiAceConfig",{}).directive("uiAce",["uiAceConfig",function(e){if(angular.isUndefined(window.ace))throw new Error("ui-ace need ace to work... (o rly?)");return{restrict:"EA",require:"?ngModel",link:function(n,r,a,i){var t,o,s=e.ace||{},u=angular.extend({},s,n.$eval(a.uiAce)),c=window.ace.edit(r[0]),d=c.getSession(),l=function(){var e=arguments[0],r=Array.prototype.slice.call(arguments,1);angular.isDefined(e)&&n.$evalAsync(function(){if(!angular.isFunction(e))throw new Error("ui-ace use a function as callback.");e(r)})},f=function(e){return function(r){var a=d.getValue();!i||a===i.$viewValue||n.$$phase||n.$root.$$phase||n.$evalAsync(function(){i.$setViewValue(a)}),l(e,r,c)}},g=function(e){return function(){l(e,c)}};a.$observe("readonly",function(e){c.setReadOnly(!!e||""===e)}),i&&(i.$formatters.push(function(e){if(angular.isUndefined(e)||null===e)return"";if(angular.isObject(e)||angular.isArray(e))throw new Error("ui-ace cannot use an object or an array as a model");return e}),i.$render=function(){d.setValue(i.$viewValue)});var h=function(e,r){e!==r&&((u=angular.extend({},s,n.$eval(a.uiAce))).callbacks=[u.onLoad],u.onLoad!==s.onLoad&&u.callbacks.unshift(s.onLoad),d.removeListener("change",t),t=f(u.onChange),d.on("change",t),c.removeListener("blur",o),o=g(u.onBlur),c.on("blur",o),function(e,n,r){var a,i;angular.isDefined(r.workerPath)&&window.ace.require("ace/config").set("workerPath",r.workerPath);if(angular.isDefined(r.require)&&r.require.forEach(function(e){window.ace.require(e)}),angular.isDefined(r.showGutter)&&e.renderer.setShowGutter(r.showGutter),angular.isDefined(r.useWrapMode)&&n.setUseWrapMode(r.useWrapMode),angular.isDefined(r.showInvisibles)&&e.renderer.setShowInvisibles(r.showInvisibles),angular.isDefined(r.showIndentGuides)&&e.renderer.setDisplayIndentGuides(r.showIndentGuides),angular.isDefined(r.useSoftTabs)&&n.setUseSoftTabs(r.useSoftTabs),angular.isDefined(r.showPrintMargin)&&e.setShowPrintMargin(r.showPrintMargin),angular.isDefined(r.disableSearch)&&r.disableSearch&&e.commands.addCommands([{name:"unfind",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(){return!1},readOnly:!0}]),angular.isString(r.theme)&&e.setTheme("ace/theme/"+r.theme),angular.isString(r.mode)&&n.setMode("ace/mode/"+r.mode),angular.isDefined(r.firstLineNumber)&&(angular.isNumber(r.firstLineNumber)?n.setOption("firstLineNumber",r.firstLineNumber):angular.isFunction(r.firstLineNumber)&&n.setOption("firstLineNumber",r.firstLineNumber())),angular.isDefined(r.advanced))for(a in r.advanced)i={name:a,value:r.advanced[a]},e.setOption(i.name,i.value);if(angular.isDefined(r.rendererOptions))for(a in r.rendererOptions)i={name:a,value:r.rendererOptions[a]},e.renderer.setOption(i.name,i.value);angular.forEach(r.callbacks,function(n){angular.isFunction(n)&&n(e)})}(c,d,u))};n.$watch(a.uiAce,h,!0),h(s),r.on("$destroy",function(){c.session.$stopWorker(),c.destroy()}),n.$watch(function(){return[r[0].offsetWidth,r[0].offsetHeight]},function(){c.resize(),c.renderer.updateFull()},!0)}}}]);